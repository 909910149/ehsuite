var AppointmentForm=function(d){this.appointId=d;var e=this.setup();var f=new Ext.Window({id:"AppointmentFormWin",iconCls:"menu-appointment",title:"约会详细信息",width:500,height:428,modal:true,layout:"fit",buttonAlign:"center",items:[this.setup()],buttons:[{text:"保存",iconCls:"btn-save",handler:function(){var c=Ext.getCmp("AppointmentForm");if(c.getForm().isValid()){var i=Ext.getCmp("startTime").getValue();var a=Ext.getCmp("endTime").getValue();var b=Date.parse(i);var j=Date.parse(a);if(b>j){Ext.ux.Toast.msg("操作信息","约会开始时间大于结束进间,不能保存!");return;}c.getForm().submit({method:"post",waitMsg:"正在提交数据...",success:function(h,g){Ext.ux.Toast.msg("操作信息","成功保存信息！");Ext.getCmp("AppointmentGrid").getStore().reload();f.close();},failure:function(h,g){Ext.MessageBox.show({title:"操作信息",msg:"信息保存出错，请联系管理员！",buttons:Ext.MessageBox.OK,icon:"ext-mb-error"});f.close();}});}}},{text:"取消",iconCls:"btn-cancel",handler:function(){f.close();}}]});f.show();};AppointmentForm.prototype.setup=function(){var b=new Ext.FormPanel({url:__ctxPath+"/task/saveAppointment.do",layout:"form",id:"AppointmentForm",frame:false,border:false,formId:"AppointmentFormId",bodyStyle:"padding:5px;",defaultType:"textfield",defaults:{anchor:"98%,100%"},items:[{name:"appointment.appointId",id:"appointId",xtype:"hidden",value:this.appointId==null?"":this.appointId},{fieldLabel:"主题",allowBlank:false,name:"appointment.subject",id:"subject"},{fieldLabel:"开始时间",name:"appointment.startTime",id:"startTime",allowBlank:false,xtype:"datetimefield",format:"Y-m-d H:i:s"},{fieldLabel:"结束时间",name:"appointment.endTime",id:"endTime",allowBlank:false,xtype:"datetimefield",format:"Y-m-d H:i:s"},{fieldLabel:"约会内容",name:"appointment.content",xtype:"textarea",allowBlank:false,id:"content"},{fieldLabel:"地点",name:"appointment.location",allowBlank:false,id:"location"},{fieldLabel:"备注",name:"appointment.notes",xtype:"textarea",id:"notes"},{fieldLabel:"受邀人Email",xtype:"textarea",name:"appointment.inviteEmails",id:"inviteEmails"},{xtype:"checkboxgroup",layout:"column",fieldLabel:"提醒方式",items:[{xtype:"checkbox",name:"appointment.sendMessage",boxLabel:"手机提醒",id:"sendMessage",inputValue:0},{xtype:"checkbox",name:"appointment.sendMail",boxLabel:"邮件提醒",id:"sendMail",inputValue:1}]}]});if(this.appointId!=null&&this.appointId!="undefined"){b.getForm().load({deferredRender:false,url:__ctxPath+"/task/getAppointment.do?appointId="+this.appointId,waitMsg:"正在载入数据...",success:function(i,h){var j=h.result.data;if(j.sendMessage==0){var a=Ext.getCmp("sendMessage");a.setValue(true);}if(j.sendMail==1){var g=Ext.getCmp("sendMail");g.setValue(true);}},failure:function(a,d){Ext.ux.Toast.msg("编辑","载入失败");}});}return b;};