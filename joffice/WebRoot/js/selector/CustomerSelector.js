var CustomerSelector={getView:function(j,o){var p=new Ext.tree.TreePanel({title:"客户地区",region:"west",width:180,height:300,split:true,collapsible:true,autoScroll:true,bbar:new Ext.Toolbar({items:[{xtype:"button",text:"展开",iconCls:"btn-expand",handler:function(){p.expandAll();}},{xtype:"button",text:"收起",iconCls:"btn-collapse",handler:function(){p.collapseAll();}}]}),loader:new Ext.tree.TreeLoader({url:__ctxPath+"/system/treeRegion.do"}),root:new Ext.tree.AsyncTreeNode({expanded:true}),rootVisible:false,listeners:{"click":function(a){if(a!=null){var b=Ext.getCmp("CustomerSelectorGrid");var c=b.getStore();c.proxy.conn.url=__ctxPath+"/customer/listCustomer.do";if(a.leaf&&a.id>4){c.baseParams={"Q_city_S_EQ":a.text};}else{if(a.id!=0){c.baseParams={"Q_state_S_EQ":a.text};}else{c.baseParams={"Q_state_S_EQ":null,"Q_city_S_EQ":null};}}c.load({params:{start:0,limit:12}});}}}});var q=null;if(o){var q=new Ext.grid.CheckboxSelectionModel({singleSelect:true});}else{q=new Ext.grid.CheckboxSelectionModel();}var k=new Ext.grid.ColumnModel({columns:[q,new Ext.grid.RowNumberer(),{header:"customerId",dataIndex:"customerId",hidden:true},{header:"客户号",dataIndex:"customerNo",width:60},{header:"客户名称",dataIndex:"customerName",width:60}]});var l=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:__ctxPath+"/customer/listCustomer.do"}),reader:new Ext.data.JsonReader({root:"result",totalProperty:"totalCounts",id:"customerId",fields:[{name:"customerId",type:"int"},"customerNo","customerName"]})});var n=new Ext.grid.GridPanel({id:"CustomerSelectorGrid",width:400,height:300,region:"center",title:"客户列表",store:l,shim:true,trackMouseOver:true,disableSelection:false,loadMask:true,cm:k,sm:q,viewConfig:{forceFit:true,enableRowBody:false,showPreview:false},bbar:new HT.PagingBar({store:l})});l.load({params:{start:0,limit:25}});var r=new Ext.FormPanel({width:400,region:"north",id:"CustomerForm",height:40,frame:false,border:false,layout:"hbox",layoutConfig:{padding:"5",align:"middle"},defaults:{xtype:"label",margins:{top:0,right:4,bottom:4,left:4}},items:[{text:"请输入查询条件:"},{text:"客户号"},{xtype:"textfield",name:"Q_customerNo_S_LK"},{text:"客户名称"},{xtype:"textfield",name:"Q_customerName_S_LK"},{xtype:"button",text:"查询",iconCls:"search",handler:function(){var b=Ext.getCmp("CustomerForm");var a=Ext.getCmp("CustomerSelectorGrid");if(b.getForm().isValid()){b.getForm().submit({waitMsg:"正在提交查询",url:__ctxPath+"/customer/listCustomer.do",success:function(c,e){var d=Ext.util.JSON.decode(e.response.responseText);a.getStore().loadData(d);}});}}}]});var m=new Ext.Window({title:"客户选择器",iconCls:"menu-customerView",width:630,height:380,layout:"border",border:false,items:[p,r,n],modal:true,buttonAlign:"center",buttons:[{iconCls:"btn-ok",text:"确定",handler:function(){var c=Ext.getCmp("CustomerSelectorGrid");var e=c.getSelectionModel().getSelections();var a="";var b="";for(var d=0;d<e.length;d++){if(d>0){a+=",";b+=",";}a+=e[d].data.customerId;b+=e[d].data.customerName;}if(j!=null){j.call(this,a,b);}m.close();}},{text:"取消",iconCls:"btn-cancel",handler:function(){m.close();}}]});return m;}};