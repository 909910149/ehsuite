var RelativeJobSelector={getView:function(g,h){var f=this.initPanel(h);var e=new Ext.Window({id:"RelativeJobSelectorWin",title:"相对岗位选择器",iconCls:"menu-relativeJob",width:630,minWidth:400,height:430,minHeight:430,maximizable:true,layout:"fit",border:false,items:[f],modal:true,buttonAlign:"center",buttons:[{iconCls:"btn-ok",text:"确定",handler:function(){var c="";var a="";if(h==null||h==true){var b=Ext.getCmp("relativeJobSelectorTreePanel").getSelectionModel().getSelectedNode();if(b!=null&&b.id>0){c=b.id;a=b.text;}}else{var i=Ext.getCmp("selectedRelativeJobGridPanel").getStore();for(var d=0;d<i.getCount();d++){c+=i.getAt(d).data.jobId+",";a+=i.getAt(d).data.jobName+",";}c=c.substring(0,c.length-1);a=a.substring(0,a.length-1);}if(g!=null){g.call(this,c,a);}e.close();}},{text:"取消",iconCls:"btn-cancel",handler:function(){e.close();}}]});return e;},initPanel:function(k){var m=k!=null&&k==true?"center":"west";var l=new Ext.tree.TreePanel({id:"relativeJobSelectorTreePanel",layout:"form",region:m,collapsible:true,autoScroll:true,split:true,width:200,title:"相对岗位列表",tbar:new Ext.Toolbar({items:[{xtype:"button",iconCls:"btn-refresh",text:"刷新",handler:function(){l.root.reload();}},{xtype:"button",text:"展开",iconCls:"btn-expand",handler:function(){l.expandAll();}},{xtype:"button",text:"收起",iconCls:"btn-collapse",handler:function(){l.collapseAll();}}]}),loader:new Ext.tree.TreeLoader({url:__ctxPath+"/system/treeLoadRelativeJob.do"}),root:new Ext.tree.AsyncTreeNode({expanded:true}),rootVisible:false,listeners:{"dblclick":this.nodeDBLClick}});var j=new Ext.grid.CheckboxSelectionModel();var i=new Ext.grid.EditorGridPanel({id:"selectedRelativeJobGridPanel",title:"已选相对岗位",layout:"form",region:"center",width:"100%",autoWidth:"100%",height:"100%",autoHeight:"100%",border:false,autoScroll:true,viewConfig:{forceFit:true,enableRowBody:false,showPreview:false},store:new Ext.data.ArrayStore({fields:["jobId","jobName"]}),trackMouseOver:true,sm:j,columns:[j,new Ext.grid.RowNumberer(),{header:"jobId",dataIndex:"jobId",hidden:true},{header:"岗位名称",dataIndex:"jobName"}]});i.addListener("dblclick",function(b){var b=Ext.getCmp("selectedRelativeJobGridPanel");var d=b.getStore();var a=b.getSelectionModel().getSelections();for(var c=0;c<a.length;c++){b.stopEditing();d.remove(a[c]);}});var n=new Ext.Panel({layout:"border",region:"center",width:"100%",height:"100%",border:false,autoScroll:true,items:[new Ext.Panel({region:"west",frame:true,width:40,layout:{type:"vbox",pack:"center",align:"stretch"},defaultType:"button",items:[{iconCls:"add-all",text:"",scope:this,handler:this.addAll},{iconCls:"rem-all",text:"",scope:this,handler:this.removeAll}]}),{region:"center",autoScroll:true,items:[i]}]});var h=new Ext.Panel({layout:"border",region:"center",autoScroll:true,border:false,anchor:"98%,98%",items:[l]});if(k!=null&&k==false){h.add(n);h.doLayout();}return h;},nodeDBLClick:function(k){if(k!=null&&k.id>0){var m=Ext.getCmp("selectedRelativeJobGridPanel");var h=m.getStore();var j=true;for(var n=0;n<h.getCount();n++){if(h.getAt(n).data.jobId==k.id){j=false;break;}}if(j){var l={jobId:k.id,jobName:k.text};var i=new h.recordType(l);m.stopEditing();h.add(i);}}},addAll:function(){var j=Ext.getCmp("relativeJobSelectorTreePanel");var n=Ext.getCmp("selectedRelativeJobGridPanel");var l=j.getSelectionModel().getSelectedNode();if(l!=null&&l.id>0){var p=n.getStore();var k=true;for(var o=0;o<p.getCount();o++){if(p.getAt(o).data.jobId==l.id){k=false;break;}}if(k){var m={jobId:l.id,jobName:l.text};var i=new p.recordType(m);n.stopEditing();p.add(i);}}},removeAll:function(){var h=Ext.getCmp("selectedRelativeJobGridPanel");var g=h.getSelectionModel().getSelections();var f=h.getStore();for(var e=0;e<g.length;e++){h.stopEditing();f.remove(g[e]);}}};