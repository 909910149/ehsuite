Ext.ux.Exporter.ExcelFormatter.Style=Ext.extend(Object,{constructor:function(b){b=b||{};Ext.apply(this,b,{parentStyle:"",attributes:[]});Ext.ux.Exporter.ExcelFormatter.Style.superclass.constructor.apply(this,arguments);if(this.id==undefined){throw new Error("An ID must be provided to Style");}this.preparePropertyStrings();},preparePropertyStrings:function(){Ext.each(this.attributes,function(d,c){this.attributes[c].propertiesString=this.buildPropertyString(d);this.attributes[c].children=d.children||[];Ext.each(d.children,function(a,b){this.attributes[c].children[b].propertiesString=this.buildPropertyString(a);},this);},this);},buildPropertyString:function(c){var d="";Ext.each(c.properties||[],function(a){d+=String.format('ss:{0}="{1}" ',a.name,a.value);},this);return d;},render:function(){return this.tpl.apply(this);},tpl:new Ext.XTemplate('<tpl if="parentStyle.length == 0">','<ss:Style ss:ID="{id}">',"</tpl>",'<tpl if="parentStyle.length != 0">','<ss:Style ss:ID="{id}" ss:Parent="{parentStyle}">',"</tpl>",'<tpl for="attributes">','<tpl if="children.length == 0">',"<ss:{name} {propertiesString} />","</tpl>",'<tpl if="children.length > 0">',"<ss:{name} {propertiesString}>",'<tpl for="children">',"<ss:{name} {propertiesString} />","</tpl>","</ss:{name}>","</tpl>","</tpl>","</ss:Style>")});