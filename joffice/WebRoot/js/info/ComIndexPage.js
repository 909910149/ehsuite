Portlet=Ext.extend(Ext.ux.Portlet,{tools:null,url:null,constructor:function(b){Ext.applyIf(this,b);this.initTool(b);if(b.sectionType==2){this.url=__ctxPath+"/pages/indexpages/deskNewsListPage.jsp?sectionId="+b.sectionId;}else{if(b.sectionType==3){this.url=__ctxPath+"/pages/indexpages/noticeScrollPage.jsp?sectionId="+b.sectionId;}else{this.url=__ctxPath+"/pages/indexpages/newsListPage.jsp?sectionId="+b.sectionId;}}Portlet.superclass.constructor.call(this,{title:b.title,iconCls:b.iconCls,tools:this.tools,autoLoad:{url:this.url,scripts:true}});},initTool:function(b){this.tools=[{id:"refresh",scope:this,handler:function(){this.getUpdater().update(this.url);}}];}});ComIndexPage=Ext.extend(Ext.Panel,{toolbar:null,constructor:function(b){Ext.applyIf(this,b);this.initUIComponents();ComIndexPage.superclass.constructor.call(this,{title:"公司主页",closable:false,id:"ComIndexPage",iconCls:"menu-company",layout:"fit",defaults:{padding:"0 5 0 0"},tbar:this.toolbar,items:[]});},initUIComponents:function(){this.toolbar=new Ext.Toolbar({height:30,items:[{iconCls:"btn-refresh",text:"刷新视图",xtype:"button",scope:this,handler:this.refreshRs.createCallback(this)}]});var b=[{id:"gear",handler:function(){Ext.Msg.alert("Message","The Settings tool was clicked.");}}];this.refreshRs(this);},refreshRs:function(g,i){g.removeAll(true);g.doLayout();var h=[];var j=[];var f=[];Ext.Ajax.request({url:__ctxPath+"/info/listSection.do",method:"POST",params:{"Q_status_SN_EQ":1},success:function(m){var d=Ext.util.JSON.decode(m.responseText);var c=d.result;if(i==null||i==undefined||i==""){i=d.columnType;}for(var e=0;e<d.totalCounts;e++){var a=c[e];if(i==1){h.push(new Portlet({title:a.sectionName,sectionId:a.sectionId,sectionType:a.sectionType}));}else{if(i==2){if(a.colNumber==1){h.push(new Portlet({title:a.sectionName,sectionId:a.sectionId,sectionType:a.sectionType}));}else{j.push(new Portlet({title:a.sectionName,sectionId:a.sectionId,sectionType:a.sectionType}));}}else{if(a.colNumber==1){h.push(new Portlet({title:a.sectionName,sectionId:a.sectionId,sectionType:a.sectionType}));}else{if(a.colNumber==2){j.push(new Portlet({title:a.sectionName,sectionId:a.sectionId,sectionType:a.sectionType}));}else{f.push(new Portlet({title:a.sectionName,sectionId:a.sectionId,sectionType:a.sectionType}));}}}}}var b=null;if(i==1){b=[{columnWidth:0.98,style:"padding:10px 0 10px 10px",name:"FirstColumn",items:h}];}else{if(i==2){b=[{columnWidth:0.64,style:"padding:10px 0 10px 10px",name:"FirstColumn",items:h},{columnWidth:0.35,style:"padding:10px 10px 10px 10px",items:j}];}else{b=[{columnWidth:0.33,style:"padding:10px 0 10px 10px",name:"FirstColumn",items:h},{columnWidth:0.33,style:"padding:10px 10px 10px 10px",items:j},{columnWidth:0.33,style:"padding:10px 0px 10px 0px",items:f}];}}g.add({xtype:"portal",region:"center",border:false,id:"IndexPortal",margins:"35 5 5 0",items:b});g.doLayout();},failure:function(){}});}});