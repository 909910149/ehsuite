MessageWin=Ext.extend(Ext.Window,{constructor:function(b){Ext.applyIf(this,b);MessageWin.superclass.constructor.call(this,{id:"win",title:"",iconCls:"btn-replyM",region:"west",width:300,height:200,x:5,y:350,layout:"fit",plain:true,border:false,bodyStyle:"padding:5px;",buttonAlign:"center",items:[],buttons:[]});this.addUI();},addUI:function(){Ext.Ajax.request({url:__ctxPath+"/info/readInMessage.do",method:"Get",success:function(h,l){var g=Ext.util.JSON.decode(h.responseText);var j=g.message;var i=Ext.getCmp("win");if(j!=null){i.setTitle(j.sender+"--发送的消息");i.add({id:"pp",xtype:"panel",height:150,width:160,html:"<p>  "+j.sender+"  "+j.sendTime+'</p><p style="color:blue;">'+j.content+"</p>"});if(j.haveNext){i.addButton({text:"下一条",iconCls:"btn-down",id:"nextMessage",handler:function(){var a=Ext.getCmp("win");if(a!=null){a.close();}new MessageWin().show();}});}if(j.msgType==1){i.addButton({text:"回复",iconCls:"btn-replyM",id:"replyMessage",handler:function(){var a=Ext.getCmp("win");a.close();new ReMessageWin({id:j.senderId,name:j.sender}).show();}});}i.addButton({text:"删除",iconCls:"btn-del",handler:function(){Ext.Ajax.request({url:__ctxPath+"/info/multiRemoveInMessage.do",method:"POST",params:{ids:j.receiveId},success:function(c,b){var a=Ext.getCmp("win");a.close();Ext.ux.Toast.msg("操作信息","信息删除成功！");},failure:function(b,a){Ext.ux.Toast.msg("操作信息","信息删除失败！");},scope:this});}});i.doLayout();var k=Ext.getCmp("MessagePanelView");if(k!=null){k.getUpdater().update(__ctxPath+"/info/displayInMessage.do");}}else{if(i!=null){i.close();}}}});}});