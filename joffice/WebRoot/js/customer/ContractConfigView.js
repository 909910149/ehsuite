Ext.ns("ContractConfigView");var ContractConfigView=function(){return this.setup();};ContractConfigView.prototype.setup=function(){return this.grid();};ContractConfigView.prototype.grid=function(){var h=new Ext.grid.CheckboxSelectionModel();var g=new Ext.grid.ColumnModel({columns:[h,new Ext.grid.RowNumberer(),{header:"configId",dataIndex:"configId",hidden:true},{header:"设备名称",width:100,dataIndex:"itemName",editor:new Ext.form.TextField({allowBlank:false})},{header:"设置规格",width:100,dataIndex:"itemSpec",editor:new Ext.form.TextField({allowBlank:false})},{header:"数量",width:60,dataIndex:"amount",editor:new Ext.form.NumberField({allowBlank:false})},{header:"备注",width:120,dataIndex:"notes",editor:new Ext.form.TextField({})},{header:"管理",dataIndex:"configId",width:65,sortable:false,renderer:function(c,d,l,a,e){var b='<button title="删除" value=" " class="btn-del" onclick="ContractConfigView.remove('+a+')">&nbsp</button>';return b;}}],defaults:{sortable:true,menuDisabled:false,width:100}});var f=this.store();var i=new Ext.ux.grid.RowEditor({saveText:"Update"});var j=new Ext.grid.EditorGridPanel({id:"ContractConfigGrid",tbar:this.topbar(),store:f,plugins:[i],trackMouseOver:true,disableSelection:false,loadMask:true,width:350,height:180,clicksToEdit:1,cm:g,sm:h,viewConfig:{forceFit:true,enableRowBody:false,showPreview:false}});return j;};ContractConfigView.prototype.store=function(){var b=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:__ctxPath+"/customer/listContractConfig.do"}),reader:new Ext.data.JsonReader({root:"result",totalProperty:"totalCounts",id:"id",fields:[{name:"configId",type:"int"},"itemName","itemSpec","amount","notes"]}),remoteSort:true});b.setDefaultSort("configId","desc");return b;};ContractConfigView.prototype.topbar=function(){var b=new Ext.Toolbar({id:"ContractConfigFootBar",height:28,bodyStyle:"text-align:left",items:[{iconCls:"btn-add",text:"添加配置",xtype:"button",handler:function(){var g=Ext.getCmp("ContractConfigGrid");var a=g.getStore();var h=g.getStore().recordType;var f=new h();g.stopEditing();a.insert(a.getCount(),f);a.sort();g.getView().refresh();g.startEditing(0,0);}},{iconCls:"btn-del",text:"删除配置",xtype:"button",handler:function(){var j=Ext.getCmp("ContractConfigGrid");j.stopEditing();var a=j.getSelectionModel().getSelections();var l=j.getStore();if(a.length==0){Ext.ux.Toast.msg("信息","请选择要删除的记录！");return;}var i=j.getSelectionModel().getSelections();for(var k=0,h;h=i[k];k++){l.remove(h);}l.sort();j.getView().refresh();j.startEditing(0,0);}}]});return b;};ContractConfigView.remove=function(h){var f=Ext.getCmp("ContractConfigGrid");f.stopEditing();var j=f.getSelectionModel().getSelections();for(var g=0,i;i=j[g];g++){f.getStore().remove(i);}f.getView().refresh();f.startEditing(0,0);};