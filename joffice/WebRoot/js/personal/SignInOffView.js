var SignInOffView=function(){var f=new Ext.grid.ColumnModel({defaults:{sortable:false,menuDisabled:true,width:100},columns:[new Ext.grid.RowNumberer(),{dataIndex:"sectionId",hidden:true},{dataIndex:"signInFlag",hidden:true},{dataIndex:"signOffFlag",hidden:true},{dataIndex:"allowSignIn",hidden:true},{dataIndex:"allowSignOff",hidden:true},{header:"班次名称",dataIndex:"systemName"},{header:"上班规定时间",dataIndex:"dutyStartTime"},{header:"签到时间",dataIndex:"signInTime"},{header:"签到",dataIndex:"signInTime",renderer:function(a,c,k){var b=k.data.sectionId;var l=k.data.signInFlag;if(l!=""){if(l==1){return'<img src="'+__ctxPath+'/images/flag/personal/signNormal.gif" title="正常"/>';}else{if(l==2){return'<img src="'+__ctxPath+'/images/flag/personal/signLateEarly.gif" title="迟到"/>';}}}else{var d=k.data.allowSignIn;if(d=="1"){return'<button class="btn-signIn" title="签到" onclick="SignInOffView.signIn('+b+');">&nbsp;</button>';}else{if(d=="-1"){return"尚未到签到时间";}else{return"<font color='red'>已过签到时间</font>";}}}}},{header:"下班规定时间",dataIndex:"dutyEndTime"},{header:"签退时间",dataIndex:"signOffTime"},{header:"签退",dataIndex:"signOffTime",renderer:function(a,d,k){var c=k.data.sectionId;var l=k.data.signOffFlag;if(l!=""){if(l==1){return'<img src="'+__ctxPath+'/images/flag/personal/signNormal.gif" title="正常"/>';}else{if(l==3){return'<img src="'+__ctxPath+'/images/flag/personal/signLateEarly.gif" title="早退"/>';}}}else{var b=k.data.allowSignOff;if(b=="1"){return'<button class="btn-signOff" title="签退" onclick="SignInOffView.signOff('+c+');">&nbsp;</button>';}else{if(b=="-1"){return"尚未到签退时间";}else{return"<font color='red'>已过签退时间</font>";}}}}}]});var h=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:__ctxPath+"/personal/todayDutyRegister.do"}),reader:new Ext.data.JsonReader({root:"result",fields:["sectionId","systemName","dutyStartTime","signInTime","signInFlag","dutyEndTime","signOffTime","signOffFlag","allowSignIn","allowSignOff"]})});h.load();var g=new Ext.grid.GridPanel({id:"SignInOffGrid",margins:"0",border:false,store:h,tbar:new Ext.Toolbar({height:28,items:[{text:"刷新",iconCls:"btn-refresh",handler:function(){h.reload();}},{text:"请假登记",iconCls:"menu-holiday",handler:function(){App.clickTopTab("ErrandsRegisterView");}},{text:"外出登记",iconCls:"menu-errands",handler:function(){App.clickTopTab("ErrandsRegisterOutView");}},{text:"个人考勤查询",iconCls:"menu-person",handler:function(){App.clickTopTab("DutyRegisterPersonView");}}]}),height:200,cm:f});var e=new Ext.Panel({title:"考勤--签到、签退",iconCls:"menu-signInOff",id:"SignInOffView",layout:"anchor",items:[g,{xtype:"panel",height:250,border:false,bodyStyle:"padding-top:20px;padding-left:20px;text-align:center",html:'<h1>请按规定的时间进行上下班签到签退</h1><img src="'+__ctxPath+'/images/clock.jpg"/>'}]});return e;};SignInOffView.signIn=function(b){Ext.Ajax.request({url:__ctxPath+"/personal/signInDutyRegister.do",method:"POST",params:{sectionId:b},success:function(a,d){Ext.getCmp("SignInOffGrid").getStore().reload();Ext.ux.Toast.msg("操作信息","成功签到！");}});};SignInOffView.signOff=function(b){Ext.Ajax.request({url:__ctxPath+"/personal/signOffDutyRegister.do",method:"POST",params:{sectionId:b},success:function(a,d){Ext.getCmp("SignInOffGrid").getStore().reload();Ext.ux.Toast.msg("操作信息","成功签退！");}});};