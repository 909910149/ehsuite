var TreeCombo=Ext.extend(Ext.form.ComboBox,{constructor:function(e){var h={store:new Ext.data.SimpleStore({fields:[],data:[[]]}),editable:false,mode:"local",emptyText:"请选择",triggerAction:"all",maxHeight:200,tpl:"<tpl for='.'><div style='height:200px'><div id='"+e.id+"tree'></div></div></tpl>",onSelect:Ext.emptyFn}||e;Ext.apply(this,h);TreeCombo.superclass.constructor.call(this,h);var f=new Ext.tree.TreePanel({id:e.id+"Tree",height:200,autoScroll:true,split:true,loader:new Ext.tree.TreeLoader({url:e.url}),root:new Ext.tree.AsyncTreeNode({expanded:true}),rootVisible:false});var g=this;g.on("collapse",function(a){var b=f.getSelectionModel().getSelectedNode();if(b==null){g.expand();return;}else{f.getSelectionModel().clearSelections();}},this);f.on("click",function(a){var b=Ext.getCmp(e.valId);if(a.id!=null&&a.id!=""){g.setValue(a.text);g.id=a.id;g.collapse();if(b!=null){b.setValue(a.id);}}});this.on("expand",function(){f.render(e.id+"tree");});}});Ext.reg("treecombo",TreeCombo);