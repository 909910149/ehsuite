var FCK_STATUS_NOTLOADED=window.parent.FCK_STATUS_NOTLOADED=0;var FCK_STATUS_ACTIVE=window.parent.FCK_STATUS_ACTIVE=1;var FCK_STATUS_COMPLETE=window.parent.FCK_STATUS_COMPLETE=2;var FCK_TRISTATE_OFF=window.parent.FCK_TRISTATE_OFF=0;var FCK_TRISTATE_ON=window.parent.FCK_TRISTATE_ON=1;var FCK_TRISTATE_DISABLED=window.parent.FCK_TRISTATE_DISABLED=-1;var FCK_UNKNOWN=window.parent.FCK_UNKNOWN=-9;var FCK_TOOLBARITEM_ONLYICON=window.parent.FCK_TOOLBARITEM_ONLYICON=0;var FCK_TOOLBARITEM_ONLYTEXT=window.parent.FCK_TOOLBARITEM_ONLYTEXT=1;var FCK_TOOLBARITEM_ICONTEXT=window.parent.FCK_TOOLBARITEM_ICONTEXT=2;var FCK_EDITMODE_WYSIWYG=window.parent.FCK_EDITMODE_WYSIWYG=0;var FCK_EDITMODE_SOURCE=window.parent.FCK_EDITMODE_SOURCE=1;var FCK_IMAGES_PATH="images/";var FCK_SPACER_PATH="images/spacer.gif";var CTRL=1000;var SHIFT=2000;var ALT=4000;var FCK_STYLE_BLOCK=0;var FCK_STYLE_INLINE=1;var FCK_STYLE_OBJECT=2;String.prototype.Contains=function(b){return(this.indexOf(b)>-1);};String.prototype.Equals=function(){var d=arguments;if(d.length==1&&d[0].pop){d=d[0];}for(var c=0;c<d.length;c++){if(this==d[c]){return true;}}return false;};String.prototype.IEquals=function(){var f=this.toUpperCase();var g=arguments;if(g.length==1&&g[0].pop){g=g[0];}for(var d=0;d<g.length;d++){if(f==g[d].toUpperCase()){return true;}}return false;};String.prototype.ReplaceAll=function(g,h){var j=this;for(var f=0;f<g.length;f++){j=j.replace(g[f],h[f]);}return j;};String.prototype.StartsWith=function(b){return(this.substr(0,b.length)==b);};String.prototype.EndsWith=function(h,j){var k=this.length;var l=h.length;if(l>k){return false;}if(j){var g=new RegExp(h+"$","i");return g.test(this);}else{return(l==0||this.substr(k-l,l)==h);}};String.prototype.Remove=function(f,g){var d="";if(f>0){d=this.substring(0,f);}if(f+g<this.length){d+=this.substring(f+g,this.length);}return d;};String.prototype.Trim=function(){return this.replace(/(^[ \t\n\r]*)|([ \t\n\r]*$)/g,"");};String.prototype.LTrim=function(){return this.replace(/^[ \t\n\r]*/g,"");};String.prototype.RTrim=function(){return this.replace(/[ \t\n\r]*$/g,"");};String.prototype.ReplaceNewLineChars=function(b){return this.replace(/\n/g,b);};String.prototype.Replace=function(f,g,d){if(typeof g=="function"){return this.replace(f,function(){return g.apply(d||this,arguments);});}else{return this.replace(f,g);}};Array.prototype.IndexOf=function(d){for(var c=0;c<this.length;c++){if(this[c]==d){return c;}}return -1;};var FCKIECleanup=function(b){if(b._FCKCleanupObj){this.Items=b._FCKCleanupObj.Items;}else{this.Items=[];b._FCKCleanupObj=this;FCKTools.AddEventListenerEx(b,"unload",FCKIECleanup_Cleanup);}};FCKIECleanup.prototype.AddItem=function(d,c){this.Items.push([d,c]);};function FCKIECleanup_Cleanup(){if(!this._FCKCleanupObj||(FCKConfig.MsWebBrowserControlCompat&&!window.FCKUnloadFlag)){return;}var d=this._FCKCleanupObj.Items;while(d.length>0){var c=d.pop();if(c){c[1].call(c[0]);}}this._FCKCleanupObj=null;if(CollectGarbage){CollectGarbage();}}var s=navigator.userAgent.toLowerCase();var FCKBrowserInfo={IsIE:
/*@cc_on!@*/
false,IsIE7:
/*@cc_on!@*/
false&&(parseInt(s.match(/msie (\d+)/)[1],10)>=7),IsIE6:
/*@cc_on!@*/
false&&(parseInt(s.match(/msie (\d+)/)[1],10)>=6),IsSafari:s.Contains(" applewebkit/"),IsOpera:!!window.opera,IsAIR:s.Contains(" adobeair/"),IsMac:s.Contains("macintosh")};(function(f){f.IsGecko=(navigator.product=="Gecko")&&!f.IsSafari&&!f.IsOpera;f.IsGeckoLike=(f.IsGecko||f.IsSafari||f.IsOpera);if(f.IsGecko){var g=s.match(/rv:(\d+\.\d+)/);var d=g&&parseFloat(g[1]);if(d){f.IsGecko10=(d<1.8);f.IsGecko19=(d>1.8);}}if(f.IsSafari){f.IsSafari3=(parseFloat(s.match(/ applewebkit\/(\d+)/)[1])<526);}})(FCKBrowserInfo);var FCKURLParams={};(function(){var h=document.location.search.substr(1).split("&");for(var g=0;g<h.length;g++){var j=h[g].split("=");var k=decodeURIComponent(j[0]);var l=decodeURIComponent(j[1]);FCKURLParams[k]=l;}})();var FCKEvents=function(b){this.Owner=b;this._RegisteredEvents={};};FCKEvents.prototype.AttachEvent=function(f,g){var d;if(!(d=this._RegisteredEvents[f])){this._RegisteredEvents[f]=[g];}else{if(d.IndexOf(g)==-1){d.push(g);}}};FCKEvents.prototype.FireEvent=function(j,k){var l=true;var m=this._RegisteredEvents[j];if(m){for(var h=0;h<m.length;h++){try{l=(m[h](this.Owner,k)&&l);}catch(n){if(n.number!=-2146823277){throw n;}}}}return l;};var FCKDataProcessor=function(){};FCKDataProcessor.prototype={ConvertToHtml:function(d){if(FCKConfig.FullPage){FCK.DocTypeDeclaration=d.match(FCKRegexLib.DocTypeTag);if(!FCKRegexLib.HasBodyTag.test(d)){d="<body>"+d+"</body>";}if(!FCKRegexLib.HtmlOpener.test(d)){d='<html dir="'+FCKConfig.ContentLangDirection+'">'+d+"</html>";}if(!FCKRegexLib.HeadOpener.test(d)){d=d.replace(FCKRegexLib.HtmlOpener,"$&<head><title></title></head>");}return d;}else{var c=FCKConfig.DocType+'<html dir="'+FCKConfig.ContentLangDirection+'"';if(FCKBrowserInfo.IsIE&&FCKConfig.DocType.length>0&&!FCKRegexLib.Html4DocType.test(FCKConfig.DocType)){c+=' style="overflow-y: scroll"';}c+="><head><title></title></head><body"+FCKConfig.GetBodyAttributes()+">"+d+"</body></html>";return c;}},ConvertToDataFormat:function(h,j,k,l){var g=FCKXHtml.GetXHTML(h,!j,l);if(k&&FCKRegexLib.EmptyOutParagraph.test(g)){return"";}return g;},FixHtml:function(b){return b;}};var FCK={Name:FCKURLParams["InstanceName"],Status:0,EditMode:0,Toolbar:null,HasFocus:false,DataProcessor:new FCKDataProcessor(),GetInstanceObject:(function(){var b=window;return function(a){return b[a];};})(),AttachToOnSelectionChange:function(b){this.Events.AttachEvent("OnSelectionChange",b);},GetLinkedFieldValue:function(){return this.LinkedField.value;},GetParentForm:function(){return this.LinkedField.form;},StartupValue:"",IsDirty:function(){if(this.EditMode==1){return(this.StartupValue!=this.EditingArea.Textarea.value);}else{if(!this.EditorDocument){return false;}return(this.StartupValue!=this.EditorDocument.body.innerHTML);}},ResetIsDirty:function(){if(this.EditMode==1){this.StartupValue=this.EditingArea.Textarea.value;}else{if(this.EditorDocument.body){this.StartupValue=this.EditorDocument.body.innerHTML;}}},StartEditor:function(){this.TempBaseTag=FCKConfig.BaseHref.length>0?'<base href="'+FCKConfig.BaseHref+'" _fcktemp="true"></base>':"";var b=FCK.KeystrokeHandler=new FCKKeystrokeHandler();b.OnKeystroke=_FCK_KeystrokeHandler_OnKeystroke;b.SetKeystrokes(FCKConfig.Keystrokes);if(FCKBrowserInfo.IsIE7){if((CTRL+86) in b.Keystrokes){b.SetKeystrokes([CTRL+86,true]);}if((SHIFT+45) in b.Keystrokes){b.SetKeystrokes([SHIFT+45,true]);}}b.SetKeystrokes([CTRL+8,true]);this.EditingArea=new FCKEditingArea(document.getElementById("xEditingArea"));this.EditingArea.FFSpellChecker=FCKConfig.FirefoxSpellChecker;this.SetData(this.GetLinkedFieldValue(),true);FCKTools.AddEventListener(document,"keydown",this._TabKeyHandler);this.AttachToOnSelectionChange(_FCK_PaddingNodeListener);if(FCKBrowserInfo.IsGecko){this.AttachToOnSelectionChange(this._ExecCheckEmptyBlock);}},Focus:function(){FCK.EditingArea.Focus();},SetStatus:function(b){this.Status=b;if(b==1){FCKFocusManager.AddWindow(window,true);if(FCKBrowserInfo.IsIE){FCKFocusManager.AddWindow(window.frameElement,true);}if(FCKConfig.StartupFocus){FCK.Focus();}}this.Events.FireEvent("OnStatusChange",b);},FixBody:function(){var l=FCKConfig.EnterMode;if(l!="p"&&l!="div"){return;}var m=this.EditorDocument;if(!m){return;}var n=m.body;if(!n){return;}FCKDomTools.TrimNode(n);var o=n.firstChild;var p;while(o){var q=false;switch(o.nodeType){case 1:var r=o.nodeName.toLowerCase();if(!FCKListsLib.BlockElements[r]&&r!="li"&&!o.getAttribute("_fckfakelement")&&o.getAttribute("_moz_dirty")==null){q=true;}break;case 3:if(p||o.nodeValue.Trim().length>0){q=true;}break;case 8:if(p){q=true;}break;}if(q){var k=o.parentNode;if(!p){p=k.insertBefore(m.createElement(l),o);}p.appendChild(k.removeChild(o));o=p.nextSibling;}else{if(p){FCKDomTools.TrimNode(p);p=null;}o=o.nextSibling;}}if(p){FCKDomTools.TrimNode(p);}},GetData:function(g){FCK.Events.FireEvent("OnBeforeGetData");if(FCK.EditMode==1){return FCK.EditingArea.Textarea.value;}this.FixBody();var h=FCK.EditorDocument;if(!h){return null;}var j=FCKConfig.FullPage;var f=FCK.DataProcessor.ConvertToDataFormat(j?h.documentElement:h.body,!j,FCKConfig.IgnoreEmptyParagraphValue,g);f=FCK.ProtectEventsRestore(f);if(FCKBrowserInfo.IsIE){f=f.replace(FCKRegexLib.ToReplace,"$1");}if(j){if(FCK.DocTypeDeclaration&&FCK.DocTypeDeclaration.length>0){f=FCK.DocTypeDeclaration+"\n"+f;}if(FCK.XmlDeclaration&&FCK.XmlDeclaration.length>0){f=FCK.XmlDeclaration+"\n"+f;}}f=FCKConfig.ProtectedSource.Revert(f);setTimeout(function(){FCK.Events.FireEvent("OnAfterGetData");},0);return f;},UpdateLinkedField:function(){var b=FCK.GetXHTML(FCKConfig.FormatOutput);if(FCKConfig.HtmlEncodeOutput){b=FCKTools.HTMLEncode(b);}FCK.LinkedField.value=b;FCK.Events.FireEvent("OnAfterLinkedFieldUpdate");},RegisteredDoubleClickHandlers:{},OnDoubleClick:function(f){var g=FCK.RegisteredDoubleClickHandlers[f.tagName.toUpperCase()];if(g){for(var d=0;d<g.length;d++){g[d](f);}}g=FCK.RegisteredDoubleClickHandlers["*"];if(g){for(var d=0;d<g.length;d++){g[d](f);}}},RegisterDoubleClickHandler:function(g,h){var j=h||"*";j=j.toUpperCase();var f;if(!(f=FCK.RegisteredDoubleClickHandlers[j])){FCK.RegisteredDoubleClickHandlers[j]=[g];}else{if(f.IndexOf(g)==-1){f.push(g);}}},OnAfterSetHTML:function(){FCKDocumentProcessor.Process(FCK.EditorDocument);FCKUndo.SaveUndoStep();FCK.Events.FireEvent("OnSelectionChange");FCK.Events.FireEvent("OnAfterSetHTML");},ProtectUrls:function(b){b=b.replace(FCKRegexLib.ProtectUrlsA,"$& _fcksavedurl=$1");b=b.replace(FCKRegexLib.ProtectUrlsImg,"$& _fcksavedurl=$1");b=b.replace(FCKRegexLib.ProtectUrlsArea,"$& _fcksavedurl=$1");return b;},ProtectEvents:function(b){return b.replace(FCKRegexLib.TagsWithEvent,_FCK_ProtectEvents_ReplaceTags);},ProtectEventsRestore:function(b){return b.replace(FCKRegexLib.ProtectedEvents,_FCK_ProtectEvents_RestoreEvents);},ProtectTags:function(f){var g=FCKConfig.ProtectedTags;if(FCKBrowserInfo.IsIE){g+=g.length>0?"|ABBR|XML|EMBED|OBJECT":"ABBR|XML|EMBED|OBJECT";}var d;if(g.length>0){d=new RegExp("<("+g+")(?!w|:)","gi");f=f.replace(d,"<FCK:$1");d=new RegExp("</("+g+")>","gi");f=f.replace(d,"</FCK:$1>");}g="META";if(FCKBrowserInfo.IsIE){g+="|HR";}d=new RegExp("<(("+g+")(?=\\s|>|/)[\\s\\S]*?)/?>","gi");f=f.replace(d,"<FCK:$1 />");return f;},SetData:function(f,g){this.EditingArea.Mode=FCK.EditMode;if(FCKBrowserInfo.IsIE&&FCK.EditorDocument){FCK.EditorDocument.detachEvent("onselectionchange",Doc_OnSelectionChange);}FCKTempBin.Reset();FCK.Selection.Release();if(FCK.EditMode==0){this._ForceResetIsDirty=(g===true);f=FCKConfig.ProtectedSource.Protect(f);f=FCK.DataProcessor.ConvertToHtml(f);f=f.replace(FCKRegexLib.InvalidSelfCloseTags,"$1></$2>");f=FCK.ProtectEvents(f);f=FCK.ProtectUrls(f);f=FCK.ProtectTags(f);if(FCK.TempBaseTag.length>0&&!FCKRegexLib.HasBaseTag.test(f)){f=f.replace(FCKRegexLib.HeadOpener,"$&"+FCK.TempBaseTag);}var d="";if(!FCKConfig.FullPage){d+=_FCK_GetEditorAreaStyleTags();}if(FCKBrowserInfo.IsIE){d+=FCK._GetBehaviorsStyle();}else{if(FCKConfig.ShowBorders){d+=FCKTools.GetStyleHtml(FCK_ShowTableBordersCSS,true);}}d+=FCKTools.GetStyleHtml(FCK_InternalCSS,true);f=f.replace(FCKRegexLib.HeadCloser,d+"$&");this.EditingArea.OnLoad=_FCK_EditingArea_OnLoad;this.EditingArea.Start(f);}else{FCK.EditorWindow=null;FCK.EditorDocument=null;FCKDomTools.PaddingNode=null;this.EditingArea.OnLoad=null;this.EditingArea.Start(f);this.EditingArea.Textarea._FCKShowContextMenu=true;FCK.EnterKeyHandler=null;if(g){this.ResetIsDirty();}FCK.KeystrokeHandler.AttachToElement(this.EditingArea.Textarea);this.EditingArea.Textarea.focus();FCK.Events.FireEvent("OnAfterSetHTML");}if(window.onresize){window.onresize();}},RedirectNamedCommands:{},ExecuteNamedCommand:function(g,h,j,f){if(!f){FCKUndo.SaveUndoStep();}if(!j&&FCK.RedirectNamedCommands[g]!=null){FCK.ExecuteRedirectedNamedCommand(g,h);}else{FCK.Focus();FCK.EditorDocument.execCommand(g,false,h);FCK.Events.FireEvent("OnSelectionChange");}if(!f){FCKUndo.SaveUndoStep();}},GetNamedCommandState:function(d){try{if(FCKBrowserInfo.IsSafari&&FCK.EditorWindow&&d.IEquals("Paste")){return 0;}if(!FCK.EditorDocument.queryCommandEnabled(d)){return -1;}else{return FCK.EditorDocument.queryCommandState(d)?1:0;}}catch(c){return 0;}},GetNamedCommandValue:function(g){var h="";var j=FCK.GetNamedCommandState(g);if(j==-1){return null;}try{h=this.EditorDocument.queryCommandValue(g);}catch(f){}return h?h:"";},Paste:function(b){if(FCK.Status!=2||!FCK.Events.FireEvent("OnPaste")){return false;}return b||FCK._ExecPaste();},PasteFromWord:function(){FCKDialog.OpenDialog("FCKDialog_Paste",FCKLang.PasteFromWord,"dialog/fck_paste.html",400,330,"Word");},Preview:function(){var j;if(FCKConfig.FullPage){if(FCK.TempBaseTag.length>0){j=FCK.TempBaseTag+FCK.GetXHTML();}else{j=FCK.GetXHTML();}}else{j=FCKConfig.DocType+'<html dir="'+FCKConfig.ContentLangDirection+'"><head>'+FCK.TempBaseTag+"<title>"+FCKLang.Preview+"</title>"+_FCK_GetEditorAreaStyleTags()+"</head><body"+FCKConfig.GetBodyAttributes()+">"+FCK.GetXHTML()+"</body></html>";}var k=FCKConfig.ScreenWidth*0.8;var l=FCKConfig.ScreenHeight*0.7;var m=(FCKConfig.ScreenWidth-k)/2;var n="";if(FCK_IS_CUSTOM_DOMAIN&&FCKBrowserInfo.IsIE){window._FCKHtmlToLoad=j;n='javascript:void( (function(){document.open() ;document.domain="'+document.domain+'" ;document.write( window.opener._FCKHtmlToLoad );document.close() ;window.opener._FCKHtmlToLoad = null ;})() )';}var h=window.open(n,null,"toolbar=yes,location=no,status=yes,menubar=yes,scrollbars=yes,resizable=yes,width="+k+",height="+l+",left="+m);if(!FCK_IS_CUSTOM_DOMAIN||!FCKBrowserInfo.IsIE){h.document.write(j);h.document.close();}},SwitchEditMode:function(g){var h=(FCK.EditMode==0);var j=FCK.IsDirty();var f;if(h){FCKCommands.GetCommand("ShowBlocks").SaveState();if(!g&&FCKBrowserInfo.IsIE){FCKUndo.SaveUndoStep();}f=FCK.GetXHTML(FCKConfig.FormatSource);if(FCKBrowserInfo.IsIE){FCKTempBin.ToHtml();}if(f==null){return false;}}else{f=this.EditingArea.Textarea.value;}FCK.EditMode=h?1:0;FCK.SetData(f,!j);FCK.Focus();FCKTools.RunFunction(FCK.ToolbarSet.RefreshModeState,FCK.ToolbarSet);return true;},InsertElement:function(g){if(typeof g=="string"){g=this.EditorDocument.createElement(g);}var h=g.nodeName.toLowerCase();FCKSelection.Restore();var j=new FCKDomRange(this.EditorWindow);j.MoveToSelection();j.DeleteContents();if(FCKListsLib.BlockElements[h]!=null){if(j.StartBlock){if(j.CheckStartOfBlock()){j.MoveToPosition(j.StartBlock,3);}else{if(j.CheckEndOfBlock()){j.MoveToPosition(j.StartBlock,4);}else{j.SplitBlock();}}}j.InsertNode(g);var f=FCKDomTools.GetNextSourceElement(g,false,null,["hr","br","param","img","area","input"],true);if(!f&&FCKConfig.EnterMode!="br"){f=this.EditorDocument.body.appendChild(this.EditorDocument.createElement(FCKConfig.EnterMode));if(FCKBrowserInfo.IsGeckoLike){FCKTools.AppendBogusBr(f);}}if(FCKListsLib.EmptyElements[h]==null){j.MoveToElementEditStart(g);}else{if(f){j.MoveToElementEditStart(f);}else{j.MoveToPosition(g,4);}}if(FCKBrowserInfo.IsGeckoLike){if(f){FCKDomTools.ScrollIntoView(f,false);}FCKDomTools.ScrollIntoView(g,false);}}else{j.InsertNode(g);j.SetStart(g,4);j.SetEnd(g,4);}j.Select();j.Release();this.Focus();return g;},_InsertBlockElement:function(b){},_IsFunctionKey:function(b){if(b>=16&&b<=20){return true;}if(b==27||(b>=33&&b<=40)){return true;}if(b==45){return true;}return false;},_KeyDownListener:function(b){if(!b){b=FCK.EditorWindow.event;}if(FCK.EditorWindow){if(!FCK._IsFunctionKey(b.keyCode)&&!(b.ctrlKey||b.metaKey)&&!(b.keyCode==46)){FCK._KeyDownUndo();}}return true;},_KeyDownUndo:function(){if(!FCKUndo.Typing){FCKUndo.SaveUndoStep();FCKUndo.Typing=true;FCK.Events.FireEvent("OnSelectionChange");}FCKUndo.TypesCount++;FCKUndo.Changed=1;if(FCKUndo.TypesCount>FCKUndo.MaxTypes){FCKUndo.TypesCount=0;FCKUndo.SaveUndoStep();}},_TabKeyHandler:function(a){if(!a){a=window.event;}var k=a.keyCode;if(k==9&&FCK.EditMode!=0){if(FCKBrowserInfo.IsIE){var l=document.selection.createRange();if(l.parentElement()!=FCK.EditingArea.Textarea){return true;}l.text="\t";l.select();}else{var p=[];var m=FCK.EditingArea.Textarea;var n=m.selectionStart;var o=m.selectionEnd;p.push(m.value.substr(0,n));p.push("\t");p.push(m.value.substr(o));m.value=p.join("");m.setSelectionRange(n+1,n+1);}if(a.preventDefault){return a.preventDefault();}return a.returnValue=false;}return true;}};FCK.Events=new FCKEvents(FCK);FCK.GetHTML=FCK.GetXHTML=FCK.GetData;FCK.SetHTML=FCK.SetData;FCK.InsertElementAndGetIt=FCK.CreateElement=FCK.InsertElement;function _FCK_ProtectEvents_ReplaceTags(b){return b.replace(FCKRegexLib.EventAttributes,_FCK_ProtectEvents_ReplaceEvents);}function _FCK_ProtectEvents_ReplaceEvents(d,c){return" "+c+'_fckprotectedatt="'+encodeURIComponent(d)+'"';}function _FCK_ProtectEvents_RestoreEvents(d,c){return decodeURIComponent(c);}function _FCK_MouseEventsListener(b){if(!b){b=window.event;}if(b.type=="mousedown"){FCK.MouseDownFlag=true;}else{if(b.type=="mouseup"){FCK.MouseDownFlag=false;}else{if(b.type=="mousemove"){FCK.Events.FireEvent("OnMouseMove",b);}}}}function _FCK_PaddingNodeListener(){if(FCKConfig.EnterMode.IEquals("br")){return;}FCKDomTools.EnforcePaddingNode(FCK.EditorDocument,FCKConfig.EnterMode);if(!FCKBrowserInfo.IsIE&&FCKDomTools.PaddingNode){var h=FCKSelection.GetSelection();if(h&&h.rangeCount==1){var j=h.getRangeAt(0);if(j.collapsed&&j.startContainer==FCK.EditorDocument.body&&j.startOffset==0){j.selectNodeContents(FCKDomTools.PaddingNode);j.collapse(true);h.removeAllRanges();h.addRange(j);}}}else{if(FCKDomTools.PaddingNode){var k=FCKSelection.GetParentElement();var l=FCKDomTools.PaddingNode;if(k&&k.nodeName.IEquals("body")){if(FCK.EditorDocument.body.childNodes.length==1&&FCK.EditorDocument.body.firstChild==l){if(FCKSelection._GetSelectionDocument(FCK.EditorDocument.selection)!=FCK.EditorDocument){return;}var j=FCK.EditorDocument.body.createTextRange();var g=false;if(!l.childNodes.firstChild){l.appendChild(FCKTools.GetElementDocument(l).createTextNode("\ufeff"));g=true;}j.moveToElementText(l);j.select();if(g){j.pasteHTML("");}}}}}}function _FCK_EditingArea_OnLoad(){FCK.EditorWindow=FCK.EditingArea.Window;FCK.EditorDocument=FCK.EditingArea.Document;if(FCKBrowserInfo.IsIE){FCKTempBin.ToElements();}FCK.InitializeBehaviors();FCK.MouseDownFlag=false;FCKTools.AddEventListener(FCK.EditorDocument,"mousemove",_FCK_MouseEventsListener);FCKTools.AddEventListener(FCK.EditorDocument,"mousedown",_FCK_MouseEventsListener);FCKTools.AddEventListener(FCK.EditorDocument,"mouseup",_FCK_MouseEventsListener);if(FCKBrowserInfo.IsSafari){FCKTools.AddEventListener(FCK.EditorDocument,"paste",function(j){var a=new FCKDomRange(FCK.EditorWindow);var g=FCK.EditorDocument.createTextNode("\ufeff");var h=FCK.EditorDocument.createElement("a");h.id="fck_paste_padding";h.innerHTML="&#65279;";a.MoveToSelection();a.DeleteContents();a.InsertNode(g);a.Collapse();a.InsertNode(h);a.MoveToPosition(h,3);a.Select();setTimeout(function(){g.parentNode.removeChild(g);h=FCK.EditorDocument.getElementById("fck_paste_padding");h.parentNode.removeChild(h);},0);});}if(FCKBrowserInfo.IsSafari){var b=function(a){if(!(a.ctrlKey||a.metaKey)){return;}if(FCK.EditMode!=0){return;}switch(a.keyCode){case 89:FCKUndo.Redo();break;case 90:FCKUndo.Undo();break;}};FCKTools.AddEventListener(FCK.EditorDocument,"keyup",b);}FCK.EnterKeyHandler=new FCKEnterKey(FCK.EditorWindow,FCKConfig.EnterMode,FCKConfig.ShiftEnterMode,FCKConfig.TabSpaces);FCK.KeystrokeHandler.AttachToElement(FCK.EditorDocument);if(FCK._ForceResetIsDirty){FCK.ResetIsDirty();}if(FCKBrowserInfo.IsIE&&FCK.HasFocus){FCK.EditorDocument.body.setActive();}FCK.OnAfterSetHTML();FCKCommands.GetCommand("ShowBlocks").RestoreState();if(FCK.Status!=0){return;}FCK.SetStatus(1);}function _FCK_GetEditorAreaStyleTags(){return FCKTools.GetStyleHtml(FCKConfig.EditorAreaCSS)+FCKTools.GetStyleHtml(FCKConfig.EditorAreaStyles);}function _FCK_KeystrokeHandler_OnKeystroke(f,g){if(FCK.Status!=2){return false;}if(FCK.EditMode==0){switch(g){case"Paste":return !FCK.Paste();case"Cut":FCKUndo.SaveUndoStep();return false;}}else{if(g.Equals("Paste","Undo","Redo","SelectAll","Cut")){return false;}}var d=FCK.Commands.GetCommand(g);if(d.GetState()==-1){return false;}return(d.Execute.apply(d,FCKTools.ArgumentsToArray(arguments,2))!==false);}(function(){var f=window.parent.document;var g=f.getElementById(FCK.Name);var d=0;while(g||d==0){if(g&&g.tagName.toLowerCase().Equals("input","textarea")){FCK.LinkedField=g;break;}g=f.getElementsByName(FCK.Name)[d++];}})();var FCKTempBin={Elements:[],AddElement:function(d){var c=this.Elements.length;this.Elements[c]=d;return c;},RemoveElement:function(d){var c=this.Elements[d];this.Elements[d]=null;return c;},Reset:function(){var b=0;while(b<this.Elements.length){this.Elements[b++]=null;}this.Elements.length=0;},ToHtml:function(){for(var b=0;b<this.Elements.length;b++){this.Elements[b]="<div>&nbsp;"+this.Elements[b].outerHTML+"</div>";this.Elements[b].isHtml=true;}},ToElements:function(){var d=FCK.EditorDocument.createElement("div");for(var c=0;c<this.Elements.length;c++){if(this.Elements[c].isHtml){d.innerHTML=this.Elements[c];this.Elements[c]=d.firstChild.removeChild(d.firstChild.lastChild);}}}};var FCKFocusManager=FCK.FocusManager={IsLocked:false,AddWindow:function(f,g){var d;if(FCKBrowserInfo.IsIE){d=f.nodeType==1?f:f.frameElement?f.frameElement:f.document;}else{if(FCKBrowserInfo.IsSafari){d=f;}else{d=f.document;}}FCKTools.AddEventListener(d,"blur",FCKFocusManager_Win_OnBlur);FCKTools.AddEventListener(d,"focus",g?FCKFocusManager_Win_OnFocus_Area:FCKFocusManager_Win_OnFocus);},RemoveWindow:function(b){if(FCKBrowserInfo.IsIE){oTarget=b.nodeType==1?b:b.frameElement?b.frameElement:b.document;}else{oTarget=b.document;}FCKTools.RemoveEventListener(oTarget,"blur",FCKFocusManager_Win_OnBlur);FCKTools.RemoveEventListener(oTarget,"focus",FCKFocusManager_Win_OnFocus_Area);FCKTools.RemoveEventListener(oTarget,"focus",FCKFocusManager_Win_OnFocus);},Lock:function(){this.IsLocked=true;},Unlock:function(){if(this._HasPendingBlur){FCKFocusManager._Timer=window.setTimeout(FCKFocusManager_FireOnBlur,100);}this.IsLocked=false;},_ResetTimer:function(){this._HasPendingBlur=false;if(this._Timer){window.clearTimeout(this._Timer);delete this._Timer;}}};function FCKFocusManager_Win_OnBlur(){if(typeof(FCK)!="undefined"&&FCK.HasFocus){FCKFocusManager._ResetTimer();FCKFocusManager._Timer=window.setTimeout(FCKFocusManager_FireOnBlur,100);}}function FCKFocusManager_FireOnBlur(){if(FCKFocusManager.IsLocked){FCKFocusManager._HasPendingBlur=true;}else{FCK.HasFocus=false;FCK.Events.FireEvent("OnBlur");}}function FCKFocusManager_Win_OnFocus_Area(){if(FCKFocusManager._IsFocusing){return;}FCKFocusManager._IsFocusing=true;FCK.Focus();FCKFocusManager_Win_OnFocus();FCKTools.RunFunction(function(){delete FCKFocusManager._IsFocusing;});}function FCKFocusManager_Win_OnFocus(){FCKFocusManager._ResetTimer();if(!FCK.HasFocus&&!FCKFocusManager.IsLocked){FCK.HasFocus=true;FCK.Events.FireEvent("OnFocus");}}(function(){var g=window.frameElement;var h=g.width;var j=g.height;if(/^\d+$/.test(h)){h+="px";}if(/^\d+$/.test(j)){j+="px";}var f=g.style;f.border=f.padding=f.margin=0;f.backgroundColor="transparent";f.backgroundImage="none";f.width=h;f.height=j;})();FCK.Description="FCKeditor for Internet Explorer 5.5+";FCK._GetBehaviorsStyle=function(){if(!FCK._BehaviorsStyle){var f=FCKConfig.BasePath;var g="";var d;d='<style type="text/css" _fcktemp="true">';if(FCKConfig.ShowBorders){g="url("+f+"css/behaviors/showtableborders.htc)";}d+="INPUT,TEXTAREA,SELECT,.FCK__Anchor,.FCK__PageBreak,.FCK__InputHidden";if(FCKConfig.DisableObjectResizing){d+=",IMG";g+=" url("+f+"css/behaviors/disablehandles.htc)";}d+=" { behavior: url("+f+"css/behaviors/disablehandles.htc) ; }";if(g.length>0){d+="TABLE { behavior: "+g+" ; }";}d+="</style>";FCK._BehaviorsStyle=d;}return FCK._BehaviorsStyle;};function Doc_OnMouseUp(){if(FCK.EditorWindow.event.srcElement.tagName=="HTML"){FCK.Focus();FCK.EditorWindow.event.cancelBubble=true;FCK.EditorWindow.event.returnValue=false;}}function Doc_OnPaste(){var d=FCK.EditorDocument.body;d.detachEvent("onpaste",Doc_OnPaste);var c=FCK.Paste(!FCKConfig.ForcePasteAsPlainText&&!FCKConfig.AutoDetectPasteFromWord);d.attachEvent("onpaste",Doc_OnPaste);return c;}function Doc_OnDblClick(){FCK.OnDoubleClick(FCK.EditorWindow.event.srcElement);FCK.EditorWindow.event.cancelBubble=true;}function Doc_OnSelectionChange(){if(!FCK.IsSelectionChangeLocked&&FCK.EditorDocument){FCK.Events.FireEvent("OnSelectionChange");}}function Doc_OnDrop(){if(FCK.MouseDownFlag){FCK.MouseDownFlag=false;return;}if(FCKConfig.ForcePasteAsPlainText){var b=FCK.EditorWindow.event;if(FCK._CheckIsPastingEnabled()||FCKConfig.ShowDropDialog){FCK.PasteAsPlainText(b.dataTransfer.getData("Text"));}b.returnValue=false;b.cancelBubble=true;}}FCK.InitializeBehaviors=function(b){this.EditorDocument.attachEvent("onmouseup",Doc_OnMouseUp);this.EditorDocument.body.attachEvent("onpaste",Doc_OnPaste);this.EditorDocument.body.attachEvent("ondrop",Doc_OnDrop);FCK.ContextMenu._InnerContextMenu.AttachToElement(FCK.EditorDocument.body);this.EditorDocument.attachEvent("onkeydown",FCK._KeyDownListener);this.EditorDocument.attachEvent("ondblclick",Doc_OnDblClick);this.EditorDocument.attachEvent("onbeforedeactivate",function(){FCKSelection.Save();});this.EditorDocument.attachEvent("onselectionchange",Doc_OnSelectionChange);FCKTools.AddEventListener(FCK.EditorDocument,"mousedown",Doc_OnMouseDown);};FCK.InsertHtml=function(f){f=FCKConfig.ProtectedSource.Protect(f);f=FCK.ProtectEvents(f);f=FCK.ProtectUrls(f);f=FCK.ProtectTags(f);FCKSelection.Restore();FCK.EditorWindow.focus();FCKUndo.SaveUndoStep();var g=FCKSelection.GetSelection();if(g.type.toLowerCase()=="control"){g.clear();}f='<span id="__fakeFCKRemove__" style="display:none;">fakeFCKRemove</span>'+f;g.createRange().pasteHTML(f);var d=FCK.EditorDocument.getElementById("__fakeFCKRemove__");if(d.parentNode.childNodes.length==1){d=d.parentNode;}d.removeNode(true);FCKDocumentProcessor.Process(FCK.EditorDocument);this.Events.FireEvent("OnSelectionChange");};FCK.SetInnerHtml=function(d){var c=FCK.EditorDocument;c.body.innerHTML='<div id="__fakeFCKRemove__">&nbsp;</div>'+d;c.getElementById("__fakeFCKRemove__").removeNode(true);};function FCK_PreloadImages(){var b=new FCKImagePreloader();b.AddImages(FCKConfig.PreloadImages);b.AddImages(FCKConfig.SkinPath+"fck_strip.gif");b.OnComplete=LoadToolbarSetup;b.Start();}function Document_OnContextMenu(){return(event.srcElement._FCKShowContextMenu==true);}document.oncontextmenu=Document_OnContextMenu;function FCK_Cleanup(){this.LinkedField=null;this.EditorWindow=null;this.EditorDocument=null;}FCK._ExecPaste=function(){if(FCK._PasteIsRunning){return true;}if(FCKConfig.ForcePasteAsPlainText){FCK.PasteAsPlainText();return false;}var d=FCK._CheckIsPastingEnabled(true);if(d===false){FCKTools.RunFunction(FCKDialog.OpenDialog,FCKDialog,["FCKDialog_Paste",FCKLang.Paste,"dialog/fck_paste.html",400,330,"Security"]);}else{if(FCKConfig.AutoDetectPasteFromWord&&d.length>0){var c=/<\w[^>]*(( class="?MsoNormal"?)|(="mso-))/gi;if(c.test(d)){if(confirm(FCKLang.PasteWordConfirm)){FCK.PasteFromWord();return false;}}}FCK._PasteIsRunning=true;FCK.ExecuteNamedCommand("Paste");delete FCK._PasteIsRunning;}return false;};FCK.PasteAsPlainText=function(h){if(!FCK._CheckIsPastingEnabled()){FCKDialog.OpenDialog("FCKDialog_Paste",FCKLang.PasteAsText,"dialog/fck_paste.html",400,330,"PlainText");return;}var j=null;if(!h){j=clipboardData.getData("Text");}else{j=h;}if(j&&j.length>0){j=FCKTools.HTMLEncode(j);j=FCKTools.ProcessLineBreaks(window,FCKConfig,j);var k=j.search("</p>");var l=j.search("<p>");if((k!=-1&&l!=-1&&k<l)||(k!=-1&&l==-1)){var g=j.substr(0,k);j=j.substr(k+4);this.InsertHtml(g);}FCKUndo.SaveLocked=true;this.InsertHtml(j);FCKUndo.SaveLocked=false;}};FCK._CheckIsPastingEnabled=function(d){FCK._PasteIsEnabled=false;document.body.attachEvent("onpaste",FCK_CheckPasting_Listener);var c=FCK.GetClipboardHTML();document.body.detachEvent("onpaste",FCK_CheckPasting_Listener);if(FCK._PasteIsEnabled){if(!d){c=true;}}else{c=false;}delete FCK._PasteIsEnabled;return c;};function FCK_CheckPasting_Listener(){FCK._PasteIsEnabled=true;}FCK.GetClipboardHTML=function(){var g=document.getElementById("___FCKHiddenDiv");if(!g){g=document.createElement("DIV");g.id="___FCKHiddenDiv";var h=g.style;h.position="absolute";h.visibility=h.overflow="hidden";h.width=h.height=1;document.body.appendChild(g);}g.innerHTML="";var j=document.body.createTextRange();j.moveToElementText(g);j.execCommand("Paste");var f=g.innerHTML;g.innerHTML="";return f;};FCK.CreateLink=function(v,x){var y=[];var z=FCKSelection.GetType()=="Control";var n=z&&FCKSelection.GetSelectedElement();if(!(z&&!FCKTools.GetElementAscensor(n,"a"))){FCK.ExecuteNamedCommand("Unlink",null,false,!!x);}if(v.length>0){if(z){var o=this.EditorDocument.createElement("A");o.href=v;var p=n;p.parentNode.insertBefore(o,p);p.parentNode.removeChild(p);o.appendChild(p);return[o];}var q="javascript:void(0);/*"+(new Date().getTime())+"*/";FCK.ExecuteNamedCommand("CreateLink",q,false,!!x);var r=this.EditorDocument.links;for(i=0;i<r.length;i++){var o=r[i];if(o.getAttribute("href",2)==q){var t=o.innerHTML;o.href=v;o.innerHTML=t;var u=o.lastChild;if(u&&u.nodeName=="BR"){FCKDomTools.InsertAfterNode(o,o.removeChild(u));}y.push(o);}}}return y;};function _FCK_RemoveDisabledAtt(){this.removeAttribute("disabled");}function Doc_OnMouseDown(d){var c=d.srcElement;if(c.nodeName&&c.nodeName.IEquals("input")&&c.type.IEquals(["radio","checkbox"])&&!c.disabled){c.disabled=true;FCKTools.SetTimeout(_FCK_RemoveDisabledAtt,1,c);}}var FCKConfig=FCK.Config={};if(document.location.protocol=="file:"){FCKConfig.BasePath=decodeURIComponent(document.location.pathname.substr(1));FCKConfig.BasePath=FCKConfig.BasePath.replace(/\\/gi,"/");var sFullProtocol=document.location.href.match(/^(file\:\/{2,3})/)[1];if(FCKBrowserInfo.IsOpera){sFullProtocol+="localhost/";}FCKConfig.BasePath=sFullProtocol+FCKConfig.BasePath.substring(0,FCKConfig.BasePath.lastIndexOf("/")+1);}else{FCKConfig.BasePath=document.location.protocol+"//"+document.location.host+document.location.pathname.substring(0,document.location.pathname.lastIndexOf("/")+1);}FCKConfig.FullBasePath=FCKConfig.BasePath;FCKConfig.EditorPath=FCKConfig.BasePath.replace(/editor\/$/,"");try{FCKConfig.ScreenWidth=screen.width;FCKConfig.ScreenHeight=screen.height;}catch(e){FCKConfig.ScreenWidth=800;FCKConfig.ScreenHeight=600;}FCKConfig.ProcessHiddenField=function(){this.PageConfig={};var j=window.parent.document.getElementById(FCK.Name+"___Config");if(!j){return;}var k=j.value.split("&");for(var h=0;h<k.length;h++){if(k[h].length==0){continue;}var l=k[h].split("=");var m=decodeURIComponent(l[0]);var n=decodeURIComponent(l[1]);if(m=="CustomConfigurationsPath"){FCKConfig[m]=n;}else{if(n.toLowerCase()=="true"){this.PageConfig[m]=true;}else{if(n.toLowerCase()=="false"){this.PageConfig[m]=false;}else{if(n.length>0&&!isNaN(n)){this.PageConfig[m]=parseFloat(n);}else{this.PageConfig[m]=n;}}}}}};function FCKConfig_LoadPageConfig(){var d=FCKConfig.PageConfig;for(var c in d){FCKConfig[c]=d[c];}}function FCKConfig_PreProcess(){var f=FCKConfig;if(f.AllowQueryStringDebug){try{if((/fckdebug=true/i).test(window.top.location.search)){f.Debug=true;}}catch(d){}}if(!f.PluginsPath.EndsWith("/")){f.PluginsPath+="/";}var g=f.ToolbarComboPreviewCSS;if(!g||g.length==0){f.ToolbarComboPreviewCSS=f.EditorAreaCSS;}f.RemoveAttributesArray=(f.RemoveAttributes||"").split(",");if(!FCKConfig.SkinEditorCSS||FCKConfig.SkinEditorCSS.length==0){FCKConfig.SkinEditorCSS=FCKConfig.SkinPath+"fck_editor.css";}if(!FCKConfig.SkinDialogCSS||FCKConfig.SkinDialogCSS.length==0){FCKConfig.SkinDialogCSS=FCKConfig.SkinPath+"fck_dialog.css";}}FCKConfig.ToolbarSets={};FCKConfig.Plugins={};FCKConfig.Plugins.Items=[];FCKConfig.Plugins.Add=function(f,g,d){FCKConfig.Plugins.Items.push([f,g,d]);};FCKConfig.ProtectedSource={};FCKConfig.ProtectedSource._CodeTag=(new Date()).valueOf();FCKConfig.ProtectedSource.RegexEntries=[/<!--[\s\S]*?-->/g,/<script[\s\S]*?<\/script>/gi,/<noscript[\s\S]*?<\/noscript>/gi];FCKConfig.ProtectedSource.Add=function(b){this.RegexEntries.push(b);};FCKConfig.ProtectedSource.Protect=function(g){var h=this._CodeTag;function j(b){var a=FCKTempBin.AddElement(b);return"<!--{"+h+a+"}-->";}for(var f=0;f<this.RegexEntries.length;f++){g=g.replace(this.RegexEntries[f],j);}return g;};FCKConfig.ProtectedSource.Revert=function(g,h){function j(d,b,c){var a=h?FCKTempBin.RemoveElement(c):FCKTempBin.Elements[c];return FCKConfig.ProtectedSource.Revert(a,h);}var f=new RegExp("(<|&lt;)!--\\{"+this._CodeTag+"(\\d+)\\}--(>|&gt;)","g");return g.replace(f,j);};FCKConfig.GetBodyAttributes=function(){var b="";if(this.BodyId&&this.BodyId.length>0){b+=' id="'+this.BodyId+'"';}if(this.BodyClass&&this.BodyClass.length>0){b+=' class="'+this.BodyClass+'"';}return b;};FCKConfig.ApplyBodyAttributes=function(b){if(this.BodyId&&this.BodyId.length>0){b.id=FCKConfig.BodyId;}if(this.BodyClass&&this.BodyClass.length>0){b.className+=" "+FCKConfig.BodyClass;}};var FCKDebug={Output:function(){},OutputObject:function(){}};var FCKDomTools={MoveChildren:function(g,h,j){if(g==h){return;}var f;if(j){while((f=g.lastChild)){h.insertBefore(g.removeChild(f),h.firstChild);}}else{while((f=g.firstChild)){h.appendChild(g.removeChild(f));}}},MoveNode:function(f,g,d){if(d){g.insertBefore(FCKDomTools.RemoveNode(f),g.firstChild);}else{g.appendChild(FCKDomTools.RemoveNode(f));}},TrimNode:function(b){this.LTrimNode(b);this.RTrimNode(b);},LTrimNode:function(g){var h;while((h=g.firstChild)){if(h.nodeType==3){var j=h.nodeValue.LTrim();var f=h.nodeValue.length;if(j.length==0){g.removeChild(h);continue;}else{if(j.length<f){h.splitText(f-j.length);g.removeChild(g.firstChild);}}}break;}},RTrimNode:function(g){var h;while((h=g.lastChild)){if(h.nodeType==3){var j=h.nodeValue.RTrim();var f=h.nodeValue.length;if(j.length==0){h.parentNode.removeChild(h);continue;}else{if(j.length<f){h.splitText(j.length);g.lastChild.parentNode.removeChild(g.lastChild);}}}break;}if(!FCKBrowserInfo.IsIE&&!FCKBrowserInfo.IsOpera){h=g.lastChild;if(h&&h.nodeType==1&&h.nodeName.toLowerCase()=="br"){h.parentNode.removeChild(h);}}},RemoveNode:function(f,g){if(g){var d;while((d=f.firstChild)){f.parentNode.insertBefore(f.removeChild(d),f);}}return f.parentNode.removeChild(f);},GetFirstChild:function(f,g){if(typeof(g)=="string"){g=[g];}var d=f.firstChild;while(d){if(d.nodeType==1&&d.tagName.Equals.apply(d.tagName,g)){return d;}d=d.nextSibling;}return null;},GetLastChild:function(f,g){if(typeof(g)=="string"){g=[g];}var d=f.lastChild;while(d){if(d.nodeType==1&&(!g||d.tagName.Equals(g))){return d;}d=d.previousSibling;}return null;},GetPreviousSourceElement:function(g,h,j,f){if(!g){return null;}if(j&&g.nodeType==1&&g.nodeName.IEquals(j)){return null;}if(g.previousSibling){g=g.previousSibling;}else{return this.GetPreviousSourceElement(g.parentNode,h,j,f);}while(g){if(g.nodeType==1){if(j&&g.nodeName.IEquals(j)){break;}if(!f||!g.nodeName.IEquals(f)){return g;}}else{if(h&&g.nodeType==3&&g.nodeValue.RTrim().length>0){break;}}if(g.lastChild){g=g.lastChild;}else{return this.GetPreviousSourceElement(g,h,j,f);}}return null;},GetNextSourceElement:function(h,j,k,l,g){while((h=this.GetNextSourceNode(h,g))){if(h.nodeType==1){if(k&&h.nodeName.IEquals(k)){break;}if(l&&h.nodeName.IEquals(l)){return this.GetNextSourceElement(h,j,k,l);}return h;}else{if(j&&h.nodeType==3&&h.nodeValue.RTrim().length>0){break;}}}return null;},GetNextSourceNode:function(h,j,k,l){if(!h){return null;}var g;if(!j&&h.firstChild){g=h.firstChild;}else{if(l&&h==l){return null;}g=h.nextSibling;if(!g&&(!l||l!=h.parentNode)){return this.GetNextSourceNode(h.parentNode,true,k,l);}}if(k&&g&&g.nodeType!=k){return this.GetNextSourceNode(g,false,k,l);}return g;},GetPreviousSourceNode:function(h,j,k,l){if(!h){return null;}var g;if(!j&&h.lastChild){g=h.lastChild;}else{if(l&&h==l){return null;}g=h.previousSibling;if(!g&&(!l||l!=h.parentNode)){return this.GetPreviousSourceNode(h.parentNode,true,k,l);}}if(k&&g&&g.nodeType!=k){return this.GetPreviousSourceNode(g,false,k,l);}return g;},InsertAfterNode:function(d,c){return d.parentNode.insertBefore(c,d.nextSibling);},GetParents:function(d){var c=[];while(d){c.unshift(d);d=d.parentNode;}return c;},GetCommonParents:function(j,k){var l=this.GetParents(j);var m=this.GetParents(k);var n=[];for(var h=0;h<l.length;h++){if(l[h]==m[h]){n.push(l[h]);}}return n;},GetCommonParentNode:function(j,k,l){var m={};if(!l.pop){l=[l];}while(l.length>0){m[l.pop().toLowerCase()]=1;}var n=this.GetCommonParents(j,k);var h=null;while((h=n.pop())){if(m[h.nodeName.toLowerCase()]){return h;}}return null;},GetIndexOf:function(f){var g=f.parentNode?f.parentNode.firstChild:null;var d=-1;while(g){d++;if(g==f){return d;}g=g.nextSibling;}return -1;},PaddingNode:null,EnforcePaddingNode:function(g,h){try{if(!g||!g.body){return;}}catch(f){return;}this.CheckAndRemovePaddingNode(g,h,true);try{if(g.body.lastChild&&(g.body.lastChild.nodeType!=1||g.body.lastChild.tagName.toLowerCase()==h.toLowerCase())){return;}}catch(f){return;}var j=g.createElement(h);if(FCKBrowserInfo.IsGecko&&FCKListsLib.NonEmptyBlockElements[h]){FCKTools.AppendBogusBr(j);}this.PaddingNode=j;if(g.body.childNodes.length==1&&g.body.firstChild.nodeType==1&&g.body.firstChild.tagName.toLowerCase()=="br"&&(g.body.firstChild.getAttribute("_moz_dirty")!=null||g.body.firstChild.getAttribute("type")=="_moz")){g.body.replaceChild(j,g.body.firstChild);}else{g.body.appendChild(j);}},CheckAndRemovePaddingNode:function(h,j,k){var l=this.PaddingNode;if(!l){return;}try{if(l.parentNode!=h.body||l.tagName.toLowerCase()!=j||(l.childNodes.length>1)||(l.firstChild&&l.firstChild.nodeValue!="\xa0"&&String(l.firstChild.tagName).toLowerCase()!="br")){this.PaddingNode=null;return;}}catch(g){this.PaddingNode=null;return;}if(!k){if(l.parentNode.childNodes.length>1){l.parentNode.removeChild(l);}this.PaddingNode=null;}},HasAttribute:function(f,g){if(f.hasAttribute){return f.hasAttribute(g);}else{var d=f.attributes[g];return(d!=undefined&&d.specified);}},HasAttributes:function(g){var h=g.attributes;for(var f=0;f<h.length;f++){if(FCKBrowserInfo.IsIE){var j=h[f].nodeName;if(j.StartsWith("_fck")){continue;}if(j=="class"){if(g.className.length>0){return true;}continue;}}if(h[f].specified){return true;}}return false;},RemoveAttribute:function(d,c){if(FCKBrowserInfo.IsIE&&c.toLowerCase()=="class"){c="className";}return d.removeAttribute(c,0);},RemoveAttributes:function(f,g){for(var d=0;d<g.length;d++){this.RemoveAttribute(f,g[d]);}},GetAttributeValue:function(f,g){var d=g;if(typeof g=="string"){g=f.attributes[g];}else{d=g.nodeName;}if(g&&g.specified){if(d=="style"){return f.style.cssText;}else{if(d=="class"||d.indexOf("on")==0){return g.nodeValue;}else{return f.getAttribute(d,2);}}}return null;},Contains:function(d,c){if(d.contains&&c.nodeType==1){return d.contains(c);}while((c=c.parentNode)){if(c==d){return true;}}return false;},BreakParent:function(h,j,k){var l=k||new FCKDomRange(FCKTools.GetElementWindow(h));l.SetStart(h,4);l.SetEnd(j,4);var g=l.ExtractContents();l.InsertNode(h.parentNode.removeChild(h));g.InsertAfterNode(h);l.Release(!!k);},GetNodeAddress:function(k,l){var m=[];while(k&&k!=FCKTools.GetElementDocument(k).documentElement){var n=k.parentNode;var o=-1;for(var j=0;j<n.childNodes.length;j++){var p=n.childNodes[j];if(l===true&&p.nodeType==3&&p.previousSibling&&p.previousSibling.nodeType==3){continue;}o++;if(n.childNodes[j]==k){break;}}m.unshift(o);k=k.parentNode;}return m;},GetNodeFromAddress:function(q,r,t){var u=q.documentElement;for(var o=0;o<r.length;o++){var j=r[o];if(!t){u=u.childNodes[j];continue;}var m=-1;for(var p=0;p<u.childNodes.length;p++){var n=u.childNodes[p];if(t===true&&n.nodeType==3&&n.previousSibling&&n.previousSibling.nodeType==3){continue;}m++;if(m==j){u=n;break;}}}return u;},CloneElement:function(b){b=b.cloneNode(false);b.removeAttribute("id",false);return b;},ClearElementJSProperty:function(d,c){if(FCKBrowserInfo.IsIE){d.removeAttribute(c);}else{delete d[c];}},SetElementMarker:function(h,j,k,l){var g=String(parseInt(Math.random()*4294967295,10));j._FCKMarkerId=g;j[k]=l;if(!h[g]){h[g]={"element":j,"markers":{}};}h[g]["markers"][k]=l;},ClearElementMarkers:function(h,j,k){var l=j._FCKMarkerId;if(!l){return;}this.ClearElementJSProperty(j,"_FCKMarkerId");for(var g in h[l]["markers"]){this.ClearElementJSProperty(j,g);}if(k){delete h[l];}},ClearAllMarkers:function(d){for(var c in d){this.ClearElementMarkers(d,d[c]["element"],true);}},ListToArray:function(t,u,v,x,j){if(!t.nodeName.IEquals(["ul","ol"])){return[];}if(!x){x=0;}if(!v){v=[];}for(var q=0;q<t.childNodes.length;q++){var n=t.childNodes[q];if(!n.nodeName.IEquals("li")){continue;}var o={"parent":t,"indent":x,"contents":[]};if(!j){o.grandparent=t.parentNode;if(o.grandparent&&o.grandparent.nodeName.IEquals("li")){o.grandparent=o.grandparent.parentNode;}}else{o.grandparent=j;}if(u){this.SetElementMarker(u,n,"_FCK_ListArray_Index",v.length);}v.push(o);for(var r=0;r<n.childNodes.length;r++){var p=n.childNodes[r];if(p.nodeName.IEquals(["ul","ol"])){this.ListToArray(p,u,v,x+1,o.grandparent);}else{o.contents.push(p);}}}return v;},ArrayToList:function(C,D,E){if(E==undefined){E=0;}if(!C||C.length<E+1){return null;}var F=FCKTools.GetElementDocument(C[E].parent);var q=F.createDocumentFragment();var r=null;var t=E;var u=Math.max(C[E].indent,0);var v=null;while(true){var x=C[t];if(x.indent==u){if(!r||C[t].parent.nodeName!=r.nodeName){r=C[t].parent.cloneNode(false);q.appendChild(r);}v=F.createElement("li");r.appendChild(v);for(var B=0;B<x.contents.length;B++){v.appendChild(x.contents[B].cloneNode(true));}t++;}else{if(x.indent==Math.max(u,0)+1){var y=this.ArrayToList(C,null,t);v.appendChild(y.listNode);t=y.nextIndex;}else{if(x.indent==-1&&E==0&&x.grandparent){var v;if(x.grandparent.nodeName.IEquals(["ul","ol"])){v=F.createElement("li");}else{if(FCKConfig.EnterMode.IEquals(["div","p"])&&!x.grandparent.nodeName.IEquals("td")){v=F.createElement(FCKConfig.EnterMode);}else{v=F.createDocumentFragment();}}for(var B=0;B<x.contents.length;B++){v.appendChild(x.contents[B].cloneNode(true));}if(v.nodeType==11){if(v.lastChild&&v.lastChild.getAttribute&&v.lastChild.getAttribute("type")=="_moz"){v.removeChild(v.lastChild);}v.appendChild(F.createElement("br"));}if(v.nodeName.IEquals(FCKConfig.EnterMode)&&v.firstChild){this.TrimNode(v);if(FCKListsLib.BlockBoundaries[v.firstChild.nodeName.toLowerCase()]){var z=F.createDocumentFragment();while(v.firstChild){z.appendChild(v.removeChild(v.firstChild));}v=z;}}if(FCKBrowserInfo.IsGeckoLike&&v.nodeName.IEquals(["div","p"])){FCKTools.AppendBogusBr(v);}q.appendChild(v);r=null;t++;}else{return null;}}}if(C.length<=t||Math.max(C[t].indent,0)<u){break;}}if(D){var A=q.firstChild;while(A){if(A.nodeType==1){this.ClearElementMarkers(D,A);}A=this.GetNextSourceNode(A);}}return{"listNode":q,"nextIndex":t};},GetNextSibling:function(d,c){d=d.nextSibling;while(d&&!c&&d.nodeType!=1&&(d.nodeType!=3||d.nodeValue.length==0)){d=d.nextSibling;}return d;},GetPreviousSibling:function(d,c){d=d.previousSibling;while(d&&!c&&d.nodeType!=1&&(d.nodeType!=3||d.nodeValue.length==0)){d=d.previousSibling;}return d;},CheckIsEmptyElement:function(g,h){var j=g.firstChild;var f;while(j){if(j.nodeType==1){if(f||!FCKListsLib.InlineNonEmptyElements[j.nodeName.toLowerCase()]){return false;}if(!h||h(j)===true){f=j;}}else{if(j.nodeType==3&&j.nodeValue.length>0){return false;}}j=j.nextSibling;}return f?this.CheckIsEmptyElement(f,h):true;},SetElementStyles:function(g,h){var j=g.style;for(var f in h){j[f]=h[f];}},SetOpacity:function(d,c){if(FCKBrowserInfo.IsIE){c=Math.round(c*100);d.style.filter=(c>100?"":"progid:DXImageTransform.Microsoft.Alpha(opacity="+c+")");}else{d.style.opacity=c;}},GetCurrentElementStyle:function(d,c){if(FCKBrowserInfo.IsIE){return d.currentStyle[c];}else{return d.ownerDocument.defaultView.getComputedStyle(d,"").getPropertyValue(c);}},GetPositionedAncestor:function(d){var c=d;while(c!=FCKTools.GetElementDocument(c).documentElement){if(this.GetCurrentElementStyle(c,"position")!="static"){return c;}if(c==FCKTools.GetElementDocument(c).documentElement&&currentWindow!=w){c=currentWindow.frameElement;}else{c=c.parentNode;}}return null;},ScrollIntoView:function(k,l){var m=FCKTools.GetElementWindow(k);var n=FCKTools.GetViewPaneSize(m).Height;var o=n*-1;if(l===false){o+=k.offsetHeight||0;o+=parseInt(this.GetCurrentElementStyle(k,"marginBottom")||0,10)||0;}var p=FCKTools.GetDocumentPosition(m,k);o+=p.y;var j=FCKTools.GetScrollPosition(m).Y;if(o>0&&(o>j||o<j-n)){m.scrollTo(0,o);}},CheckIsEditable:function(f){var g=f.nodeName.toLowerCase();var d=FCK.DTD[g]||FCK.DTD.span;return(d["#"]&&!FCKListsLib.NonEditableElements[g]);},GetSelectedDivContainers:function(){var k=[];var l=new FCKDomRange(FCK.EditorWindow);l.MoveToSelection();var m=l.GetTouchedStartNode();var n=l.GetTouchedEndNode();var o=m;if(m==n){while(n.nodeType==1&&n.lastChild){n=n.lastChild;}n=FCKDomTools.GetNextSourceNode(n);}while(o&&o!=n){if(o.nodeType!=3||!/^[ \t\n]*$/.test(o.nodeValue)){var p=new FCKElementPath(o);var j=p.BlockLimit;if(j&&j.nodeName.IEquals("div")&&k.IndexOf(j)==-1){k.push(j);}}o=FCKDomTools.GetNextSourceNode(o);}return k;}};var FCKTools={};FCKTools.CreateBogusBR=function(d){var c=d.createElement("br");c.setAttribute("type","_moz");return c;};FCKTools.FixCssUrls=function(d,c){if(!d||d.length==0){return c;}return c.replace(/url\s*\(([\s'"]*)(.*?)([\s"']*)\)/g,function(j,h,b,a){if(/^\/|^\w?:/.test(b)){return j;}else{return"url("+h+d+b+a+")";}});};FCKTools._GetUrlFixedCss=function(f,g){var d=f.match(/^([^|]+)\|([\s\S]*)/);if(d){return FCKTools.FixCssUrls(d[1],d[2]);}else{return f;}};FCKTools.AppendStyleSheet=function(g,h){if(!h){return[];}if(typeof(h)=="string"){if(/[\\\/\.][^{}]*$/.test(h)){return this.AppendStyleSheet(g,h.split(","));}else{return[this.AppendStyleString(g,FCKTools._GetUrlFixedCss(h))];}}else{var j=[];for(var f=0;f<h.length;f++){j.push(this._AppendStyleSheet(g,h[f]));}return j;}};FCKTools.GetStyleHtml=(function(){var d=function(b,g){if(b.length==0){return"";}var a=g?' _fcktemp="true"':"";return'<style type="text/css"'+a+">"+b+"</style>";};var c=function(g,b){if(g.length==0){return"";}var a=b?' _fcktemp="true"':"";return'<link href="'+g+'" type="text/css" rel="stylesheet" '+a+"/>";};return function(a,h){if(!a){return"";}if(typeof(a)=="string"){if(/[\\\/\.][^{}]*$/.test(a)){return this.GetStyleHtml(a.split(","),h);}else{return d(this._GetUrlFixedCss(a),h);}}else{var b="";for(var j=0;j<a.length;j++){b+=c(a[j],h);}return b;}};})();FCKTools.GetElementDocument=function(b){return b.ownerDocument||b.document;};FCKTools.GetElementWindow=function(b){return this.GetDocumentWindow(this.GetElementDocument(b));};FCKTools.GetDocumentWindow=function(b){if(FCKBrowserInfo.IsSafari&&!b.parentWindow){this.FixDocumentParentWindow(window.top);}return b.parentWindow||b.defaultView;};FCKTools.FixDocumentParentWindow=function(d){if(d.document){d.document.parentWindow=d;}for(var c=0;c<d.frames.length;c++){FCKTools.FixDocumentParentWindow(d.frames[c]);}};FCKTools.HTMLEncode=function(b){if(!b){return"";}b=b.replace(/&/g,"&amp;");b=b.replace(/</g,"&lt;");b=b.replace(/>/g,"&gt;");return b;};FCKTools.HTMLDecode=function(b){if(!b){return"";}b=b.replace(/&gt;/g,">");b=b.replace(/&lt;/g,"<");b=b.replace(/&amp;/g,"&");return b;};FCKTools._ProcessLineBreaksForPMode=function(y,z,A,B,c){var n=0;var q="<p>";var r="</p>";var t="<br />";if(A){q="<li>";r="</li>";n=1;}while(B&&B!=y.FCK.EditorDocument.body){if(B.tagName.toLowerCase()=="p"){n=1;break;}B=B.parentNode;}for(var v=0;v<z.length;v++){var u=z.charAt(v);if(u=="\r"){continue;}if(u!="\n"){c.push(u);continue;}var x=z.charAt(v+1);if(x=="\r"){v++;x=z.charAt(v+1);}if(x=="\n"){v++;if(n){c.push(r);}c.push(q);n=1;}else{c.push(t);}}};FCKTools._ProcessLineBreaksForDivMode=function(t,u,v,x,c){var n=0;var o="<div>";var p="</div>";if(v){o="<li>";p="</li>";n=1;}while(x&&x!=t.FCK.EditorDocument.body){if(x.tagName.toLowerCase()=="div"){n=1;break;}x=x.parentNode;}for(var r=0;r<u.length;r++){var q=u.charAt(r);if(q=="\r"){continue;}if(q!="\n"){c.push(q);continue;}if(n){if(c[c.length-1]==o){c.push("&nbsp;");}c.push(p);}c.push(o);n=1;}if(n){c.push(p);}};FCKTools._ProcessLineBreaksForBrMode=function(t,u,v,x,c){var n=0;var o="<br />";var p="";if(v){o="<li>";p="</li>";n=1;}for(var r=0;r<u.length;r++){var q=u.charAt(r);if(q=="\r"){continue;}if(q!="\n"){c.push(q);continue;}if(n&&p.length){c.push(p);}c.push(o);n=1;}};FCKTools.ProcessLineBreaks=function(l,m,n){var o=m.EnterMode.toLowerCase();var p=[];var q=0;var r=new l.FCKDomRange(l.FCK.EditorWindow);r.MoveToSelection();var k=r._Range.startContainer;while(k&&k.nodeType!=1){k=k.parentNode;}if(k&&k.tagName.toLowerCase()=="li"){q=1;}if(o=="p"){this._ProcessLineBreaksForPMode(l,n,q,k,p);}else{if(o=="div"){this._ProcessLineBreaksForDivMode(l,n,q,k,p);}else{if(o=="br"){this._ProcessLineBreaksForBrMode(l,n,q,k,p);}}}return p.join("");};FCKTools.AddSelectOption=function(g,h,j){var f=FCKTools.GetElementDocument(g).createElement("OPTION");f.text=h;f.value=j;g.options.add(f);return f;};FCKTools.RunFunction=function(g,h,j,f){if(g){this.SetTimeout(g,0,h,j,f);}};FCKTools.SetTimeout=function(h,j,k,l,g){return(g||window).setTimeout(function(){if(l){h.apply(k,[].concat(l));}else{h.apply(k);}},j);};FCKTools.SetInterval=function(h,j,k,l,g){return(g||window).setInterval(function(){h.apply(k,l||[]);},j);};FCKTools.ConvertStyleSizeToHtml=function(b){return b.EndsWith("%")?b:parseInt(b,10);};FCKTools.ConvertHtmlSizeToStyle=function(b){return b.EndsWith("%")?b:(b+"px");};FCKTools.GetElementAscensor=function(g,h){var f=g;var j=","+h.toUpperCase()+",";while(f){if(j.indexOf(","+f.nodeName.toUpperCase()+",")!=-1){return f;}f=f.parentNode;}return null;};FCKTools.CreateEventListener=function(f,g){var d=function(){var a=[];for(var b=0;b<arguments.length;b++){a.push(arguments[b]);}f.apply(this,a.concat(g));};return d;};FCKTools.IsStrictMode=function(b){return("CSS1Compat"==(b.compatMode||(FCKBrowserInfo.IsSafari?"CSS1Compat":null)));};FCKTools.ArgumentsToArray=function(h,j,k){j=j||0;k=k||h.length;var l=[];for(var g=j;g<j+k&&g<h.length;g++){l.push(h[g]);}return l;};FCKTools.CloneObject=function(d){var c=function(){};c.prototype=d;return new c;};FCKTools.AppendBogusBr=function(f){if(!f){return;}var g=this.GetLastItem(f.getElementsByTagName("br"));if(!g||(g.getAttribute("type",2)!="_moz"&&g.getAttribute("_moz_dirty")==null)){var d=this.GetElementDocument(f);if(FCKBrowserInfo.IsOpera){f.appendChild(d.createTextNode(""));}else{f.appendChild(this.CreateBogusBR(d));}}};FCKTools.GetLastItem=function(b){if(b.length>0){return b[b.length-1];}return null;};FCKTools.GetDocumentPosition=function(r,k){var l=0;var m=0;var n=k;var o=null;var p=FCKTools.GetElementWindow(n);while(n&&!(p==r&&(n==r.document.body||n==r.document.documentElement))){l+=n.offsetLeft-n.scrollLeft;m+=n.offsetTop-n.scrollTop;if(!FCKBrowserInfo.IsOpera){var q=o;while(q&&q!=n){l-=q.scrollLeft;m-=q.scrollTop;q=q.parentNode;}}o=n;if(n.offsetParent){n=n.offsetParent;}else{if(p!=r){n=p.frameElement;o=null;if(n){p=n.contentWindow.parent;}}else{n=null;}}}if(FCKDomTools.GetCurrentElementStyle(r.document.body,"position")!="static"||(FCKBrowserInfo.IsIE&&FCKDomTools.GetPositionedAncestor(k)==null)){l+=r.document.body.offsetLeft;m+=r.document.body.offsetTop;}return{"x":l,"y":m};};FCKTools.GetWindowPosition=function(f,g){var h=this.GetDocumentPosition(f,g);var j=FCKTools.GetScrollPosition(f);h.x-=j.X;h.y-=j.Y;return h;};FCKTools.ProtectFormStyles=function(j){if(!j||j.nodeType!=1||j.tagName.toLowerCase()!="form"){return[];}var k=[];var l=["style","className"];for(var h=0;h<l.length;h++){var m=l[h];if(j.elements.namedItem(m)){var n=j.elements.namedItem(m);k.push([n,n.nextSibling]);j.removeChild(n);}}return k;};FCKTools.RestoreFormStyles=function(h,j){if(!h||h.nodeType!=1||h.tagName.toLowerCase()!="form"){return;}if(j.length>0){for(var g=j.length-1;g>=0;g--){var k=j[g][0];var l=j[g][1];if(l){h.insertBefore(k,l);}else{h.appendChild(k);}}}};FCKTools.GetNextNode=function(f,g){if(f.firstChild){return f.firstChild;}else{if(f.nextSibling){return f.nextSibling;}else{var d=f.parentNode;while(d){if(d==g){return null;}if(d.nextSibling){return d.nextSibling;}else{d=d.parentNode;}}}}return null;};FCKTools.GetNextTextNode=function(f,g,d){node=this.GetNextNode(f,g);if(d&&node&&d(node)){return null;}while(node&&node.nodeType!=3){node=this.GetNextNode(node,g);if(d&&node&&d(node)){return null;}}return node;};FCKTools.Merge=function(){var h=arguments;var k=h[0];for(var g=1;g<h.length;g++){var j=h[g];for(var l in j){k[l]=j[l];}}return k;};FCKTools.IsArray=function(b){return(b instanceof Array);};FCKTools.AppendLengthProperty=function(g,h){var f=0;for(var j in g){f++;}return g[h||"length"]=f;};FCKTools.NormalizeCssText=function(d){var c=document.createElement("span");c.style.cssText=d;return c.style.cssText;};FCKTools.Bind=function(d,c){return function(){return c.apply(d,arguments);};};FCKTools.GetVoidUrl=function(){if(FCK_IS_CUSTOM_DOMAIN){return"javascript: void( function(){document.open();document.write('<html><head><title></title></head><body></body></html>');document.domain = '"+FCK_RUNTIME_DOMAIN+"';document.close();}() ) ;";}if(FCKBrowserInfo.IsIE){if(FCKBrowserInfo.IsIE7||!FCKBrowserInfo.IsIE6){return"";}else{return"javascript: '';";}}return"javascript: void(0);";};FCKTools.ResetStyles=function(b){b.style.cssText="margin:0;padding:0;border:0;background-color:transparent;background-image:none;";};FCKTools.CancelEvent=function(b){return false;};FCKTools._AppendStyleSheet=function(d,c){return d.createStyleSheet(c).owningElement;};FCKTools.AppendStyleString=function(f,g){if(!g){return null;}var d=f.createStyleSheet("");d.cssText=g;return d;};FCKTools.ClearElementAttributes=function(b){b.clearAttributes();};FCKTools.GetAllChildrenIds=function(g){var h=[];for(var f=0;f<g.all.length;f++){var j=g.all[f].id;if(j&&j.length>0){h[h.length]=j;}}return h;};FCKTools.RemoveOuterTags=function(b){b.insertAdjacentHTML("beforeBegin",b.innerHTML);b.parentNode.removeChild(b);};FCKTools.CreateXmlObject=function(g){var h;switch(g){case"XmlHttp":if(document.location.protocol!="file:"){try{return new XMLHttpRequest();}catch(j){}}h=["MSXML2.XmlHttp","Microsoft.XmlHttp"];break;case"DOMDocument":h=["MSXML2.DOMDocument","Microsoft.XmlDom"];break;}for(var f=0;f<2;f++){try{return new ActiveXObject(h[f]);}catch(j){}}if(FCKLang.NoActiveX){alert(FCKLang.NoActiveX);FCKLang.NoActiveX=null;}return null;};FCKTools.DisableSelection=function(f){f.unselectable="on";var g,d=0;while((g=f.all[d++])){switch(g.tagName){case"IFRAME":case"TEXTAREA":case"INPUT":case"SELECT":break;default:g.unselectable="on";}}};FCKTools.GetScrollPosition=function(f){var g=f.document;var d={X:g.documentElement.scrollLeft,Y:g.documentElement.scrollTop};if(d.X>0||d.Y>0){return d;}return{X:g.body.scrollLeft,Y:g.body.scrollTop};};FCKTools.AddEventListener=function(f,g,d){f.attachEvent("on"+g,d);};FCKTools.RemoveEventListener=function(f,g,d){f.detachEvent("on"+g,d);};FCKTools.AddEventListenerEx=function(h,j,k,g){var l={};l.Source=h;l.Params=g||[];l.Listener=function(a){return k.apply(l.Source,[a].concat(l.Params));};if(FCK.IECleanup){FCK.IECleanup.AddItem(null,function(){l.Source=null;l.Params=null;});}h.attachEvent("on"+j,l.Listener);h=null;g=null;};FCKTools.GetViewPaneSize=function(f){var g;var d=f.document.documentElement;if(d&&d.clientWidth){g=d;}else{g=f.document.body;}if(g){return{Width:g.clientWidth,Height:g.clientHeight};}else{return{Width:0,Height:0};}};FCKTools.SaveStyles=function(g){var h=FCKTools.ProtectFormStyles(g);var j={};if(g.className.length>0){j.Class=g.className;g.className="";}var f=g.style.cssText;if(f.length>0){j.Inline=f;g.style.cssText="";}FCKTools.RestoreFormStyles(g,h);return j;};FCKTools.RestoreStyles=function(f,g){var d=FCKTools.ProtectFormStyles(f);f.className=g.Class||"";f.style.cssText=g.Inline||"";FCKTools.RestoreFormStyles(f,d);};FCKTools.RegisterDollarFunction=function(b){b.$=b.document.getElementById;};FCKTools.AppendElement=function(d,c){return d.appendChild(this.GetElementDocument(d).createElement(c));};FCKTools.ToLowerCase=function(b){return b.toLowerCase();};var FCKeditorAPI;function InitializeAPI(){var A=window.parent;if(!(FCKeditorAPI=A.FCKeditorAPI)){var B='window.FCKeditorAPI = {Version : "2.6.6",VersionBuild : "25427",Instances : window.FCKeditorAPI && window.FCKeditorAPI.Instances || {},GetInstance : function( name ){return this.Instances[ name ];},_FormSubmit : function(){for ( var name in FCKeditorAPI.Instances ){var oEditor = FCKeditorAPI.Instances[ name ] ;if ( oEditor.GetParentForm && oEditor.GetParentForm() == this )oEditor.UpdateLinkedField() ;}this._FCKOriginalSubmit() ;},_FunctionQueue	: window.FCKeditorAPI && window.FCKeditorAPI._FunctionQueue || {Functions : new Array(),IsRunning : false,Add : function( f ){this.Functions.push( f );if ( !this.IsRunning )this.StartNext();},StartNext : function(){var aQueue = this.Functions ;if ( aQueue.length > 0 ){this.IsRunning = true;aQueue[0].call();}else this.IsRunning = false;},Remove : function( f ){var aQueue = this.Functions;var i = 0, fFunc;while( (fFunc = aQueue[ i ]) ){if ( fFunc == f )aQueue.splice( i,1 );i++ ;}this.StartNext();}}}';if(A.execScript){A.execScript(B,"JavaScript");}else{if(FCKBrowserInfo.IsGecko10){eval.call(A,B);}else{if(FCKBrowserInfo.IsAIR){FCKAdobeAIR.FCKeditorAPI_Evaluate(A,B);}else{if(FCKBrowserInfo.IsSafari){var C=A.document;var D=C.createElement("script");D.appendChild(C.createTextNode(B));C.documentElement.appendChild(D);}else{A.eval(B);}}}}FCKeditorAPI=A.FCKeditorAPI;FCKeditorAPI.__Instances=FCKeditorAPI.Instances;}FCKeditorAPI.Instances[FCK.Name]=FCK;}function _AttachFormSubmitToAPI(){var b=FCK.GetParentForm();if(b){FCKTools.AddEventListener(b,"submit",FCK.UpdateLinkedField);if(!b._FCKOriginalSubmit&&(typeof(b.submit)=="function"||(!b.submit.tagName&&!b.submit.length))){b._FCKOriginalSubmit=b.submit;b.submit=FCKeditorAPI._FormSubmit;}}}function FCKeditorAPI_Cleanup(){if(window.FCKConfig&&FCKConfig.MsWebBrowserControlCompat&&!window.FCKUnloadFlag){return;}delete FCKeditorAPI.Instances[FCK.Name];}function FCKeditorAPI_ConfirmCleanup(){if(window.FCKConfig&&FCKConfig.MsWebBrowserControlCompat){window.FCKUnloadFlag=true;}}FCKTools.AddEventListener(window,"unload",FCKeditorAPI_Cleanup);FCKTools.AddEventListener(window,"beforeunload",FCKeditorAPI_ConfirmCleanup);var FCKImagePreloader=function(){this._Images=[];};FCKImagePreloader.prototype={AddImages:function(b){if(typeof(b)=="string"){b=b.split(";");}this._Images=this._Images.concat(b);},Start:function(){var f=this._Images;this._PreloadCount=f.length;for(var d=0;d<f.length;d++){var g=document.createElement("img");FCKTools.AddEventListenerEx(g,"load",_FCKImagePreloader_OnImage,this);FCKTools.AddEventListenerEx(g,"error",_FCKImagePreloader_OnImage,this);g.src=f[d];_FCKImagePreloader_ImageCache.push(g);}}};var _FCKImagePreloader_ImageCache=[];function _FCKImagePreloader_OnImage(d,c){if((--c._PreloadCount)==0&&c.OnComplete){c.OnComplete();}}var FCKRegexLib={AposEntity:/&apos;/gi,ObjectElements:/^(?:IMG|TABLE|TR|TD|TH|INPUT|SELECT|TEXTAREA|HR|OBJECT|A|UL|OL|LI)$/i,NamedCommands:/^(?:Cut|Copy|Paste|Print|SelectAll|RemoveFormat|Unlink|Undo|Redo|Bold|Italic|Underline|StrikeThrough|Subscript|Superscript|JustifyLeft|JustifyCenter|JustifyRight|JustifyFull|Outdent|Indent|InsertOrderedList|InsertUnorderedList|InsertHorizontalRule)$/i,BeforeBody:/(^[\s\S]*\<body[^\>]*\>)/i,AfterBody:/(\<\/body\>[\s\S]*$)/i,ToReplace:/___fcktoreplace:([\w]+)/ig,MetaHttpEquiv:/http-equiv\s*=\s*["']?([^"' ]+)/i,HasBaseTag:/<base /i,HasBodyTag:/<body[\s|>]/i,HtmlOpener:/<html\s?[^>]*>/i,HeadOpener:/<head\s?[^>]*>/i,HeadCloser:/<\/head\s*>/i,FCK_Class:/\s*FCK__[^ ]*(?=\s+|$)/,ElementName:/(^[a-z_:][\w.\-:]*\w$)|(^[a-z_]$)/,ForceSimpleAmpersand:/___FCKAmp___/g,SpaceNoClose:/\/>/g,EmptyParagraph:/^<(p|div|address|h\d|center)(?=[ >])[^>]*>\s*(<\/\1>)?$/,EmptyOutParagraph:/^<(p|div|address|h\d|center)(?=[ >])[^>]*>(?:\s*|&nbsp;|&#160;)(<\/\1>)?$/,TagBody:/></,GeckoEntitiesMarker:/#\?-\:/g,ProtectUrlsImg:/<img(?=\s).*?\ssrc=((?:(?:\s*)("|').*?\2)|(?:[^"'][^ >]+))/gi,ProtectUrlsA:/<a(?=\s).*?\shref=((?:(?:\s*)("|').*?\2)|(?:[^"'][^ >]+))/gi,ProtectUrlsArea:/<area(?=\s).*?\shref=((?:(?:\s*)("|').*?\2)|(?:[^"'][^ >]+))/gi,Html4DocType:/HTML 4\.0 Transitional/i,DocTypeTag:/<!DOCTYPE[^>]*>/i,HtmlDocType:/DTD HTML/,TagsWithEvent:/<[^\>]+ on\w+[\s\r\n]*=[\s\r\n]*?('|")[\s\S]+?\>/g,EventAttributes:/\s(on\w+)[\s\r\n]*=[\s\r\n]*?('|")([\s\S]*?)\2/g,ProtectedEvents:/\s\w+_fckprotectedatt="([^"]+)"/g,StyleProperties:/\S+\s*:/g,InvalidSelfCloseTags:/(<(?!base|meta|link|hr|br|param|img|area|input)([a-zA-Z0-9:]+)[^>]*)\/>/gi,StyleVariableAttName:/#\(\s*("|')(.+?)\1[^\)]*\s*\)/g,RegExp:/^\/(.*)\/([gim]*)$/,HtmlTag:/<[^\s<>](?:"[^"]*"|'[^']*'|[^<])*>/};var FCKListsLib={BlockElements:{address:1,blockquote:1,center:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,marquee:1,noscript:1,ol:1,p:1,pre:1,script:1,table:1,ul:1},NonEmptyBlockElements:{p:1,div:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,address:1,pre:1,ol:1,ul:1,li:1,td:1,th:1},InlineChildReqElements:{abbr:1,acronym:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1},InlineNonEmptyElements:{a:1,abbr:1,acronym:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1},EmptyElements:{base:1,col:1,meta:1,link:1,hr:1,br:1,param:1,img:1,area:1,input:1},PathBlockElements:{address:1,blockquote:1,dl:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,p:1,pre:1,li:1,dt:1,de:1},PathBlockLimitElements:{body:1,div:1,td:1,th:1,caption:1,form:1},StyleBlockElements:{address:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,p:1,pre:1},StyleObjectElements:{img:1,hr:1,li:1,table:1,tr:1,td:1,embed:1,object:1,ol:1,ul:1},NonEditableElements:{button:1,option:1,script:1,iframe:1,textarea:1,object:1,embed:1,map:1,applet:1},BlockBoundaries:{p:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,address:1,pre:1,ol:1,ul:1,li:1,dt:1,de:1,table:1,thead:1,tbody:1,tfoot:1,tr:1,th:1,td:1,caption:1,col:1,colgroup:1,blockquote:1,body:1},ListBoundaries:{p:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,address:1,pre:1,ol:1,ul:1,li:1,dt:1,de:1,table:1,thead:1,tbody:1,tfoot:1,tr:1,th:1,td:1,caption:1,col:1,colgroup:1,blockquote:1,body:1,br:1}};var FCKLanguageManager=FCK.Language={AvailableLanguages:{af:"Afrikaans",ar:"Arabic",bg:"Bulgarian",bn:"Bengali/Bangla",bs:"Bosnian",ca:"Catalan",cs:"Czech",da:"Danish",de:"German",el:"Greek",en:"English","en-au":"English (Australia)","en-ca":"English (Canadian)","en-uk":"English (United Kingdom)",eo:"Esperanto",es:"Spanish",et:"Estonian",eu:"Basque",fa:"Persian",fi:"Finnish",fo:"Faroese",fr:"French","fr-ca":"French (Canada)",gl:"Galician",gu:"Gujarati",he:"Hebrew",hi:"Hindi",hr:"Croatian",hu:"Hungarian",is:"Icelandic",it:"Italian",ja:"Japanese",km:"Khmer",ko:"Korean",lt:"Lithuanian",lv:"Latvian",mn:"Mongolian",ms:"Malay",nb:"Norwegian Bokmal",nl:"Dutch",no:"Norwegian",pl:"Polish",pt:"Portuguese (Portugal)","pt-br":"Portuguese (Brazil)",ro:"Romanian",ru:"Russian",sk:"Slovak",sl:"Slovenian",sr:"Serbian (Cyrillic)","sr-latn":"Serbian (Latin)",sv:"Swedish",th:"Thai",tr:"Turkish",uk:"Ukrainian",vi:"Vietnamese",zh:"Chinese Traditional","zh-cn":"Chinese Simplified"},GetActiveLanguage:function(){if(FCKConfig.AutoDetectLanguage){var b;if(navigator.userLanguage){b=navigator.userLanguage.toLowerCase();}else{if(navigator.language){b=navigator.language.toLowerCase();}else{return FCKConfig.DefaultLanguage;}}if(b.length>=5){b=b.substr(0,5);if(this.AvailableLanguages[b]){return b;}}if(b.length>=2){b=b.substr(0,2);if(this.AvailableLanguages[b]){return b;}}}return this.DefaultLanguage;},TranslateElements:function(l,m,n,o){var p=l.getElementsByTagName(m);var q,r;for(var k=0;k<p.length;k++){if((q=p[k].getAttribute("fckLang"))){if((r=FCKLang[q])){if(o){r=FCKTools.HTMLEncode(r);}p[k][n]=r;}}}},TranslatePage:function(b){this.TranslateElements(b,"INPUT","value");this.TranslateElements(b,"SPAN","innerHTML");this.TranslateElements(b,"LABEL","innerHTML");this.TranslateElements(b,"OPTION","innerHTML",true);this.TranslateElements(b,"LEGEND","innerHTML");},Initialize:function(){if(this.AvailableLanguages[FCKConfig.DefaultLanguage]){this.DefaultLanguage=FCKConfig.DefaultLanguage;}else{this.DefaultLanguage="en";}this.ActiveLanguage={};this.ActiveLanguage.Code=this.GetActiveLanguage();this.ActiveLanguage.Name=this.AvailableLanguages[this.ActiveLanguage.Code];}};var FCKXHtmlEntities={};FCKXHtmlEntities.Initialize=function(){if(FCKXHtmlEntities.Entities){return;}var h="";var j,l;if(FCKConfig.ProcessHTMLEntities){FCKXHtmlEntities.Entities={" ":"nbsp","¡":"iexcl","¢":"cent","£":"pound","¤":"curren","¥":"yen","¦":"brvbar","§":"sect","¨":"uml","©":"copy","ª":"ordf","«":"laquo","¬":"not","":"shy","®":"reg","¯":"macr","°":"deg","±":"plusmn","²":"sup2","³":"sup3","´":"acute","µ":"micro","¶":"para","·":"middot","¸":"cedil","¹":"sup1","º":"ordm","»":"raquo","¼":"frac14","½":"frac12","¾":"frac34","¿":"iquest","×":"times","÷":"divide","ƒ":"fnof","•":"bull","…":"hellip","′":"prime","″":"Prime","‾":"oline","⁄":"frasl","℘":"weierp","ℑ":"image","ℜ":"real","™":"trade","ℵ":"alefsym","←":"larr","↑":"uarr","→":"rarr","↓":"darr","↔":"harr","↵":"crarr","⇐":"lArr","⇑":"uArr","⇒":"rArr","⇓":"dArr","⇔":"hArr","∀":"forall","∂":"part","∃":"exist","∅":"empty","∇":"nabla","∈":"isin","∉":"notin","∋":"ni","∏":"prod","∑":"sum","−":"minus","∗":"lowast","√":"radic","∝":"prop","∞":"infin","∠":"ang","∧":"and","∨":"or","∩":"cap","∪":"cup","∫":"int","∴":"there4","∼":"sim","≅":"cong","≈":"asymp","≠":"ne","≡":"equiv","≤":"le","≥":"ge","⊂":"sub","⊃":"sup","⊄":"nsub","⊆":"sube","⊇":"supe","⊕":"oplus","⊗":"otimes","⊥":"perp","⋅":"sdot","\u2308":"lceil","\u2309":"rceil","\u230a":"lfloor","\u230b":"rfloor","\u2329":"lang","\u232a":"rang","◊":"loz","♠":"spades","♣":"clubs","♥":"hearts","♦":"diams",'"':"quot",">":"gt","ˆ":"circ","˜":"tilde"," ":"ensp"," ":"emsp"," ":"thinsp","":"zwnj","":"zwj","":"lrm","":"rlm","–":"ndash","—":"mdash","‘":"lsquo","’":"rsquo","‚":"sbquo","“":"ldquo","”":"rdquo","„":"bdquo","†":"dagger","‡":"Dagger","‰":"permil","‹":"lsaquo","›":"rsaquo","€":"euro"};for(l in FCKXHtmlEntities.Entities){h+=l;}if(FCKConfig.IncludeLatinEntities){j={"À":"Agrave","Á":"Aacute","Â":"Acirc","Ã":"Atilde","Ä":"Auml","Å":"Aring","Æ":"AElig","Ç":"Ccedil","È":"Egrave","É":"Eacute","Ê":"Ecirc","Ë":"Euml","Ì":"Igrave","Í":"Iacute","Î":"Icirc","Ï":"Iuml","Ð":"ETH","Ñ":"Ntilde","Ò":"Ograve","Ó":"Oacute","Ô":"Ocirc","Õ":"Otilde","Ö":"Ouml","Ø":"Oslash","Ù":"Ugrave","Ú":"Uacute","Û":"Ucirc","Ü":"Uuml","Ý":"Yacute","Þ":"THORN","ß":"szlig","à":"agrave","á":"aacute","â":"acirc","ã":"atilde","ä":"auml","å":"aring","æ":"aelig","ç":"ccedil","è":"egrave","é":"eacute","ê":"ecirc","ë":"euml","ì":"igrave","í":"iacute","î":"icirc","ï":"iuml","ð":"eth","ñ":"ntilde","ò":"ograve","ó":"oacute","ô":"ocirc","õ":"otilde","ö":"ouml","ø":"oslash","ù":"ugrave","ú":"uacute","û":"ucirc","ü":"uuml","ý":"yacute","þ":"thorn","ÿ":"yuml","Œ":"OElig","œ":"oelig","Š":"Scaron","š":"scaron","Ÿ":"Yuml"};for(l in j){FCKXHtmlEntities.Entities[l]=j[l];h+=l;}j=null;}if(FCKConfig.IncludeGreekEntities){j={"Α":"Alpha","Β":"Beta","Γ":"Gamma","Δ":"Delta","Ε":"Epsilon","Ζ":"Zeta","Η":"Eta","Θ":"Theta","Ι":"Iota","Κ":"Kappa","Λ":"Lambda","Μ":"Mu","Ν":"Nu","Ξ":"Xi","Ο":"Omicron","Π":"Pi","Ρ":"Rho","Σ":"Sigma","Τ":"Tau","Υ":"Upsilon","Φ":"Phi","Χ":"Chi","Ψ":"Psi","Ω":"Omega","α":"alpha","β":"beta","γ":"gamma","δ":"delta","ε":"epsilon","ζ":"zeta","η":"eta","θ":"theta","ι":"iota","κ":"kappa","λ":"lambda","μ":"mu","ν":"nu","ξ":"xi","ο":"omicron","π":"pi","ρ":"rho","ς":"sigmaf","σ":"sigma","τ":"tau","υ":"upsilon","φ":"phi","χ":"chi","ψ":"psi","ω":"omega","\u03d1":"thetasym","\u03d2":"upsih","\u03d6":"piv"};for(l in j){FCKXHtmlEntities.Entities[l]=j[l];h+=l;}j=null;}}else{FCKXHtmlEntities.Entities={">":"gt"};h=">";h+=" ";}var k="["+h+"]";if(FCKConfig.ProcessNumericEntities){k="[^ -~]|"+k;}var g=FCKConfig.AdditionalNumericEntities;if(g&&g.length>0){k+="|"+FCKConfig.AdditionalNumericEntities;}FCKXHtmlEntities.EntitiesRegex=new RegExp(k,"g");};var FCKXHtml={};FCKXHtml.CurrentJobNum=0;FCKXHtml.GetXHTML=function(k,l,m){FCKDomTools.CheckAndRemovePaddingNode(FCKTools.GetElementDocument(k),FCKConfig.EnterMode);FCKXHtmlEntities.Initialize();this._NbspEntity=(FCKConfig.ProcessHTMLEntities?"nbsp":"#160");var n=FCK.IsDirty();FCKXHtml.SpecialBlocks=[];this.XML=FCKTools.CreateXmlObject("DOMDocument");this.MainNode=this.XML.appendChild(this.XML.createElement("xhtml"));FCKXHtml.CurrentJobNum++;if(l){this._AppendNode(this.MainNode,k);}else{this._AppendChildNodes(this.MainNode,k,false);}if(FCKBrowserInfo.IsIE){FCKXHtml._RemoveXHtmlJobProperties(k);}var o=this._GetMainXmlString();this.XML=null;if(FCKBrowserInfo.IsSafari){o=o.replace(/^<xhtml.*?>/,"<xhtml>");}o=o.substr(7,o.length-15).Trim();if(FCKConfig.DocType.length>0&&FCKRegexLib.HtmlDocType.test(FCKConfig.DocType)){o=o.replace(FCKRegexLib.SpaceNoClose,">");}else{o=o.replace(FCKRegexLib.SpaceNoClose," />");}if(FCKConfig.ForceSimpleAmpersand){o=o.replace(FCKRegexLib.ForceSimpleAmpersand,"&");}if(m){o=FCKCodeFormatter.Format(o);}for(var j=0;j<FCKXHtml.SpecialBlocks.length;j++){var p=new RegExp("___FCKsi___"+j);o=o.replace(p,FCKXHtml.SpecialBlocks[j]);}o=o.replace(FCKRegexLib.GeckoEntitiesMarker,"&");if(!n){FCK.ResetIsDirty();}FCKDomTools.EnforcePaddingNode(FCKTools.GetElementDocument(k),FCKConfig.EnterMode);return o;};FCKXHtml._AppendAttribute=function(h,j,k){try{if(k==undefined||k==null){k="";}else{if(k.replace){if(FCKConfig.ForceSimpleAmpersand){k=k.replace(/&/g,"___FCKAmp___");}k=k.replace(FCKXHtmlEntities.EntitiesRegex,FCKXHtml_GetEntity);}}var l=this.XML.createAttribute(j);l.value=k;h.attributes.setNamedItem(l);}catch(g){}};FCKXHtml._AppendChildNodes=function(j,k,l){var m=k.firstChild;while(m){this._AppendNode(j,m);m=m.nextSibling;}if(l&&k.tagName&&k.tagName.toLowerCase()!="pre"){FCKDomTools.TrimNode(j);if(FCKConfig.FillEmptyBlocks){var n=j.lastChild;if(n&&n.nodeType==1&&n.nodeName=="br"){this._AppendEntity(j,this._NbspEntity);}}}if(j.childNodes.length==0){if(l&&FCKConfig.FillEmptyBlocks){this._AppendEntity(j,this._NbspEntity);return j;}var h=j.nodeName;if(FCKListsLib.InlineChildReqElements[h]){return null;}if(!FCKListsLib.EmptyElements[h]){j.appendChild(this.XML.createTextNode(""));}}return j;};FCKXHtml._AppendNode=function(k,l){if(!l){return false;}switch(l.nodeType){case 1:if(FCKBrowserInfo.IsGecko&&l.tagName.toLowerCase()=="br"&&l.parentNode.tagName.toLowerCase()=="pre"){var m="\r";if(l==l.parentNode.firstChild){m+="\r";}return FCKXHtml._AppendNode(k,this.XML.createTextNode(m));}if(l.getAttribute("_fckfakelement")){return FCKXHtml._AppendNode(k,FCK.GetRealElement(l));}if(FCKBrowserInfo.IsGecko&&(l.hasAttribute("_moz_editor_bogus_node")||l.getAttribute("type")=="_moz")){if(l.nextSibling){return false;}else{l.removeAttribute("_moz_editor_bogus_node");l.removeAttribute("type");}}if(l.getAttribute("_fcktemp")){return false;}var n=l.tagName.toLowerCase();if(FCKBrowserInfo.IsIE){if(l.scopeName&&l.scopeName!="HTML"&&l.scopeName!="FCK"){n=l.scopeName.toLowerCase()+":"+n;}}else{if(n.StartsWith("fck:")){n=n.Remove(0,4);}}if(!FCKRegexLib.ElementName.test(n)){return false;}if(l._fckxhtmljob&&l._fckxhtmljob==FCKXHtml.CurrentJobNum){return false;}var p=this.XML.createElement(n);FCKXHtml._AppendAttributes(k,l,p,n);l._fckxhtmljob=FCKXHtml.CurrentJobNum;var j=FCKXHtml.TagProcessors[n];if(j){p=j(p,l,k);}else{p=this._AppendChildNodes(p,l,Boolean(FCKListsLib.NonEmptyBlockElements[n]));}if(!p){return false;}k.appendChild(p);break;case 3:if(l.parentNode&&l.parentNode.nodeName.IEquals("pre")){return this._AppendTextNode(k,l.nodeValue);}return this._AppendTextNode(k,l.nodeValue.ReplaceNewLineChars(" "));case 8:if(FCKBrowserInfo.IsIE&&!l.innerHTML){break;}try{k.appendChild(this.XML.createComment(l.nodeValue));}catch(o){}break;default:k.appendChild(this.XML.createComment("Element not supported - Type: "+l.nodeType+" Name: "+l.nodeName));break;}return true;};FCKXHtml._AppendSpecialItem=function(b){return"___FCKsi___"+(FCKXHtml.SpecialBlocks.push(b)-1);};FCKXHtml._AppendEntity=function(d,c){d.appendChild(this.XML.createTextNode("#?-:"+c+";"));};FCKXHtml._AppendTextNode=function(f,g){var d=g.length>0;if(d){f.appendChild(this.XML.createTextNode(g.replace(FCKXHtmlEntities.EntitiesRegex,FCKXHtml_GetEntity)));}return d;};function FCKXHtml_GetEntity(d){var c=FCKXHtmlEntities.Entities[d]||("#"+d.charCodeAt(0));return"#?-:"+c+";";}FCKXHtml.TagProcessors={a:function(f,g){if(g.innerHTML.Trim().length==0&&!g.name){return false;}var d=g.getAttribute("_fcksavedurl");if(d!=null){FCKXHtml._AppendAttribute(f,"href",d);}if(FCKBrowserInfo.IsIE){if(g.name){FCKXHtml._AppendAttribute(f,"name",g.name);}}f=FCKXHtml._AppendChildNodes(f,g,false);return f;},area:function(h,j){var k=j.getAttribute("_fcksavedurl");if(k!=null){FCKXHtml._AppendAttribute(h,"href",k);}if(FCKBrowserInfo.IsIE){if(!h.attributes.getNamedItem("coords")){var l=j.getAttribute("coords",2);if(l&&l!="0,0,0"){FCKXHtml._AppendAttribute(h,"coords",l);}}if(!h.attributes.getNamedItem("shape")){var g=j.getAttribute("shape",2);if(g&&g.length>0){FCKXHtml._AppendAttribute(h,"shape",g.toLowerCase());}}}return h;},body:function(d,c){d=FCKXHtml._AppendChildNodes(d,c,false);d.removeAttribute("spellcheck");return d;},iframe:function(f,g){var d=g.innerHTML;if(FCKBrowserInfo.IsGecko){d=FCKTools.HTMLDecode(d);}d=d.replace(/\s_fcksavedurl="[^"]*"/g,"");f.appendChild(FCKXHtml.XML.createTextNode(FCKXHtml._AppendSpecialItem(d)));return f;},img:function(f,g){if(!f.attributes.getNamedItem("alt")){FCKXHtml._AppendAttribute(f,"alt","");}var d=g.getAttribute("_fcksavedurl");if(d!=null){FCKXHtml._AppendAttribute(f,"src",d);}if(g.style.width){f.removeAttribute("width");}if(g.style.height){f.removeAttribute("height");}return f;},li:function(g,h,j){if(j.nodeName.IEquals(["ul","ol"])){return FCKXHtml._AppendChildNodes(g,h,true);}var f=FCKXHtml.XML.createElement("ul");h._fckxhtmljob=null;do{FCKXHtml._AppendNode(f,h);do{h=FCKDomTools.GetNextSibling(h);}while(h&&h.nodeType==3&&h.nodeValue.Trim().length==0);}while(h&&h.nodeName.toLowerCase()=="li");return f;},ol:function(g,h,j){if(h.innerHTML.Trim().length==0){return false;}var f=j.lastChild;if(f&&f.nodeType==3){f=f.previousSibling;}if(f&&f.nodeName.toUpperCase()=="LI"){h._fckxhtmljob=null;FCKXHtml._AppendNode(f,h);return false;}g=FCKXHtml._AppendChildNodes(g,h);return g;},pre:function(f,g){var d=g.firstChild;if(d&&d.nodeType==3){f.appendChild(FCKXHtml.XML.createTextNode(FCKXHtml._AppendSpecialItem("\r\n")));}FCKXHtml._AppendChildNodes(f,g,true);return f;},script:function(d,c){if(!d.attributes.getNamedItem("type")){FCKXHtml._AppendAttribute(d,"type","text/javascript");}d.appendChild(FCKXHtml.XML.createTextNode(FCKXHtml._AppendSpecialItem(c.text)));return d;},span:function(d,c){if(c.innerHTML.length==0){return false;}d=FCKXHtml._AppendChildNodes(d,c,false);return d;},style:function(f,g){if(!f.attributes.getNamedItem("type")){FCKXHtml._AppendAttribute(f,"type","text/css");}var d=g.innerHTML;if(FCKBrowserInfo.IsIE){d=d.replace(/^(\r\n|\n|\r)/,"");}f.appendChild(FCKXHtml.XML.createTextNode(FCKXHtml._AppendSpecialItem(d)));return f;},title:function(d,c){d.appendChild(FCKXHtml.XML.createTextNode(FCK.EditorDocument.title));return d;}};FCKXHtml.TagProcessors.ul=FCKXHtml.TagProcessors.ol;FCKXHtml._GetMainXmlString=function(){return this.MainNode.xml;};FCKXHtml._AppendAttributes=function(A,B,C,D){var n=B.attributes,y;for(var z=0;z<n.length;z++){var q=n[z];if(q.specified){var r=q.nodeName.toLowerCase();var t;if(r.StartsWith("_fck")){continue;}else{if(r=="style"){y=true;continue;}else{if(r=="class"){t=q.nodeValue.replace(FCKRegexLib.FCK_Class,"");if(t.length==0){continue;}}else{if(r.indexOf("on")==0){t=q.nodeValue;}else{if(D=="body"&&r=="contenteditable"){continue;}else{if(q.nodeValue===true){t=r;}else{try{t=B.getAttribute(r,2);}catch(x){}}}}}}}this._AppendAttribute(C,r,t||q.nodeValue);}}if(y||B.style.cssText.length>0){var u=FCKTools.ProtectFormStyles(B);var v=B.style.cssText.replace(FCKRegexLib.StyleProperties,FCKTools.ToLowerCase);FCKTools.RestoreFormStyles(B,u);this._AppendAttribute(C,"style",v);}};FCKXHtml._RemoveXHtmlJobProperties=function(g){if(!g||!g.nodeType||g.nodeType!=1){return;}if(typeof g._fckxhtmljob=="undefined"&&g.tagName!=="BODY"){return;}g.removeAttribute("_fckxhtmljob");if(g.hasChildNodes()){var h=g.childNodes;for(var f=h.length-1;f>=0;f--){var j=h[f];if(j.parentNode==g){FCKXHtml._RemoveXHtmlJobProperties(j);}}}};FCKXHtml.TagProcessors["div"]=function(d,c){if(c.align.length>0){FCKXHtml._AppendAttribute(d,"align",c.align);}d=FCKXHtml._AppendChildNodes(d,c,true);return d;};FCKXHtml.TagProcessors["font"]=function(d,c){if(d.attributes.length==0){d=FCKXHtml.XML.createDocumentFragment();}d=FCKXHtml._AppendChildNodes(d,c);return d;};FCKXHtml.TagProcessors["form"]=function(f,g){if(g.acceptCharset&&g.acceptCharset.length>0&&g.acceptCharset!="UNKNOWN"){FCKXHtml._AppendAttribute(f,"accept-charset",g.acceptCharset);}var d=g.attributes["name"];if(d&&d.value.length>0){FCKXHtml._AppendAttribute(f,"name",d.value);}f=FCKXHtml._AppendChildNodes(f,g,true);return f;};FCKXHtml.TagProcessors["input"]=function(d,c){if(c.name){FCKXHtml._AppendAttribute(d,"name",c.name);}if(c.value&&!d.attributes.getNamedItem("value")){FCKXHtml._AppendAttribute(d,"value",c.value);}if(!d.attributes.getNamedItem("type")){FCKXHtml._AppendAttribute(d,"type","text");}return d;};FCKXHtml.TagProcessors["label"]=function(d,c){if(c.htmlFor.length>0){FCKXHtml._AppendAttribute(d,"for",c.htmlFor);}d=FCKXHtml._AppendChildNodes(d,c);return d;};FCKXHtml.TagProcessors["map"]=function(f,g){if(!f.attributes.getNamedItem("name")){var d=g.name;if(d){FCKXHtml._AppendAttribute(f,"name",d);}}f=FCKXHtml._AppendChildNodes(f,g,true);return f;};FCKXHtml.TagProcessors["meta"]=function(g,h){var j=g.attributes.getNamedItem("http-equiv");if(j==null||j.value.length==0){var f=h.outerHTML.match(FCKRegexLib.MetaHttpEquiv);if(f){f=f[1];FCKXHtml._AppendAttribute(g,"http-equiv",f);}}return g;};FCKXHtml.TagProcessors["option"]=function(d,c){if(c.selected&&!d.attributes.getNamedItem("selected")){FCKXHtml._AppendAttribute(d,"selected","selected");}d=FCKXHtml._AppendChildNodes(d,c);return d;};FCKXHtml.TagProcessors["textarea"]=FCKXHtml.TagProcessors["select"]=function(d,c){if(c.name){FCKXHtml._AppendAttribute(d,"name",c.name);}d=FCKXHtml._AppendChildNodes(d,c);return d;};var FCKCodeFormatter={};FCKCodeFormatter.Init=function(){var b=this.Regex={};b.BlocksOpener=/\<(P|DIV|H1|H2|H3|H4|H5|H6|ADDRESS|PRE|OL|UL|LI|DL|DT|DD|TITLE|META|LINK|BASE|SCRIPT|LINK|TD|TH|AREA|OPTION)[^\>]*\>/gi;b.BlocksCloser=/\<\/(P|DIV|H1|H2|H3|H4|H5|H6|ADDRESS|PRE|OL|UL|LI|DL|DT|DD|TITLE|META|LINK|BASE|SCRIPT|LINK|TD|TH|AREA|OPTION)[^\>]*\>/gi;b.NewLineTags=/\<(BR|HR)[^\>]*\>/gi;b.MainTags=/\<\/?(HTML|HEAD|BODY|FORM|TABLE|TBODY|THEAD|TR)[^\>]*\>/gi;b.LineSplitter=/\s*\n+\s*/g;b.IncreaseIndent=/^\<(HTML|HEAD|BODY|FORM|TABLE|TBODY|THEAD|TR|UL|OL|DL)[ \/\>]/i;b.DecreaseIndent=/^\<\/(HTML|HEAD|BODY|FORM|TABLE|TBODY|THEAD|TR|UL|OL|DL)[ \>]/i;b.FormatIndentatorRemove=new RegExp("^"+FCKConfig.FormatIndentator);b.ProtectedTags=/(<PRE[^>]*>)([\s\S]*?)(<\/PRE>)/gi;};FCKCodeFormatter._ProtectData=function(g,h,j,f){return h+"___FCKpd___"+(FCKCodeFormatter.ProtectedData.push(j)-1)+f;};FCKCodeFormatter.Format=function(l){if(!this.Regex){this.Init();}FCKCodeFormatter.ProtectedData=[];var m=l.replace(this.Regex.ProtectedTags,FCKCodeFormatter._ProtectData);m=m.replace(this.Regex.BlocksOpener,"\n$&");m=m.replace(this.Regex.BlocksCloser,"$&\n");m=m.replace(this.Regex.NewLineTags,"$&\n");m=m.replace(this.Regex.MainTags,"\n$&\n");var n="";var o=m.split(this.Regex.LineSplitter);m="";for(var r=0;r<o.length;r++){var p=o[r];if(p.length==0){continue;}if(this.Regex.DecreaseIndent.test(p)){n=n.replace(this.Regex.FormatIndentatorRemove,"");}m+=n+p+"\n";if(this.Regex.IncreaseIndent.test(p)){n+=FCKConfig.FormatIndentator;}}for(var j=0;j<FCKCodeFormatter.ProtectedData.length;j++){var q=new RegExp("___FCKpd___"+j);m=m.replace(q,FCKCodeFormatter.ProtectedData[j].replace(/\$/g,"$$$$"));}return m.Trim();};var FCKUndo={};FCKUndo.SavedData=[];FCKUndo.CurrentIndex=-1;FCKUndo.TypesCount=0;FCKUndo.Changed=false;FCKUndo.MaxTypes=25;FCKUndo.Typing=false;FCKUndo.SaveLocked=false;FCKUndo._GetBookmark=function(){FCKSelection.Restore();var g=new FCKDomRange(FCK.EditorWindow);try{g.MoveToSelection();}catch(f){return null;}if(FCKBrowserInfo.IsIE){var h=g.CreateBookmark();var j=FCK.EditorDocument.body.innerHTML;g.MoveToBookmark(h);return[h,j];}return g.CreateBookmark2();};FCKUndo._SelectBookmark=function(f){if(!f){return;}var g=new FCKDomRange(FCK.EditorWindow);if(f instanceof Object){if(FCKBrowserInfo.IsIE){g.MoveToBookmark(f[0]);}else{g.MoveToBookmark2(f);}try{g.Select();}catch(d){g.MoveToPosition(FCK.EditorDocument.body,4);g.Select();}}};FCKUndo._CompareCursors=function(f,g){for(var d=0;d<Math.min(f.length,g.length);d++){if(f[d]<g[d]){return -1;}else{if(f[d]>g[d]){return 1;}}}if(f.length<g.length){return -1;}else{if(f.length>g.length){return 1;}}return 0;};FCKUndo._CheckIsBookmarksEqual=function(j,k){if(!(j&&k)){return false;}if(FCKBrowserInfo.IsIE){var l=j[1].search(j[0].StartId);var m=k[1].search(k[0].StartId);var n=j[1].search(j[0].EndId);var h=k[1].search(k[0].EndId);return l==m&&n==h;}else{return this._CompareCursors(j.Start,k.Start)==0&&this._CompareCursors(j.End,k.End)==0;}};FCKUndo.SaveUndoStep=function(){if(FCK.EditMode!=0||this.SaveLocked){return;}if(this.SavedData.length){this.Changed=true;}var d=FCK.EditorDocument.body.innerHTML;var c=this._GetBookmark();this.SavedData=this.SavedData.slice(0,this.CurrentIndex+1);if(this.CurrentIndex>0&&d==this.SavedData[this.CurrentIndex][0]&&this._CheckIsBookmarksEqual(c,this.SavedData[this.CurrentIndex][1])){return;}else{if(this.CurrentIndex==0&&this.SavedData.length&&d==this.SavedData[0][0]){this.SavedData[0][1]=c;return;}}if(this.CurrentIndex+1>=FCKConfig.MaxUndoLevels){this.SavedData.shift();}else{this.CurrentIndex++;}this.SavedData[this.CurrentIndex]=[d,c];FCK.Events.FireEvent("OnSelectionChange");};FCKUndo.CheckUndoState=function(){return(this.Changed||this.CurrentIndex>0);};FCKUndo.CheckRedoState=function(){return(this.CurrentIndex<(this.SavedData.length-1));};FCKUndo.Undo=function(){if(this.CheckUndoState()){if(this.CurrentIndex==(this.SavedData.length-1)){this.SaveUndoStep();}this._ApplyUndoLevel(--this.CurrentIndex);FCK.Events.FireEvent("OnSelectionChange");}};FCKUndo.Redo=function(){if(this.CheckRedoState()){this._ApplyUndoLevel(++this.CurrentIndex);FCK.Events.FireEvent("OnSelectionChange");}};FCKUndo._ApplyUndoLevel=function(d){var c=this.SavedData[d];if(!c){return;}if(FCKBrowserInfo.IsIE){if(c[1]&&c[1][1]){FCK.SetInnerHtml(c[1][1]);}else{FCK.SetInnerHtml(c[0]);}}else{FCK.EditorDocument.body.innerHTML=c[0];}this._SelectBookmark(c[1]);this.TypesCount=0;this.Changed=false;this.Typing=false;};var FCKEditingArea=function(b){this.TargetElement=b;this.Mode=0;if(FCK.IECleanup){FCK.IECleanup.AddItem(this,FCKEditingArea_Cleanup);}};FCKEditingArea.prototype.Start=function(y,z){var A=this.TargetElement;var B=FCKTools.GetElementDocument(A);while(A.firstChild){A.removeChild(A.firstChild);}if(this.Mode==0){if(FCK_IS_CUSTOM_DOMAIN){y='<script>document.domain="'+FCK_RUNTIME_DOMAIN+'";<\/script>'+y;}if(FCKBrowserInfo.IsIE){y=y.replace(/(<base[^>]*?)\s*\/?>(?!\s*<\/base>)/gi,"$1></base>");}else{if(!z){var o=y.match(FCKRegexLib.BeforeBody);var p=y.match(FCKRegexLib.AfterBody);if(o&&p){var q=y.substr(o[1].length,y.length-o[1].length-p[1].length);y=o[1]+"&nbsp;"+p[1];if(FCKBrowserInfo.IsGecko&&(q.length==0||FCKRegexLib.EmptyParagraph.test(q))){q='<br type="_moz">';}this._BodyHTML=q;}else{this._BodyHTML=y;}}}var r=this.IFrame=B.createElement("iframe");var t='<script type="text/javascript" _fcktemp="true">window.onerror=function(){return true;};<\/script>';r.frameBorder=0;r.style.width=r.style.height="100%";if(FCK_IS_CUSTOM_DOMAIN&&FCKBrowserInfo.IsIE){window._FCKHtmlToLoad=y.replace(/<head>/i,"<head>"+t);r.src='javascript:void( (function(){document.open() ;document.domain="'+document.domain+'" ;document.write( window.parent._FCKHtmlToLoad );document.close() ;window.parent._FCKHtmlToLoad = null ;})() )';}else{if(!FCKBrowserInfo.IsGecko){r.src="javascript:void(0)";}}A.appendChild(r);this.Window=r.contentWindow;if(!FCK_IS_CUSTOM_DOMAIN||!FCKBrowserInfo.IsIE){var u=this.Window.document;u.open();u.write(y.replace(/<head>/i,"<head>"+t));u.close();}if(FCKBrowserInfo.IsAIR){FCKAdobeAIR.EditingArea_Start(u,y);}if(FCKBrowserInfo.IsGecko10&&!z){this.Start(y,true);return;}if(r.readyState&&r.readyState!="completed"){var v=this;setTimeout(function(){try{v.Window.document.documentElement.doScroll("left");}catch(a){setTimeout(arguments.callee,0);return;}v.Window._FCKEditingArea=v;FCKEditingArea_CompleteStart.call(v.Window);},0);}else{this.Window._FCKEditingArea=this;if(FCKBrowserInfo.IsGecko10){this.Window.setTimeout(FCKEditingArea_CompleteStart,500);}else{FCKEditingArea_CompleteStart.call(this.Window);}}}else{var x=this.Textarea=B.createElement("textarea");x.className="SourceField";x.dir="ltr";FCKDomTools.SetElementStyles(x,{width:"100%",height:"100%",border:"none",resize:"none",outline:"none"});A.appendChild(x);x.value=y;FCKTools.RunFunction(this.OnLoad);}};function FCKEditingArea_CompleteStart(){if(!this.document.body){this.setTimeout(FCKEditingArea_CompleteStart,50);return;}var b=this._FCKEditingArea;b.Document=b.Window.document;b.MakeEditable();FCKTools.RunFunction(b.OnLoad);}FCKEditingArea.prototype.MakeEditable=function(){var d=this.Document;if(FCKBrowserInfo.IsIE){d.body.disabled=true;d.body.contentEditable=true;d.body.removeAttribute("disabled");}else{try{d.body.spellcheck=(this.FFSpellChecker!==false);if(this._BodyHTML){d.body.innerHTML=this._BodyHTML;d.body.offsetLeft;this._BodyHTML=null;}d.designMode="on";d.execCommand("enableObjectResizing",false,!FCKConfig.DisableObjectResizing);d.execCommand("enableInlineTableEditing",false,!FCKConfig.DisableFFTableHandles);}catch(c){FCKTools.AddEventListener(this.Window.frameElement,"DOMAttrModified",FCKEditingArea_Document_AttributeNodeModified);}}};function FCKEditingArea_Document_AttributeNodeModified(d){var c=d.currentTarget.contentWindow._FCKEditingArea;if(c._timer){window.clearTimeout(c._timer);}c._timer=FCKTools.SetTimeout(FCKEditingArea_MakeEditableByMutation,1000,c);}function FCKEditingArea_MakeEditableByMutation(){delete this._timer;FCKTools.RemoveEventListener(this.Window.frameElement,"DOMAttrModified",FCKEditingArea_Document_AttributeNodeModified);this.MakeEditable();}FCKEditingArea.prototype.Focus=function(){try{if(this.Mode==0){if(FCKBrowserInfo.IsIE){this._FocusIE();}else{this.Window.focus();}}else{var d=FCKTools.GetElementDocument(this.Textarea);if((!d.hasFocus||d.hasFocus())&&d.activeElement==this.Textarea){return;}this.Textarea.focus();}}catch(c){}};FCKEditingArea.prototype._FocusIE=function(){this.Document.body.setActive();this.Window.focus();var f=this.Document.selection.createRange();var g=f.parentElement();var d=g.nodeName.toLowerCase();if(g.childNodes.length>0||!(FCKListsLib.BlockElements[d]||FCKListsLib.NonEmptyBlockElements[d])){return;}f=new FCKDomRange(this.Window);f.MoveToElementEditStart(g);f.Select();};function FCKEditingArea_Cleanup(){if(this.Document){this.Document.selection.empty();this.Document.body.innerHTML="";}this.TargetElement=null;this.IFrame=null;this.Document=null;this.Textarea=null;if(this.Window){this.Window._FCKEditingArea=null;this.Window=null;}}var FCKKeystrokeHandler=function(b){this.Keystrokes={};this.CancelCtrlDefaults=(b!==false);};FCKKeystrokeHandler.prototype.AttachToElement=function(b){FCKTools.AddEventListenerEx(b,"keydown",_FCKKeystrokeHandler_OnKeyDown,this);if(FCKBrowserInfo.IsGecko10||FCKBrowserInfo.IsOpera||(FCKBrowserInfo.IsGecko&&FCKBrowserInfo.IsMac)){FCKTools.AddEventListenerEx(b,"keypress",_FCKKeystrokeHandler_OnKeyPress,this);}};FCKKeystrokeHandler.prototype.SetKeystrokes=function(){for(var c=0;c<arguments.length;c++){var d=arguments[c];if(!d){continue;}if(typeof(d[0])=="object"){this.SetKeystrokes.apply(this,d);}else{if(d.length==1){delete this.Keystrokes[d[0]];}else{this.Keystrokes[d[0]]=d[1]===true?true:d;}}}};function _FCKKeystrokeHandler_OnKeyDown(k,l){var m=k.keyCode||k.which;var n=0;if(k.ctrlKey||k.metaKey){n+=CTRL;}if(k.shiftKey){n+=SHIFT;}if(k.altKey){n+=ALT;}var o=m+n;var p=l._CancelIt=false;var j=l.Keystrokes[o];if(j){if(j===true||!(l.OnKeystroke&&l.OnKeystroke.apply(l,j))){return true;}p=true;}if(p||(l.CancelCtrlDefaults&&n==CTRL&&(m<33||m>40))){l._CancelIt=true;if(k.preventDefault){return k.preventDefault();}k.returnValue=false;k.cancelBubble=true;return false;}return true;}function _FCKKeystrokeHandler_OnKeyPress(d,c){if(c._CancelIt){if(d.preventDefault){return d.preventDefault();}return false;}return true;}FCK.DTD=(function(){var N=FCKTools.Merge;var v,H,F,I,J,K,z,D,L,G,M,B,C,y,x,A,E;v={isindex:1,fieldset:1};x={input:1,button:1,select:1,textarea:1,label:1};y=N({a:1},x);z=N({iframe:1},y);A={hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1};B={ins:1,del:1,script:1};C=N({b:1,acronym:1,bdo:1,"var":1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1},B);D=N({sub:1,img:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1},C);E=N({p:1},D);F=N({iframe:1},D,x);G={img:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,"var":1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1};H=N({a:1},F);I={tr:1};J={"#":1};K=N({param:1},G);L=N({form:1},v,z,A,E);M={li:1};return{col:{},tr:{td:1,th:1},img:{},colgroup:{col:1},noscript:L,td:L,br:{},th:L,center:L,kbd:H,button:N(E,A),basefont:{},h5:H,h4:H,samp:H,h6:H,ol:M,h1:H,h3:H,option:J,h2:H,form:N(v,z,A,E),select:{optgroup:1,option:1},font:F,ins:L,menu:M,abbr:H,label:H,table:{thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1},code:H,script:J,tfoot:I,cite:H,li:L,input:{},iframe:L,strong:F,textarea:J,noframes:L,big:F,small:F,span:F,hr:{},dt:H,sub:F,optgroup:{option:1},param:{},bdo:H,"var":F,div:L,object:K,sup:F,dd:L,strike:F,area:{},dir:M,map:N({area:1,form:1,p:1},v,B,A),applet:K,dl:{dt:1,dd:1},del:L,isindex:{},fieldset:N({legend:1},G),thead:I,ul:M,acronym:H,b:F,a:F,blockquote:L,caption:H,i:F,u:F,tbody:I,s:H,address:N(z,E),tt:F,legend:H,q:H,pre:N(C,y),p:H,em:F,dfn:H};})();var FCKStyle=function(b){this.Element=(b.Element||"span").toLowerCase();this._StyleDesc=b;};FCKStyle.prototype={GetType:function(){var d=this.GetType_$;if(d!=undefined){return d;}var c=this.Element;if(c=="#"||FCKListsLib.StyleBlockElements[c]){d=0;}else{if(FCKListsLib.StyleObjectElements[c]){d=2;}else{d=1;}}return(this.GetType_$=d);},ApplyToSelection:function(d){var c=new FCKDomRange(d);c.MoveToSelection();this.ApplyToRange(c,true);},ApplyToRange:function(f,g,d){switch(this.GetType()){case 0:this.ApplyToRange=this._ApplyBlockStyle;break;case 1:this.ApplyToRange=this._ApplyInlineStyle;break;default:return;}this.ApplyToRange(f,g,d);},ApplyToObject:function(b){if(!b){return;}this.BuildElement(null,b);},RemoveFromSelection:function(d){var c=new FCKDomRange(d);c.MoveToSelection();this.RemoveFromRange(c,true);},RemoveFromRange:function(a,b,c){var C;var j=this._GetAttribsForComparison();var A=this._GetOverridesForComparison();if(a.CheckIsCollapsed()){var C=a.CreateBookmark(true);var B=a.GetBookmarkNode(C,true);var D=new FCKElementPath(B.parentNode);var E=[];var F=!FCKDomTools.GetNextSibling(B);var H=F||!FCKDomTools.GetPreviousSibling(B);var I;var J=-1;for(var Z=0;Z<D.Elements.length;Z++){var K=D.Elements[Z];if(this.CheckElementRemovable(K)){if(H&&!FCKDomTools.CheckIsEmptyElement(K,function(d){return(d!=B);})){I=K;J=E.length-1;}else{var L=K.nodeName.toLowerCase();if(L==this.Element){for(var M in j){if(FCKDomTools.HasAttribute(K,M)){switch(M){case"style":this._RemoveStylesFromElement(K);break;case"class":if(FCKDomTools.GetAttributeValue(K,M)!=this.GetFinalAttributeValue(M)){continue;}default:FCKDomTools.RemoveAttribute(K,M);}}}}this._RemoveOverrides(K,A[L]);if(this.GetType()==1){this._RemoveNoAttribElement(K);}}}else{if(H){E.push(K);}}H=H&&((F&&!FCKDomTools.GetNextSibling(K))||(!F&&!FCKDomTools.GetPreviousSibling(K)));if(I&&(!H||(Z==D.Elements.length-1))){var N=FCKDomTools.RemoveNode(B);for(var ab=0;ab<=J;ab++){var O=FCKDomTools.CloneElement(E[ab]);O.appendChild(N);N=O;}if(F){FCKDomTools.InsertAfterNode(I,N);}else{I.parentNode.insertBefore(N,I);}H=false;I=null;}}if(b){a.SelectBookmark(C);}if(c){a.MoveToBookmark(C);}return;}a.Expand("inline_elements");C=a.CreateBookmark(true);var P=a.GetBookmarkNode(C,true);var Q=a.GetBookmarkNode(C,false);a.Release(true);var D=new FCKElementPath(P);var R=D.Elements;var K;for(var Z=1;Z<R.length;Z++){K=R[Z];if(K==D.Block||K==D.BlockLimit){break;}if(this.CheckElementRemovable(K)){FCKDomTools.BreakParent(P,K,a);}}D=new FCKElementPath(Q);R=D.Elements;for(var Z=1;Z<R.length;Z++){K=R[Z];if(K==D.Block||K==D.BlockLimit){break;}U=K.nodeName.toLowerCase();if(this.CheckElementRemovable(K)){FCKDomTools.BreakParent(Q,K,a);}}var T=FCKDomTools.GetNextSourceNode(P,true);while(T){var S=FCKDomTools.GetNextSourceNode(T);if(T.nodeType==1){var U=T.nodeName.toLowerCase();var X=(U==this.Element);if(X){for(var M in j){if(FCKDomTools.HasAttribute(T,M)){switch(M){case"style":this._RemoveStylesFromElement(T);break;case"class":if(FCKDomTools.GetAttributeValue(T,M)!=this.GetFinalAttributeValue(M)){continue;}default:FCKDomTools.RemoveAttribute(T,M);}}}}else{X=!!A[U];}if(X){this._RemoveOverrides(T,A[U]);this._RemoveNoAttribElement(T);}}if(S==Q){break;}T=S;}this._FixBookmarkStart(P);if(b){a.SelectBookmark(C);}if(c){a.MoveToBookmark(C);}},CheckElementRemovable:function(t,u){if(!t){return false;}var v=t.nodeName.toLowerCase();if(v==this.Element){if(!u&&!FCKDomTools.HasAttributes(t)){return true;}var x=this._GetAttribsForComparison();var m=(x._length==0);for(var n in x){if(n=="_length"){continue;}if(this._CompareAttributeValues(n,FCKDomTools.GetAttributeValue(t,n),(this.GetFinalAttributeValue(n)||""))){m=true;if(!u){break;}}else{m=false;if(u){return false;}}}if(m){return true;}}var o=this._GetOverridesForComparison()[v];if(o){if(!(x=o.Attributes)){return true;}for(var r=0;r<x.length;r++){var p=x[r][0];if(FCKDomTools.HasAttribute(t,p)){var q=x[r][1];if(q==null||(typeof q=="string"&&FCKDomTools.GetAttributeValue(t,p)==q)||q.test(FCKDomTools.GetAttributeValue(t,p))){return true;}}}}return false;},CheckActive:function(g){switch(this.GetType()){case 0:return this.CheckElementRemovable(g.Block||g.BlockLimit,true);case 1:var h=g.Elements;for(var f=0;f<h.length;f++){var j=h[f];if(j==g.Block||j==g.BlockLimit){continue;}if(this.CheckElementRemovable(j,true)){return true;}}}return false;},RemoveFromElement:function(l){var m=this._GetAttribsForComparison();var n=this._GetOverridesForComparison();var o=l.getElementsByTagName(this.Element);for(var k=o.length-1;k>=0;k--){var p=o[k];for(var q in m){if(FCKDomTools.HasAttribute(p,q)){switch(q){case"style":this._RemoveStylesFromElement(p);break;case"class":if(FCKDomTools.GetAttributeValue(p,q)!=this.GetFinalAttributeValue(q)){continue;}default:FCKDomTools.RemoveAttribute(p,q);}}}this._RemoveOverrides(p,n[this.Element]);this._RemoveNoAttribElement(p);}for(var r in n){if(r!=this.Element){o=l.getElementsByTagName(r);for(var k=o.length-1;k>=0;k--){var p=o[k];this._RemoveOverrides(p,n[r]);this._RemoveNoAttribElement(p);}}}},_RemoveStylesFromElement:function(g){var h=g.style.cssText;var j=this.GetFinalStyleValue();if(h.length>0&&j.length==0){return;}j="(^|;)\\s*("+j.replace(/\s*([^ ]+):.*?(;|$)/g,"$1|").replace(/\|$/,"")+"):[^;]+";var f=new RegExp(j,"gi");h=h.replace(f,"").Trim();if(h.length==0||h==";"){FCKDomTools.RemoveAttribute(g,"style");}else{g.style.cssText=h.replace(f,"");}},_RemoveOverrides:function(j,k){var l=k&&k.Attributes;if(l){for(var h=0;h<l.length;h++){var m=l[h][0];if(FCKDomTools.HasAttribute(j,m)){var n=l[h][1];if(n==null||(n.test&&n.test(FCKDomTools.GetAttributeValue(j,m)))||(typeof n=="string"&&FCKDomTools.GetAttributeValue(j,m)==n)){FCKDomTools.RemoveAttribute(j,m);}}}}},_RemoveNoAttribElement:function(f){if(!FCKDomTools.HasAttributes(f)){var g=f.firstChild;var d=f.lastChild;FCKDomTools.RemoveNode(f,true);this._MergeSiblings(g);if(g!=d){this._MergeSiblings(d);}}},BuildElement:function(j,k){var l=k||j.createElement(this.Element);var m=this._StyleDesc.Attributes;var n;if(m){for(var h in m){n=this.GetFinalAttributeValue(h);if(h.toLowerCase()=="class"){l.className=n;}else{l.setAttribute(h,n);}}}if(this._GetStyleText().length>0){l.style.cssText=this.GetFinalStyleValue();}return l;},_CompareAttributeValues:function(f,g,d){if(f=="style"&&g&&d){g=g.replace(/;$/,"").toLowerCase();d=d.replace(/;$/,"").toLowerCase();}return(g==d||((g===null||g==="")&&(d===null||d==="")));},GetFinalAttributeValue:function(d){var c=this._StyleDesc.Attributes;var c=c?c[d]:null;if(!c&&d=="style"){return this.GetFinalStyleValue();}if(c&&this._Variables){c=c.Replace(FCKRegexLib.StyleVariableAttName,this._GetVariableReplace,this);}return c;},GetFinalStyleValue:function(){var b=this._GetStyleText();if(b.length>0&&this._Variables){b=b.Replace(FCKRegexLib.StyleVariableAttName,this._GetVariableReplace,this);b=FCKTools.NormalizeCssText(b);}return b;},_GetVariableReplace:function(){return this._Variables[arguments[2]]||arguments[0];},SetVariable:function(f,g){var d=this._Variables;if(!d){d=this._Variables={};}this._Variables[f]=g;},_FromPre:function(j,k,l){var m=k.innerHTML;m=m.replace(/(\r\n|\r)/g,"\n");m=m.replace(/^[ \t]*\n/,"");m=m.replace(/\n$/,"");m=m.replace(/^[ \t]+|[ \t]+$/g,function(c,a,b){if(c.length==1){return"&nbsp;";}else{if(a==0){return new Array(c.length).join("&nbsp;")+" ";}else{return" "+new Array(c.length).join("&nbsp;");}}});var n=new FCKHtmlIterator(m);var h=[];n.Each(function(b,a){if(!b){a=a.replace(/\n/g,"<br>");a=a.replace(/[ \t]{2,}/g,function(c){return new Array(c.length).join("&nbsp;")+" ";});}h.push(a);});l.innerHTML=h.join("");return l;},_ToPre:function(k,l,m){var n=l.innerHTML.Trim();n=n.replace(/[ \t\r\n]*(<br[^>]*>)[ \t\r\n]*/gi,"<br />");var o=new FCKHtmlIterator(n);var p=[];o.Each(function(b,a){if(!b){a=a.replace(/([ \t\n\r]+|&nbsp;)/g," ");}else{if(b&&a=="<br />"){a="\n";}}p.push(a);});if(FCKBrowserInfo.IsIE){var j=k.createElement("div");j.appendChild(m);m.outerHTML="<pre>\n"+p.join("")+"</pre>";m=j.removeChild(j.firstChild);}else{m.innerHTML=p.join("");}return m;},_CheckAndMergePre:function(f,g){if(f!=FCKDomTools.GetPreviousSourceElement(g,true)){return;}var d=f.innerHTML.replace(/\n$/,"")+"\n\n"+g.innerHTML.replace(/^\n/,"");if(FCKBrowserInfo.IsIE){g.outerHTML="<pre>"+d+"</pre>";}else{g.innerHTML=d;}FCKDomTools.RemoveNode(f);},_CheckAndSplitPre:function(g){var h;var j=g.firstChild;j=j&&j.nextSibling;while(j){var f=j.nextSibling;if(f&&f.nextSibling&&j.nodeName.IEquals("br")&&f.nodeName.IEquals("br")){FCKDomTools.RemoveNode(j);j=f.nextSibling;FCKDomTools.RemoveNode(f);h=FCKDomTools.InsertAfterNode(h||g,FCKDomTools.CloneElement(g));continue;}if(h){j=j.previousSibling;FCKDomTools.MoveNode(j.nextSibling,h);}j=j.nextSibling;}},_ApplyBlockStyle:function(A,B,C){var D;if(B){D=A.CreateBookmark();}var p=new FCKDomRangeIterator(A);p.EnforceRealBlocks=true;var q;var r=A.Window.document;var t;while((q=p.GetNextParagraph())){var u=this.BuildElement(r);var v=u.nodeName.IEquals("pre");var x=q.nodeName.IEquals("pre");var y=v&&!x;var z=!v&&x;if(y){u=this._ToPre(r,q,u);}else{if(z){u=this._FromPre(r,q,u);}else{FCKDomTools.MoveChildren(q,u);}}q.parentNode.insertBefore(u,q);FCKDomTools.RemoveNode(q);if(v){if(t){this._CheckAndMergePre(t,u);}t=u;}else{if(z){this._CheckAndSplitPre(u);}}}if(B){A.SelectBookmark(D);}if(C){A.MoveToBookmark(D);}},_ApplyInlineStyle:function(v,x,y){var z=v.Window.document;if(v.CheckIsCollapsed()){var A=this.BuildElement(z);v.InsertNode(A);v.MoveToPosition(A,2);v.Select();return;}var B=this.Element;var C=FCK.DTD[B]||FCK.DTD.span;var D=this._GetAttribsForComparison();var E;v.Expand("inline_elements");var F=v.CreateBookmark(true);var G=v.GetBookmarkNode(F,true);var H=v.GetBookmarkNode(F,false);v.Release(true);var I=FCKDomTools.GetNextSourceNode(G,true);while(I){var J=false;var K=I.nodeType;var L=K==1?I.nodeName.toLowerCase():null;if(!L||C[L]){if((FCK.DTD[I.parentNode.nodeName.toLowerCase()]||FCK.DTD.span)[B]||!FCK.DTD[B]){if(!v.CheckHasRange()){v.SetStart(I,3);}if(K!=1||I.childNodes.length==0){var M=I;var N=M.parentNode;while(M==N.lastChild&&C[N.nodeName.toLowerCase()]){M=N;}v.SetEnd(M,4);if(M==M.parentNode.lastChild&&!C[M.parentNode.nodeName.toLowerCase()]){J=true;}}else{v.SetEnd(I,3);}}else{J=true;}}else{J=true;}I=FCKDomTools.GetNextSourceNode(I);if(I==H){I=null;J=true;}if(J&&v.CheckHasRange()&&!v.CheckIsCollapsed()){E=this.BuildElement(z);v.ExtractContents().AppendTo(E);if(E.innerHTML.RTrim().length>0){v.InsertNode(E);this.RemoveFromElement(E);this._MergeSiblings(E,this._GetAttribsForComparison());if(!FCKBrowserInfo.IsIE){E.normalize();}}v.Release(true);}}this._FixBookmarkStart(G);if(x){v.SelectBookmark(F);}if(y){v.MoveToBookmark(F);}},_FixBookmarkStart:function(d){var c;while((c=d.nextSibling)){if(c.nodeType==1&&FCKListsLib.InlineNonEmptyElements[c.nodeName.toLowerCase()]){if(!c.firstChild){FCKDomTools.RemoveNode(c);}else{FCKDomTools.MoveNode(d,c,true);}continue;}if(c.nodeType==3&&c.length==0){FCKDomTools.RemoveNode(c);continue;}break;}},_MergeSiblings:function(d,c){if(!d||d.nodeType!=1||!FCKListsLib.InlineNonEmptyElements[d.nodeName.toLowerCase()]){return;}this._MergeNextSibling(d,c);this._MergePreviousSibling(d,c);},_MergeNextSibling:function(h,j){var k=h.nextSibling;var l=(k&&k.nodeType==1&&k.getAttribute("_fck_bookmark"));if(l){k=k.nextSibling;}if(k&&k.nodeType==1&&k.nodeName==h.nodeName){if(!j){j=this._CreateElementAttribsForComparison(h);}if(this._CheckAttributesMatch(k,j)){var g=h.lastChild;if(l){FCKDomTools.MoveNode(h.nextSibling,h);}FCKDomTools.MoveChildren(k,h);FCKDomTools.RemoveNode(k);if(g){this._MergeNextSibling(g);}}}},_MergePreviousSibling:function(h,j){var k=h.previousSibling;var l=(k&&k.nodeType==1&&k.getAttribute("_fck_bookmark"));if(l){k=k.previousSibling;}if(k&&k.nodeType==1&&k.nodeName==h.nodeName){if(!j){j=this._CreateElementAttribsForComparison(h);}if(this._CheckAttributesMatch(k,j)){var g=h.firstChild;if(l){FCKDomTools.MoveNode(h.previousSibling,h,true);}FCKDomTools.MoveChildren(k,h,true);FCKDomTools.RemoveNode(k);if(g){this._MergePreviousSibling(g);}}}},_GetStyleText:function(){var f=this._StyleDesc.Styles;var g=(this._StyleDesc.Attributes?this._StyleDesc.Attributes["style"]||"":"");if(g.length>0){g+=";";}for(var d in f){g+=d+":"+f[d]+";";}if(g.length>0&&!(/#\(/.test(g))){g=FCKTools.NormalizeCssText(g);}return(this._GetStyleText=function(){return g;})();},_GetAttribsForComparison:function(){var f=this._GetAttribsForComparison_$;if(f){return f;}f={};var g=this._StyleDesc.Attributes;if(g){for(var d in g){f[d.toLowerCase()]=g[d].toLowerCase();}}if(this._GetStyleText().length>0){f["style"]=this._GetStyleText().toLowerCase();}FCKTools.AppendLengthProperty(f,"_length");return(this._GetAttribsForComparison_$=f);},_GetOverridesForComparison:function(){var q=this._GetOverridesForComparison_$;if(q){return q;}q={};var r=this._StyleDesc.Overrides;if(r){if(!FCKTools.IsArray(r)){r=[r];}for(var p=0;p<r.length;p++){var t=r[p];var u;var l;var m;if(typeof t=="string"){u=t.toLowerCase();}else{u=t.Element?t.Element.toLowerCase():this.Element;m=t.Attributes;}l=q[u]||(q[u]={});if(m){var n=(l.Attributes=l.Attributes||[]);for(var o in m){n.push([o.toLowerCase(),m[o]]);}}}}return(this._GetOverridesForComparison_$=q);},_CreateElementAttribsForComparison:function(h){var j={};var k=0;for(var g=0;g<h.attributes.length;g++){var l=h.attributes[g];if(l.specified){j[l.nodeName.toLowerCase()]=FCKDomTools.GetAttributeValue(h,l).toLowerCase();k++;}}j._length=k;return j;},_CheckAttributesMatch:function(l,m){var n=l.attributes;var o=0;for(var k=0;k<n.length;k++){var p=n[k];if(p.specified){var q=p.nodeName.toLowerCase();var r=m[q];if(!r){break;}if(r!=FCKDomTools.GetAttributeValue(l,p).toLowerCase()){break;}o++;}}return(o==m._length);}};var FCKStyles=FCK.Styles={_Callbacks:{},_ObjectStyles:{},ApplyStyle:function(b){if(typeof b=="string"){b=this.GetStyles()[b];}if(b){if(b.GetType()==2){b.ApplyToObject(FCKSelection.GetSelectedElement());}else{b.ApplyToSelection(FCK.EditorWindow);}FCK.Events.FireEvent("OnSelectionChange");}},RemoveStyle:function(b){if(typeof b=="string"){b=this.GetStyles()[b];}if(b){b.RemoveFromSelection(FCK.EditorWindow);FCK.Events.FireEvent("OnSelectionChange");}},AttachStyleStateChange:function(g,h,j){var f=this._Callbacks[g];if(!f){f=this._Callbacks[g]=[];}f.push([h,j]);},CheckSelectionChanges:function(){var t=FCKSelection.GetBoundaryParentElement(true);if(!t){return;}var u=new FCKElementPath(t);var v=this.GetStyles();for(var x in v){var m=this._Callbacks[x];if(m){var n=v[x];var o=n.CheckActive(u);if(o!=(n._LastState||null)){n._LastState=o;for(var r=0;r<m.length;r++){var p=m[r][0];var q=m[r][1];p.call(q||window,x,o);}}}}},CheckStyleInSelection:function(b){return false;},_GetRemoveFormatTagsRegex:function(){var b=new RegExp("^(?:"+FCKConfig.RemoveFormatTags.replace(/,/g,"|")+")$","i");return(this._GetRemoveFormatTagsRegex=function(){return b;})&&b;},RemoveAll:function(){var v=new FCKDomRange(FCK.EditorWindow);v.MoveToSelection();if(v.CheckIsCollapsed()){return;}v.Expand("inline_elements");var x=v.CreateBookmark(true);var y=v.GetBookmarkNode(x,true);var z=v.GetBookmarkNode(x,false);v.Release(true);var n=this._GetRemoveFormatTagsRegex();var o=new FCKElementPath(y);var p=o.Elements;var q;for(var u=1;u<p.length;u++){q=p[u];if(q==o.Block||q==o.BlockLimit){break;}if(n.test(q.nodeName)){FCKDomTools.BreakParent(y,q,v);}}o=new FCKElementPath(z);p=o.Elements;for(var u=1;u<p.length;u++){q=p[u];if(q==o.Block||q==o.BlockLimit){break;}elementName=q.nodeName.toLowerCase();if(n.test(q.nodeName)){FCKDomTools.BreakParent(z,q,v);}}var r=FCKDomTools.GetNextSourceNode(y,true,1);while(r){if(r==z){break;}var t=FCKDomTools.GetNextSourceNode(r,false,1);if(n.test(r.nodeName)){FCKDomTools.RemoveNode(r,true);}else{FCKDomTools.RemoveAttributes(r,FCKConfig.RemoveAttributesArray);}r=t;}v.SelectBookmark(x);FCK.Events.FireEvent("OnSelectionChange");},GetStyle:function(b){return this.GetStyles()[b];},GetStyles:function(){var b=this._GetStyles;if(!b){b=this._GetStyles=FCKTools.Merge(this._LoadStylesCore(),this._LoadStylesCustom(),this._LoadStylesXml());}return b;},CheckHasObjectStyle:function(b){return !!this._ObjectStyles[b];},_LoadStylesCore:function(){var g={};var h=FCKConfig.CoreStyles;for(var j in h){var f=g["_FCK_"+j]=new FCKStyle(h[j]);f.IsCore=true;}return g;},_LoadStylesCustom:function(){var g={};var h=FCKConfig.CustomStyles;if(h){for(var j in h){var f=g[j]=new FCKStyle(h[j]);f.Name=j;}}return g;},_LoadStylesXml:function(){var B={};var C=FCKConfig.StylesXmlPath;if(!C||C.length==0){return B;}var D=new FCKXml();D.LoadUrl(C);var E=FCKXml.TransformToObject(D.SelectSingleNode("Styles"));var F=E.$Style;if(!F){return B;}for(var j=0;j<F.length;j++){var G=F[j];var H=(G.element||"").toLowerCase();if(H.length==0){throw ('The element name is required. Error loading "'+C+'"');}var I={Element:H,Attributes:{},Styles:{},Overrides:[]};var J=G.$Attribute||[];for(var k=0;k<J.length;k++){I.Attributes[J[k].name]=J[k].value;}var K=G.$Style||[];for(k=0;k<K.length;k++){I.Styles[K[k].name]=K[k].value;}var L=G.$Override;if(L){for(k=0;k<L.length;k++){var M=L[k];var N={Element:M.element};var O=M.$Attribute;if(O){N.Attributes={};for(var A=0;A<O.length;A++){var P=O[A].value||null;if(P){var Q=P&&FCKRegexLib.RegExp.exec(P);if(Q){P=new RegExp(Q[1],Q[2]||"");}}N.Attributes[O[A].name]=P;}}I.Overrides.push(N);}}var R=new FCKStyle(I);R.Name=G.name||H;if(R.GetType()==2){this._ObjectStyles[H]=true;}B[R.Name]=R;}return B;}};var FCKListHandler={OutdentListItem:function(C){var D=C.parentNode;if(D.tagName.toUpperCase().Equals("UL","OL")){var E=FCKTools.GetElementDocument(C);var F=new FCKDocumentFragment(E);var q=F.RootNode;var r=false;var t=FCKDomTools.GetFirstChild(C,["UL","OL"]);if(t){r=true;var u;while((u=t.firstChild)){q.appendChild(t.removeChild(u));}FCKDomTools.RemoveNode(t);}var v;var x=false;while((v=C.nextSibling)){if(!r&&v.nodeType==1&&v.nodeName.toUpperCase()=="LI"){x=r=true;}q.appendChild(v.parentNode.removeChild(v));if(!x&&v.nodeType==1&&v.nodeName.toUpperCase().Equals("UL","OL")){FCKDomTools.RemoveNode(v,true);}}var y=D.parentNode.tagName.toUpperCase();var z=(y=="LI");if(z||y.Equals("UL","OL")){if(r){var t=D.cloneNode(false);F.AppendTo(t);C.appendChild(t);}else{if(z){F.InsertAfterNode(D.parentNode);}else{F.InsertAfterNode(D);}}if(z){FCKDomTools.InsertAfterNode(D.parentNode,D.removeChild(C));}else{FCKDomTools.InsertAfterNode(D,D.removeChild(C));}}else{if(r){var A=D.cloneNode(false);F.AppendTo(A);FCKDomTools.InsertAfterNode(D,A);}var B=E.createElement(FCKConfig.EnterMode=="p"?"p":"div");FCKDomTools.MoveChildren(D.removeChild(C),B);FCKDomTools.InsertAfterNode(D,B);if(FCKConfig.EnterMode=="br"){if(FCKBrowserInfo.IsGecko){B.parentNode.insertBefore(FCKTools.CreateBogusBR(E),B);}else{FCKDomTools.InsertAfterNode(B,FCKTools.CreateBogusBR(E));}FCKDomTools.RemoveNode(B,true);}}if(this.CheckEmptyList(D)){FCKDomTools.RemoveNode(D,true);}}},CheckEmptyList:function(b){return(FCKDomTools.GetFirstChild(b,"LI")==null);},CheckListHasContents:function(d){var c=d.firstChild;while(c){switch(c.nodeType){case 1:if(!c.nodeName.IEquals("UL","LI")){return true;}break;case 3:if(c.nodeValue.Trim().length>0){return true;}}c=c.nextSibling;}return false;}};var FCKElementPath=function(j){var k=null;var l=null;var m=[];var n=j;while(n){if(n.nodeType==1){if(!this.LastElement){this.LastElement=n;}var h=n.nodeName.toLowerCase();if(FCKBrowserInfo.IsIE&&n.scopeName!="HTML"){h=n.scopeName.toLowerCase()+":"+h;}if(!l){if(!k&&FCKListsLib.PathBlockElements[h]!=null){k=n;}if(FCKListsLib.PathBlockLimitElements[h]!=null){if(!k&&h=="div"&&!FCKElementPath._CheckHasBlock(n)){k=n;}else{l=n;}}}m.push(n);if(h=="body"){break;}}n=n.parentNode;}this.Block=k;this.BlockLimit=l;this.Elements=m;};FCKElementPath._CheckHasBlock=function(h){var j=h.childNodes;for(var g=0,l=j.length;g<l;g++){var k=j[g];if(k.nodeType==1&&FCKListsLib.BlockElements[k.nodeName.toLowerCase()]){return true;}}return false;};var FCKDomRange=function(b){this.Window=b;this._Cache={};};FCKDomRange.prototype={_UpdateElementInfo:function(){var h=this._Range;if(!h){this.Release(true);}else{var j=h.startContainer;var k=new FCKElementPath(j);this.StartNode=j.nodeType==3?j:j.childNodes[h.startOffset];this.StartContainer=j;this.StartBlock=k.Block;this.StartBlockLimit=k.BlockLimit;if(h.collapsed){this.EndNode=this.StartNode;this.EndContainer=this.StartContainer;this.EndBlock=this.StartBlock;this.EndBlockLimit=this.StartBlockLimit;}else{var l=h.endContainer;if(j!=l){k=new FCKElementPath(l);}var g=l;if(h.endOffset==0){while(g&&!g.previousSibling){g=g.parentNode;}if(g){g=g.previousSibling;}}else{if(g.nodeType==1){g=g.childNodes[h.endOffset-1];}}this.EndNode=g;this.EndContainer=l;this.EndBlock=k.Block;this.EndBlockLimit=k.BlockLimit;}}this._Cache={};},CreateRange:function(){return new FCKW3CRange(this.Window.document);},DeleteContents:function(){if(this._Range){this._Range.deleteContents();this._UpdateElementInfo();}},ExtractContents:function(){if(this._Range){var b=this._Range.extractContents();this._UpdateElementInfo();return b;}return null;},CheckIsCollapsed:function(){if(this._Range){return this._Range.collapsed;}return false;},Collapse:function(b){if(this._Range){this._Range.collapse(b);}this._UpdateElementInfo();},Clone:function(){var b=FCKTools.CloneObject(this);if(this._Range){b._Range=this._Range.cloneRange();}return b;},MoveToNodeContents:function(b){if(!this._Range){this._Range=this.CreateRange();}this._Range.selectNodeContents(b);this._UpdateElementInfo();},MoveToElementStart:function(b){this.SetStart(b,1);this.SetEnd(b,1);},MoveToElementEditStart:function(d){var c;while(d&&d.nodeType==1){if(FCKDomTools.CheckIsEditable(d)){c=d;}else{if(c){break;}}d=d.firstChild;}if(c){this.MoveToElementStart(c);}},InsertNode:function(b){if(this._Range){this._Range.insertNode(b);}},CheckIsEmpty:function(){if(this.CheckIsCollapsed()){return true;}var b=this.Window.document.createElement("div");this._Range.cloneContents().AppendTo(b);FCKDomTools.TrimNode(b);return(b.innerHTML.length==0);},CheckStartOfBlock:function(){var k=this._Cache;var l=k.IsStartOfBlock;if(l!=undefined){return l;}var m=this.StartBlock||this.StartBlockLimit;var n=this._Range.startContainer;var o=this._Range.startOffset;var p;if(o>0){if(n.nodeType==3){var j=n.nodeValue.substr(0,o).Trim();if(j.length!=0){return k.IsStartOfBlock=false;}}else{p=n.childNodes[o-1];}}if(!p){p=FCKDomTools.GetPreviousSourceNode(n,true,null,m);}while(p){switch(p.nodeType){case 1:if(!FCKListsLib.InlineChildReqElements[p.nodeName.toLowerCase()]){return k.IsStartOfBlock=false;}break;case 3:if(p.nodeValue.Trim().length>0){return k.IsStartOfBlock=false;}}p=FCKDomTools.GetPreviousSourceNode(p,false,null,m);}return k.IsStartOfBlock=true;},CheckEndOfBlock:function(q){var r=this._Cache.IsEndOfBlock;if(r!=undefined){return r;}var t=this.EndBlock||this.EndBlockLimit;var u=this._Range.endContainer;var l=this._Range.endOffset;var m;if(u.nodeType==3){var n=u.nodeValue;if(l<n.length){n=n.substr(l);if(n.Trim().length!=0){return this._Cache.IsEndOfBlock=false;}}}else{m=u.childNodes[l];}if(!m){m=FCKDomTools.GetNextSourceNode(u,true,null,t);}var o=false;while(m){switch(m.nodeType){case 1:var p=m.nodeName.toLowerCase();if(FCKListsLib.InlineChildReqElements[p]){break;}if(p=="br"&&!o){o=true;break;}return this._Cache.IsEndOfBlock=false;case 3:if(m.nodeValue.Trim().length>0){return this._Cache.IsEndOfBlock=false;}}m=FCKDomTools.GetNextSourceNode(m,false,null,t);}if(q){this.Select();}return this._Cache.IsEndOfBlock=true;},CreateBookmark:function(j){var k={StartId:(new Date()).valueOf()+Math.floor(Math.random()*1000)+"S",EndId:(new Date()).valueOf()+Math.floor(Math.random()*1000)+"E"};var l=this.Window.document;var m;var n;var h;if(!this.CheckIsCollapsed()){n=l.createElement("span");n.style.display="none";n.id=k.EndId;n.setAttribute("_fck_bookmark",true);n.innerHTML="&nbsp;";h=this.Clone();h.Collapse(false);h.InsertNode(n);}m=l.createElement("span");m.style.display="none";m.id=k.StartId;m.setAttribute("_fck_bookmark",true);m.innerHTML="&nbsp;";h=this.Clone();h.Collapse(true);h.InsertNode(m);if(j){k.StartNode=m;k.EndNode=n;}if(n){this.SetStart(m,4);this.SetEnd(n,3);}else{this.MoveToPosition(m,4);}return k;},GetBookmarkNode:function(f,g){var d=this.Window.document;if(g){return f.StartNode||d.getElementById(f.StartId);}else{return f.EndNode||d.getElementById(f.EndId);}},MoveToBookmark:function(g,h){var j=this.GetBookmarkNode(g,true);var f=this.GetBookmarkNode(g,false);this.SetStart(j,3);if(!h){FCKDomTools.RemoveNode(j);}if(f){this.SetEnd(f,3);if(!h){FCKDomTools.RemoveNode(f);}}else{this.Collapse(true);}this._UpdateElementInfo();},CreateBookmark2:function(){if(!this._Range){return{"Start":0,"End":0};}var k={"Start":[this._Range.startOffset],"End":[this._Range.endOffset]};var l=this._Range.startContainer.previousSibling;var m=this._Range.endContainer.previousSibling;var n=this._Range.startContainer;var o=this._Range.endContainer;while(l&&l.nodeType==3&&n.nodeType==3){k.Start[0]+=l.length;n=l;l=l.previousSibling;}while(m&&m.nodeType==3&&o.nodeType==3){k.End[0]+=m.length;o=m;m=m.previousSibling;}if(n.nodeType==1&&n.childNodes[k.Start[0]]&&n.childNodes[k.Start[0]].nodeType==3){var p=n.childNodes[k.Start[0]];var j=0;while(p.previousSibling&&p.previousSibling.nodeType==3){p=p.previousSibling;j+=p.length;}n=p;k.Start[0]=j;}if(o.nodeType==1&&o.childNodes[k.End[0]]&&o.childNodes[k.End[0]].nodeType==3){var p=o.childNodes[k.End[0]];var j=0;while(p.previousSibling&&p.previousSibling.nodeType==3){p=p.previousSibling;j+=p.length;}o=p;k.End[0]=j;}k.Start=FCKDomTools.GetNodeAddress(n,true).concat(k.Start);k.End=FCKDomTools.GetNodeAddress(o,true).concat(k.End);return k;},MoveToBookmark2:function(h){var j=FCKDomTools.GetNodeFromAddress(this.Window.document,h.Start.slice(0,-1),true);var k=FCKDomTools.GetNodeFromAddress(this.Window.document,h.End.slice(0,-1),true);this.Release(true);this._Range=new FCKW3CRange(this.Window.document);var l=h.Start[h.Start.length-1];var g=h.End[h.End.length-1];while(j.nodeType==3&&l>j.length){if(!j.nextSibling||j.nextSibling.nodeType!=3){break;}l-=j.length;j=j.nextSibling;}while(k.nodeType==3&&g>k.length){if(!k.nextSibling||k.nextSibling.nodeType!=3){break;}g-=k.length;k=k.nextSibling;}this._Range.setStart(j,l);this._Range.setEnd(k,g);this._UpdateElementInfo();},MoveToPosition:function(d,c){this.SetStart(d,c);this.Collapse(true);},SetStart:function(g,h,j){var f=this._Range;if(!f){f=this._Range=this.CreateRange();}switch(h){case 1:f.setStart(g,0);break;case 2:f.setStart(g,g.childNodes.length);break;case 3:f.setStartBefore(g);break;case 4:f.setStartAfter(g);}if(!j){this._UpdateElementInfo();}},SetEnd:function(g,h,j){var f=this._Range;if(!f){f=this._Range=this.CreateRange();}switch(h){case 1:f.setEnd(g,0);break;case 2:f.setEnd(g,g.childNodes.length);break;case 3:f.setEndBefore(g);break;case 4:f.setEndAfter(g);}if(!j){this._UpdateElementInfo();}},Expand:function(j){var k,h;switch(j){case"inline_elements":if(this._Range.startOffset==0){k=this._Range.startContainer;if(k.nodeType!=1){k=k.previousSibling?null:k.parentNode;}if(k){while(FCKListsLib.InlineNonEmptyElements[k.nodeName.toLowerCase()]){this._Range.setStartBefore(k);if(k!=k.parentNode.firstChild){break;}k=k.parentNode;}}}k=this._Range.endContainer;var l=this._Range.endOffset;if((k.nodeType==3&&l>=k.nodeValue.length)||(k.nodeType==1&&l>=k.childNodes.length)||(k.nodeType!=1&&k.nodeType!=3)){if(k.nodeType!=1){k=k.nextSibling?null:k.parentNode;}if(k){while(FCKListsLib.InlineNonEmptyElements[k.nodeName.toLowerCase()]){this._Range.setEndAfter(k);if(k!=k.parentNode.lastChild){break;}k=k.parentNode;}}}break;case"block_contents":case"list_contents":var m=FCKListsLib.BlockBoundaries;if(j=="list_contents"||FCKConfig.EnterMode=="br"){m=FCKListsLib.ListBoundaries;}if(this.StartBlock&&FCKConfig.EnterMode!="br"&&j=="block_contents"){this.SetStart(this.StartBlock,1);}else{k=this._Range.startContainer;if(k.nodeType==1){var n=k.childNodes[this._Range.startOffset];if(n){k=FCKDomTools.GetPreviousSourceNode(n,true);}else{k=k.lastChild||k;}}while(k&&(k.nodeType!=1||(k!=this.StartBlockLimit&&!m[k.nodeName.toLowerCase()]))){this._Range.setStartBefore(k);k=k.previousSibling||k.parentNode;}}if(this.EndBlock&&FCKConfig.EnterMode!="br"&&j=="block_contents"&&this.EndBlock.nodeName.toLowerCase()!="li"){this.SetEnd(this.EndBlock,2);}else{k=this._Range.endContainer;if(k.nodeType==1){k=k.childNodes[this._Range.endOffset]||k.lastChild;}while(k&&(k.nodeType!=1||(k!=this.StartBlockLimit&&!m[k.nodeName.toLowerCase()]))){this._Range.setEndAfter(k);k=k.nextSibling||k.parentNode;}if(k&&k.nodeName.toLowerCase()=="br"){this._Range.setEndAfter(k);}}this._UpdateElementInfo();}},SplitBlock:function(l){var m=l||FCKConfig.EnterMode;if(!this._Range){this.MoveToSelection();}if(this.StartBlockLimit==this.EndBlockLimit){var n=this.StartBlock;var o=this.EndBlock;var p=null;if(m!="br"){if(!n){n=this.FixBlock(true,m);o=this.EndBlock;}if(!o){o=this.FixBlock(false,m);}}var q=(n!=null&&this.CheckStartOfBlock());var r=(o!=null&&this.CheckEndOfBlock());if(!this.CheckIsEmpty()){this.DeleteContents();}if(n&&o&&n==o){if(r){p=new FCKElementPath(this.StartContainer);this.MoveToPosition(o,4);o=null;}else{if(q){p=new FCKElementPath(this.StartContainer);this.MoveToPosition(n,3);n=null;}else{this.SetEnd(n,2);var k=this.ExtractContents();o=n.cloneNode(false);o.removeAttribute("id",false);k.AppendTo(o);FCKDomTools.InsertAfterNode(n,o);this.MoveToPosition(n,4);if(FCKBrowserInfo.IsGecko&&!n.nodeName.IEquals(["ul","ol"])){FCKTools.AppendBogusBr(n);}}}}return{PreviousBlock:n,NextBlock:o,WasStartOfBlock:q,WasEndOfBlock:r,ElementPath:p};}return null;},FixBlock:function(g,h){var j=this.CreateBookmark();this.Collapse(g);this.Expand("block_contents");var f=this.Window.document.createElement(h);this.ExtractContents().AppendTo(f);FCKDomTools.TrimNode(f);if(FCKDomTools.CheckIsEmptyElement(f,function(a){return a.getAttribute("_fck_bookmark")!="true";})&&FCKBrowserInfo.IsGeckoLike){FCKTools.AppendBogusBr(f);}this.InsertNode(f);this.MoveToBookmark(j);return f;},Release:function(b){if(!b){this.Window=null;}this.StartNode=null;this.StartContainer=null;this.StartBlock=null;this.StartBlockLimit=null;this.EndNode=null;this.EndContainer=null;this.EndBlock=null;this.EndBlockLimit=null;this._Range=null;this._Cache=null;},CheckHasRange:function(){return !!this._Range;},GetTouchedStartNode:function(){var d=this._Range;var c=d.startContainer;if(d.collapsed||c.nodeType!=1){return c;}return c.childNodes[d.startOffset]||c;},GetTouchedEndNode:function(){var d=this._Range;var c=d.endContainer;if(d.collapsed||c.nodeType!=1){return c;}return c.childNodes[d.endOffset-1]||c;}};FCKDomRange.prototype.MoveToSelection=function(){this.Release(true);this._Range=new FCKW3CRange(this.Window.document);var g=this.Window.document.selection;if(g.type!="Control"){var h=this._GetSelectionMarkerTag(true);var j=this._GetSelectionMarkerTag(false);if(!h&&!j){this._Range.setStart(this.Window.document.body,0);this._UpdateElementInfo();return;}this._Range.setStart(h.parentNode,FCKDomTools.GetIndexOf(h));h.parentNode.removeChild(h);this._Range.setEnd(j.parentNode,FCKDomTools.GetIndexOf(j));j.parentNode.removeChild(j);this._UpdateElementInfo();}else{var f=g.createRange().item(0);if(f){this._Range.setStartBefore(f);this._Range.setEndAfter(f);this._UpdateElementInfo();}}};FCKDomRange.prototype.Select=function(b){if(this._Range){this.SelectBookmark(this.CreateBookmark(true),b);}};FCKDomRange.prototype.SelectBookmark=function(q,r){var t=this.CheckIsCollapsed();var u;var l;var m=this.GetBookmarkNode(q,true);if(!m){return;}var n;if(!t){n=this.GetBookmarkNode(q,false);}var o=this.Window.document.body.createTextRange();o.moveToElementText(m);o.moveStart("character",1);if(n){var p=this.Window.document.body.createTextRange();p.moveToElementText(n);o.setEndPoint("EndToEnd",p);o.moveEnd("character",-1);}else{u=r||!m.previousSibling||m.previousSibling.nodeName.toLowerCase()=="br";l=this.Window.document.createElement("span");l.innerHTML="&#65279;";m.parentNode.insertBefore(l,m);if(u){m.parentNode.insertBefore(this.Window.document.createTextNode("\ufeff"),m);}}if(!this._Range){this._Range=this.CreateRange();}this._Range.setStartBefore(m);m.parentNode.removeChild(m);if(t){if(u){o.moveStart("character",-1);o.select();this.Window.document.selection.clear();}else{o.select();}FCKDomTools.RemoveNode(l);}else{this._Range.setEndBefore(n);n.parentNode.removeChild(n);o.select();}};FCKDomRange.prototype._GetSelectionMarkerTag=function(j){var k=this.Window.document;var l=k.selection;var m;try{m=l.createRange();}catch(n){return null;}if(m.parentElement().document!=k){return null;}m.collapse(j===true);var h="fck_dom_range_temp_"+(new Date()).valueOf()+"_"+Math.floor(Math.random()*1000);m.pasteHTML('<span id="'+h+'"></span>');return k.getElementById(h);};var FCKDomRangeIterator=function(b){this.Range=b;this.ForceBrBreak=false;this.EnforceRealBlocks=false;};FCKDomRangeIterator.CreateFromSelection=function(d){var c=new FCKDomRange(d);c.MoveToSelection();return new FCKDomRangeIterator(c);};FCKDomRangeIterator.prototype={GetNextParagraph:function(){var G;var H;var I;var J;var t;var u=this.ForceBrBreak?FCKListsLib.ListBoundaries:FCKListsLib.BlockBoundaries;if(!this._LastNode){var H=this.Range.Clone();H.Expand(this.ForceBrBreak?"list_contents":"block_contents");this._NextNode=H.GetTouchedStartNode();this._LastNode=H.GetTouchedEndNode();H=null;}var v=this._NextNode;var x=this._LastNode;this._NextNode=null;while(v){var y=false;var z=(v.nodeType!=1);var A=false;if(!z){var B=v.nodeName.toLowerCase();if(u[B]&&(!FCKBrowserInfo.IsIE||v.scopeName=="HTML")){if(B=="br"){z=true;}else{if(!H&&v.childNodes.length==0&&B!="hr"){G=v;I=v==x;break;}}if(H){H.SetEnd(v,3,true);if(B!="br"){this._NextNode=FCKDomTools.GetNextSourceNode(v,true,null,x)||v;}}y=true;}else{if(v.firstChild){if(!H){H=new FCKDomRange(this.Range.Window);H.SetStart(v,3,true);}v=v.firstChild;continue;}z=true;}}else{if(v.nodeType==3){if(/^[\r\n\t ]+$/.test(v.nodeValue)){z=false;}}}if(z&&!H){H=new FCKDomRange(this.Range.Window);H.SetStart(v,3,true);}I=((!y||z)&&v==x);if(H&&!y){while(!v.nextSibling&&!I){var C=v.parentNode;if(u[C.nodeName.toLowerCase()]){y=true;I=I||(C==x);break;}v=C;z=true;I=(v==x);A=true;}}if(z){H.SetEnd(v,4,true);}if((y||I)&&H){H._UpdateElementInfo();if(H.StartNode==H.EndNode&&H.StartNode.parentNode==H.StartBlockLimit&&H.StartNode.getAttribute&&H.StartNode.getAttribute("_fck_bookmark")){H=null;}else{break;}}if(I){break;}v=FCKDomTools.GetNextSourceNode(v,A,null,x);}if(!G){if(!H){this._NextNode=null;return null;}G=H.StartBlock;if(!G&&!this.EnforceRealBlocks&&H.StartBlockLimit.nodeName.IEquals("DIV","TH","TD")&&H.CheckStartOfBlock()&&H.CheckEndOfBlock()){G=H.StartBlockLimit;}else{if(!G||(this.EnforceRealBlocks&&G.nodeName.toLowerCase()=="li")){G=this.Range.Window.document.createElement(FCKConfig.EnterMode=="p"?"p":"div");H.ExtractContents().AppendTo(G);FCKDomTools.TrimNode(G);H.InsertNode(G);J=true;t=true;}else{if(G.nodeName.toLowerCase()!="li"){if(!H.CheckStartOfBlock()||!H.CheckEndOfBlock()){G=G.cloneNode(false);H.ExtractContents().AppendTo(G);FCKDomTools.TrimNode(G);var D=H.SplitBlock();J=!D.WasStartOfBlock;t=!D.WasEndOfBlock;H.InsertNode(G);}}else{if(!I){this._NextNode=G==x?null:FCKDomTools.GetNextSourceNode(H.EndNode,true,null,x);return G;}}}}}if(J){var E=G.previousSibling;if(E&&E.nodeType==1){if(E.nodeName.toLowerCase()=="br"){E.parentNode.removeChild(E);}else{if(E.lastChild&&E.lastChild.nodeName.IEquals("br")){E.removeChild(E.lastChild);}}}}if(t){var F=G.lastChild;if(F&&F.nodeType==1&&F.nodeName.toLowerCase()=="br"){G.removeChild(F);}}if(!this._NextNode){this._NextNode=(I||G==x)?null:FCKDomTools.GetNextSourceNode(G,true,null,x);}return G;}};var FCKDocumentFragment=function(b){this._Document=b;this.RootNode=b.createElement("div");};FCKDocumentFragment.prototype={AppendTo:function(b){FCKDomTools.MoveChildren(this.RootNode,b);},AppendHtml:function(d){var c=this._Document.createElement("div");c.innerHTML=d;FCKDomTools.MoveChildren(c,this.RootNode);},InsertAfterNode:function(f){var g=this.RootNode;var d;while((d=g.lastChild)){FCKDomTools.InsertAfterNode(f,g.removeChild(d));}}};var FCKW3CRange=function(b){this._Document=b;this.startContainer=null;this.startOffset=null;this.endContainer=null;this.endOffset=null;this.collapsed=true;};FCKW3CRange.CreateRange=function(b){return new FCKW3CRange(b);};FCKW3CRange.CreateFromRange=function(f,g){var d=FCKW3CRange.CreateRange(f);d.setStart(g.startContainer,g.startOffset);d.setEnd(g.endContainer,g.endOffset);return d;};FCKW3CRange.prototype={_UpdateCollapsed:function(){this.collapsed=(this.startContainer==this.endContainer&&this.startOffset==this.endOffset);},setStart:function(d,c){this.startContainer=d;this.startOffset=c;if(!this.endContainer){this.endContainer=d;this.endOffset=c;}this._UpdateCollapsed();},setEnd:function(d,c){this.endContainer=d;this.endOffset=c;if(!this.startContainer){this.startContainer=d;this.startOffset=c;}this._UpdateCollapsed();},setStartAfter:function(b){this.setStart(b.parentNode,FCKDomTools.GetIndexOf(b)+1);},setStartBefore:function(b){this.setStart(b.parentNode,FCKDomTools.GetIndexOf(b));},setEndAfter:function(b){this.setEnd(b.parentNode,FCKDomTools.GetIndexOf(b)+1);},setEndBefore:function(b){this.setEnd(b.parentNode,FCKDomTools.GetIndexOf(b));},collapse:function(b){if(b){this.endContainer=this.startContainer;this.endOffset=this.startOffset;}else{this.startContainer=this.endContainer;this.startOffset=this.endOffset;}this.collapsed=true;},selectNodeContents:function(b){this.setStart(b,0);this.setEnd(b,b.nodeType==3?b.data.length:b.childNodes.length);},insertNode:function(f){var g=this.startContainer;var d=this.startOffset;if(g.nodeType==3){g.splitText(d);if(g==this.endContainer){this.setEnd(g.nextSibling,this.endOffset-this.startOffset);}FCKDomTools.InsertAfterNode(g,f);return;}else{g.insertBefore(f,g.childNodes[d]||null);if(g==this.endContainer){this.endOffset++;this.collapsed=false;}}},deleteContents:function(){if(this.collapsed){return;}this._ExecContentsAction(0);},extractContents:function(){var b=new FCKDocumentFragment(this._Document);if(!this.collapsed){this._ExecContentsAction(1,b);}return b;},cloneContents:function(){var b=new FCKDocumentFragment(this._Document);if(!this.collapsed){this._ExecContentsAction(2,b);}return b;},_ExecContentsAction:function(D,E){var F=this.startContainer;var G=this.endContainer;var I=this.startOffset;var K=this.endOffset;var L=false;var M=false;if(G.nodeType==3){G=G.splitText(K);}else{if(G.childNodes.length>0){if(K>G.childNodes.length-1){G=FCKDomTools.InsertAfterNode(G.lastChild,this._Document.createTextNode(""));M=true;}else{G=G.childNodes[K];}}}if(F.nodeType==3){F.splitText(I);if(F==G){G=F.nextSibling;}}else{if(I==0){F=F.insertBefore(this._Document.createTextNode(""),F.firstChild);L=true;}else{if(I>F.childNodes.length-1){F=F.appendChild(this._Document.createTextNode(""));L=true;}else{F=F.childNodes[I].previousSibling;}}}var N=FCKDomTools.GetParents(F);var R=FCKDomTools.GetParents(G);var A,j,k;for(A=0;A<N.length;A++){j=N[A];k=R[A];if(j!=k){break;}}var S,H,J,X,U;if(E){S=E.RootNode;}for(var B=A;B<N.length;B++){H=N[B];if(S&&H!=F){J=S.appendChild(H.cloneNode(H==F));}X=H.nextSibling;while(X){if(X==R[B]||X==G){break;}U=X.nextSibling;if(D==2){S.appendChild(X.cloneNode(true));}else{X.parentNode.removeChild(X);if(D==1){S.appendChild(X);}}X=U;}if(S){S=J;}}if(E){S=E.RootNode;}for(var C=A;C<R.length;C++){H=R[C];if(D>0&&H!=G){J=S.appendChild(H.cloneNode(H==G));}if(!N[C]||H.parentNode!=N[C].parentNode){X=H.previousSibling;while(X){if(X==N[C]||X==F){break;}U=X.previousSibling;if(D==2){S.insertBefore(X.cloneNode(true),S.firstChild);}else{X.parentNode.removeChild(X);if(D==1){S.insertBefore(X,S.firstChild);}}X=U;}}if(S){S=J;}}if(D==2){var T=this.startContainer;if(T.nodeType==3){T.data+=T.nextSibling.data;T.parentNode.removeChild(T.nextSibling);}var V=this.endContainer;if(V.nodeType==3&&V.nextSibling){V.data+=V.nextSibling.data;V.parentNode.removeChild(V.nextSibling);}}else{if(j&&k&&(F.parentNode!=j.parentNode||G.parentNode!=k.parentNode)){var W=FCKDomTools.GetIndexOf(k);if(L&&k.parentNode==F.parentNode){W--;}this.setStart(k.parentNode,W);}this.collapse(true);}if(L){F.parentNode.removeChild(F);}if(M&&G.parentNode){G.parentNode.removeChild(G);}},cloneRange:function(){return FCKW3CRange.CreateFromRange(this._Document,this);}};var FCKEnterKey=function(h,j,k,l){this.Window=h;this.EnterMode=j||"p";this.ShiftEnterMode=k||"br";var g=new FCKKeystrokeHandler(false);g._EnterKey=this;g.OnKeystroke=FCKEnterKey_OnKeystroke;g.SetKeystrokes([[13,"Enter"],[SHIFT+13,"ShiftEnter"],[8,"Backspace"],[CTRL+8,"CtrlBackspace"],[46,"Delete"]]);this.TabText="";if(l>0||FCKBrowserInfo.IsSafari){while(l--){this.TabText+="\xa0";}g.SetKeystrokes([9,"Tab"]);}g.AttachToElement(h.document);};function FCKEnterKey_OnKeystroke(g,h){var j=this._EnterKey;try{switch(h){case"Enter":return j.DoEnter();break;case"ShiftEnter":return j.DoShiftEnter();break;case"Backspace":return j.DoBackspace();break;case"Delete":return j.DoDelete();break;case"Tab":return j.DoTab();break;case"CtrlBackspace":return j.DoCtrlBackspace();break;}}catch(f){}return false;}FCKEnterKey.prototype.DoEnter=function(h,j){FCKUndo.SaveUndoStep();this._HasShift=(j===true);var k=FCKSelection.GetParentElement();var l=new FCKElementPath(k);var g=h||this.EnterMode;if(g=="br"||l.Block&&l.Block.tagName.toLowerCase()=="pre"){return this._ExecuteEnterBr();}else{return this._ExecuteEnterBlock(g);}};FCKEnterKey.prototype.DoShiftEnter=function(){return this.DoEnter(this.ShiftEnterMode,true);};FCKEnterKey.prototype.DoBackspace=function(){var A=false;var B=new FCKDomRange(this.Window);B.MoveToSelection();if(FCKBrowserInfo.IsIE&&this._CheckIsAllContentsIncluded(B,this.Window.document.body)){this._FixIESelectAllBug(B);return true;}var C=B.CheckIsCollapsed();if(!C){if(FCKBrowserInfo.IsIE&&this.Window.document.selection.type.toLowerCase()=="control"){var D=this.Window.document.selection.createRange();for(var z=D.length-1;z>=0;z--){var p=D.item(z);p.parentNode.removeChild(p);}return true;}return false;}if(FCKBrowserInfo.IsIE){var q=FCKDomTools.GetPreviousSourceElement(B.StartNode,true);if(q&&q.nodeName.toLowerCase()=="br"){var r=B.Clone();r.SetStart(q,4);if(r.CheckIsEmpty()){q.parentNode.removeChild(q);return true;}}}var t=B.StartBlock;var u=B.EndBlock;if(B.StartBlockLimit==B.EndBlockLimit&&t&&u){if(!C){var v=B.CheckEndOfBlock();B.DeleteContents();if(t!=u){B.SetStart(u,1);B.SetEnd(u,1);}B.Select();A=(t==u);}if(B.CheckStartOfBlock()){var x=B.StartBlock;var y=FCKDomTools.GetPreviousSourceElement(x,true,["BODY",B.StartBlockLimit.nodeName],["UL","OL"]);A=this._ExecuteBackspace(B,y,x);}else{if(FCKBrowserInfo.IsGeckoLike){B.Select();}}}B.Release();return A;};FCKEnterKey.prototype.DoCtrlBackspace=function(){FCKUndo.SaveUndoStep();var b=new FCKDomRange(this.Window);b.MoveToSelection();if(FCKBrowserInfo.IsIE&&this._CheckIsAllContentsIncluded(b,this.Window.document.body)){this._FixIESelectAllBug(b);return true;}return false;};FCKEnterKey.prototype._ExecuteBackspace=function(q,r,t){var u=false;if(!r&&t&&t.nodeName.IEquals("LI")&&t.parentNode.parentNode.nodeName.IEquals("LI")){this._OutdentWithSelection(t,q);return true;}if(r&&r.nodeName.IEquals("LI")){var l=FCKDomTools.GetLastChild(r,["UL","OL"]);while(l){r=FCKDomTools.GetLastChild(l,"LI");l=FCKDomTools.GetLastChild(r,["UL","OL"]);}}if(r&&t){if(t.nodeName.IEquals("LI")&&!r.nodeName.IEquals("LI")){this._OutdentWithSelection(t,q);return true;}var m=t.parentNode;var n=r.nodeName.toLowerCase();if(FCKListsLib.EmptyElements[n]!=null||n=="table"){FCKDomTools.RemoveNode(r);u=true;}else{FCKDomTools.RemoveNode(t);while(m.innerHTML.Trim().length==0){var o=m.parentNode;o.removeChild(m);m=o;}FCKDomTools.LTrimNode(t);FCKDomTools.RTrimNode(r);q.SetStart(r,2,true);q.Collapse(true);var p=q.CreateBookmark(true);if(!t.tagName.IEquals(["TABLE"])){FCKDomTools.MoveChildren(t,r);}q.SelectBookmark(p);u=true;}}return u;};FCKEnterKey.prototype.DoDelete=function(){FCKUndo.SaveUndoStep();var j=false;var k=new FCKDomRange(this.Window);k.MoveToSelection();if(FCKBrowserInfo.IsIE&&this._CheckIsAllContentsIncluded(k,this.Window.document.body)){this._FixIESelectAllBug(k);return true;}if(k.CheckIsCollapsed()&&k.CheckEndOfBlock(FCKBrowserInfo.IsGeckoLike)){var l=k.StartBlock;var m=FCKTools.GetElementAscensor(l,"td");var n=FCKDomTools.GetNextSourceElement(l,true,[k.StartBlockLimit.nodeName],["UL","OL","TR"],true);if(m){var h=FCKTools.GetElementAscensor(n,"td");if(h!=m){return true;}}j=this._ExecuteBackspace(k,l,n);}k.Release();return j;};FCKEnterKey.prototype.DoTab=function(){var f=new FCKDomRange(this.Window);f.MoveToSelection();var g=f._Range.startContainer;while(g){if(g.nodeType==1){var d=g.tagName.toLowerCase();if(d=="tr"||d=="td"||d=="th"||d=="tbody"||d=="table"){return false;}else{break;}}g=g.parentNode;}if(this.TabText){f.DeleteContents();f.InsertNode(this.Window.document.createTextNode(this.TabText));f.Collapse(false);f.Select();}return true;};FCKEnterKey.prototype._ExecuteEnterBlock=function(E,F){var G=F||new FCKDomRange(this.Window);var H=G.SplitBlock(E);if(H){var r=H.PreviousBlock;var t=H.NextBlock;var u=H.WasStartOfBlock;var v=H.WasEndOfBlock;if(t){if(t.parentNode.nodeName.IEquals("li")){FCKDomTools.BreakParent(t,t.parentNode);FCKDomTools.MoveNode(t,t.nextSibling,true);}}else{if(r&&r.parentNode.nodeName.IEquals("li")){FCKDomTools.BreakParent(r,r.parentNode);G.MoveToElementEditStart(r.nextSibling);FCKDomTools.MoveNode(r,r.previousSibling);}}if(!u&&!v){if(t.nodeName.IEquals("li")&&t.firstChild&&t.firstChild.nodeName.IEquals(["ul","ol"])){t.insertBefore(FCKTools.GetElementDocument(t).createTextNode("\xa0"),t.firstChild);}if(t){G.MoveToElementEditStart(t);}}else{if(u&&v&&r.tagName.toUpperCase()=="LI"){G.MoveToElementStart(r);this._OutdentWithSelection(r,G);G.Release();return true;}var x;if(r){var y=r.tagName.toUpperCase();if(!this._HasShift&&!(/^H[1-6]$/).test(y)){x=FCKDomTools.CloneElement(r);}}else{if(t){x=FCKDomTools.CloneElement(t);}}if(!x){x=this.Window.document.createElement(E);}var z=H.ElementPath;if(z){for(var D=0,C=z.Elements.length;D<C;D++){var A=z.Elements[D];if(A==z.Block||A==z.BlockLimit){break;}if(FCKListsLib.InlineChildReqElements[A.nodeName.toLowerCase()]){A=FCKDomTools.CloneElement(A);FCKDomTools.MoveChildren(x,A);x.appendChild(A);}}}if(FCKBrowserInfo.IsGeckoLike){FCKTools.AppendBogusBr(x);}G.InsertNode(x);if(FCKBrowserInfo.IsIE){G.MoveToElementEditStart(x);G.Select();}G.MoveToElementEditStart(u&&!v?t:x);}if(FCKBrowserInfo.IsGeckoLike){if(t){var B=this.Window.document.createElement("span");B.innerHTML="&nbsp;";G.InsertNode(B);FCKDomTools.ScrollIntoView(B,false);G.DeleteContents();}else{FCKDomTools.ScrollIntoView(t||x,false);}}G.Select();}G.Release();return true;};FCKEnterKey.prototype._ExecuteEnterBr=function(q){var r=new FCKDomRange(this.Window);r.MoveToSelection();if(r.StartBlockLimit==r.EndBlockLimit){r.DeleteContents();r.MoveToSelection();var t=r.CheckStartOfBlock();var u=r.CheckEndOfBlock();var l=r.StartBlock?r.StartBlock.tagName.toUpperCase():"";var m=this._HasShift;var n=false;if(!m&&l=="LI"){return this._ExecuteEnterBlock(null,r);}if(!m&&u&&(/^H[1-6]$/).test(l)){FCKDomTools.InsertAfterNode(r.StartBlock,this.Window.document.createElement("br"));if(FCKBrowserInfo.IsGecko){FCKDomTools.InsertAfterNode(r.StartBlock,this.Window.document.createTextNode(""));}r.SetStart(r.StartBlock.nextSibling,FCKBrowserInfo.IsIE?3:1);}else{var o;n=l.IEquals("pre");if(n){o=this.Window.document.createTextNode(FCKBrowserInfo.IsIE?"\r":"\n");}else{o=this.Window.document.createElement("br");}r.InsertNode(o);if(FCKBrowserInfo.IsGecko){FCKDomTools.InsertAfterNode(o,this.Window.document.createTextNode(""));}if(u&&FCKBrowserInfo.IsGeckoLike){FCKTools.AppendBogusBr(o.parentNode);}if(FCKBrowserInfo.IsIE){r.SetStart(o,4);}else{r.SetStart(o.nextSibling,1);}if(!FCKBrowserInfo.IsIE){var p=null;if(FCKBrowserInfo.IsOpera){p=this.Window.document.createElement("span");}else{p=this.Window.document.createElement("br");}o.parentNode.insertBefore(p,o.nextSibling);FCKDomTools.ScrollIntoView(p,false);p.parentNode.removeChild(p);}}r.Collapse(true);r.Select(n);}r.Release();return true;};FCKEnterKey.prototype._OutdentWithSelection=function(f,g){var d=g.CreateBookmark();FCKListHandler.OutdentListItem(f);g.MoveToBookmark(d);g.Select();};FCKEnterKey.prototype._CheckIsAllContentsIncluded=function(h,j){var k=false;var l=false;if(h.StartContainer==j||h.StartContainer==j.firstChild){k=(h._Range.startOffset==0);}if(h.EndContainer==j||h.EndContainer==j.lastChild){var g=h.EndContainer.nodeType==3?h.EndContainer.length:h.EndContainer.childNodes.length;l=(h._Range.endOffset==g);}return k&&l;};FCKEnterKey.prototype._FixIESelectAllBug=function(f){var g=this.Window.document;g.body.innerHTML="";var d;if(FCKConfig.EnterMode.IEquals(["div","p"])){d=g.createElement(FCKConfig.EnterMode);g.body.appendChild(d);}else{d=g.body;}f.MoveToNodeContents(d);f.Collapse(true);f.Select();f.Release();};var FCKDocumentProcessor={};FCKDocumentProcessor._Items=[];FCKDocumentProcessor.AppendNew=function(){var b={};this._Items.push(b);return b;};FCKDocumentProcessor.Process=function(g){var h=FCK.IsDirty();var j,f=0;while((j=this._Items[f++])){j.ProcessDocument(g);}if(!h){FCK.ResetIsDirty();}};var FCKDocumentProcessor_CreateFakeImage=function(f,g){var d=FCKTools.GetElementDocument(g).createElement("IMG");d.className=f;d.src=FCKConfig.BasePath+"images/spacer.gif";d.setAttribute("_fckfakelement","true",0);d.setAttribute("_fckrealelement",FCKTempBin.AddElement(g),0);return d;};if(FCKBrowserInfo.IsIE||FCKBrowserInfo.IsOpera){var FCKAnchorsProcessor=FCKDocumentProcessor.AppendNew();FCKAnchorsProcessor.ProcessDocument=function(h){var j=h.getElementsByTagName("A");var k;var g=j.length-1;while(g>=0&&(k=j[g--])){if(k.name.length>0){if(k.innerHTML!==""){if(FCKBrowserInfo.IsIE){k.className+=" FCK__AnchorC";}}else{var l=FCKDocumentProcessor_CreateFakeImage("FCK__Anchor",k.cloneNode(true));l.setAttribute("_fckanchor","true",0);k.parentNode.insertBefore(l,k);k.parentNode.removeChild(k);}}}};}var FCKPageBreaksProcessor=FCKDocumentProcessor.AppendNew();FCKPageBreaksProcessor.ProcessDocument=function(h){var j=h.getElementsByTagName("DIV");var k;var g=j.length-1;while(g>=0&&(k=j[g--])){if(k.style.pageBreakAfter=="always"&&k.childNodes.length==1&&k.childNodes[0].style&&k.childNodes[0].style.display=="none"){var l=FCKDocumentProcessor_CreateFakeImage("FCK__PageBreak",k.cloneNode(true));k.parentNode.insertBefore(l,k);k.parentNode.removeChild(k);}}};var FCKEmbedAndObjectProcessor=(function(){var g=[];var h=function(d){var a=d.cloneNode(true);var b;var c=b=FCKDocumentProcessor_CreateFakeImage("FCK__UnknownObject",a);FCKEmbedAndObjectProcessor.RefreshView(c,d);for(var l=0;l<g.length;l++){b=g[l](d,b)||b;}if(b!=c){FCKTempBin.RemoveElement(c.getAttribute("_fckrealelement"));}d.parentNode.replaceChild(b,d);};var j=function(d,a){var b=a.getElementsByTagName(d);for(var c=b.length-1;c>=0;c--){h(b[c]);}};var f=function(a){j("object",a);j("embed",a);};return FCKTools.Merge(FCKDocumentProcessor.AppendNew(),{ProcessDocument:function(a){if(FCKBrowserInfo.IsGecko){FCKTools.RunFunction(f,this,[a]);}else{f(a);}},RefreshView:function(a,b){if(b.getAttribute("width")>0){a.style.width=FCKTools.ConvertHtmlSizeToStyle(b.getAttribute("width"));}if(b.getAttribute("height")>0){a.style.height=FCKTools.ConvertHtmlSizeToStyle(b.getAttribute("height"));}},AddCustomHandler:function(a){g.push(a);}});})();FCK.GetRealElement=function(d){var c=FCKTempBin.Elements[d.getAttribute("_fckrealelement")];if(d.getAttribute("_fckflash")){if(d.style.width.length>0){c.width=FCKTools.ConvertStyleSizeToHtml(d.style.width);}if(d.style.height.length>0){c.height=FCKTools.ConvertStyleSizeToHtml(d.style.height);}}return c;};if(FCKBrowserInfo.IsIE){FCKDocumentProcessor.AppendNew().ProcessDocument=function(h){var j=h.getElementsByTagName("HR");var k;var g=j.length-1;while(g>=0&&(k=j[g--])){var l=h.createElement("hr");l.mergeAttributes(k,true);FCKDomTools.InsertAfterNode(k,l);k.parentNode.removeChild(k);}};}FCKDocumentProcessor.AppendNew().ProcessDocument=function(h){var j=h.getElementsByTagName("INPUT");var k;var g=j.length-1;while(g>=0&&(k=j[g--])){if(k.type=="hidden"){var l=FCKDocumentProcessor_CreateFakeImage("FCK__InputHidden",k.cloneNode(true));l.setAttribute("_fckinputhidden","true",0);k.parentNode.insertBefore(l,k);k.parentNode.removeChild(k);}}};FCKEmbedAndObjectProcessor.AddCustomHandler(function(d,c){if(!(d.nodeName.IEquals("embed")&&(d.type=="application/x-shockwave-flash"||/\.swf|\.flv($|#|\?)/i.test(d.src)))){return;}c.className="FCK__Flash";c.setAttribute("_fckflash","true",0);});if(FCKBrowserInfo.IsSafari){FCKDocumentProcessor.AppendNew().ProcessDocument=function(f){var g=f.getElementsByClassName?f.getElementsByClassName("Apple-style-span"):Array.prototype.filter.call(f.getElementsByTagName("span"),function(a){return a.className=="Apple-style-span";});for(var d=g.length-1;d>=0;d--){FCKDomTools.RemoveNode(g[d],true);}};}var FCKSelection=FCK.Selection={GetParentBlock:function(){var b=this.GetParentElement();while(b){if(FCKListsLib.BlockBoundaries[b.nodeName.toLowerCase()]){break;}b=b.parentNode;}return b;},ApplyStyle:function(b){FCKStyles.ApplyStyle(new FCKStyle(b));}};FCKSelection.GetType=function(){try{var d=FCKSelection.GetSelection().type;if(d=="Control"||d=="Text"){return d;}if(this.GetSelection().createRange().parentElement){return"Text";}}catch(c){}return"None";};FCKSelection.GetSelectedElement=function(){if(this.GetType()=="Control"){var b=this.GetSelection().createRange();if(b&&b.item){return this.GetSelection().createRange().item(0);}}return null;};FCKSelection.GetParentElement=function(){switch(this.GetType()){case"Control":var b=FCKSelection.GetSelectedElement();return b?b.parentElement:null;case"None":return null;default:return this.GetSelection().createRange().parentElement();}};FCKSelection.GetBoundaryParentElement=function(g){switch(this.GetType()){case"Control":var h=FCKSelection.GetSelectedElement();return h?h.parentElement:null;case"None":return null;default:var j=FCK.EditorDocument;var f=j.selection.createRange();f.collapse(g!==false);var h=f.parentElement();return FCKTools.GetElementDocument(h)==j?h:null;}};FCKSelection.SelectNode=function(f){FCK.Focus();this.GetSelection().empty();var g;try{g=FCK.EditorDocument.body.createControlRange();g.addElement(f);g.select();}catch(d){g=FCK.EditorDocument.body.createTextRange();g.moveToElementText(f);g.select();}};FCKSelection.Collapse=function(d){FCK.Focus();if(this.GetType()=="Text"){var c=this.GetSelection().createRange();c.collapse(d==null||d===true);c.select();}};FCKSelection.IsGridNode=function(){var c;if(this.GetSelection().type=="Control"){c=this.GetSelectedElement();}else{var d=this.GetSelection().createRange();c=d.parentElement();}while(c){if(c.nodeName.IEquals("TABLE")){if(c.getAttribute("isgrid")){return true;}return false;}c=c.parentNode;if(!c){break;}}return false;};FCKSelection.HasAncestorNode=function(f){var g;if(this.GetSelection().type=="Control"){g=this.GetSelectedElement();}else{var d=this.GetSelection().createRange();g=d.parentElement();}while(g){if(g.nodeName.IEquals(f)){return true;}g=g.parentNode;}return false;};FCKSelection.MoveToAncestorNode=function(f){var g,d;if(!FCK.EditorDocument){return null;}if(this.GetSelection().type=="Control"){d=this.GetSelection().createRange();for(i=0;i<d.length;i++){if(d(i).parentNode){g=d(i).parentNode;break;}}}else{d=this.GetSelection().createRange();g=d.parentElement();}while(g&&!g.nodeName.Equals(f)){g=g.parentNode;}return g;};FCKSelection.Delete=function(){var b=this.GetSelection();if(b.type.toLowerCase()!="none"){b.clear();}return b;};FCKSelection.GetSelection=function(){this.Restore();return FCK.EditorDocument.selection;};FCKSelection.Save=function(h){var j=FCK.EditorDocument;if(!j){return;}if(this.locked){return;}this.locked=!!h;var k=j.selection;var l;if(k){try{l=k.createRange();}catch(g){}if(l){if(l.parentElement&&FCKTools.GetElementDocument(l.parentElement())!=j){l=null;}else{if(l.item&&FCKTools.GetElementDocument(l.item(0))!=j){l=null;}}}}this.SelectionData=l;};FCKSelection._GetSelectionDocument=function(d){var c=d.createRange();if(!c){return null;}else{if(c.item){return FCKTools.GetElementDocument(c.item(0));}else{return FCKTools.GetElementDocument(c.parentElement());}}};FCKSelection.Restore=function(){if(this.SelectionData){FCK.IsSelectionChangeLocked=true;try{if(String(this._GetSelectionDocument(FCK.EditorDocument.selection).body.contentEditable)=="true"){FCK.IsSelectionChangeLocked=false;return;}this.SelectionData.select();}catch(b){}FCK.IsSelectionChangeLocked=false;}};FCKSelection.Release=function(){this.locked=false;delete this.SelectionData;};var FCKTableHandler={};FCKTableHandler.InsertRow=function(f){var g=FCKSelection.MoveToAncestorNode("TR");if(!g){return;}var d=g.cloneNode(true);g.parentNode.insertBefore(d,g);FCKTableHandler.ClearRow(f?d:g);};FCKTableHandler.DeleteRows=function(j){if(!j){var k=FCKTableHandler.GetSelectedCells();var l=[];for(var h=0;h<k.length;h++){var m=k[h].parentNode;l[m.rowIndex]=m;}for(var h=l.length;h>=0;h--){if(l[h]){FCKTableHandler.DeleteRows(l[h]);}}return;}var n=FCKTools.GetElementAscensor(j,"TABLE");if(n.rows.length==1){FCKTableHandler.DeleteTable(n);return;}j.parentNode.removeChild(j);};FCKTableHandler.DeleteTable=function(b){if(!b){b=FCKSelection.GetSelectedElement();if(!b||b.tagName!="TABLE"){b=FCKSelection.MoveToAncestorNode("TABLE");}}if(!b){return;}FCKSelection.SelectNode(b);FCKSelection.Collapse();if(b.parentNode.childNodes.length==1){b.parentNode.parentNode.removeChild(b.parentNode);}else{b.parentNode.removeChild(b);}};FCKTableHandler.InsertColumn=function(l){var m=null;var n=this.GetSelectedCells();if(n&&n.length){m=n[l?0:(n.length-1)];}if(!m){return;}var o=FCKTools.GetElementAscensor(m,"TABLE");var p=m.cellIndex;for(var k=0;k<o.rows.length;k++){var q=o.rows[k];if(q.cells.length<(p+1)){continue;}m=q.cells[p].cloneNode(false);if(FCKBrowserInfo.IsGeckoLike){FCKTools.AppendBogusBr(m);}var r=q.cells[p];q.insertBefore(m,(l?r:r.nextSibling));}};FCKTableHandler.DeleteColumns=function(j){if(!j){var k=FCKTableHandler.GetSelectedCells();for(var h=k.length;h>=0;h--){if(k[h]){FCKTableHandler.DeleteColumns(k[h]);}}return;}if(!j){return;}var l=FCKTools.GetElementAscensor(j,"TABLE");var m=j.cellIndex;for(var h=l.rows.length-1;h>=0;h--){var n=l.rows[h];if(m==0&&n.cells.length==1){FCKTableHandler.DeleteRows(n);continue;}if(n.cells[m]){n.removeChild(n.cells[m]);}}};FCKTableHandler.InsertCell=function(h,j){var k=null;var l=this.GetSelectedCells();if(l&&l.length){k=l[j?0:(l.length-1)];}if(!k){return null;}var g=FCK.EditorDocument.createElement("TD");g.setAttribute("class","td-info");if(FCKBrowserInfo.IsGeckoLike){FCKTools.AppendBogusBr(g);}if(!j&&k.cellIndex==k.parentNode.cells.length-1){k.parentNode.appendChild(g);}else{k.parentNode.insertBefore(g,j?k:k.nextSibling);}return g;};FCKTableHandler.DeleteCell=function(b){if(b.parentNode.cells.length==1){FCKTableHandler.DeleteRows(b.parentNode);return;}b.parentNode.removeChild(b);};FCKTableHandler.DeleteCells=function(){var d=FCKTableHandler.GetSelectedCells();for(var c=d.length-1;c>=0;c--){FCKTableHandler.DeleteCell(d[c]);}};FCKTableHandler._MarkCells=function(f,g){for(var d=0;d<f.length;d++){f[d][g]=true;}};FCKTableHandler._UnmarkCells=function(f,g){for(var d=0;d<f.length;d++){FCKDomTools.ClearElementJSProperty(f[d],g);}};FCKTableHandler._ReplaceCellsByMarker=function(h,j,k){for(var l=0;l<h.length;l++){for(var g=0;g<h[l].length;g++){if(h[l][g][j]){h[l][g]=k;}}}};FCKTableHandler._GetMarkerGeometry=function(q,r,t,u){var l=0;var m=0;var n=0;var o=0;for(var p=t;q[r][p]&&q[r][p][u];p++){l++;}for(var p=t-1;q[r][p]&&q[r][p][u];p--){l++;n++;}for(var p=r;q[p]&&q[p][t]&&q[p][t][u];p++){m++;}for(var p=r-1;q[p]&&q[p][t]&&q[p][t][u];p--){m++;o++;}return{"width":l,"height":m,"x":n,"y":o};};FCKTableHandler.CheckIsSelectionRectangular=function(){var q=FCKTableHandler.GetSelectedCells();if(q.length<1){return false;}for(var p=0;p<q.length;p++){if(q[p].parentNode.parentNode!=q[0].parentNode.parentNode){return false;}}this._MarkCells(q,"_CellSelected");var r=this._CreateTableMap(q[0]);var t=q[0].parentNode.rowIndex;var u=this._GetCellIndexSpan(r,t,q[0]);var g=this._GetMarkerGeometry(r,t,u,"_CellSelected");var m=u-g.x;var n=t-g.y;if(g.width>=g.height){for(u=m;u<m+g.width;u++){t=n+(u-m)%g.height;if(!r[t]||!r[t][u]){this._UnmarkCells(q,"_CellSelected");return false;}var o=this._GetMarkerGeometry(r,t,u,"_CellSelected");if(o.width!=g.width||o.height!=g.height){this._UnmarkCells(q,"_CellSelected");return false;}}}else{for(t=n;t<n+g.height;t++){u=m+(t-n)%g.width;if(!r[t]||!r[t][u]){this._UnmarkCells(q,"_CellSelected");return false;}var o=this._GetMarkerGeometry(r,t,u,"_CellSelected");if(o.width!=g.width||o.height!=g.height){this._UnmarkCells(q,"_CellSelected");return false;}}}this._UnmarkCells(q,"_CellSelected");return true;};FCKTableHandler.MergeCells=function(){var C=this.GetSelectedCells();if(C.length<2){return;}var D=C[0];var E=this._CreateTableMap(D);var F=D.parentNode.rowIndex;var j=this._GetCellIndexSpan(E,F,D);this._MarkCells(C,"_SelectedCells");var r=this._GetMarkerGeometry(E,F,j,"_SelectedCells");var t=j-r.x;var u=F-r.y;var v=FCKTools.GetElementDocument(D).createDocumentFragment();for(var A=0;A<r.height;A++){var x=0;for(var B=0;B<r.width;B++){var y=E[u+A][t+B];while(y.childNodes.length>0){var z=y.removeChild(y.firstChild);if(z.nodeType!=1||(z.getAttribute("type",2)!="_moz"&&z.getAttribute("_moz_dirty")!=null)){v.appendChild(z);x++;}}}if(x>0){v.appendChild(FCK.EditorDocument.createElement("br"));}}this._ReplaceCellsByMarker(E,"_SelectedCells",D);this._UnmarkCells(C,"_SelectedCells");this._InstallTableMap(E,D.parentNode.parentNode.parentNode);D.appendChild(v);if(FCKBrowserInfo.IsGeckoLike&&(!D.firstChild)){FCKTools.AppendBogusBr(D);}this._MoveCaretToCell(D,false);};FCKTableHandler.MergeRight=function(){var h=this.GetMergeRightTarget();if(h==null){return;}var j=h.refCell;var k=h.tableMap;var l=h.nextCell;var g=FCK.EditorDocument.createDocumentFragment();while(l&&l.childNodes&&l.childNodes.length>0){g.appendChild(l.removeChild(l.firstChild));}l.parentNode.removeChild(l);j.appendChild(g);this._MarkCells([l],"_Replace");this._ReplaceCellsByMarker(k,"_Replace",j);this._InstallTableMap(k,j.parentNode.parentNode.parentNode);this._MoveCaretToCell(j,false);};FCKTableHandler.MergeDown=function(){var h=this.GetMergeDownTarget();if(h==null){return;}var j=h.refCell;var k=h.tableMap;var l=h.nextCell;var g=FCKTools.GetElementDocument(j).createDocumentFragment();while(l&&l.childNodes&&l.childNodes.length>0){g.appendChild(l.removeChild(l.firstChild));}if(g.firstChild){g.insertBefore(FCK.EditorDocument.createElement("br"),g.firstChild);}j.appendChild(g);this._MarkCells([l],"_Replace");this._ReplaceCellsByMarker(k,"_Replace",j);this._InstallTableMap(k,j.parentNode.parentNode.parentNode);this._MoveCaretToCell(j,false);};FCKTableHandler.HorizontalSplitCell=function(){var E=FCKTableHandler.GetSelectedCells();if(E.length!=1){return;}var F=E[0];var G=this._CreateTableMap(F);var H=F.parentNode.rowIndex;var J=FCKTableHandler._GetCellIndexSpan(G,H,F);var K=isNaN(F.colSpan)?1:F.colSpan;if(K>1){var L=Math.ceil(K/2);var j=FCK.EditorDocument.createElement(F.nodeName);j.setAttribute("class","td-info");if(FCKBrowserInfo.IsGeckoLike){FCKTools.AppendBogusBr(j);}var r=J+L;var x=J+K;var y=isNaN(F.rowSpan)?1:F.rowSpan;for(var I=H;I<H+y;I++){for(var B=r;B<x;B++){G[I][B]=j;}}}else{var z=[];for(var B=0;B<G.length;B++){var A=G[B].slice(0,J);if(G[B].length<=J){z.push(A);continue;}if(G[B][J]==F){A.push(F);var D=FCK.EditorDocument.createElement(F.nodeName);D.setAttribute("class","td-info");A.push(D);if(FCKBrowserInfo.IsGeckoLike){FCKTools.AppendBogusBr(D);}}else{A.push(G[B][J]);A.push(G[B][J]);}for(var C=J+1;C<G[B].length;C++){A.push(G[B][C]);}z.push(A);}G=z;}this._InstallTableMap(G,F.parentNode.parentNode.parentNode);};FCKTableHandler.VerticalSplitCell=function(){var H=FCKTableHandler.GetSelectedCells();if(H.length!=1){return;}var I=H[0];var J=this._CreateTableMap(I);var K=I.parentNode.rowIndex;var L=FCKTableHandler._GetCellIndexSpan(J,K,I);var u=isNaN(I.colSpan)?1:I.colSpan;var v=I.rowSpan;if(isNaN(v)){v=1;}if(v>1){I.rowSpan=Math.ceil(v/2);var x=K+Math.ceil(v/2);var y=J[x];var z=null;for(var G=L+1;G<y.length;G++){if(y[G].parentNode.rowIndex==x){z=y[G];break;}}var A=FCK.EditorDocument.createElement(I.nodeName);A.rowSpan=Math.floor(v/2);if(u>1){A.colSpan=u;}if(FCKBrowserInfo.IsGeckoLike){FCKTools.AppendBogusBr(A);}I.parentNode.parentNode.parentNode.rows[x].insertBefore(A,z);}else{var B=I.parentNode.sectionRowIndex+1;var C=FCK.EditorDocument.createElement("tr");var D=I.parentNode.parentNode;if(D.rows.length>B){D.insertBefore(C,D.rows[B]);}else{D.appendChild(C);}for(var G=0;G<J[K].length;){var E=J[K][G].colSpan;if(isNaN(E)||E<1){E=1;}if(G==L){G+=E;continue;}var F=J[K][G].rowSpan;if(isNaN(F)){F=1;}J[K][G].rowSpan=F+1;G+=E;}var A=FCK.EditorDocument.createElement(I.nodeName);A.setAttribute("class","td-info");if(u>1){A.colSpan=u;}if(FCKBrowserInfo.IsGeckoLike){FCKTools.AppendBogusBr(A);}C.appendChild(A);}};FCKTableHandler._GetCellIndexSpan=function(h,j,l){if(h.length<j+1){return null;}var c=h[j];for(var k=0;k<c.length;k++){if(c[k]==l){return k;}}return null;};FCKTableHandler._GetCellLocation=function(g,h){for(var c=0;c<g.length;c++){for(var j=0;j<g[c].length;j++){if(g[c][j]==h){return[c,j];}}}return null;};FCKTableHandler._CreateTableMap=function(z){var A=(z.nodeName=="TABLE"?z:z.parentNode.parentNode.parentNode);var B=A.rows;var C=-1;var D=[];for(var x=0;x<B.length;x++){C++;if(!D[C]){D[C]=[];}var v=-1;for(var y=0;y<B[x].cells.length;y++){var c=B[x].cells[y];v++;while(D[C][v]){v++;}var j=isNaN(c.colSpan)?1:c.colSpan;var r=isNaN(c.rowSpan)?1:c.rowSpan;for(var t=0;t<r;t++){if(!D[C+t]){D[C+t]=[];}for(var u=0;u<j;u++){D[C+t][v+u]=B[x].cells[y];}}v+=j-1;}}return D;};FCKTableHandler._InstallTableMap=function(l,m){var n=FCKBrowserInfo.IsIE?"_fckrowspan":"rowSpan";for(var q=0;q<l.length;q++){for(var r=0;r<l[q].length;r++){var o=l[q][r];if(o.parentNode){o.parentNode.removeChild(o);}o.colSpan=o[n]=1;}}var p=0;for(var q=0;q<l.length;q++){for(var r=0;r<l[q].length;r++){var o=l[q][r];if(!o){continue;}if(r>p){p=r;}if(o._colScanned===true){continue;}if(l[q][r-1]==o){o.colSpan++;}if(l[q][r+1]!=o){o._colScanned=true;}}}for(var q=0;q<=p;q++){for(var r=0;r<l.length;r++){if(!l[r]){continue;}var o=l[r][q];if(!o||o._rowScanned===true){continue;}if(l[r-1]&&l[r-1][q]==o){o[n]++;}if(!l[r+1]||l[r+1][q]!=o){o._rowScanned=true;}}}for(var q=0;q<l.length;q++){for(var r=0;r<l[q].length;r++){var o=l[q][r];FCKDomTools.ClearElementJSProperty(o,"_colScanned");FCKDomTools.ClearElementJSProperty(o,"_rowScanned");}}for(var q=0;q<l.length;q++){var j=FCK.EditorDocument.createElement("tr");for(var r=0;r<l[q].length;){var o=l[q][r];if(l[q-1]&&l[q-1][r]==o){r+=o.colSpan;continue;}j.appendChild(o);if(n!="rowSpan"){o.rowSpan=o[n];o.removeAttribute(n);}r+=o.colSpan;if(o.colSpan==1){o.removeAttribute("colspan");}if(o.rowSpan==1){o.removeAttribute("rowspan");}}if(FCKBrowserInfo.IsIE){m.rows[q].replaceNode(j);}else{m.rows[q].innerHTML="";FCKDomTools.MoveChildren(j,m.rows[q]);}}};FCKTableHandler._MoveCaretToCell=function(f,g){var d=new FCKDomRange(FCK.EditorWindow);d.MoveToNodeContents(f);d.Collapse(g);d.Select();};FCKTableHandler.ClearRow=function(f){var g=f.cells;for(var d=0;d<g.length;d++){g[d].setAttribute("class","td-info");g[d].innerHTML="";if(FCKBrowserInfo.IsGeckoLike){FCKTools.AppendBogusBr(g[d]);}}};FCKTableHandler.GetMergeRightTarget=function(){var q=this.GetSelectedCells();if(q.length!=1){return null;}var r=q[0];var t=this._CreateTableMap(r);var u=r.parentNode.rowIndex;var l=this._GetCellIndexSpan(t,u,r);var m=l+(isNaN(r.colSpan)?1:r.colSpan);var n=t[u][m];if(!n){return null;}this._MarkCells([r,n],"_SizeTest");var o=this._GetMarkerGeometry(t,u,l,"_SizeTest");var p=this._GetMarkerGeometry(t,u,m,"_SizeTest");this._UnmarkCells([r,n],"_SizeTest");if(o.height!=p.height||o.y!=p.y){return null;}return{"refCell":r,"nextCell":n,"tableMap":t};};FCKTableHandler.GetMergeDownTarget=function(){var q=this.GetSelectedCells();if(q.length!=1){return null;}var r=q[0];var t=this._CreateTableMap(r);var u=r.parentNode.rowIndex;var l=this._GetCellIndexSpan(t,u,r);var m=u+(isNaN(r.rowSpan)?1:r.rowSpan);if(!t[m]){return null;}var n=t[m][l];if(!n){return null;}if(r.parentNode.parentNode!=n.parentNode.parentNode){return null;}this._MarkCells([r,n],"_SizeTest");var o=this._GetMarkerGeometry(t,u,l,"_SizeTest");var p=this._GetMarkerGeometry(t,m,l,"_SizeTest");this._UnmarkCells([r,n],"_SizeTest");if(o.width!=p.width||o.x!=p.x){return null;}return{"refCell":r,"nextCell":n,"tableMap":t};};FCKTableHandler.GetSelectedCells=function(){if(FCKSelection.GetType()=="Control"){var j=FCKSelection.MoveToAncestorNode(["TD","TH"]);return j?[j]:[];}var k=[];var l=FCKSelection.GetSelection().createRange();var m=FCKSelection.GetParentElement();if(m&&m.tagName.Equals("TD","TH")){k[0]=m;}else{m=FCKSelection.MoveToAncestorNode("TABLE");if(m){for(var h=0;h<m.cells.length;h++){var n=FCK.EditorDocument.body.createTextRange();n.moveToElementText(m.cells[h]);if(l.inRange(n)||(l.compareEndPoints("StartToStart",n)>=0&&l.compareEndPoints("StartToEnd",n)<=0)||(l.compareEndPoints("EndToStart",n)>=0&&l.compareEndPoints("EndToEnd",n)<=0)){k[k.length]=m.cells[h];}}}}return k;};var FCKXml=function(){this.Error=false;};FCKXml.GetAttribute=function(g,h,j){var f=g.attributes.getNamedItem(h);return f?f.value:j;};FCKXml.TransformToObject=function(q){if(!q){return null;}var r={};var t=q.attributes;for(var p=0;p<t.length;p++){var u=t[p];r[u.name]=u.value;}var l=q.childNodes;for(p=0;p<l.length;p++){var m=l[p];if(m.nodeType==1){var n="$"+m.nodeName;var o=r[n];if(!o){o=r[n]=[];}o.push(this.TransformToObject(m));}}return r;};FCKXml.prototype={LoadUrl:function(d){this.Error=false;var c=FCKTools.CreateXmlObject("XmlHttp");if(!c){this.Error=true;return;}c.open("GET",d,false);c.send(null);if(c.status==200||c.status==304||(c.status==0&&c.readyState==4)){this.DOMDocument=c.responseXML;if(!this.DOMDocument||this.DOMDocument.firstChild==null){this.DOMDocument=FCKTools.CreateXmlObject("DOMDocument");this.DOMDocument.async=false;this.DOMDocument.resolveExternals=false;this.DOMDocument.loadXML(c.responseText);}}else{this.DOMDocument=null;}if(this.DOMDocument==null||this.DOMDocument.firstChild==null){this.Error=true;if(window.confirm('Error loading "'+d+'"\r\nDo you want to see more info?')){alert('URL requested: "'+d+'"\r\nServer response:\r\nStatus: '+c.status+"\r\nResponse text:\r\n"+c.responseText);}}},SelectNodes:function(d,c){if(this.Error){return[];}if(c){return c.selectNodes(d);}else{return this.DOMDocument.selectNodes(d);}},SelectSingleNode:function(d,c){if(this.Error){return null;}if(c){return c.selectSingleNode(d);}else{return this.DOMDocument.selectSingleNode(d);}}};var FCKNamedCommand=function(b){this.Name=b;};FCKNamedCommand.prototype.Execute=function(){FCK.ExecuteNamedCommand(this.Name);};FCKNamedCommand.prototype.GetState=function(){if(FCK.EditMode!=0){return -1;}return FCK.GetNamedCommandState(this.Name);};var FCKStyleCommand=function(){};FCKStyleCommand.prototype={Name:"Style",Execute:function(d,c){FCKUndo.SaveUndoStep();if(c.Selected){FCK.Styles.RemoveStyle(c.Style);}else{FCK.Styles.ApplyStyle(c.Style);}FCKUndo.SaveUndoStep();FCK.Focus();FCK.Events.FireEvent("OnSelectionChange");},GetState:function(){if(FCK.EditMode!=0||!FCK.EditorDocument){return -1;}if(FCKSelection.GetType()=="Control"){var b=FCKSelection.GetSelectedElement();if(!b||!FCKStyles.CheckHasObjectStyle(b.nodeName.toLowerCase())){return -1;}}return 0;}};var FCKDialogCommand=function(l,m,n,o,p,q,r,k){this.Name=l;this.Title=m;this.Url=n;this.Width=o;this.Height=p;this.CustomValue=k;this.GetStateFunction=q;this.GetStateParam=r;this.Resizable=false;};FCKDialogCommand.prototype.Execute=function(){FCKDialog.OpenDialog("FCKDialog_"+this.Name,this.Title,this.Url,this.Width,this.Height,this.CustomValue,this.Resizable);};FCKDialogCommand.prototype.GetState=function(){if(this.GetStateFunction){return this.GetStateFunction(this.GetStateParam);}else{return FCK.EditMode==0?0:-1;}};var FCKUndefinedCommand=function(){this.Name="Undefined";};FCKUndefinedCommand.prototype.Execute=function(){alert(FCKLang.NotImplemented);};FCKUndefinedCommand.prototype.GetState=function(){return 0;};var FCKFormatBlockCommand=function(){};FCKFormatBlockCommand.prototype={Name:"FormatBlock",Execute:FCKStyleCommand.prototype.Execute,GetState:function(){return FCK.EditorDocument?0:-1;}};var FCKFontNameCommand=function(){};FCKFontNameCommand.prototype={Name:"FontName",Execute:FCKStyleCommand.prototype.Execute,GetState:FCKFormatBlockCommand.prototype.GetState};var FCKFontSizeCommand=function(){};FCKFontSizeCommand.prototype={Name:"FontSize",Execute:FCKStyleCommand.prototype.Execute,GetState:FCKFormatBlockCommand.prototype.GetState};var FCKPreviewCommand=function(){this.Name="Preview";};FCKPreviewCommand.prototype.Execute=function(){FCK.Preview();};FCKPreviewCommand.prototype.GetState=function(){return 0;};var FCKSaveCommand=function(){this.Name="Save";};FCKSaveCommand.prototype.Execute=function(){var d=FCK.GetParentForm();if(typeof(d.onsubmit)=="function"){var c=d.onsubmit();if(c!=null&&c===false){return;}}if(typeof(d.submit)=="function"){d.submit();}else{d.submit.click();}};FCKSaveCommand.prototype.GetState=function(){return 0;};var FCKNewPageCommand=function(){this.Name="NewPage";};FCKNewPageCommand.prototype.Execute=function(){FCKUndo.SaveUndoStep();FCK.SetData("");FCKUndo.Typing=true;FCK.Focus();};FCKNewPageCommand.prototype.GetState=function(){return 0;};var FCKSourceCommand=function(){this.Name="Source";};FCKSourceCommand.prototype.Execute=function(){if(FCKConfig.SourcePopup){var d=FCKConfig.ScreenWidth*0.65;var c=FCKConfig.ScreenHeight*0.65;FCKDialog.OpenDialog("FCKDialog_Source",FCKLang.Source,"dialog/fck_source.html",d,c,null,true);}else{FCK.SwitchEditMode();}};FCKSourceCommand.prototype.GetState=function(){return(FCK.EditMode==0?0:1);};var FCKUndoCommand=function(){this.Name="Undo";};FCKUndoCommand.prototype.Execute=function(){FCKUndo.Undo();};FCKUndoCommand.prototype.GetState=function(){if(FCK.EditMode!=0){return -1;}return(FCKUndo.CheckUndoState()?0:-1);};var FCKRedoCommand=function(){this.Name="Redo";};FCKRedoCommand.prototype.Execute=function(){FCKUndo.Redo();};FCKRedoCommand.prototype.GetState=function(){if(FCK.EditMode!=0){return -1;}return(FCKUndo.CheckRedoState()?0:-1);};var FCKPageBreakCommand=function(){this.Name="PageBreak";};FCKPageBreakCommand.prototype.Execute=function(){FCKUndo.SaveUndoStep();var f=FCK.EditorDocument.createElement("DIV");f.style.pageBreakAfter="always";f.innerHTML='<span style="DISPLAY:none">&nbsp;</span>';var g=FCKDocumentProcessor_CreateFakeImage("FCK__PageBreak",f);var h=new FCKDomRange(FCK.EditorWindow);h.MoveToSelection();var j=h.SplitBlock();h.InsertNode(g);FCK.Events.FireEvent("OnSelectionChange");};FCKPageBreakCommand.prototype.GetState=function(){if(FCK.EditMode!=0){return -1;}return 0;};var FCKUnlinkCommand=function(){this.Name="Unlink";};FCKUnlinkCommand.prototype.Execute=function(){FCKUndo.SaveUndoStep();if(FCKBrowserInfo.IsGeckoLike){var b=FCK.Selection.MoveToAncestorNode("A");if(b){FCKTools.RemoveOuterTags(b);}return;}FCK.ExecuteNamedCommand(this.Name);};FCKUnlinkCommand.prototype.GetState=function(){if(FCK.EditMode!=0){return -1;}var f=FCK.GetNamedCommandState(this.Name);if(f==0&&FCK.EditMode==0){var g=FCKSelection.MoveToAncestorNode("A");var d=(g&&g.name.length>0&&g.href.length==0);if(d){f=-1;}}return f;};var FCKVisitLinkCommand=function(){this.Name="VisitLink";};FCKVisitLinkCommand.prototype={GetState:function(){if(FCK.EditMode!=0){return -1;}var d=FCK.GetNamedCommandState("Unlink");if(d==0){var c=FCKSelection.MoveToAncestorNode("A");if(!c.href){d=-1;}}return d;},Execute:function(){var h=FCKSelection.MoveToAncestorNode("A");var j=h.getAttribute("_fcksavedurl")||h.getAttribute("href",2);if(!/:\/\//.test(j)){var k=FCKConfig.BaseHref;var l=FCK.GetInstanceObject("parent");if(!k){k=l.document.location.href;k=k.substring(0,k.lastIndexOf("/")+1);}if(/^\//.test(j)){try{k=k.match(/^.*:\/\/+[^\/]+/)[0];}catch(g){k=l.document.location.protocol+"://"+l.parent.document.location.host;}}j=k+j;}if(!window.open(j,"_blank")){alert(FCKLang.VisitLinkBlocked);}}};var FCKSelectAllCommand=function(){this.Name="SelectAll";};FCKSelectAllCommand.prototype.Execute=function(){if(FCK.EditMode==0){FCK.ExecuteNamedCommand("SelectAll");}else{var b=FCK.EditingArea.Textarea;if(FCKBrowserInfo.IsIE){b.createTextRange().execCommand("SelectAll");}else{b.selectionStart=0;b.selectionEnd=b.value.length;}b.focus();}};FCKSelectAllCommand.prototype.GetState=function(){if(FCK.EditMode!=0){return -1;}return 0;};var FCKPasteCommand=function(){this.Name="Paste";};FCKPasteCommand.prototype={Execute:function(){if(FCKBrowserInfo.IsIE){FCK.Paste();}else{FCK.ExecuteNamedCommand("Paste");}},GetState:function(){if(FCK.EditMode!=0){return -1;}return FCK.GetNamedCommandState("Paste");}};var FCKRuleCommand=function(){this.Name="Rule";};FCKRuleCommand.prototype={Execute:function(){FCKUndo.SaveUndoStep();FCK.InsertElement("hr");},GetState:function(){if(FCK.EditMode!=0){return -1;}return FCK.GetNamedCommandState("InsertHorizontalRule");}};var FCKCutCopyCommand=function(b){this.Name=b?"Cut":"Copy";};FCKCutCopyCommand.prototype={Execute:function(){var g=false;if(FCKBrowserInfo.IsIE){var h=function(){g=true;};var j="on"+this.Name.toLowerCase();FCK.EditorDocument.body.attachEvent(j,h);FCK.ExecuteNamedCommand(this.Name);FCK.EditorDocument.body.detachEvent(j,h);}else{try{FCK.ExecuteNamedCommand(this.Name);g=true;}catch(f){}}if(!g){alert(FCKLang["PasteError"+this.Name]);}},GetState:function(){return FCK.EditMode!=0?-1:FCK.GetNamedCommandState("Cut");}};var FCKAnchorDeleteCommand=function(){this.Name="AnchorDelete";};FCKAnchorDeleteCommand.prototype={Execute:function(){if(FCK.Selection.GetType()=="Control"){FCK.Selection.Delete();}else{var b=FCK.Selection.GetSelectedElement();if(b){if(b.tagName=="IMG"&&b.getAttribute("_fckanchor")){oAnchor=FCK.GetRealElement(b);}else{b=null;}}if(!b){oAnchor=FCK.Selection.MoveToAncestorNode("A");if(oAnchor){FCK.Selection.SelectNode(oAnchor);}}if(oAnchor.href.length!=0){oAnchor.removeAttribute("name");if(FCKBrowserInfo.IsIE){oAnchor.className=oAnchor.className.replace(FCKRegexLib.FCK_Class,"");}return;}if(b){b.parentNode.removeChild(b);return;}if(oAnchor.innerHTML.length==0){oAnchor.parentNode.removeChild(oAnchor);return;}FCKTools.RemoveOuterTags(oAnchor);}if(FCKBrowserInfo.IsGecko){FCK.Selection.Collapse(true);}},GetState:function(){if(FCK.EditMode!=0){return -1;}return FCK.GetNamedCommandState("Unlink");}};var FCKDeleteDivCommand=function(){};FCKDeleteDivCommand.prototype={GetState:function(){if(FCK.EditMode!=0){return -1;}var d=FCKSelection.GetParentElement();var c=new FCKElementPath(d);return c.BlockLimit&&c.BlockLimit.nodeName.IEquals("div")?0:-1;},Execute:function(){FCKUndo.SaveUndoStep();var g=FCKDomTools.GetSelectedDivContainers();var h=new FCKDomRange(FCK.EditorWindow);h.MoveToSelection();var j=h.CreateBookmark();for(var f=0;f<g.length;f++){FCKDomTools.RemoveNode(g[f],true);}h.MoveToBookmark(j);h.Select();}};var FCKNbsp=function(){this.Name="Non Breaking Space";};FCKNbsp.prototype={Execute:function(){FCK.InsertHtml("&nbsp;");},GetState:function(){return(FCK.EditMode!=0?-1:0);}};var FCKShowBlockCommand=function(d,c){this.Name=d;if(c!=undefined){this._SavedState=c;}else{this._SavedState=null;}};FCKShowBlockCommand.prototype.Execute=function(){var g=this.GetState();if(g==-1){return;}var h=FCK.EditorDocument.body;if(g==1){h.className=h.className.replace(/(^| )FCK__ShowBlocks/g,"");}else{h.className+=" FCK__ShowBlocks";}if(FCKBrowserInfo.IsIE){try{FCK.EditorDocument.selection.createRange().select();}catch(f){}}else{var j=FCK.EditorWindow.getSelection().focusNode;if(j){if(j.nodeType!=1){j=j.parentNode;}FCKDomTools.ScrollIntoView(j,false);}}FCK.Events.FireEvent("OnSelectionChange");};FCKShowBlockCommand.prototype.GetState=function(){if(FCK.EditMode!=0){return -1;}if(!FCK.EditorDocument){return 0;}if(/FCK__ShowBlocks(?:\s|$)/.test(FCK.EditorDocument.body.className)){return 1;}return 0;};FCKShowBlockCommand.prototype.SaveState=function(){this._SavedState=this.GetState();};FCKShowBlockCommand.prototype.RestoreState=function(){if(this._SavedState!=null&&this.GetState()!=this._SavedState){this.Execute();}};var FCKSpellCheckCommand=function(){this.Name="SpellCheck";this.IsEnabled=true;};FCKSpellCheckCommand.prototype.Execute=function(){switch(FCKConfig.SpellChecker){case"ieSpell":this._RunIeSpell();break;case"SpellerPages":FCKDialog.OpenDialog("FCKDialog_SpellCheck","Spell Check","dialog/fck_spellerpages.html",440,480);break;case"WSC":FCKDialog.OpenDialog("FCKDialog_SpellCheck","Spell Check","wsc/w.html",530,480);}};FCKSpellCheckCommand.prototype._RunIeSpell=function(){try{var d=new ActiveXObject("ieSpell.ieSpellExtension");d.CheckAllLinkedDocuments(FCK.EditorDocument);}catch(c){if(c.number==-2146827859){if(confirm(FCKLang.IeSpellDownload)){window.open(FCKConfig.IeSpellDownloadUrl,"IeSpellDownload");}}else{alert("Error Loading ieSpell: "+c.message+" ("+c.number+")");}}};FCKSpellCheckCommand.prototype.GetState=function(){if(FCK.EditMode!=0){return -1;}return this.IsEnabled?0:-1;};var FCKTextColorCommand=function(d){this.Name=d=="ForeColor"?"TextColor":"BGColor";this.Type=d;var c;if(FCKBrowserInfo.IsIE){c=window;}else{if(FCK.ToolbarSet._IFrame){c=FCKTools.GetElementWindow(FCK.ToolbarSet._IFrame);}else{c=window.parent;}}this._Panel=new FCKPanel(c);this._Panel.AppendStyleSheet(FCKConfig.SkinEditorCSS);this._Panel.MainNode.className="FCK_Panel";this._CreatePanelBody(this._Panel.Document,this._Panel.MainNode);FCK.ToolbarSet.ToolbarItems.GetItem(this.Name).RegisterPanel(this._Panel);FCKTools.DisableSelection(this._Panel.Document.body);};FCKTextColorCommand.prototype.Execute=function(f,g,d){this._Panel.Show(f,g,d);};FCKTextColorCommand.prototype.SetColor=function(d){FCKUndo.SaveUndoStep();var c=FCKStyles.GetStyle("_FCK_"+(this.Type=="ForeColor"?"Color":"BackColor"));if(!d||d.length==0){FCK.Styles.RemoveStyle(c);}else{c.SetVariable("Color",d);FCKStyles.ApplyStyle(c);}FCKUndo.SaveUndoStep();FCK.Focus();FCK.Events.FireEvent("OnSelectionChange");};FCKTextColorCommand.prototype.GetState=function(){if(FCK.EditMode!=0){return -1;}return 0;};function FCKTextColorCommand_OnMouseOver(){this.className="ColorSelected";}function FCKTextColorCommand_OnMouseOut(){this.className="ColorDeselected";}function FCKTextColorCommand_OnClick(f,g,d){this.className="ColorDeselected";g.SetColor(d);g._Panel.Hide();}function FCKTextColorCommand_AutoOnClick(d,c){this.className="ColorDeselected";c.SetColor("");c._Panel.Hide();}function FCKTextColorCommand_MoreOnClick(d,c){this.className="ColorDeselected";c._Panel.Hide();FCKDialog.OpenDialog("FCKDialog_Color",FCKLang.DlgColorTitle,"dialog/fck_colorselector.html",410,320,FCKTools.Bind(c,c.SetColor));}FCKTextColorCommand.prototype._CreatePanelBody=function(A,B){function z(){var a=A.createElement("DIV");a.className="ColorDeselected";FCKTools.AddEventListenerEx(a,"mouseover",FCKTextColorCommand_OnMouseOver);FCKTools.AddEventListenerEx(a,"mouseout",FCKTextColorCommand_OnMouseOut);return a;}var D=B.appendChild(A.createElement("TABLE"));D.className="ForceBaseFont";D.style.tableLayout="fixed";D.cellPadding=0;D.cellSpacing=0;D.border=0;D.width=150;var p=D.insertRow(-1).insertCell(-1);p.colSpan=8;var C=p.appendChild(z());C.innerHTML='<table cellspacing="0" cellpadding="0" width="100%" border="0">\n			<tr>\n				<td><div class="ColorBoxBorder"><div class="ColorBox" style="background-color: #000000"></div></div></td>\n				<td nowrap width="100%" align="center">'+FCKLang.ColorAutomatic+"</td>\n			</tr>\n		</table>";FCKTools.AddEventListenerEx(C,"click",FCKTextColorCommand_AutoOnClick,this);if(!FCKBrowserInfo.IsIE){C.style.width="96%";}var q=FCKConfig.FontColors.toString().split(",");var r=0;while(r<q.length){var t=D.insertRow(-1);for(var y=0;y<8;y++,r++){if(r<q.length){var u=q[r].split("/");var v="#"+u[0];var x=u[1]||v;}C=t.insertCell(-1).appendChild(z());C.innerHTML='<div class="ColorBoxBorder"><div class="ColorBox" style="background-color: '+v+'"></div></div>';if(r>=q.length){C.style.visibility="hidden";}else{FCKTools.AddEventListenerEx(C,"click",FCKTextColorCommand_OnClick,[this,x]);}}}if(FCKConfig.EnableMoreFontColors){p=D.insertRow(-1).insertCell(-1);p.colSpan=8;C=p.appendChild(z());C.innerHTML='<table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td nowrap align="center">'+FCKLang.ColorMoreColors+"</td></tr></table>";FCKTools.AddEventListenerEx(C,"click",FCKTextColorCommand_MoreOnClick,this);if(!FCKBrowserInfo.IsIE){C.style.width="96%";}}};var FCKPastePlainTextCommand=function(){this.Name="PasteText";};FCKPastePlainTextCommand.prototype.Execute=function(){FCK.PasteAsPlainText();};FCKPastePlainTextCommand.prototype.GetState=function(){if(FCK.EditMode!=0){return -1;}return FCK.GetNamedCommandState("Paste");};var FCKPasteWordCommand=function(){this.Name="PasteWord";};FCKPasteWordCommand.prototype.Execute=function(){FCK.PasteFromWord();};FCKPasteWordCommand.prototype.GetState=function(){if(FCK.EditMode!=0||FCKConfig.ForcePasteAsPlainText){return -1;}else{return FCK.GetNamedCommandState("Paste");}};var FCKTableCommand=function(b){this.Name=b;};FCKTableCommand.prototype.Execute=function(){FCKUndo.SaveUndoStep();if(!FCKBrowserInfo.IsGecko){switch(this.Name){case"TableMergeRight":return FCKTableHandler.MergeRight();case"TableMergeDown":return FCKTableHandler.MergeDown();}}switch(this.Name){case"TableInsertRowAfter":return FCKTableHandler.InsertRow(false);case"TableInsertRowBefore":return FCKTableHandler.InsertRow(true);case"TableDeleteRows":return FCKTableHandler.DeleteRows();case"TableInsertColumnAfter":return FCKTableHandler.InsertColumn(false);case"TableInsertColumnBefore":return FCKTableHandler.InsertColumn(true);case"TableDeleteColumns":return FCKTableHandler.DeleteColumns();case"TableInsertCellAfter":return FCKTableHandler.InsertCell(null,false);case"TableInsertCellBefore":return FCKTableHandler.InsertCell(null,true);case"TableDeleteCells":return FCKTableHandler.DeleteCells();case"TableMergeCells":return FCKTableHandler.MergeCells();case"TableHorizontalSplitCell":return FCKTableHandler.HorizontalSplitCell();case"TableVerticalSplitCell":return FCKTableHandler.VerticalSplitCell();case"TableDelete":return FCKTableHandler.DeleteTable();default:return alert(FCKLang.UnknownCommand.replace(/%1/g,this.Name));}};FCKTableCommand.prototype.GetState=function(){if(FCK.EditorDocument!=null&&FCKSelection.HasAncestorNode("TABLE")){switch(this.Name){case"TableHorizontalSplitCell":case"TableVerticalSplitCell":if(FCKTableHandler.GetSelectedCells().length==1){return 0;}else{return -1;}case"TableMergeCells":if(FCKTableHandler.CheckIsSelectionRectangular()&&FCKTableHandler.GetSelectedCells().length>1){return 0;}else{return -1;}case"TableMergeRight":return FCKTableHandler.GetMergeRightTarget()?0:-1;case"TableMergeDown":return FCKTableHandler.GetMergeDownTarget()?0:-1;default:return 0;}}else{return -1;}};var FCKFitWindow=function(){this.Name="FitWindow";};FCKFitWindow.prototype.Execute=function(){var y=window.frameElement;var z=y.style;var A=parent;var B=A.document.documentElement;var o=A.document.body;var p=o.style;var q;var r,x;if(FCK.EditMode==0){r=new FCKDomRange(FCK.EditorWindow);r.MoveToSelection();x=FCKTools.GetScrollPosition(FCK.EditorWindow);}else{var t=FCK.EditingArea.Textarea;r=!FCKBrowserInfo.IsIE&&[t.selectionStart,t.selectionEnd];x=[t.scrollLeft,t.scrollTop];}if(!this.IsMaximized){if(FCKBrowserInfo.IsIE){A.attachEvent("onresize",FCKFitWindow_Resize);}else{A.addEventListener("resize",FCKFitWindow_Resize,true);}this._ScrollPos=FCKTools.GetScrollPosition(A);q=y;while((q=q.parentNode)){if(q.nodeType==1){q._fckSavedStyles=FCKTools.SaveStyles(q);q.style.zIndex=FCKConfig.FloatingPanelsZIndex-1;}}if(FCKBrowserInfo.IsIE){this.documentElementOverflow=B.style.overflow;B.style.overflow="hidden";p.overflow="hidden";}else{p.overflow="hidden";p.width="0px";p.height="0px";}this._EditorFrameStyles=FCKTools.SaveStyles(y);var u=FCKTools.GetViewPaneSize(A);z.position="absolute";y.offsetLeft;z.zIndex=FCKConfig.FloatingPanelsZIndex-1;z.left="0px";z.top="0px";z.width=u.Width+"px";z.height=u.Height+"px";if(!FCKBrowserInfo.IsIE){z.borderRight=z.borderBottom="9999px solid white";z.backgroundColor="white";}A.scrollTo(0,0);var v=FCKTools.GetWindowPosition(A,y);if(v.x!=0){z.left=(-1*v.x)+"px";}if(v.y!=0){z.top=(-1*v.y)+"px";}this.IsMaximized=true;}else{if(FCKBrowserInfo.IsIE){A.detachEvent("onresize",FCKFitWindow_Resize);}else{A.removeEventListener("resize",FCKFitWindow_Resize,true);}q=y;while((q=q.parentNode)){if(q._fckSavedStyles){FCKTools.RestoreStyles(q,q._fckSavedStyles);q._fckSavedStyles=null;}}if(FCKBrowserInfo.IsIE){B.style.overflow=this.documentElementOverflow;}FCKTools.RestoreStyles(y,this._EditorFrameStyles);A.scrollTo(this._ScrollPos.X,this._ScrollPos.Y);this.IsMaximized=false;}FCKToolbarItems.GetItem("FitWindow").RefreshState();if(FCK.EditMode==0){FCK.EditingArea.MakeEditable();}FCK.Focus();if(FCK.EditMode==0){r.Select();FCK.EditorWindow.scrollTo(x.X,x.Y);}else{if(!FCKBrowserInfo.IsIE){t.selectionStart=r[0];t.selectionEnd=r[1];}t.scrollLeft=x[0];t.scrollTop=x[1];}};FCKFitWindow.prototype.GetState=function(){if(FCKConfig.ToolbarLocation!="In"){return -1;}else{return(this.IsMaximized?1:0);}};function FCKFitWindow_Resize(){var d=FCKTools.GetViewPaneSize(parent);var c=window.frameElement.style;c.width=d.Width+"px";c.height=d.Height+"px";}var FCKListCommand=function(d,c){this.Name=d;this.TagName=c;};FCKListCommand.prototype={GetState:function(){if(FCK.EditMode!=0||!FCK.EditorWindow){return -1;}var d=FCKSelection.GetBoundaryParentElement(true);var c=d;while(c){if(c.nodeName.IEquals(["ul","ol"])){break;}c=c.parentNode;}if(c&&c.nodeName.IEquals(this.TagName)){return 1;}else{return 0;}},Execute:function(){FCKUndo.SaveUndoStep();var B=FCK.EditorDocument;var C=new FCKDomRange(FCK.EditorWindow);C.MoveToSelection();var D=this.GetState();if(D==0){FCKDomTools.TrimNode(B.body);if(!B.body.firstChild){var E=B.createElement("p");B.body.appendChild(E);C.MoveToNodeContents(E);}}var F=C.CreateBookmark();var G=[];var H={};var I=new FCKDomRangeIterator(C);var J;I.ForceBrBreak=(D==0);var K=true;var L=null;while(K){while((J=I.GetNextParagraph())){var M=new FCKElementPath(J);var N=null;var O=false;var P=M.BlockLimit;for(var A=M.Elements.length-1;A>=0;A--){var Q=M.Elements[A];if(Q.nodeName.IEquals(["ol","ul"])){if(P._FCK_ListGroupObject){P._FCK_ListGroupObject=null;}var R=Q._FCK_ListGroupObject;if(R){R.contents.push(J);}else{R={"root":Q,"contents":[J]};G.push(R);FCKDomTools.SetElementMarker(H,Q,"_FCK_ListGroupObject",R);}O=true;break;}}if(O){continue;}var T=P;if(T._FCK_ListGroupObject){T._FCK_ListGroupObject.contents.push(J);}else{var R={"root":T,"contents":[J]};FCKDomTools.SetElementMarker(H,T,"_FCK_ListGroupObject",R);G.push(R);}}if(FCKBrowserInfo.IsIE){K=false;}else{if(L==null){L=[];var U=FCKSelection.GetSelection();if(U&&G.length==0){L.push(U.getRangeAt(0));}for(var A=1;U&&A<U.rangeCount;A++){L.push(U.getRangeAt(A));}}if(L.length<1){K=false;}else{var W=FCKW3CRange.CreateFromRange(B,L.shift());C._Range=W;C._UpdateElementInfo();if(C.StartNode.nodeName.IEquals("td")){C.SetStart(C.StartNode,1);}if(C.EndNode.nodeName.IEquals("td")){C.SetEnd(C.EndNode,2);}I=new FCKDomRangeIterator(C);I.ForceBrBreak=(D==0);}}}var Y=[];while(G.length>0){var R=G.shift();if(D==0){if(R.root.nodeName.IEquals(["ul","ol"])){this._ChangeListType(R,H,Y);}else{this._CreateList(R,Y);}}else{if(D==1&&R.root.nodeName.IEquals(["ul","ol"])){this._RemoveList(R,H);}}}for(var A=0;A<Y.length;A++){var N=Y[A];var Z=false;var a=N;while(!Z){a=a.nextSibling;if(a&&a.nodeType==3&&a.nodeValue.search(/^[\n\r\t ]*$/)==0){continue;}Z=true;}if(a&&a.nodeName.IEquals(this.TagName)){a.parentNode.removeChild(a);while(a.firstChild){N.appendChild(a.removeChild(a.firstChild));}}Z=false;a=N;while(!Z){a=a.previousSibling;if(a&&a.nodeType==3&&a.nodeValue.search(/^[\n\r\t ]*$/)==0){continue;}Z=true;}if(a&&a.nodeName.IEquals(this.TagName)){a.parentNode.removeChild(a);while(a.lastChild){N.insertBefore(a.removeChild(a.lastChild),N.firstChild);}}}FCKDomTools.ClearAllMarkers(H);C.MoveToBookmark(F);C.Select();FCK.Focus();FCK.Events.FireEvent("OnSelectionChange");},_ChangeListType:function(t,u,v){var x=FCKDomTools.ListToArray(t.root,u);var m=[];for(var r=0;r<t.contents.length;r++){var n=t.contents[r];n=FCKTools.GetElementAscensor(n,"li");if(!n||n._FCK_ListItem_Processed){continue;}m.push(n);FCKDomTools.SetElementMarker(u,n,"_FCK_ListItem_Processed",true);}var o=FCKTools.GetElementDocument(t.root).createElement(this.TagName);for(var r=0;r<m.length;r++){var p=m[r]._FCK_ListArray_Index;x[p].parent=o;}var q=FCKDomTools.ArrayToList(x,u);for(var r=0;r<q.listNode.childNodes.length;r++){if(q.listNode.childNodes[r].nodeName.IEquals(this.TagName)){v.push(q.listNode.childNodes[r]);}}t.root.parentNode.replaceChild(q.listNode,t.root);},_CreateList:function(C,D){var E=C.contents;var F=FCKTools.GetElementDocument(C.root);var q=[];if(E.length==1&&E[0]==C.root){var r=F.createElement("div");while(E[0].firstChild){r.appendChild(E[0].removeChild(E[0].firstChild));}E[0].appendChild(r);E[0]=r;}var t=C.contents[0].parentNode;for(var B=0;B<E.length;B++){t=FCKDomTools.GetCommonParents(t,E[B].parentNode).pop();}for(var B=0;B<E.length;B++){var u=E[B];while(u.parentNode){if(u.parentNode==t){q.push(u);break;}u=u.parentNode;}}if(q.length<1){return;}var v=q[q.length-1].nextSibling;var x=F.createElement(this.TagName);D.push(x);while(q.length){var y=q.shift();var z=F.createDocumentFragment();while(y.firstChild){z.appendChild(y.removeChild(y.firstChild));}y.parentNode.removeChild(y);var A=F.createElement("li");A.appendChild(z);x.appendChild(A);}t.insertBefore(x,v);},_RemoveList:function(v,x){var y=FCKDomTools.ListToArray(v.root,x);var z=[];for(var u=0;u<v.contents.length;u++){var n=v.contents[u];n=FCKTools.GetElementAscensor(n,"li");if(!n||n._FCK_ListItem_Processed){continue;}z.push(n);FCKDomTools.SetElementMarker(x,n,"_FCK_ListItem_Processed",true);}var o=null;for(var u=0;u<z.length;u++){var p=z[u]._FCK_ListArray_Index;y[p].indent=-1;o=p;}for(var u=o+1;u<y.length;u++){if(y[u].indent>y[u-1].indent+1){var q=y[u-1].indent+1-y[u].indent;var r=y[u].indent;while(y[u]&&y[u].indent>=r){y[u].indent+=q;u++;}u--;}}var t=FCKDomTools.ArrayToList(y,x);if(v.root.nextSibling==null||v.root.nextSibling.nodeName.IEquals("br")){if(t.listNode.lastChild.nodeName.IEquals("br")){t.listNode.removeChild(t.listNode.lastChild);}}v.root.parentNode.replaceChild(t.listNode,v.root);}};var FCKJustifyCommand=function(f){this.AlignValue=f;var g=FCKConfig.ContentLangDirection.toLowerCase();this.IsDefaultAlign=(f=="left"&&g=="ltr")||(f=="right"&&g=="rtl");var d=this._CssClassName=(function(){var a=FCKConfig.JustifyClasses;if(a){switch(f){case"left":return a[0]||null;case"center":return a[1]||null;case"right":return a[2]||null;case"justify":return a[3]||null;}}return null;})();if(d&&d.length>0){this._CssClassRegex=new RegExp("(?:^|\\s+)"+d+"(?=$|\\s)");}};FCKJustifyCommand._GetClassNameRegex=function(){var h=FCKJustifyCommand._ClassRegex;if(h!=undefined){return h;}var j=[];var k=FCKConfig.JustifyClasses;if(k){for(var g=0;g<4;g++){var l=k[g];if(l&&l.length>0){j.push(l);}}}if(j.length>0){h=new RegExp("(?:^|\\s+)(?:"+j.join("|")+")(?=$|\\s)");}else{h=null;}return FCKJustifyCommand._ClassRegex=h;};FCKJustifyCommand.prototype={Execute:function(){FCKUndo.SaveUndoStep();var l=new FCKDomRange(FCK.EditorWindow);l.MoveToSelection();var m=this.GetState();if(m==-1){return;}var n=l.CreateBookmark();var o=this._CssClassName;var p=new FCKDomRangeIterator(l);var q;while((q=p.GetNextParagraph())){q.removeAttribute("align");if(o){var r=q.className.replace(FCKJustifyCommand._GetClassNameRegex(),"");if(m==0){if(r.length>0){r+=" ";}q.className=r+o;}else{if(r.length==0){FCKDomTools.RemoveAttribute(q,"class");}}}else{var k=q.style;if(m==0){k.textAlign=this.AlignValue;}else{k.textAlign="";if(k.cssText.length==0){q.removeAttribute("style");}}}}l.MoveToBookmark(n);l.Select();FCK.Focus();FCK.Events.FireEvent("OnSelectionChange");},GetState:function(){if(FCK.EditMode!=0||!FCK.EditorWindow){return -1;}var f=new FCKElementPath(FCKSelection.GetBoundaryParentElement(true));var g=f.Block||f.BlockLimit;if(!g||g.nodeName.toLowerCase()=="body"){return 0;}var d;if(FCKBrowserInfo.IsIE){d=g.currentStyle.textAlign;}else{d=FCK.EditorWindow.getComputedStyle(g,"").getPropertyValue("text-align");}d=d.replace(/(-moz-|-webkit-|start|auto)/i,"");if((!d&&this.IsDefaultAlign)||d==this.AlignValue){return 1;}return 0;}};var FCKIndentCommand=function(d,c){this.Name=d;this.Offset=c;this.IndentCSSProperty=FCKConfig.ContentLangDirection.IEquals("ltr")?"marginLeft":"marginRight";};FCKIndentCommand._InitIndentModeParameters=function(){if(FCKConfig.IndentClasses&&FCKConfig.IndentClasses.length>0){this._UseIndentClasses=true;this._IndentClassMap={};for(var b=0;b<FCKConfig.IndentClasses.length;b++){this._IndentClassMap[FCKConfig.IndentClasses[b]]=b+1;}this._ClassNameRegex=new RegExp("(?:^|\\s+)("+FCKConfig.IndentClasses.join("|")+")(?=$|\\s)");}else{this._UseIndentClasses=false;}};FCKIndentCommand.prototype={Execute:function(){FCKUndo.SaveUndoStep();var f=new FCKDomRange(FCK.EditorWindow);f.MoveToSelection();var g=f.CreateBookmark();var d=FCKDomTools.GetCommonParentNode(f.StartNode||f.StartContainer,f.EndNode||f.EndContainer,["ul","ol"]);if(d){this._IndentList(f,d);}else{this._IndentBlock(f);}f.MoveToBookmark(g);f.Select();FCK.Focus();FCK.Events.FireEvent("OnSelectionChange");},GetState:function(){if(FCK.EditMode!=0||!FCK.EditorWindow){return -1;}if(FCKIndentCommand._UseIndentClasses==undefined){FCKIndentCommand._InitIndentModeParameters();}var q=FCKSelection.GetBoundaryParentElement(true);var r=FCKSelection.GetBoundaryParentElement(false);var t=FCKDomTools.GetCommonParentNode(q,r,["ul","ol"]);if(t){if(this.Name.IEquals("outdent")){return 0;}var u=FCKTools.GetElementAscensor(q,"li");if(!u||!u.previousSibling){return -1;}return 0;}if(!FCKIndentCommand._UseIndentClasses&&this.Name.IEquals("indent")){return 0;}var l=new FCKElementPath(q);var m=l.Block||l.BlockLimit;if(!m){return -1;}if(FCKIndentCommand._UseIndentClasses){var n=m.className.match(FCKIndentCommand._ClassNameRegex);var o=0;if(n!=null){n=n[1];o=FCKIndentCommand._IndentClassMap[n];}if((this.Name=="outdent"&&o==0)||(this.Name=="indent"&&o==FCKConfig.IndentClasses.length)){return -1;}return 0;}else{var p=parseInt(m.style[this.IndentCSSProperty],10);if(isNaN(p)){p=0;}if(p<=0){return -1;}return 0;}},_IndentBlock:function(q){var r=new FCKDomRangeIterator(q);r.EnforceRealBlocks=true;q.Expand("block_contents");var t=FCKDomTools.GetCommonParents(q.StartContainer,q.EndContainer);var u=t[t.length-1];var l;while((l=r.GetNextParagraph())){if(!(l==u||l.parentNode==u)){continue;}if(FCKIndentCommand._UseIndentClasses){var m=l.className.match(FCKIndentCommand._ClassNameRegex);var n=0;if(m!=null){m=m[1];n=FCKIndentCommand._IndentClassMap[m];}if(this.Name.IEquals("outdent")){n--;}else{if(this.Name.IEquals("indent")){n++;}}n=Math.min(n,FCKConfig.IndentClasses.length);n=Math.max(n,0);var o=l.className.replace(FCKIndentCommand._ClassNameRegex,"");if(n<1){l.className=o;}else{l.className=(o.length>0?o+" ":"")+FCKConfig.IndentClasses[n-1];}}else{var p=parseInt(l.style[this.IndentCSSProperty],10);if(isNaN(p)){p=0;}p+=this.Offset;p=Math.max(p,0);p=Math.ceil(p/this.Offset)*this.Offset;l.style[this.IndentCSSProperty]=p?p+FCKConfig.IndentUnit:"";if(l.getAttribute("style")==""){l.removeAttribute("style");}}}},_IndentList:function(G,H){var I=G.StartContainer;var J=G.EndContainer;while(I&&I.parentNode!=H){I=I.parentNode;}while(J&&J.parentNode!=H){J=J.parentNode;}if(!I||!J){return;}var t=I;var u=[];var v=false;while(v==false){if(t==J){v=true;}u.push(t);t=t.nextSibling;}if(u.length<1){return;}var x=FCKDomTools.GetParents(H);for(var F=0;F<x.length;F++){if(x[F].nodeName.IEquals(["ul","ol"])){H=x[F];break;}}var y=this.Name.IEquals("indent")?1:-1;var z=u[0];var A=u[u.length-1];var B={};var C=FCKDomTools.ListToArray(H,B);var D=C[A._FCK_ListArray_Index].indent;for(var F=z._FCK_ListArray_Index;F<=A._FCK_ListArray_Index;F++){C[F].indent+=y;}for(var F=A._FCK_ListArray_Index+1;F<C.length&&C[F].indent>D;F++){C[F].indent+=y;}var E=FCKDomTools.ArrayToList(C);if(E){H.parentNode.replaceChild(E.listNode,H);}FCKDomTools.ClearAllMarkers(B);}};var FCKBlockQuoteCommand=function(){};FCKBlockQuoteCommand.prototype={Execute:function(){FCKUndo.SaveUndoStep();var c=this.GetState();var d=new FCKDomRange(FCK.EditorWindow);d.MoveToSelection();var A=d.CreateBookmark();if(FCKBrowserInfo.IsIE){var B=d.GetBookmarkNode(A,true);var C=d.GetBookmarkNode(A,false);var D;if(B&&B.parentNode.nodeName.IEquals("blockquote")&&!B.previousSibling){D=B;while((D=D.nextSibling)){if(FCKListsLib.BlockElements[D.nodeName.toLowerCase()]){FCKDomTools.MoveNode(B,D,true);}}}if(C&&C.parentNode.nodeName.IEquals("blockquote")&&!C.previousSibling){D=C;while((D=D.nextSibling)){if(FCKListsLib.BlockElements[D.nodeName.toLowerCase()]){if(D.firstChild==B){FCKDomTools.InsertAfterNode(B,C);}else{FCKDomTools.MoveNode(C,D,true);}}}}}var E=new FCKDomRangeIterator(d);var F;if(c==0){var G=[];while((F=E.GetNextParagraph())){G.push(F);}if(G.length<1){para=d.Window.document.createElement(FCKConfig.EnterMode.IEquals("p")?"p":"div");d.InsertNode(para);para.appendChild(d.Window.document.createTextNode("\ufeff"));d.MoveToBookmark(A);d.MoveToNodeContents(para);d.Collapse(true);A=d.CreateBookmark();G.push(para);}var H=G[0].parentNode;var I=[];for(var a=0;a<G.length;a++){F=G[a];H=FCKDomTools.GetCommonParents(F.parentNode,H).pop();}while(H.nodeName.IEquals("table","tbody","tr","ol","ul")){H=H.parentNode;}var J=null;while(G.length>0){F=G.shift();while(F.parentNode!=H){F=F.parentNode;}if(F!=J){I.push(F);}J=F;}while(I.length>0){F=I.shift();if(F.nodeName.IEquals("blockquote")){var K=FCKTools.GetElementDocument(F).createDocumentFragment();while(F.firstChild){K.appendChild(F.removeChild(F.firstChild));G.push(K.lastChild);}F.parentNode.replaceChild(K,F);}else{G.push(F);}}var L=d.Window.document.createElement("blockquote");H.insertBefore(L,G[0]);while(G.length>0){F=G.shift();L.appendChild(F);}}else{if(c==1){var M=[];var N={};while((F=E.GetNextParagraph())){var O=null;var P=null;while(F.parentNode){if(F.parentNode.nodeName.IEquals("blockquote")){O=F.parentNode;P=F;break;}F=F.parentNode;}if(O&&P&&!P._fckblockquotemoveout){M.push(P);FCKDomTools.SetElementMarker(N,P,"_fckblockquotemoveout",true);}}FCKDomTools.ClearAllMarkers(N);var Q=[];var R=[],N={};var S=function(f){for(var b=0;b<f.childNodes.length;b++){if(FCKListsLib.BlockElements[f.childNodes[b].nodeName.toLowerCase()]){return false;}}return true;};while(M.length>0){var U=M.shift();var L=U.parentNode;if(U==U.parentNode.firstChild){L.parentNode.insertBefore(L.removeChild(U),L);}else{if(U==U.parentNode.lastChild){L.parentNode.insertBefore(L.removeChild(U),L.nextSibling);}else{FCKDomTools.BreakParent(U,U.parentNode,d);}}if(!L._fckbqprocessed){R.push(L);FCKDomTools.SetElementMarker(N,L,"_fckbqprocessed",true);}Q.push(U);}for(var a=R.length-1;a>=0;a--){var L=R[a];if(S(L)){FCKDomTools.RemoveNode(L);}}FCKDomTools.ClearAllMarkers(N);if(FCKConfig.EnterMode.IEquals("br")){while(Q.length){var U=Q.shift();var T=true;if(U.nodeName.IEquals("div")){var K=FCKTools.GetElementDocument(U).createDocumentFragment();var W=T&&U.previousSibling&&!FCKListsLib.BlockBoundaries[U.previousSibling.nodeName.toLowerCase()];if(T&&W){K.appendChild(FCKTools.GetElementDocument(U).createElement("br"));}var ab=U.nextSibling&&!FCKListsLib.BlockBoundaries[U.nextSibling.nodeName.toLowerCase()];while(U.firstChild){K.appendChild(U.removeChild(U.firstChild));}if(ab){K.appendChild(FCKTools.GetElementDocument(U).createElement("br"));}U.parentNode.replaceChild(K,U);T=false;}}}}}d.MoveToBookmark(A);d.Select();FCK.Focus();FCK.Events.FireEvent("OnSelectionChange");},GetState:function(){if(FCK.EditMode!=0||!FCK.EditorWindow){return -1;}var f=new FCKElementPath(FCKSelection.GetBoundaryParentElement(true));var g=f.Block||f.BlockLimit;if(!g||g.nodeName.toLowerCase()=="body"){return 0;}for(var d=0;d<f.Elements.length;d++){if(f.Elements[d].nodeName.IEquals("blockquote")){return 1;}}return 0;}};var FCKCoreStyleCommand=function(b){this.Name="CoreStyle";this.StyleName="_FCK_"+b;this.IsActive=false;FCKStyles.AttachStyleStateChange(this.StyleName,this._OnStyleStateChange,this);};FCKCoreStyleCommand.prototype={Execute:function(){FCKUndo.SaveUndoStep();if(this.IsActive){FCKStyles.RemoveStyle(this.StyleName);}else{FCKStyles.ApplyStyle(this.StyleName);}FCK.Focus();FCK.Events.FireEvent("OnSelectionChange");},GetState:function(){if(FCK.EditMode!=0){return -1;}return this.IsActive?1:0;},_OnStyleStateChange:function(d,c){this.IsActive=c;}};var FCKRemoveFormatCommand=function(){this.Name="RemoveFormat";};FCKRemoveFormatCommand.prototype={Execute:function(){FCKStyles.RemoveAll();FCK.Focus();FCK.Events.FireEvent("OnSelectionChange");},GetState:function(){return FCK.EditorWindow?0:-1;}};var FCKCommands=FCK.Commands={};FCKCommands.LoadedCommands={};FCKCommands.RegisterCommand=function(d,c){this.LoadedCommands[d]=c;};FCKCommands.GetCommand=function(d){var c=FCKCommands.LoadedCommands[d];if(c){return c;}switch(d){case"Bold":case"Italic":case"Underline":case"StrikeThrough":case"Subscript":case"Superscript":c=new FCKCoreStyleCommand(d);break;case"RemoveFormat":c=new FCKRemoveFormatCommand();break;case"DocProps":c=new FCKDialogCommand("DocProps",FCKLang.DocProps,"dialog/fck_docprops.html",400,380,FCKCommands.GetFullPageState);break;case"Templates":c=new FCKDialogCommand("Templates",FCKLang.DlgTemplatesTitle,"dialog/fck_template.html",380,450);break;case"Link":c=new FCKDialogCommand("Link",FCKLang.DlgLnkWindowTitle,"dialog/fck_link.html",400,300);break;case"Unlink":c=new FCKUnlinkCommand();break;case"VisitLink":c=new FCKVisitLinkCommand();break;case"Anchor":c=new FCKDialogCommand("Anchor",FCKLang.DlgAnchorTitle,"dialog/fck_anchor.html",370,160);break;case"AnchorDelete":c=new FCKAnchorDeleteCommand();break;case"BulletedList":c=new FCKDialogCommand("BulletedList",FCKLang.BulletedListProp,"dialog/fck_listprop.html?UL",370,160);break;case"NumberedList":c=new FCKDialogCommand("NumberedList",FCKLang.NumberedListProp,"dialog/fck_listprop.html?OL",370,160);break;case"About":c=new FCKDialogCommand("About",FCKLang.About,"dialog/fck_about.html",420,330,function(){return 0;});break;case"Find":c=new FCKDialogCommand("Find",FCKLang.DlgFindAndReplaceTitle,"dialog/fck_replace.html",340,230,null,null,"Find");break;case"Replace":c=new FCKDialogCommand("Replace",FCKLang.DlgFindAndReplaceTitle,"dialog/fck_replace.html",340,230,null,null,"Replace");break;case"Image":c=new FCKDialogCommand("Image",FCKLang.DlgImgTitle,"dialog/fck_image.html",450,390);break;case"Flash":c=new FCKDialogCommand("Flash",FCKLang.DlgFlashTitle,"dialog/fck_flash.html",450,390);break;case"SpecialChar":c=new FCKDialogCommand("SpecialChar",FCKLang.DlgSpecialCharTitle,"dialog/fck_specialchar.html",400,290);break;case"Smiley":c=new FCKDialogCommand("Smiley",FCKLang.DlgSmileyTitle,"dialog/fck_smiley.html",FCKConfig.SmileyWindowWidth,FCKConfig.SmileyWindowHeight);break;case"Table":c=new FCKDialogCommand("Table",FCKLang.DlgTableTitle,"dialog/fck_table.html",480,250);break;case"TableProp":c=new FCKDialogCommand("Table",FCKLang.DlgTableTitle,"dialog/fck_table.html?Parent",480,250);break;case"TableCellProp":c=new FCKDialogCommand("TableCell",FCKLang.DlgCellTitle,"dialog/fck_tablecell.html",550,240);break;case"Style":c=new FCKStyleCommand();break;case"FontName":c=new FCKFontNameCommand();break;case"FontSize":c=new FCKFontSizeCommand();break;case"FontFormat":c=new FCKFormatBlockCommand();break;case"Source":c=new FCKSourceCommand();break;case"Preview":c=new FCKPreviewCommand();break;case"Save":c=new FCKSaveCommand();break;case"NewPage":c=new FCKNewPageCommand();break;case"PageBreak":c=new FCKPageBreakCommand();break;case"Rule":c=new FCKRuleCommand();break;case"Nbsp":c=new FCKNbsp();break;case"TextColor":c=new FCKTextColorCommand("ForeColor");break;case"BGColor":c=new FCKTextColorCommand("BackColor");break;case"Paste":c=new FCKPasteCommand();break;case"PasteText":c=new FCKPastePlainTextCommand();break;case"PasteWord":c=new FCKPasteWordCommand();break;case"JustifyLeft":c=new FCKJustifyCommand("left");break;case"JustifyCenter":c=new FCKJustifyCommand("center");break;case"JustifyRight":c=new FCKJustifyCommand("right");break;case"JustifyFull":c=new FCKJustifyCommand("justify");break;case"Indent":c=new FCKIndentCommand("indent",FCKConfig.IndentLength);break;case"Outdent":c=new FCKIndentCommand("outdent",FCKConfig.IndentLength*-1);break;case"Blockquote":c=new FCKBlockQuoteCommand();break;case"CreateDiv":c=new FCKDialogCommand("CreateDiv",FCKLang.CreateDiv,"dialog/fck_div.html",380,210,null,null,true);break;case"EditDiv":c=new FCKDialogCommand("EditDiv",FCKLang.EditDiv,"dialog/fck_div.html",380,210,null,null,false);break;case"DeleteDiv":c=new FCKDeleteDivCommand();break;case"TableInsertRowAfter":c=new FCKTableCommand("TableInsertRowAfter");break;case"TableInsertRowBefore":c=new FCKTableCommand("TableInsertRowBefore");break;case"TableDeleteRows":c=new FCKTableCommand("TableDeleteRows");break;case"TableInsertColumnAfter":c=new FCKTableCommand("TableInsertColumnAfter");break;case"TableInsertColumnBefore":c=new FCKTableCommand("TableInsertColumnBefore");break;case"TableDeleteColumns":c=new FCKTableCommand("TableDeleteColumns");break;case"TableInsertCellAfter":c=new FCKTableCommand("TableInsertCellAfter");break;case"TableInsertCellBefore":c=new FCKTableCommand("TableInsertCellBefore");break;case"TableDeleteCells":c=new FCKTableCommand("TableDeleteCells");break;case"TableMergeCells":c=new FCKTableCommand("TableMergeCells");break;case"TableMergeRight":c=new FCKTableCommand("TableMergeRight");break;case"TableMergeDown":c=new FCKTableCommand("TableMergeDown");break;case"TableHorizontalSplitCell":c=new FCKTableCommand("TableHorizontalSplitCell");break;case"TableVerticalSplitCell":c=new FCKTableCommand("TableVerticalSplitCell");break;case"TableDelete":c=new FCKTableCommand("TableDelete");break;case"Form":c=new FCKDialogCommand("Form",FCKLang.Form,"dialog/fck_form.html",380,210);break;case"Checkbox":c=new FCKDialogCommand("Checkbox",FCKLang.Checkbox,"dialog/fck_checkbox.html",380,200);break;case"Radio":c=new FCKDialogCommand("Radio",FCKLang.RadioButton,"dialog/fck_radiobutton.html",380,200);break;case"TextField":c=new FCKDialogCommand("TextField",FCKLang.TextField,"dialog/fck_textfield.html",380,210);break;case"Textarea":c=new FCKDialogCommand("Textarea",FCKLang.Textarea,"dialog/fck_textarea.html",380,210);break;case"HiddenField":c=new FCKDialogCommand("HiddenField",FCKLang.HiddenField,"dialog/fck_hiddenfield.html",380,190);break;case"Button":c=new FCKDialogCommand("Button",FCKLang.Button,"dialog/fck_button.html",380,210);break;case"Select":c=new FCKDialogCommand("Select",FCKLang.SelectionField,"dialog/fck_select.html",400,340);break;case"ImageButton":c=new FCKDialogCommand("ImageButton",FCKLang.ImageButton,"dialog/fck_image.html?ImageButton",450,390);break;case"SpellCheck":c=new FCKSpellCheckCommand();break;case"FitWindow":c=new FCKFitWindow();break;case"Undo":c=new FCKUndoCommand();break;case"Redo":c=new FCKRedoCommand();break;case"Copy":c=new FCKCutCopyCommand(false);break;case"Cut":c=new FCKCutCopyCommand(true);break;case"SelectAll":c=new FCKSelectAllCommand();break;case"InsertOrderedList":c=new FCKListCommand("insertorderedlist","ol");break;case"InsertUnorderedList":c=new FCKListCommand("insertunorderedlist","ul");break;case"ShowBlocks":c=new FCKShowBlockCommand("ShowBlocks",FCKConfig.StartupShowBlocks?1:0);break;case"Undefined":c=new FCKUndefinedCommand();break;case"Scayt":c=FCKScayt.CreateCommand();break;case"ScaytContext":c=FCKScayt.CreateContextCommand();break;default:if(FCKRegexLib.NamedCommands.test(d)){c=new FCKNamedCommand(d);}else{alert(FCKLang.UnknownCommand.replace(/%1/g,d));return null;}}FCKCommands.LoadedCommands[d]=c;return c;};FCKCommands.GetFullPageState=function(){return FCKConfig.FullPage?0:-1;};FCKCommands.GetBooleanState=function(b){return b?-1:0;};var FCKPanel=function(j){this.IsRTL=(FCKLang.Dir=="rtl");this.IsContextMenu=false;this._LockCounter=0;this._Window=j||window;var k;if(FCKBrowserInfo.IsIE){this._Popup=this._Window.createPopup();var l=this._Window.document;if(FCK_IS_CUSTOM_DOMAIN&&!FCKBrowserInfo.IsIE7){l.domain=FCK_ORIGINAL_DOMAIN;document.domain=FCK_ORIGINAL_DOMAIN;}k=this.Document=this._Popup.document;if(FCK_IS_CUSTOM_DOMAIN){k.domain=FCK_RUNTIME_DOMAIN;l.domain=FCK_RUNTIME_DOMAIN;document.domain=FCK_RUNTIME_DOMAIN;}FCK.IECleanup.AddItem(this,FCKPanel_Cleanup);}else{var m=this._IFrame=this._Window.document.createElement("iframe");FCKTools.ResetStyles(m);m.src="javascript:void(0)";m.allowTransparency=true;m.frameBorder="0";m.scrolling="no";m.style.width=m.style.height="0px";FCKDomTools.SetElementStyles(m,{position:"absolute",zIndex:FCKConfig.FloatingPanelsZIndex});this._Window.document.body.appendChild(m);var n=m.contentWindow;k=this.Document=n.document;var h="";if(FCKBrowserInfo.IsSafari){h='<base href="'+window.document.location+'">';}k.open();k.write("<html><head>"+h+'</head><body style="margin:0px;padding:0px;"></body></html>');k.close();if(FCKBrowserInfo.IsAIR){FCKAdobeAIR.Panel_Contructor(k,window.document.location);}FCKTools.AddEventListenerEx(n,"focus",FCKPanel_Window_OnFocus,this);FCKTools.AddEventListenerEx(n,"blur",FCKPanel_Window_OnBlur,this);}k.dir=FCKLang.Dir;FCKTools.AddEventListener(k,"contextmenu",FCKTools.CancelEvent);this.MainNode=k.body.appendChild(k.createElement("DIV"));this.MainNode.style.cssFloat=this.IsRTL?"right":"left";};FCKPanel.prototype.AppendStyleSheet=function(b){FCKTools.AppendStyleSheet(this.Document,b);};FCKPanel.prototype.Preload=function(d,g,f){if(this._Popup){this._Popup.show(d,g,0,0,f);}};FCKPanel.prototype.ResizeForSubpanel=function(j,l,m){if(!FCKBrowserInfo.IsIE7){return false;}if(!this._Popup.isOpen){this.Subpanel=null;return false;}if(l==0&&m==0){if(this.Subpanel!==j){return false;}this.Subpanel=null;this.IncreasedX=0;}else{this.Subpanel=j;if((this.IncreasedX>=l)&&(this.IncreasedY>=m)){return false;}this.IncreasedX=Math.max(this.IncreasedX,l);this.IncreasedY=Math.max(this.IncreasedY,m);}var k=this.ShowRect.x;var p=this.IncreasedX;if(this.IsRTL){k=k-p;}var n=this.ShowRect.w+p;var o=Math.max(this.ShowRect.h,this.IncreasedY);if(this.ParentPanel){this.ParentPanel.ResizeForSubpanel(this,n,o);}this._Popup.show(k,this.ShowRect.y,n,o,this.RelativeElement);return this.IsRTL;};FCKPanel.prototype.Show=function(y,A,E,F,G){var H;var r=this.MainNode;if(this._Popup){this._Popup.show(y,A,0,0,E);FCKDomTools.SetElementStyles(r,{B:F?F+"px":"",C:G?G+"px":""});H=r.offsetWidth;if(FCKBrowserInfo.IsIE7){if(this.ParentPanel&&this.ParentPanel.ResizeForSubpanel(this,H,r.offsetHeight)){FCKTools.RunFunction(this.Show,this,[y,A,E]);return;}}if(this.IsRTL){if(this.IsContextMenu){y=y-H+1;}else{if(E){y=(y*-1)+E.offsetWidth-H;}}}if(FCKBrowserInfo.IsIE7){this.ShowRect={x:y,y:A,w:H,h:r.offsetHeight};this.IncreasedX=0;this.IncreasedY=0;this.RelativeElement=E;}this._PopupArgs=[y,A,H,r.offsetHeight,E];this._Popup.show(y,A,H,r.offsetHeight,E);if(this.OnHide){if(this._Timer){CheckPopupOnHide.call(this,true);}this._Timer=FCKTools.SetInterval(CheckPopupOnHide,100,this);}}else{if(typeof(FCK.ToolbarSet.CurrentInstance.FocusManager)!="undefined"){FCK.ToolbarSet.CurrentInstance.FocusManager.Lock();}if(this.ParentPanel){this.ParentPanel.Lock();FCKPanel_Window_OnBlur(null,this.ParentPanel);}if(FCKBrowserInfo.IsGecko&&FCKBrowserInfo.IsMac){this._IFrame.scrolling="";FCKTools.RunFunction(function(){this._IFrame.scrolling="no";},this);}if(FCK.ToolbarSet.CurrentInstance.GetInstanceObject("FCKPanel")._OpenedPanel&&FCK.ToolbarSet.CurrentInstance.GetInstanceObject("FCKPanel")._OpenedPanel!=this){FCK.ToolbarSet.CurrentInstance.GetInstanceObject("FCKPanel")._OpenedPanel.Hide(false,true);}FCKDomTools.SetElementStyles(r,{B:F?F+"px":"",C:G?G+"px":""});H=r.offsetWidth;if(!F){this._IFrame.width=1;}if(!G){this._IFrame.height=1;}H=r.offsetWidth||r.firstChild.offsetWidth;var t=FCKTools.GetDocumentPosition(this._Window,E.nodeType==9?(FCKTools.IsStrictMode(E)?E.documentElement:E.body):E);var u=FCKDomTools.GetPositionedAncestor(this._IFrame.parentNode);if(u){var v=FCKTools.GetDocumentPosition(FCKTools.GetElementWindow(u),u);t.x-=v.x;t.y-=v.y;}if(this.IsRTL&&!this.IsContextMenu){y=(y*-1);}y+=t.x;A+=t.y;if(this.IsRTL){if(this.IsContextMenu){y=y-H+1;}else{if(E){y=y+E.offsetWidth-H;}}}else{var x=FCKTools.GetViewPaneSize(this._Window);var z=FCKTools.GetScrollPosition(this._Window);var B=x.Height+z.Y;var C=x.Width+z.X;if((y+H)>C){y-=y+H-C;}if((A+r.offsetHeight)>B){A-=A+r.offsetHeight-B;}}FCKDomTools.SetElementStyles(this._IFrame,{left:y+"px",top:A+"px"});this._IFrame.contentWindow.focus();this._IsOpened=true;var D=this;this._resizeTimer=setTimeout(function(){var a=r.offsetWidth||r.firstChild.offsetWidth;var b=r.offsetHeight;D._IFrame.style.width=a+"px";D._IFrame.style.height=b+"px";},0);FCK.ToolbarSet.CurrentInstance.GetInstanceObject("FCKPanel")._OpenedPanel=this;}FCKTools.RunFunction(this.OnShow,this);};FCKPanel.prototype.Hide=function(d,c){if(this._Popup){this._Popup.hide();}else{if(!this._IsOpened||this._LockCounter>0){return;}if(typeof(FCKFocusManager)!="undefined"&&!c){FCKFocusManager.Unlock();}this._IFrame.style.width=this._IFrame.style.height="0px";this._IsOpened=false;if(this._resizeTimer){clearTimeout(this._resizeTimer);this._resizeTimer=null;}if(this.ParentPanel){this.ParentPanel.Unlock();}if(!d){FCKTools.RunFunction(this.OnHide,this);}}};FCKPanel.prototype.CheckIsOpened=function(){if(this._Popup){return this._Popup.isOpen;}else{return this._IsOpened;}};FCKPanel.prototype.CreateChildPanel=function(){var d=this._Popup?FCKTools.GetDocumentWindow(this.Document):this._Window;var c=new FCKPanel(d);c.ParentPanel=this;return c;};FCKPanel.prototype.Lock=function(){this._LockCounter++;};FCKPanel.prototype.Unlock=function(){if(--this._LockCounter==0&&!this.HasFocus){this.Hide();}};function FCKPanel_Window_OnFocus(c,d){d.HasFocus=true;}function FCKPanel_Window_OnBlur(c,d){d.HasFocus=false;if(d._LockCounter==0){FCKTools.RunFunction(d.Hide,d);}}function CheckPopupOnHide(b){if(b||!this._Popup.isOpen){window.clearInterval(this._Timer);this._Timer=null;if(this._Popup&&this.ParentPanel&&!b){this.ParentPanel.ResizeForSubpanel(this,0,0);}FCKTools.RunFunction(this.OnHide,this);}}function FCKPanel_Cleanup(){this._Popup=null;this._Window=null;this.Document=null;this.MainNode=null;this.RelativeElement=null;}var FCKIcon=function(d){var c=d?typeof(d):"undefined";switch(c){case"number":this.Path=FCKConfig.SkinPath+"fck_strip.gif";this.Size=16;this.Position=d;break;case"undefined":this.Path=FCK_SPACER_PATH;break;case"string":this.Path=d;break;default:this.Path=d[0];this.Size=d[1];this.Position=d[2];}};FCKIcon.prototype.CreateIconElement=function(g){var h,f;if(this.Position){var j="-"+((this.Position-1)*this.Size)+"px";if(FCKBrowserInfo.IsIE){h=g.createElement("DIV");f=h.appendChild(g.createElement("IMG"));f.src=this.Path;f.style.top=j;}else{h=g.createElement("IMG");h.src=FCK_SPACER_PATH;h.style.backgroundPosition="0px "+j;h.style.backgroundImage='url("'+this.Path+'")';}}else{if(FCKBrowserInfo.IsIE){h=g.createElement("DIV");f=h.appendChild(g.createElement("IMG"));f.src=this.Path?this.Path:FCK_SPACER_PATH;}else{h=g.createElement("IMG");h.src=this.Path?this.Path:FCK_SPACER_PATH;}}h.className="TB_Button_Image";return h;};var FCKToolbarButtonUI=function(j,k,l,m,n,h){this.Name=j;this.Label=k||j;this.Tooltip=l||this.Label;this.Style=n||0;this.State=h||0;this.Icon=new FCKIcon(m);if(FCK.IECleanup){FCK.IECleanup.AddItem(this,FCKToolbarButtonUI_Cleanup);}};FCKToolbarButtonUI.prototype._CreatePaddingElement=function(d){var c=d.createElement("IMG");c.className="TB_Button_Padding";c.src=FCK_SPACER_PATH;return c;};FCKToolbarButtonUI.prototype.Create=function(k){var l=FCKTools.GetElementDocument(k);var m=this.MainElement=l.createElement("DIV");m.title=this.Tooltip;if(FCKBrowserInfo.IsGecko){m.onmousedown=FCKTools.CancelEvent;}FCKTools.AddEventListenerEx(m,"mouseover",FCKToolbarButtonUI_OnMouseOver,this);FCKTools.AddEventListenerEx(m,"mouseout",FCKToolbarButtonUI_OnMouseOut,this);FCKTools.AddEventListenerEx(m,"click",FCKToolbarButtonUI_OnClick,this);this.ChangeState(this.State,true);if(this.Style==0&&!this.ShowArrow){m.appendChild(this.Icon.CreateIconElement(l));}else{var n=m.appendChild(l.createElement("TABLE"));n.cellPadding=0;n.cellSpacing=0;var o=n.insertRow(-1);var p=o.insertCell(-1);if(this.Style==0||this.Style==2){p.appendChild(this.Icon.CreateIconElement(l));}else{p.appendChild(this._CreatePaddingElement(l));}if(this.Style==1||this.Style==2){p=o.insertCell(-1);p.className="TB_Button_Text";p.noWrap=true;p.appendChild(l.createTextNode(this.Label));}if(this.ShowArrow){if(this.Style!=0){o.insertCell(-1).appendChild(this._CreatePaddingElement(l));}p=o.insertCell(-1);var j=p.appendChild(l.createElement("IMG"));j.src=FCKConfig.SkinPath+"images/toolbar.buttonarrow.gif";j.width=5;j.height=3;}p=o.insertCell(-1);p.appendChild(this._CreatePaddingElement(l));}k.appendChild(m);};FCKToolbarButtonUI.prototype.ChangeState=function(f,g){if(!g&&this.State==f){return;}var d=this.MainElement;if(!d){return;}switch(parseInt(f,10)){case 0:d.className="TB_Button_Off";break;case 1:d.className="TB_Button_On";break;case -1:d.className="TB_Button_Disabled";break;}this.State=f;};function FCKToolbarButtonUI_OnMouseOver(d,c){if(c.State==0){this.className="TB_Button_Off_Over";}else{if(c.State==1){this.className="TB_Button_On_Over";}}}function FCKToolbarButtonUI_OnMouseOut(d,c){if(c.State==0){this.className="TB_Button_Off";}else{if(c.State==1){this.className="TB_Button_On";}}}function FCKToolbarButtonUI_OnClick(d,c){if(c.OnClick&&c.State!=-1){c.OnClick(c);}}function FCKToolbarButtonUI_Cleanup(){this.MainElement=null;}var FCKToolbarButton=function(k,l,m,n,o,p,j){this.CommandName=k;this.Label=l;this.Tooltip=m;this.Style=n;this.SourceView=o?true:false;this.ContextSensitive=p?true:false;if(j==null){this.IconPath=FCKConfig.SkinPath+"toolbar/"+k.toLowerCase()+".gif";}else{if(typeof(j)=="number"){this.IconPath=[FCKConfig.SkinPath+"fck_strip.gif",16,j];}else{this.IconPath=j;}}};FCKToolbarButton.prototype.Create=function(b){this._UIButton=new FCKToolbarButtonUI(this.CommandName,this.Label,this.Tooltip,this.IconPath,this.Style);this._UIButton.OnClick=this.Click;this._UIButton._ToolbarButton=this;this._UIButton.Create(b);};FCKToolbarButton.prototype.RefreshState=function(){var d=this._UIButton;if(!d){return;}var c=FCK.ToolbarSet.CurrentInstance.Commands.GetCommand(this.CommandName).GetState();if(c==d.State){return;}d.ChangeState(c);};FCKToolbarButton.prototype.Click=function(){var b=this._ToolbarButton||this;FCK.ToolbarSet.CurrentInstance.Commands.GetCommand(b.CommandName).Execute();};FCKToolbarButton.prototype.Enable=function(){this.RefreshState();};FCKToolbarButton.prototype.Disable=function(){this._UIButton.ChangeState(-1);};var FCKSpecialCombo=function(h,j,k,l,g){this.FieldWidth=j||100;this.PanelWidth=k||150;this.PanelMaxHeight=l||150;this.Label="&nbsp;";this.Caption=h;this.Tooltip=h;this.Style=2;this.Enabled=true;this.Items={};this._Panel=new FCKPanel(g||window);this._Panel.AppendStyleSheet(FCKConfig.SkinEditorCSS);this._PanelBox=this._Panel.MainNode.appendChild(this._Panel.Document.createElement("DIV"));this._PanelBox.className="SC_Panel";this._PanelBox.style.width=this.PanelWidth+"px";this._PanelBox.innerHTML='<table cellpadding="0" cellspacing="0" width="100%" style="TABLE-LAYOUT: fixed"><tr><td nowrap></td></tr></table>';this._ItemsHolderEl=this._PanelBox.getElementsByTagName("TD")[0];if(FCK.IECleanup){FCK.IECleanup.AddItem(this,FCKSpecialCombo_Cleanup);}};function FCKSpecialCombo_ItemOnMouseOver(){this.className+=" SC_ItemOver";}function FCKSpecialCombo_ItemOnMouseOut(){this.className=this.originalClass;}function FCKSpecialCombo_ItemOnClick(f,g,d){this.className=this.originalClass;g._Panel.Hide();g.SetLabel(this.FCKItemLabel);if(typeof(g.OnSelect)=="function"){g.OnSelect(d,this);}}FCKSpecialCombo.prototype.ClearItems=function(){if(this.Items){this.Items={};}var b=this._ItemsHolderEl;while(b.firstChild){b.removeChild(b.firstChild);}};FCKSpecialCombo.prototype.AddItem=function(h,j,k,l){var g=this._ItemsHolderEl.appendChild(this._Panel.Document.createElement("DIV"));g.className=g.originalClass="SC_Item";g.innerHTML=j;g.FCKItemLabel=k||h;g.Selected=false;if(FCKBrowserInfo.IsIE){g.style.width="100%";}if(l){g.style.backgroundColor=l;}FCKTools.AddEventListenerEx(g,"mouseover",FCKSpecialCombo_ItemOnMouseOver);FCKTools.AddEventListenerEx(g,"mouseout",FCKSpecialCombo_ItemOnMouseOut);FCKTools.AddEventListenerEx(g,"click",FCKSpecialCombo_ItemOnClick,[this,h]);this.Items[h.toString().toLowerCase()]=g;return g;};FCKSpecialCombo.prototype.SelectItem=function(b){if(typeof b=="string"){b=this.Items[b.toString().toLowerCase()];}if(b){b.className=b.originalClass="SC_ItemSelected";b.Selected=true;}};FCKSpecialCombo.prototype.SelectItemByLabel=function(g,h){for(var j in this.Items){var f=this.Items[j];if(f.FCKItemLabel==g){f.className=f.originalClass="SC_ItemSelected";f.Selected=true;if(h){this.SetLabel(g);}}}};FCKSpecialCombo.prototype.DeselectAll=function(d){for(var c in this.Items){if(!this.Items[c]){continue;}this.Items[c].className=this.Items[c].originalClass="SC_Item";this.Items[c].Selected=false;}if(d){this.SetLabel("");}};FCKSpecialCombo.prototype.SetLabelById=function(d){d=d?d.toString().toLowerCase():"";var c=this.Items[d];this.SetLabel(c?c.FCKItemLabel:"");};FCKSpecialCombo.prototype.SetLabel=function(d){d=(!d||d.length==0)?"&nbsp;":d;if(d==this.Label){return;}this.Label=d;var c=this._LabelEl;if(c){c.innerHTML=d;FCKTools.DisableSelection(c);}};FCKSpecialCombo.prototype.SetEnabled=function(b){this.Enabled=b;if(this._OuterTable){this._OuterTable.className=b?"":"SC_FieldDisabled";}};FCKSpecialCombo.prototype.Create=function(k){var l=FCKTools.GetElementDocument(k);var m=this._OuterTable=k.appendChild(l.createElement("TABLE"));m.cellPadding=0;m.cellSpacing=0;m.insertRow(-1);var n;var o;switch(this.Style){case 0:n="TB_ButtonType_Icon";o=false;break;case 1:n="TB_ButtonType_Text";o=false;break;case 2:o=true;break;}if(this.Caption&&this.Caption.length>0&&o){var p=m.rows[0].insertCell(-1);p.innerHTML=this.Caption;p.className="SC_FieldCaption";}var j=FCKTools.AppendElement(m.rows[0].insertCell(-1),"div");if(o){j.className="SC_Field";j.style.width=this.FieldWidth+"px";j.innerHTML='<table width="100%" cellpadding="0" cellspacing="0" style="TABLE-LAYOUT: fixed;"><tbody><tr><td class="SC_FieldLabel"><label>&nbsp;</label></td><td class="SC_FieldButton">&nbsp;</td></tr></tbody></table>';this._LabelEl=j.getElementsByTagName("label")[0];this._LabelEl.innerHTML=this.Label;}else{j.className="TB_Button_Off";j.innerHTML='<table title="'+this.Tooltip+'" class="'+n+'" cellspacing="0" cellpadding="0" border="0"><tr><td><img class="TB_Button_Padding" src="'+FCK_SPACER_PATH+'" /></td><td class="TB_Text">'+this.Caption+'</td><td><img class="TB_Button_Padding" src="'+FCK_SPACER_PATH+'" /></td><td class="TB_ButtonArrow"><img src="'+FCKConfig.SkinPath+'images/toolbar.buttonarrow.gif" width="5" height="3"></td><td><img class="TB_Button_Padding" src="'+FCK_SPACER_PATH+'" /></td></tr></table>';}FCKTools.AddEventListenerEx(j,"mouseover",FCKSpecialCombo_OnMouseOver,this);FCKTools.AddEventListenerEx(j,"mouseout",FCKSpecialCombo_OnMouseOut,this);FCKTools.AddEventListenerEx(j,"click",FCKSpecialCombo_OnClick,this);FCKTools.DisableSelection(this._Panel.Document.body);};function FCKSpecialCombo_Cleanup(){this._LabelEl=null;this._OuterTable=null;this._ItemsHolderEl=null;this._PanelBox=null;if(this.Items){for(var b in this.Items){this.Items[b]=null;}}}function FCKSpecialCombo_OnMouseOver(d,c){if(c.Enabled){switch(c.Style){case 0:this.className="TB_Button_On_Over";break;case 1:this.className="TB_Button_On_Over";break;case 2:this.className="SC_Field SC_FieldOver";break;}}}function FCKSpecialCombo_OnMouseOut(d,c){switch(c.Style){case 0:this.className="TB_Button_Off";break;case 1:this.className="TB_Button_Off";break;case 2:this.className="SC_Field";break;}}function FCKSpecialCombo_OnClick(m,j){if(j.Enabled){var k=j._Panel;var l=j._PanelBox;var n=j._ItemsHolderEl;var h=j.PanelMaxHeight;if(j.OnBeforeClick){j.OnBeforeClick(j);}if(FCKBrowserInfo.IsIE){k.Preload(0,this.offsetHeight,this);}if(n.offsetHeight>h){l.style.height=h+"px";}else{l.style.height="";}k.Show(0,this.offsetHeight,this);}}var FCKToolbarSpecialCombo=function(){this.SourceView=false;this.ContextSensitive=true;this.FieldWidth=null;this.PanelWidth=null;this.PanelMaxHeight=null;};FCKToolbarSpecialCombo.prototype.DefaultLabel="";function FCKToolbarSpecialCombo_OnSelect(d,c){FCK.ToolbarSet.CurrentInstance.Commands.GetCommand(this.CommandName).Execute(d,c);}FCKToolbarSpecialCombo.prototype.Create=function(b){this._Combo=new FCKSpecialCombo(this.GetLabel(),this.FieldWidth,this.PanelWidth,this.PanelMaxHeight,FCKBrowserInfo.IsIE?window:FCKTools.GetElementWindow(b).parent);this._Combo.Tooltip=this.Tooltip;this._Combo.Style=this.Style;this.CreateItems(this._Combo);this._Combo.Create(b);this._Combo.CommandName=this.CommandName;this._Combo.OnSelect=FCKToolbarSpecialCombo_OnSelect;};function FCKToolbarSpecialCombo_RefreshActiveItems(d,c){d.DeselectAll();d.SelectItem(c);d.SetLabelById(c);}FCKToolbarSpecialCombo.prototype.RefreshState=function(){var d;var c=FCK.ToolbarSet.CurrentInstance.Commands.GetCommand(this.CommandName).GetState();if(c!=-1){d=1;if(this.RefreshActiveItems){this.RefreshActiveItems(this._Combo,c);}else{if(this._LastValue!==c){this._LastValue=c;if(!c||c.length==0){this._Combo.DeselectAll();this._Combo.SetLabel(this.DefaultLabel);}else{FCKToolbarSpecialCombo_RefreshActiveItems(this._Combo,c);}}}}else{d=-1;}if(d==this.State){return;}if(d==-1){this._Combo.DeselectAll();this._Combo.SetLabel("");}this.State=d;this._Combo.SetEnabled(d!=-1);};FCKToolbarSpecialCombo.prototype.Enable=function(){this.RefreshState();};FCKToolbarSpecialCombo.prototype.Disable=function(){this.State=-1;this._Combo.DeselectAll();this._Combo.SetLabel("");this._Combo.SetEnabled(false);};var FCKToolbarStyleCombo=function(d,c){if(d===false){return;}this.CommandName="Style";this.Label=this.GetLabel();this.Tooltip=d?d:this.Label;this.Style=c?c:2;this.DefaultLabel=FCKConfig.DefaultStyleLabel||"";};FCKToolbarStyleCombo.prototype=new FCKToolbarSpecialCombo;FCKToolbarStyleCombo.prototype.GetLabel=function(){return FCKLang.Style;};FCKToolbarStyleCombo.prototype.GetStyles=function(){var g={};var h=FCK.ToolbarSet.CurrentInstance.Styles.GetStyles();for(var j in h){var f=h[j];if(!f.IsCore){g[j]=f;}}return g;};FCKToolbarStyleCombo.prototype.CreateItems=function(k){var l=k._Panel.Document;FCKTools.AppendStyleSheet(l,FCKConfig.ToolbarComboPreviewCSS);FCKTools.AppendStyleString(l,FCKConfig.EditorAreaStyles);l.body.className+=" ForceBaseFont";FCKConfig.ApplyBodyAttributes(l.body);var m=this.GetStyles();for(var n in m){var o=m[n];var p=o.GetType()==2?n:FCKToolbarStyleCombo_BuildPreview(o,o.Label||n);var j=k.AddItem(n,p);j.Style=o;}k.OnBeforeClick=this.StyleCombo_OnBeforeClick;};FCKToolbarStyleCombo.prototype.RefreshActiveItems=function(l){var m=FCK.ToolbarSet.CurrentInstance.Selection.GetBoundaryParentElement(true);if(m){var n=new FCKElementPath(m);var o=n.Elements;for(var p=0;p<o.length;p++){for(var k in l.Items){var q=l.Items[k];var r=q.Style;if(r.CheckElementRemovable(o[p],true)){l.SetLabel(r.Label||r.Name);return;}}}}l.SetLabel(this.DefaultLabel);};FCKToolbarStyleCombo.prototype.StyleCombo_OnBeforeClick=function(l){l.DeselectAll();var m;var n;var o;var p=FCK.ToolbarSet.CurrentInstance.Selection;if(p.GetType()=="Control"){m=p.GetSelectedElement();o=m.nodeName.toLowerCase();}else{m=p.GetBoundaryParentElement(true);n=new FCKElementPath(m);}for(var k in l.Items){var q=l.Items[k];var r=q.Style;if((o&&r.Element==o)||(!o&&r.GetType()!=2)){q.style.display="";if((n&&r.CheckActive(n))||(!n&&r.CheckElementRemovable(m,true))){l.SelectItem(r.Name);}}else{q.style.display="none";}}};function FCKToolbarStyleCombo_BuildPreview(k,l){var m=k.GetType();var n=[];if(m==0){n.push('<div class="BaseFont">');}var o=k.Element;if(o=="bdo"){o="span";}n=["<",o];var p=k._StyleDesc.Attributes;if(p){for(var j in p){n.push(" ",j,'="',k.GetFinalAttributeValue(j),'"');}}if(k._GetStyleText().length>0){n.push(' style="',k.GetFinalStyleValue(),'"');}n.push(">",l,"</",o,">");if(m==0){n.push("</div>");}return n.join("");}var FCKToolbarFontFormatCombo=function(d,c){if(d===false){return;}this.CommandName="FontFormat";this.Label=this.GetLabel();this.Tooltip=d?d:this.Label;this.Style=c?c:2;this.NormalLabel="Normal";this.PanelWidth=190;this.DefaultLabel=FCKConfig.DefaultFontFormatLabel||"";};FCKToolbarFontFormatCombo.prototype=new FCKToolbarStyleCombo(false);FCKToolbarFontFormatCombo.prototype.GetLabel=function(){return FCKLang.FontFormat;};FCKToolbarFontFormatCombo.prototype.GetStyles=function(){var k={};var l=FCKLang["FontFormats"].split(";");var m={p:l[0],pre:l[1],address:l[2],h1:l[3],h2:l[4],h3:l[5],h4:l[6],h5:l[7],h6:l[8],div:l[9]||(l[0]+" (DIV)")};var n=FCKConfig.FontFormats.split(";");for(var j=0;j<n.length;j++){var o=n[j];var p=FCKStyles.GetStyle("_FCK_"+o);if(p){p.Label=m[o];k["_FCK_"+o]=p;}else{alert("The FCKConfig.CoreStyles['"+o+"'] setting was not found. Please check the fckconfig.js file");}}return k;};FCKToolbarFontFormatCombo.prototype.RefreshActiveItems=function(k){var l=FCK.ToolbarSet.CurrentInstance.Selection.GetBoundaryParentElement(true);if(l){var m=new FCKElementPath(l);var n=m.Block;if(n){for(var j in k.Items){var o=k.Items[j];var p=o.Style;if(p.CheckElementRemovable(n)){k.SetLabel(p.Label);return;}}}}k.SetLabel(this.DefaultLabel);};FCKToolbarFontFormatCombo.prototype.StyleCombo_OnBeforeClick=function(k){k.DeselectAll();var l=FCK.ToolbarSet.CurrentInstance.Selection.GetBoundaryParentElement(true);if(l){var m=new FCKElementPath(l);var n=m.Block;for(var j in k.Items){var o=k.Items[j];var p=o.Style;if(p.CheckElementRemovable(n)){k.SelectItem(o);return;}}}};var FCKToolbarFontsCombo=function(d,c){this.CommandName="FontName";this.Label=this.GetLabel();this.Tooltip=d?d:this.Label;this.Style=c?c:2;this.DefaultLabel=FCKConfig.DefaultFontLabel||"";};FCKToolbarFontsCombo.prototype=new FCKToolbarFontFormatCombo(false);FCKToolbarFontsCombo.prototype.GetLabel=function(){return FCKLang.Font;};FCKToolbarFontsCombo.prototype.GetStyles=function(){var l=FCKStyles.GetStyle("_FCK_FontFace");if(!l){alert("The FCKConfig.CoreStyles['Size'] setting was not found. Please check the fckconfig.js file");return{};}var m={};var n=FCKConfig.FontNames.split(";");for(var k=0;k<n.length;k++){var o=n[k].split("/");var p=o[0];var q=o[1]||p;var r=FCKTools.CloneObject(l);r.SetVariable("Font",p);r.Label=q;m[q]=r;}return m;};FCKToolbarFontsCombo.prototype.RefreshActiveItems=FCKToolbarStyleCombo.prototype.RefreshActiveItems;FCKToolbarFontsCombo.prototype.StyleCombo_OnBeforeClick=function(j){j.DeselectAll();var k=FCKSelection.GetBoundaryParentElement(true);if(k){var l=new FCKElementPath(k);for(var h in j.Items){var m=j.Items[h];var n=m.Style;if(n.CheckActive(l)){j.SelectItem(m);return;}}}};var FCKToolbarFontSizeCombo=function(d,c){this.CommandName="FontSize";this.Label=this.GetLabel();this.Tooltip=d?d:this.Label;this.Style=c?c:2;this.DefaultLabel=FCKConfig.DefaultFontSizeLabel||"";this.FieldWidth=70;};FCKToolbarFontSizeCombo.prototype=new FCKToolbarFontFormatCombo(false);FCKToolbarFontSizeCombo.prototype.GetLabel=function(){return FCKLang.FontSize;};FCKToolbarFontSizeCombo.prototype.GetStyles=function(){var l=FCKStyles.GetStyle("_FCK_Size");if(!l){alert("The FCKConfig.CoreStyles['FontFace'] setting was not found. Please check the fckconfig.js file");return{};}var m={};var n=FCKConfig.FontSizes.split(";");for(var k=0;k<n.length;k++){var o=n[k].split("/");var p=o[0];var q=o[1]||p;var r=FCKTools.CloneObject(l);r.SetVariable("Size",p);r.Label=q;m[q]=r;}return m;};FCKToolbarFontSizeCombo.prototype.RefreshActiveItems=FCKToolbarStyleCombo.prototype.RefreshActiveItems;FCKToolbarFontSizeCombo.prototype.StyleCombo_OnBeforeClick=FCKToolbarFontsCombo.prototype.StyleCombo_OnBeforeClick;var FCKToolbarPanelButton=function(k,l,m,n,o){this.CommandName=k;var p;if(o==null){p=FCKConfig.SkinPath+"toolbar/"+k.toLowerCase()+".gif";}else{if(typeof(o)=="number"){p=[FCKConfig.SkinPath+"fck_strip.gif",16,o];}}var j=this._UIButton=new FCKToolbarButtonUI(k,l,m,p,n);j._FCKToolbarPanelButton=this;j.ShowArrow=true;j.OnClick=FCKToolbarPanelButton_OnButtonClick;};FCKToolbarPanelButton.prototype.TypeName="FCKToolbarPanelButton";FCKToolbarPanelButton.prototype.Create=function(d){d.className+="Menu";this._UIButton.Create(d);var c=FCK.ToolbarSet.CurrentInstance.Commands.GetCommand(this.CommandName)._Panel;this.RegisterPanel(c);};FCKToolbarPanelButton.prototype.RegisterPanel=function(f){if(f._FCKToolbarPanelButton){return;}f._FCKToolbarPanelButton=this;var g=f.Document.body.appendChild(f.Document.createElement("div"));g.style.position="absolute";g.style.top="0px";var d=f._FCKToolbarPanelButtonLineDiv=g.appendChild(f.Document.createElement("IMG"));d.className="TB_ConnectionLine";d.style.position="absolute";d.src=FCK_SPACER_PATH;f.OnHide=FCKToolbarPanelButton_OnPanelHide;};function FCKToolbarPanelButton_OnButtonClick(h){var j=this._FCKToolbarPanelButton;var l=j._UIButton.MainElement;j._UIButton.ChangeState(1);var k=FCK.ToolbarSet.CurrentInstance.Commands.GetCommand(j.CommandName);var g=k._Panel;g._FCKToolbarPanelButtonLineDiv.style.width=(l.offsetWidth-2)+"px";k.Execute(0,l.offsetHeight-1,l);}function FCKToolbarPanelButton_OnPanelHide(){var b=this._FCKToolbarPanelButton;b._UIButton.ChangeState(0);}FCKToolbarPanelButton.prototype.RefreshState=FCKToolbarButton.prototype.RefreshState;FCKToolbarPanelButton.prototype.Enable=FCKToolbarButton.prototype.Enable;FCKToolbarPanelButton.prototype.Disable=FCKToolbarButton.prototype.Disable;var FCKScayt;(function(){var E=[];var F=(FCK&&FCK.EditorWindow&&FCK.EditorWindow.parent.parent.scayt)?true:false;var G=false;var I=false;function B(k){if(F){return;}F=true;var d=FCK.EditorWindow.parent.parent;var h=function(){window.scayt=d.scayt;D();var l=FCKToolbarItems.LoadedItems["ScaytCombobox"];l&&l.SetEnabled(scyt_control&&scyt_control.disabled);z();};if(d.scayt){h();return;}if(FCK.Config.ScaytCustomUrl){FCK.Config.ScaytCustomUrl=new String(FCK.Config.ScaytCustomUrl).replace(new RegExp("^http[s]*://"),"");}var j=document.location.protocol;var c=FCK.Config.ScaytCustomUrl||"svc.spellchecker.net/spellcheck3/lf/scayt/scayt4.js";var f=j+"//"+c;var g=J(f).path+"/";var a=d.window.CKEDITOR||(d.window.CKEDITOR={});a._djScaytConfig={I:g,addOnLoad:function(){h();},isDebug:false};if(k){E.push(k);}C(f);}function C(a){if(!a){return false;}var c=FCK.EditorWindow.parent.parent;var d=c.document.createElement("script");d.type="text/javascript";d.src=a;c.document.getElementsByTagName("head")[0].appendChild(d);return true;}function J(c){var a=c.match(/(.*)[\/\\]([^\/\\]+\.\w+)$/);return a?{path:a[1],file:a[2]}:c;}function u(){var c={};var d=FCK.EditorWindow.parent.parent;c.srcNodeRef=FCK.EditingArea.IFrame;c.customerid=FCK.Config.ScaytCustomerid;c.customDictionaryName=FCK.Config.ScaytCustomDictionaryName;c.userDictionaryName=FCK.Config.ScaytUserDictionaryName;c.defLang=FCK.Config.ScaytDefLang;var f=d.scayt;var a=window.scayt_control=new f(c);}function D(){u();var c=window.scayt_control;if(c){c.setDisabled(false);I=true;G=!c.disabled;var f=FCKToolbarItems.LoadedItems["ScaytCombobox"];f&&f.Enable();x();}for(var a=0;a<E.length;a++){try{E[a].call(this);}catch(d){}}}var A=function(){name="Scayt";};A.prototype.Execute=function(c){switch(c){case"Options":case"Langs":case"About":if(F&&I&&!G){y("SCAYT is not enabled");break;}if(F&&I){FCKDialog.OpenDialog("Scayt","SCAYT Settings","dialog/fck_scayt.html?"+c.toLowerCase(),343,343);}break;default:if(!F){var a=this;B(function(){a.SetEnabled(!window.scayt_control.disabled);});return true;}else{if(I){if(G){this.Disable();}else{this.Enable();}x();}}}if(!F){return y("SCAYT is not loaded")||false;}if(!I){return y("SCAYT is not ready")||false;}return true;};A.prototype.Enable=function(){window.scayt_control.setDisabled(false);G=true;};A.prototype.Disable=function(){window.scayt_control.setDisabled(true);G=false;};A.prototype.SetEnabled=function(a){if(a){this.Enable();}else{this.Disable();}x();return true;};A.prototype.GetState=function(){return 0;};function x(){var a=FCKToolbarItems.GetItem("SpellCheck");if(!a||!a._Combo||!a._Combo._OuterTable){return;}var c=a._Combo._OuterTable.getElementsByTagName("img")[1];var d=a._Combo.Items["trigger"];if(G){c.style.opacity="1";d.innerHTML=b();}else{c.style.opacity="0.5";d.innerHTML=b();}}function b(){if(!I){return"<b>Enable SCAYT</b>";}return G?"<b>Disable SCAYT</b>":"<b>Enable SCAYT</b>";}var H=function(c,a){this.Command=FCKCommands.GetCommand("Scayt");this.CommandName="Scayt";this.Label=this.GetLabel();this.Tooltip=FCKLang.ScaytTitle;this.Style=1;};H.prototype=new FCKToolbarSpecialCombo;H.prototype.CreateItems=function(){this._Combo.AddItem("Trigger","<b>Enable SCAYT</b>");this._Combo.AddItem("Options",FCKLang.ScaytTitleOptions||"Options");this._Combo.AddItem("Langs",FCKLang.ScaytTitleLangs||"Languages");this._Combo.AddItem("About",FCKLang.ScaytTitleAbout||"About");};H.prototype.GetLabel=function(){var a=FCKConfig.SkinPath+"fck_strip.gif";return FCKBrowserInfo.IsIE?'<div class="TB_Button_Image"><img src="'+a+'" style="top:-192px"></div>':'<img class="TB_Button_Image" src="'+FCK_SPACER_PATH+'" style="background-position: 0px -192px;background-image: url('+a+');">';};function y(a){a&&alert(a);}var v=function(){name="ScaytContext";};v.prototype.Execute=function(c){var g=c&&c.action,d=g&&c.node,f=window.scayt_control;if(d){switch(g){case"Suggestion":f.replace(d,c.suggestion);break;case"Ignore":f.ignore(d);break;case"Ignore All":f.ignoreAll(d);break;case"Add Word":var a=FCK.EditorWindow.parent.parent;a.scayt.addWordToUserDictionary(d);break;}}};function z(){FCK.ContextMenu.RegisterListener({AddItems:function(j){var a=FCK.EditorWindow.parent.parent;var g=window.scayt_control,d=a.scayt;if(!g){return;}var c=g.getScaytNode();if(!c){return;}var f=d.getSuggestion(g.getWord(c),g.getLang());if(!f||!f.length){return;}j.AddSeparator();var k=FCK.Config.ScaytMaxSuggestions||5;var l=(k==-1)?f.length:k;for(var h=0;h<l;h+=1){if(f[h]){j.AddItem("ScaytContext",f[h],null,false,{"action":"Suggestion","node":c,"suggestion":f[h]});}}j.AddSeparator();j.AddItem("ScaytContext","Ignore",null,false,{"action":"Ignore","node":c});j.AddItem("ScaytContext","Ignore All",null,false,{"action":"Ignore All","node":c});j.AddItem("ScaytContext","Add Word",null,false,{"action":"Add Word","node":c});try{if(I&&G){g.fireOnContextMenu(null,FCK.ContextMenu._InnerContextMenu);}}catch(m){}}});FCK.Events.AttachEvent("OnPaste",function(){window.scayt_control.refresh();return true;});}FCK.Events.AttachEvent("OnAfterSetHTML",function(){if(FCKConfig.SpellChecker=="SCAYT"){if(!F&&FCK.Config.ScaytAutoStartup){B();}if(FCK.EditMode==0&&F&&I){u();}x();}});FCK.Events.AttachEvent("OnBeforeGetData",function(){I&&window.scayt_control.reset();});FCK.Events.AttachEvent("OnAfterGetData",function(){I&&window.scayt_control.refresh();});FCKScayt={CreateCommand:function(){return new A();},CreateContextCommand:function(){return new v();},CreateToolbarItem:function(){return new H();}};})();var FCKToolbarItems={};FCKToolbarItems.LoadedItems={};FCKToolbarItems.RegisterItem=function(d,c){this.LoadedItems[d]=c;};FCKToolbarItems.GetItem=function(d){var c=FCKToolbarItems.LoadedItems[d];if(c){return c;}switch(d){case"Source":c=new FCKToolbarButton("Source",FCKLang.Source,null,2,true,true,1);break;case"DocProps":c=new FCKToolbarButton("DocProps",FCKLang.DocProps,null,null,null,null,2);break;case"Save":c=new FCKToolbarButton("Save",FCKLang.Save,null,null,true,null,3);break;case"NewPage":c=new FCKToolbarButton("NewPage",FCKLang.NewPage,null,null,true,null,4);break;case"Preview":c=new FCKToolbarButton("Preview",FCKLang.Preview,null,null,true,null,5);break;case"Templates":c=new FCKToolbarButton("Templates",FCKLang.Templates,null,null,null,null,6);break;case"About":c=new FCKToolbarButton("About",FCKLang.About,null,null,true,null,47);break;case"Cut":c=new FCKToolbarButton("Cut",FCKLang.Cut,null,null,false,true,7);break;case"Copy":c=new FCKToolbarButton("Copy",FCKLang.Copy,null,null,false,true,8);break;case"Paste":c=new FCKToolbarButton("Paste",FCKLang.Paste,null,null,false,true,9);break;case"PasteText":c=new FCKToolbarButton("PasteText",FCKLang.PasteText,null,null,false,true,10);break;case"PasteWord":c=new FCKToolbarButton("PasteWord",FCKLang.PasteWord,null,null,false,true,11);break;case"Print":c=new FCKToolbarButton("Print",FCKLang.Print,null,null,false,true,12);break;case"Undo":c=new FCKToolbarButton("Undo",FCKLang.Undo,null,null,false,true,14);break;case"Redo":c=new FCKToolbarButton("Redo",FCKLang.Redo,null,null,false,true,15);break;case"SelectAll":c=new FCKToolbarButton("SelectAll",FCKLang.SelectAll,null,null,true,null,18);break;case"RemoveFormat":c=new FCKToolbarButton("RemoveFormat",FCKLang.RemoveFormat,null,null,false,true,19);break;case"FitWindow":c=new FCKToolbarButton("FitWindow",FCKLang.FitWindow,null,null,true,true,66);break;case"Bold":c=new FCKToolbarButton("Bold",FCKLang.Bold,null,null,false,true,20);break;case"Italic":c=new FCKToolbarButton("Italic",FCKLang.Italic,null,null,false,true,21);break;case"Underline":c=new FCKToolbarButton("Underline",FCKLang.Underline,null,null,false,true,22);break;case"StrikeThrough":c=new FCKToolbarButton("StrikeThrough",FCKLang.StrikeThrough,null,null,false,true,23);break;case"Subscript":c=new FCKToolbarButton("Subscript",FCKLang.Subscript,null,null,false,true,24);break;case"Superscript":c=new FCKToolbarButton("Superscript",FCKLang.Superscript,null,null,false,true,25);break;case"OrderedList":c=new FCKToolbarButton("InsertOrderedList",FCKLang.NumberedListLbl,FCKLang.NumberedList,null,false,true,26);break;case"UnorderedList":c=new FCKToolbarButton("InsertUnorderedList",FCKLang.BulletedListLbl,FCKLang.BulletedList,null,false,true,27);break;case"Outdent":c=new FCKToolbarButton("Outdent",FCKLang.DecreaseIndent,null,null,false,true,28);break;case"Indent":c=new FCKToolbarButton("Indent",FCKLang.IncreaseIndent,null,null,false,true,29);break;case"Blockquote":c=new FCKToolbarButton("Blockquote",FCKLang.Blockquote,null,null,false,true,73);break;case"CreateDiv":c=new FCKToolbarButton("CreateDiv",FCKLang.CreateDiv,null,null,false,true,74);break;case"Link":c=new FCKToolbarButton("Link",FCKLang.InsertLinkLbl,FCKLang.InsertLink,null,false,true,34);break;case"Unlink":c=new FCKToolbarButton("Unlink",FCKLang.RemoveLink,null,null,false,true,35);break;case"Anchor":c=new FCKToolbarButton("Anchor",FCKLang.Anchor,null,null,null,null,36);break;case"Image":c=new FCKToolbarButton("Image",FCKLang.InsertImageLbl,FCKLang.InsertImage,null,false,true,37);break;case"Flash":c=new FCKToolbarButton("Flash",FCKLang.InsertFlashLbl,FCKLang.InsertFlash,null,false,true,38);break;case"Table":c=new FCKToolbarButton("Table",FCKLang.InsertTableLbl,FCKLang.InsertTable,null,false,true,39);break;case"SpecialChar":c=new FCKToolbarButton("SpecialChar",FCKLang.InsertSpecialCharLbl,FCKLang.InsertSpecialChar,null,false,true,42);break;case"Smiley":c=new FCKToolbarButton("Smiley",FCKLang.InsertSmileyLbl,FCKLang.InsertSmiley,null,false,true,41);break;case"PageBreak":c=new FCKToolbarButton("PageBreak",FCKLang.PageBreakLbl,FCKLang.PageBreak,null,false,true,43);break;case"Rule":c=new FCKToolbarButton("Rule",FCKLang.InsertLineLbl,FCKLang.InsertLine,null,false,true,40);break;case"JustifyLeft":c=new FCKToolbarButton("JustifyLeft",FCKLang.LeftJustify,null,null,false,true,30);break;case"JustifyCenter":c=new FCKToolbarButton("JustifyCenter",FCKLang.CenterJustify,null,null,false,true,31);break;case"JustifyRight":c=new FCKToolbarButton("JustifyRight",FCKLang.RightJustify,null,null,false,true,32);break;case"JustifyFull":c=new FCKToolbarButton("JustifyFull",FCKLang.BlockJustify,null,null,false,true,33);break;case"Style":c=new FCKToolbarStyleCombo();break;case"FontName":c=new FCKToolbarFontsCombo();break;case"FontSize":c=new FCKToolbarFontSizeCombo();break;case"FontFormat":c=new FCKToolbarFontFormatCombo();break;case"TextColor":c=new FCKToolbarPanelButton("TextColor",FCKLang.TextColor,null,null,45);break;case"BGColor":c=new FCKToolbarPanelButton("BGColor",FCKLang.BGColor,null,null,46);break;case"Find":c=new FCKToolbarButton("Find",FCKLang.Find,null,null,null,null,16);break;case"Replace":c=new FCKToolbarButton("Replace",FCKLang.Replace,null,null,null,null,17);break;case"Form":c=new FCKToolbarButton("Form",FCKLang.Form,null,null,null,null,48);break;case"Checkbox":c=new FCKToolbarButton("Checkbox",FCKLang.Checkbox,null,null,null,null,49);break;case"Radio":c=new FCKToolbarButton("Radio",FCKLang.RadioButton,null,null,null,null,50);break;case"TextField":c=new FCKToolbarButton("TextField",FCKLang.TextField,null,null,null,null,51);break;case"Textarea":c=new FCKToolbarButton("Textarea",FCKLang.Textarea,null,null,null,null,52);break;case"HiddenField":c=new FCKToolbarButton("HiddenField",FCKLang.HiddenField,null,null,null,null,56);break;case"Button":c=new FCKToolbarButton("Button",FCKLang.Button,null,null,null,null,54);break;case"Select":c=new FCKToolbarButton("Select",FCKLang.SelectionField,null,null,null,null,53);break;case"ImageButton":c=new FCKToolbarButton("ImageButton",FCKLang.ImageButton,null,null,null,null,55);break;case"ShowBlocks":c=new FCKToolbarButton("ShowBlocks",FCKLang.ShowBlocks,null,null,null,true,72);break;case"SpellCheck":if(FCKConfig.SpellChecker=="SCAYT"){c=FCKScayt.CreateToolbarItem();}else{c=new FCKToolbarButton("SpellCheck",FCKLang.SpellCheck,null,null,null,null,13);}break;default:alert(FCKLang.UnknownToolbarItem.replace(/%1/g,d));return null;}FCKToolbarItems.LoadedItems[d]=c;return c;};var FCKToolbar=function(){this.Items=[];};FCKToolbar.prototype.AddItem=function(b){return this.Items[this.Items.length]=b;};FCKToolbar.prototype.AddButton=function(k,l,m,n,o,p){if(typeof(n)=="number"){n=[this.DefaultIconsStrip,this.DefaultIconSize,n];}var j=new FCKToolbarButtonUI(k,l,m,n,o,p);j._FCKToolbar=this;j.OnClick=FCKToolbar_OnItemClick;return this.AddItem(j);};function FCKToolbar_OnItemClick(d){var c=d._FCKToolbar;if(c.OnItemClick){c.OnItemClick(c,d);}}FCKToolbar.prototype.AddSeparator=function(){this.AddItem(new FCKToolbarSeparator());};FCKToolbar.prototype.Create=function(j){var k=FCKTools.GetElementDocument(j);var m=k.createElement("table");m.className="TB_Toolbar";m.style.styleFloat=m.style.cssFloat=(FCKLang.Dir=="ltr"?"left":"right");m.dir=FCKLang.Dir;m.cellPadding=0;m.cellSpacing=0;var l=m.insertRow(-1);var n;if(!this.HideStart){n=l.insertCell(-1);n.appendChild(k.createElement("div")).className="TB_Start";}for(var h=0;h<this.Items.length;h++){this.Items[h].Create(l.insertCell(-1));}if(!this.HideEnd){n=l.insertCell(-1);n.appendChild(k.createElement("div")).className="TB_End";}j.appendChild(m);};var FCKToolbarSeparator=function(){};FCKToolbarSeparator.prototype.Create=function(b){FCKTools.AppendElement(b,"div").className="TB_Separator";};var FCKToolbarBreak=function(){};FCKToolbarBreak.prototype.Create=function(d){var c=FCKTools.GetElementDocument(d).createElement("div");c.className="TB_Break";c.style.clear=FCKLang.Dir=="rtl"?"left":"right";d.appendChild(c);};function FCKToolbarSet_Create(A){var B;var C=A||FCKConfig.ToolbarLocation;switch(C){case"In":document.getElementById("xToolbarRow").style.display="";B=new FCKToolbarSet(document);break;case"None":B=new FCKToolbarSet(document);break;default:FCK.Events.AttachEvent("OnBlur",FCK_OnBlur);FCK.Events.AttachEvent("OnFocus",FCK_OnFocus);var D;var E=C.match(/^Out:(.+)\((\w+)\)$/);if(E){if(FCKBrowserInfo.IsAIR){FCKAdobeAIR.ToolbarSet_GetOutElement(window,E);}else{D=eval("parent."+E[1]).document.getElementById(E[2]);}}else{E=C.match(/^Out:(\w+)$/);if(E){D=parent.document.getElementById(E[1]);}}if(!D){alert('Invalid value for "ToolbarLocation"');return arguments.callee("In");}B=D.__FCKToolbarSet;if(B){break;}var F=FCKTools.GetElementDocument(D).createElement("iframe");F.src="javascript:void(0)";F.frameBorder=0;F.width="100%";F.height="10";D.appendChild(F);F.unselectable="on";var G=F.contentWindow.document;var H="";if(FCKBrowserInfo.IsSafari){H='<base href="'+window.document.location+'">';}G.open();G.write("<html><head>"+H+'<script type="text/javascript"> var adjust = function() { window.frameElement.height = document.body.scrollHeight ; }; window.onresize = window.onload = function(){var timer = null;var lastHeight = -1;var lastChange = 0;var poller = function(){var currentHeight = document.body.scrollHeight || 0;var currentTime = (new Date()).getTime();if (currentHeight != lastHeight){lastChange = currentTime;adjust();lastHeight = document.body.scrollHeight;}if (lastChange < currentTime - 1000) clearInterval(timer);};timer = setInterval(poller, 100);}<\/script></head><body style="overflow: hidden">'+document.getElementById("xToolbarSpace").innerHTML+"</body></html>");G.close();if(FCKBrowserInfo.IsAIR){FCKAdobeAIR.ToolbarSet_InitOutFrame(G);}FCKTools.AddEventListener(G,"contextmenu",FCKTools.CancelEvent);FCKTools.AppendStyleSheet(G,FCKConfig.SkinEditorCSS);B=D.__FCKToolbarSet=new FCKToolbarSet(G);B._IFrame=F;if(FCK.IECleanup){FCK.IECleanup.AddItem(D,FCKToolbarSet_Target_Cleanup);}}B.CurrentInstance=FCK;if(!B.ToolbarItems){B.ToolbarItems=FCKToolbarItems;}FCK.AttachToOnSelectionChange(B.RefreshItemsState);return B;}function FCK_OnBlur(d){var c=d.ToolbarSet;if(c.CurrentInstance==d){c.Disable();}}function FCK_OnFocus(f){var g=f.ToolbarSet;var d=f||FCK;g.CurrentInstance.FocusManager.RemoveWindow(g._IFrame.contentWindow);g.CurrentInstance=d;d.FocusManager.AddWindow(g._IFrame.contentWindow,true);g.Enable();}function FCKToolbarSet_Cleanup(){this._TargetElement=null;this._IFrame=null;}function FCKToolbarSet_Target_Cleanup(){this.__FCKToolbarSet=null;}var FCKToolbarSet=function(f){this._Document=f;this._TargetElement=f.getElementById("xToolbar");var g=f.getElementById("xExpandHandle");var d=f.getElementById("xCollapseHandle");g.title=FCKLang.ToolbarExpand;FCKTools.AddEventListener(g,"click",FCKToolbarSet_Expand_OnClick);d.title=FCKLang.ToolbarCollapse;FCKTools.AddEventListener(d,"click",FCKToolbarSet_Collapse_OnClick);if(!FCKConfig.ToolbarCanCollapse||FCKConfig.ToolbarStartExpanded){this.Expand();}else{this.Collapse();}d.style.display=FCKConfig.ToolbarCanCollapse?"":"none";if(FCKConfig.ToolbarCanCollapse){d.style.display="";}else{f.getElementById("xTBLeftBorder").style.display="";}this.Toolbars=[];this.IsLoaded=false;if(FCK.IECleanup){FCK.IECleanup.AddItem(this,FCKToolbarSet_Cleanup);}};function FCKToolbarSet_Expand_OnClick(){FCK.ToolbarSet.Expand();}function FCKToolbarSet_Collapse_OnClick(){FCK.ToolbarSet.Collapse();}FCKToolbarSet.prototype.Expand=function(){this._ChangeVisibility(false);};FCKToolbarSet.prototype.Collapse=function(){this._ChangeVisibility(true);};FCKToolbarSet.prototype._ChangeVisibility=function(b){this._Document.getElementById("xCollapsed").style.display=b?"":"none";this._Document.getElementById("xExpanded").style.display=b?"none":"";if(window.onresize){FCKTools.RunFunction(window.onresize);}};FCKToolbarSet.prototype.Load=function(j){this.Name=j;this.Items=[];this.ItemsWysiwygOnly=[];this.ItemsContextSensitive=[];this._TargetElement.innerHTML="";var m=FCKConfig.ToolbarSets[j];if(!m){alert(FCKLang.UnknownToolbarSet.replace(/%1/g,j));return;}this.Toolbars=[];for(var l=0;l<m.length;l++){var n=m[l];if(!n){continue;}var o;if(typeof(n)=="string"){if(n=="/"){o=new FCKToolbarBreak();}}else{o=new FCKToolbar();for(var r=0;r<n.length;r++){var p=n[r];if(p=="-"){o.AddSeparator();}else{var q=FCKToolbarItems.GetItem(p);if(q){o.AddItem(q);this.Items.push(q);if(!q.SourceView){this.ItemsWysiwygOnly.push(q);}if(q.ContextSensitive){this.ItemsContextSensitive.push(q);}}}}}o.Create(this._TargetElement);this.Toolbars[this.Toolbars.length]=o;}FCKTools.DisableSelection(this._Document.getElementById("xCollapseHandle").parentNode);if(FCK.Status!=2){FCK.Events.AttachEvent("OnStatusChange",this.RefreshModeState);}else{this.RefreshModeState();}this.IsLoaded=true;this.IsEnabled=true;FCKTools.RunFunction(this.OnLoad);};FCKToolbarSet.prototype.Enable=function(){if(this.IsEnabled){return;}this.IsEnabled=true;var d=this.Items;for(var c=0;c<d.length;c++){d[c].RefreshState();}};FCKToolbarSet.prototype.Disable=function(){if(!this.IsEnabled){return;}this.IsEnabled=false;var d=this.Items;for(var c=0;c<d.length;c++){d[c].Disable();}};FCKToolbarSet.prototype.RefreshModeState=function(h){if(FCK.Status!=2){return;}var j=h?h.ToolbarSet:this;var k=j.ItemsWysiwygOnly;if(FCK.EditMode==0){for(var l=0;l<k.length;l++){k[l].Enable();}j.RefreshItemsState(h);}else{j.RefreshItemsState(h);for(var g=0;g<k.length;g++){k[g].Disable();}}};FCKToolbarSet.prototype.RefreshItemsState=function(f){var g=(f?f.ToolbarSet:this).ItemsContextSensitive;for(var d=0;d<g.length;d++){g[d].RefreshState();}};var FCKDialog=(function(){var l;var m;var n;var o=window.parent;while(o.parent&&o.parent!=o){try{if(o.parent.document.domain!=document.domain){break;}if(o.parent.document.getElementsByTagName("frameset").length>0){break;}}catch(p){break;}o=o.parent;}var q=o.document;var r=function(){if(!m){m=FCKConfig.FloatingPanelsZIndex+999;}return ++m;};var k=function(){if(!n){return;}var a=FCKTools.IsStrictMode(q)?q.documentElement:q.body;FCKDomTools.SetElementStyles(n,{"width":Math.max(a.scrollWidth,a.clientWidth,q.scrollWidth||0)-1+"px","height":Math.max(a.scrollHeight,a.clientHeight,q.scrollHeight||0)-1+"px"});};return{OpenDialog:function(f,j,B,g,A,d,h){if(!l){this.DisplayMainCover();}var C={Title:j,Page:B,Editor:window,CustomValue:d,TopWindow:o};FCK.ToolbarSet.CurrentInstance.Selection.Save(true);var D=FCKTools.GetViewPaneSize(o);var E={"X":0,"Y":0};var F=FCKBrowserInfo.IsIE&&(!FCKBrowserInfo.IsIE7||!FCKTools.IsStrictMode(o.document));if(F){E=FCKTools.GetScrollPosition(o);}var a=Math.max(E.Y+(D.Height-A-20)/2,0);var b=Math.max(E.X+(D.Width-g-20)/2,0);var c=q.createElement("iframe");FCKTools.ResetStyles(c);c.src=FCKConfig.BasePath+"fckdialog.html";c.frameBorder=0;c.allowTransparency=true;FCKDomTools.SetElementStyles(c,{"position":(F)?"absolute":"fixed","top":a+"px","left":b+"px","width":g+"px","height":A+"px","zIndex":r()});c._DialogArguments=C;q.body.appendChild(c);c._ParentDialog=l;l=c;},OnDialogClose:function(a){var b=a.frameElement;FCKDomTools.RemoveNode(b);if(b._ParentDialog){l=b._ParentDialog;b._ParentDialog.contentWindow.SetEnabled(true);}else{if(!FCKBrowserInfo.IsIE){FCK.Focus();}this.HideMainCover();setTimeout(function(){l=null;},0);FCK.ToolbarSet.CurrentInstance.Selection.Release();}},DisplayMainCover:function(){n=q.createElement("div");FCKTools.ResetStyles(n);FCKDomTools.SetElementStyles(n,{"position":"absolute","zIndex":r(),"top":"0px","left":"0px","backgroundColor":FCKConfig.BackgroundBlockerColor});FCKDomTools.SetOpacity(n,FCKConfig.BackgroundBlockerOpacity);if(FCKBrowserInfo.IsIE&&!FCKBrowserInfo.IsIE7){var a=q.createElement("iframe");FCKTools.ResetStyles(a);a.hideFocus=true;a.frameBorder=0;a.src=FCKTools.GetVoidUrl();FCKDomTools.SetElementStyles(a,{"width":"100%","height":"100%","position":"absolute","left":"0px","top":"0px","filter":"progid:DXImageTransform.Microsoft.Alpha(opacity=0)"});n.appendChild(a);}FCKTools.AddEventListener(o,"resize",k);k();q.body.appendChild(n);FCKFocusManager.Lock();var b=FCK.ToolbarSet.CurrentInstance.GetInstanceObject("frameElement");b._fck_originalTabIndex=b.tabIndex;b.tabIndex=-1;},HideMainCover:function(){FCKDomTools.RemoveNode(n);FCKFocusManager.Unlock();var a=FCK.ToolbarSet.CurrentInstance.GetInstanceObject("frameElement");a.tabIndex=a._fck_originalTabIndex;FCKDomTools.ClearElementJSProperty(a,"_fck_originalTabIndex");},GetCover:function(){return n;}};})();var FCKMenuItem=function(j,k,l,m,n,h){this.Name=k;this.Label=l||k;this.IsDisabled=n;this.Icon=new FCKIcon(m);this.SubMenu=new FCKMenuBlockPanel();this.SubMenu.Parent=j;this.SubMenu.OnClick=FCKTools.CreateEventListener(FCKMenuItem_SubMenu_OnClick,this);this.CustomData=h;if(FCK.IECleanup){FCK.IECleanup.AddItem(this,FCKMenuItem_Cleanup);}};FCKMenuItem.prototype.AddItem=function(h,j,k,l,g){this.HasSubMenu=true;return this.SubMenu.AddItem(h,j,k,l,g);};FCKMenuItem.prototype.AddSeparator=function(){this.SubMenu.AddSeparator();};FCKMenuItem.prototype.Create=function(j){var k=this.HasSubMenu;var l=FCKTools.GetElementDocument(j);var h=this.MainElement=j.insertRow(-1);h.className=this.IsDisabled?"MN_Item_Disabled":"MN_Item";if(!this.IsDisabled){FCKTools.AddEventListenerEx(h,"mouseover",FCKMenuItem_OnMouseOver,[this]);FCKTools.AddEventListenerEx(h,"click",FCKMenuItem_OnClick,[this]);if(!k){FCKTools.AddEventListenerEx(h,"mouseout",FCKMenuItem_OnMouseOut,[this]);}}var m=h.insertCell(-1);m.className="MN_Icon";m.appendChild(this.Icon.CreateIconElement(l));m=h.insertCell(-1);m.className="MN_Label";m.noWrap=true;m.appendChild(l.createTextNode(this.Label));m=h.insertCell(-1);if(k){m.className="MN_Arrow";var n=m.appendChild(l.createElement("IMG"));n.src=FCK_IMAGES_PATH+"arrow_"+FCKLang.Dir+".gif";n.width=4;n.height=7;this.SubMenu.Create();this.SubMenu.Panel.OnHide=FCKTools.CreateEventListener(FCKMenuItem_SubMenu_OnHide,this);}};FCKMenuItem.prototype.Activate=function(){this.MainElement.className="MN_Item_Over";if(this.HasSubMenu){this.SubMenu.Show(this.MainElement.offsetWidth+2,-2,this.MainElement);}FCKTools.RunFunction(this.OnActivate,this);};FCKMenuItem.prototype.Deactivate=function(){this.MainElement.className="MN_Item";if(this.HasSubMenu){this.SubMenu.Hide();}};function FCKMenuItem_SubMenu_OnClick(d,c){FCKTools.RunFunction(c.OnClick,c,[d]);}function FCKMenuItem_SubMenu_OnHide(b){b.Deactivate();}function FCKMenuItem_OnClick(d,c){if(c.HasSubMenu){c.Activate();}else{c.Deactivate();FCKTools.RunFunction(c.OnClick,c,[c]);}}function FCKMenuItem_OnMouseOver(d,c){c.Activate();}function FCKMenuItem_OnMouseOut(d,c){c.Deactivate();}function FCKMenuItem_Cleanup(){this.MainElement=null;}var FCKMenuBlock=function(){this._Items=[];};FCKMenuBlock.prototype.Count=function(){return this._Items.length;};FCKMenuBlock.prototype.AddItem=function(j,k,l,m,n){var h=new FCKMenuItem(this,j,k,l,m,n);h.OnClick=FCKTools.CreateEventListener(FCKMenuBlock_Item_OnClick,this);h.OnActivate=FCKTools.CreateEventListener(FCKMenuBlock_Item_OnActivate,this);this._Items.push(h);return h;};FCKMenuBlock.prototype.AddSeparator=function(){this._Items.push(new FCKMenuSeparator());};FCKMenuBlock.prototype.RemoveAllItems=function(){this._Items=[];var b=this._ItemsTable;if(b){while(b.rows.length>0){b.deleteRow(0);}}};FCKMenuBlock.prototype.Create=function(j){if(!this._ItemsTable){if(FCK.IECleanup){FCK.IECleanup.AddItem(this,FCKMenuBlock_Cleanup);}this._Window=FCKTools.GetElementWindow(j);var k=FCKTools.GetElementDocument(j);var l=j.appendChild(k.createElement("table"));l.cellPadding=0;l.cellSpacing=0;FCKTools.DisableSelection(l);var m=l.insertRow(-1).insertCell(-1);m.className="MN_Menu";var n=this._ItemsTable=m.appendChild(k.createElement("table"));n.cellPadding=0;n.cellSpacing=0;}for(var h=0;h<this._Items.length;h++){this._Items[h].Create(this._ItemsTable);}};function FCKMenuBlock_Item_OnClick(d,c){if(c.Hide){c.Hide();}FCKTools.RunFunction(c.OnClick,c,[d]);}function FCKMenuBlock_Item_OnActivate(d){var c=d._ActiveItem;if(c&&c!=this){if(!FCKBrowserInfo.IsIE&&c.HasSubMenu&&!this.HasSubMenu){d._Window.focus();d.Panel.HasFocus=true;}c.Deactivate();}d._ActiveItem=this;}function FCKMenuBlock_Cleanup(){this._Window=null;this._ItemsTable=null;}var FCKMenuSeparator=function(){};FCKMenuSeparator.prototype.Create=function(g){var h=FCKTools.GetElementDocument(g);var f=g.insertRow(-1);var j=f.insertCell(-1);j.className="MN_Separator MN_Icon";j=f.insertCell(-1);j.className="MN_Separator";j.appendChild(h.createElement("DIV")).className="MN_Separator_Line";j=f.insertCell(-1);j.className="MN_Separator";j.appendChild(h.createElement("DIV")).className="MN_Separator_Line";};var FCKMenuBlockPanel=function(){FCKMenuBlock.call(this);};FCKMenuBlockPanel.prototype=new FCKMenuBlock();FCKMenuBlockPanel.prototype.Create=function(){var b=this.Panel=(this.Parent&&this.Parent.Panel?this.Parent.Panel.CreateChildPanel():new FCKPanel());b.AppendStyleSheet(FCKConfig.SkinEditorCSS);FCKMenuBlock.prototype.Create.call(this,b.MainNode);};FCKMenuBlockPanel.prototype.Show=function(d,g,f){if(!this.Panel.CheckIsOpened()){this.Panel.Show(d,g,f);}};FCKMenuBlockPanel.prototype.Hide=function(){if(this.Panel.CheckIsOpened()){this.Panel.Hide();}};var FCKContextMenu=function(g,h){this.CtrlDisable=false;var j=this._Panel=new FCKPanel(g);j.AppendStyleSheet(FCKConfig.SkinEditorCSS);j.IsContextMenu=true;if(FCKBrowserInfo.IsGecko){j.Document.addEventListener("draggesture",function(a){a.preventDefault();return false;},true);}var f=this._MenuBlock=new FCKMenuBlock();f.Panel=j;f.OnClick=FCKTools.CreateEventListener(FCKContextMenu_MenuBlock_OnClick,this);this._Redraw=true;};FCKContextMenu.prototype.SetMouseClickWindow=function(b){if(!FCKBrowserInfo.IsIE){this._Document=b.document;if(FCKBrowserInfo.IsOpera&&!("oncontextmenu" in document.createElement("foo"))){this._Document.addEventListener("mousedown",FCKContextMenu_Document_OnMouseDown,false);this._Document.addEventListener("mouseup",FCKContextMenu_Document_OnMouseUp,false);}this._Document.addEventListener("contextmenu",FCKContextMenu_Document_OnContextMenu,false);}};FCKContextMenu.prototype.AddItem=function(j,k,l,m,n){var h=this._MenuBlock.AddItem(j,k,l,m,n);this._Redraw=true;return h;};FCKContextMenu.prototype.AddSeparator=function(){this._MenuBlock.AddSeparator();this._Redraw=true;};FCKContextMenu.prototype.RemoveAllItems=function(){this._MenuBlock.RemoveAllItems();this._Redraw=true;};FCKContextMenu.prototype.AttachToElement=function(b){if(FCKBrowserInfo.IsIE){FCKTools.AddEventListenerEx(b,"contextmenu",FCKContextMenu_AttachedElement_OnContextMenu,this);}else{b._FCKContextMenu=this;}};function FCKContextMenu_Document_OnContextMenu(c){if(FCKConfig.BrowserContextMenu){return true;}var d=c.target;while(d){if(d._FCKContextMenu){if(d._FCKContextMenu.CtrlDisable&&(c.ctrlKey||c.metaKey)){return true;}FCKTools.CancelEvent(c);FCKContextMenu_AttachedElement_OnContextMenu(c,d._FCKContextMenu,d);return false;}d=d.parentNode;}return true;}var FCKContextMenu_OverrideButton;function FCKContextMenu_Document_OnMouseDown(l){if(!l||l.button!=2){return false;}if(FCKConfig.BrowserContextMenu){return true;}var h=l.target;while(h){if(h._FCKContextMenu){if(h._FCKContextMenu.CtrlDisable&&(l.ctrlKey||l.metaKey)){return true;}var j=FCKContextMenu_OverrideButton;if(!j){var k=FCKTools.GetElementDocument(l.target);j=FCKContextMenu_OverrideButton=k.createElement("input");j.type="button";var g=k.createElement("p");k.body.appendChild(g);g.appendChild(j);}j.style.cssText="position:absolute;top:"+(l.clientY-2)+"px;left:"+(l.clientX-2)+"px;width:5px;height:5px;opacity:0.01";}h=h.parentNode;}return false;}function FCKContextMenu_Document_OnMouseUp(d){if(FCKConfig.BrowserContextMenu){return true;}var f=FCKContextMenu_OverrideButton;if(f){var g=f.parentNode;g.parentNode.removeChild(g);FCKContextMenu_OverrideButton=undefined;if(d&&d.button==2){FCKContextMenu_Document_OnContextMenu(d);return false;}}return true;}function FCKContextMenu_AttachedElement_OnContextMenu(h,k,m){if((k.CtrlDisable&&(h.ctrlKey||h.metaKey))||FCKConfig.BrowserContextMenu){return true;}var n=m||this;if(k.OnBeforeOpen){k.OnBeforeOpen.call(k,n);}if(k._MenuBlock.Count()==0){return false;}if(k._Redraw){k._MenuBlock.Create(k._Panel.MainNode);k._Redraw=false;}FCKTools.DisableSelection(k._Panel.Document.body);var j=0;var l=0;if(FCKBrowserInfo.IsIE){j=h.screenX;l=h.screenY;}else{if(FCKBrowserInfo.IsSafari){j=h.clientX;l=h.clientY;}else{j=h.pageX;l=h.pageY;}}k._Panel.Show(j,l,h.currentTarget||null);return false;}function FCKContextMenu_MenuBlock_OnClick(d,c){c._Panel.Hide();FCKTools.RunFunction(c.OnItemClick,c,d);}FCK.ContextMenu={};FCK.ContextMenu.Listeners=[];FCK.ContextMenu.RegisterListener=function(b){if(b){this.Listeners.push(b);}};function FCK_ContextMenu_Init(){var f=FCK.ContextMenu._InnerContextMenu=new FCKContextMenu(FCKBrowserInfo.IsIE?window:window.parent,FCKLang.Dir);f.CtrlDisable=FCKConfig.BrowserContextMenuOnCtrl;f.OnBeforeOpen=FCK_ContextMenu_OnBeforeOpen;f.OnItemClick=FCK_ContextMenu_OnItemClick;var g=FCK.ContextMenu;for(var d=0;d<FCKConfig.ContextMenu.length;d++){g.RegisterListener(FCK_ContextMenu_GetListener(FCKConfig.ContextMenu[d]));}}function FCK_ContextMenu_GetListener(b){switch(b){case"Generic":return{AddItems:function(f,a,g){f.AddItem("Cut",FCKLang.Cut,7,FCKCommands.GetCommand("Cut").GetState()==-1);f.AddItem("Copy",FCKLang.Copy,8,FCKCommands.GetCommand("Copy").GetState()==-1);f.AddItem("Paste",FCKLang.Paste,9,FCKCommands.GetCommand("Paste").GetState()==-1);}};case"Table":return{AddItems:function(k,a,n){var j=(n=="TABLE");var l=(!j&&FCKSelection.HasAncestorNode("TABLE")&&!FCKSelection.IsGridNode());if(l){k.AddSeparator();var m=k.AddItem("Cell",FCKLang.CellCM);m.AddItem("TableInsertCellBefore",FCKLang.InsertCellBefore,69);m.AddItem("TableInsertCellAfter",FCKLang.InsertCellAfter,58);m.AddItem("TableDeleteCells",FCKLang.DeleteCells,59);if(FCKBrowserInfo.IsGecko){m.AddItem("TableMergeCells",FCKLang.MergeCells,60,FCKCommands.GetCommand("TableMergeCells").GetState()==-1);}else{m.AddItem("TableMergeRight",FCKLang.MergeRight,60,FCKCommands.GetCommand("TableMergeRight").GetState()==-1);m.AddItem("TableMergeDown",FCKLang.MergeDown,60,FCKCommands.GetCommand("TableMergeDown").GetState()==-1);}m.AddItem("TableHorizontalSplitCell",FCKLang.HorizontalSplitCell,61,FCKCommands.GetCommand("TableHorizontalSplitCell").GetState()==-1);m.AddItem("TableVerticalSplitCell",FCKLang.VerticalSplitCell,61,FCKCommands.GetCommand("TableVerticalSplitCell").GetState()==-1);m.AddSeparator();m.AddItem("TableCellProp",FCKLang.CellProperties,57,FCKCommands.GetCommand("TableCellProp").GetState()==-1);k.AddSeparator();m=k.AddItem("Row",FCKLang.RowCM);m.AddItem("TableInsertRowBefore",FCKLang.InsertRowBefore,70);m.AddItem("TableInsertRowAfter",FCKLang.InsertRowAfter,62);m.AddItem("TableDeleteRows",FCKLang.DeleteRows,63);k.AddSeparator();m=k.AddItem("Column",FCKLang.ColumnCM);m.AddItem("TableInsertColumnBefore",FCKLang.InsertColumnBefore,71);m.AddItem("TableInsertColumnAfter",FCKLang.InsertColumnAfter,64);m.AddItem("TableDeleteColumns",FCKLang.DeleteColumns,65);}if(j||l){k.AddSeparator();k.AddItem("TableDelete",FCKLang.TableDelete);k.AddItem("TableProp",FCKLang.TableProperties,39);}}};case"Link":return{AddItems:function(j,a,n){var k=(n=="A"||FCKSelection.HasAncestorNode("A"));if(k||FCK.GetNamedCommandState("Unlink")!=-1){var l=FCKSelection.MoveToAncestorNode("A");var m=(l&&l.name.length>0&&l.href.length==0);if(m){return;}j.AddSeparator();j.AddItem("VisitLink",FCKLang.VisitLink);j.AddSeparator();if(k){j.AddItem("Link",FCKLang.EditLink,34);}j.AddItem("Unlink",FCKLang.RemoveLink,35);}}};case"Image":return{AddItems:function(f,a,g){if(g=="IMG"&&!a.getAttribute("_fckfakelement")){f.AddSeparator();f.AddItem("Image",FCKLang.ImageProperties,37);}}};case"Anchor":return{AddItems:function(h,a,l){var j=FCKSelection.MoveToAncestorNode("A");var k=(j&&j.name.length>0);if(k||(l=="IMG"&&a.getAttribute("_fckanchor"))){h.AddSeparator();h.AddItem("Anchor",FCKLang.AnchorProp,36);h.AddItem("AnchorDelete",FCKLang.AnchorDelete);}}};case"Flash":return{AddItems:function(f,a,g){if(g=="IMG"&&a.getAttribute("_fckflash")){f.AddSeparator();f.AddItem("Flash",FCKLang.FlashProperties,38);}}};case"Form":return{AddItems:function(f,a,g){if(FCKSelection.HasAncestorNode("FORM")){f.AddSeparator();f.AddItem("Form",FCKLang.FormProp,48);}}};case"Checkbox":return{AddItems:function(f,a,g){if(g=="INPUT"&&a.type=="checkbox"){f.AddSeparator();f.AddItem("Checkbox",FCKLang.CheckboxProp,49);}}};case"Radio":return{AddItems:function(f,a,g){if(g=="INPUT"&&a.type=="radio"){f.AddSeparator();f.AddItem("Radio",FCKLang.RadioButtonProp,50);}}};case"TextField":return{AddItems:function(f,a,g){if(g=="INPUT"&&(a.type=="text"||a.type=="password")){f.AddSeparator();f.AddItem("TextField",FCKLang.TextFieldProp,51);}}};case"HiddenField":return{AddItems:function(f,a,g){if(g=="IMG"&&a.getAttribute("_fckinputhidden")){f.AddSeparator();f.AddItem("HiddenField",FCKLang.HiddenFieldProp,56);}}};case"ImageButton":return{AddItems:function(f,a,g){if(g=="INPUT"&&a.type=="image"){f.AddSeparator();f.AddItem("ImageButton",FCKLang.ImageButtonProp,55);}}};case"Button":return{AddItems:function(f,a,g){if(g=="INPUT"&&(a.type=="button"||a.type=="submit"||a.type=="reset")){f.AddSeparator();f.AddItem("Button",FCKLang.ButtonProp,54);}}};case"Select":return{AddItems:function(f,a,g){if(g=="SELECT"){f.AddSeparator();f.AddItem("Select",FCKLang.SelectionFieldProp,53);}}};case"Textarea":return{AddItems:function(f,a,g){if(g=="TEXTAREA"){f.AddSeparator();f.AddItem("Textarea",FCKLang.TextareaProp,52);}}};case"BulletedList":return{AddItems:function(f,a,g){if(FCKSelection.HasAncestorNode("UL")){f.AddSeparator();f.AddItem("BulletedList",FCKLang.BulletedListProp,27);}}};case"NumberedList":return{AddItems:function(f,a,g){if(FCKSelection.HasAncestorNode("OL")){f.AddSeparator();f.AddItem("NumberedList",FCKLang.NumberedListProp,26);}}};case"DivContainer":return{AddItems:function(g,a,h){var j=FCKDomTools.GetSelectedDivContainers();if(j.length>0){g.AddSeparator();g.AddItem("EditDiv",FCKLang.EditDiv,75);g.AddItem("DeleteDiv",FCKLang.DeleteDiv,76);}}};}return null;}function FCK_ContextMenu_OnBeforeOpen(){FCK.Events.FireEvent("OnSelectionChange");var h,g;if((h=FCKSelection.GetSelectedElement())){g=h.tagName;}var j=FCK.ContextMenu._InnerContextMenu;j.RemoveAllItems();var k=FCK.ContextMenu.Listeners;for(var l=0;l<k.length;l++){k[l].AddItems(j,h,g);}}function FCK_ContextMenu_OnItemClick(b){if(!FCKBrowserInfo.IsIE){FCK.Focus();}FCKCommands.GetCommand(b.Name).Execute(b.CustomData);}var FCKHtmlIterator=function(b){this._sourceHtml=b;};FCKHtmlIterator.prototype={Next:function(){var g=this._sourceHtml;if(g==null){return null;}var h=FCKRegexLib.HtmlTag.exec(g);var j=false;var f="";if(h){if(h.index>0){f=g.substr(0,h.index);this._sourceHtml=g.substr(h.index);}else{j=true;f=h[0];this._sourceHtml=g.substr(h[0].length);}}else{f=g;this._sourceHtml=null;}return{"isTag":j,"value":f};},Each:function(d){var c;while((c=this.Next())){d(c.isTag,c.value);}}};var FCKHtmlIterator=function(b){this._sourceHtml=b;};FCKHtmlIterator.prototype={Next:function(){var g=this._sourceHtml;if(g==null){return null;}var h=FCKRegexLib.HtmlTag.exec(g);var j=false;var f="";if(h){if(h.index>0){f=g.substr(0,h.index);this._sourceHtml=g.substr(h.index);}else{j=true;f=h[0];this._sourceHtml=g.substr(h[0].length);}}else{f=g;this._sourceHtml=null;}return{"isTag":j,"value":f};},Each:function(d){var c;while((c=this.Next())){d(c.isTag,c.value);}}};var FCKPlugin=function(f,g,d){this.Name=f;this.BasePath=d?d:FCKConfig.PluginsPath;this.Path=this.BasePath+f+"/";if(!g||g.length==0){this.AvailableLangs=[];}else{this.AvailableLangs=g.split(",");}};FCKPlugin.prototype.Load=function(){if(this.AvailableLangs.length>0){var b;if(this.AvailableLangs.IndexOf(FCKLanguageManager.ActiveLanguage.Code)>=0){b=FCKLanguageManager.ActiveLanguage.Code;}else{b=this.AvailableLangs[0];}LoadScript(this.Path+"lang/"+b+".js");}LoadScript(this.Path+"fckplugin.js");};var FCKPlugins=FCK.Plugins={};FCKPlugins.ItemsCount=0;FCKPlugins.Items={};FCKPlugins.Load=function(){var h=FCKPlugins.Items;for(var g=0;g<FCKConfig.Plugins.Items.length;g++){var j=FCKConfig.Plugins.Items[g];var k=h[j[0]]=new FCKPlugin(j[0],j[1],j[2]);FCKPlugins.ItemsCount++;}for(var l in h){h[l].Load();}FCKPlugins.Load=null;};