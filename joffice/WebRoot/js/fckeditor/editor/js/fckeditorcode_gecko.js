var FCK_STATUS_NOTLOADED=window.parent.FCK_STATUS_NOTLOADED=0;var FCK_STATUS_ACTIVE=window.parent.FCK_STATUS_ACTIVE=1;var FCK_STATUS_COMPLETE=window.parent.FCK_STATUS_COMPLETE=2;var FCK_TRISTATE_OFF=window.parent.FCK_TRISTATE_OFF=0;var FCK_TRISTATE_ON=window.parent.FCK_TRISTATE_ON=1;var FCK_TRISTATE_DISABLED=window.parent.FCK_TRISTATE_DISABLED=-1;var FCK_UNKNOWN=window.parent.FCK_UNKNOWN=-9;var FCK_TOOLBARITEM_ONLYICON=window.parent.FCK_TOOLBARITEM_ONLYICON=0;var FCK_TOOLBARITEM_ONLYTEXT=window.parent.FCK_TOOLBARITEM_ONLYTEXT=1;var FCK_TOOLBARITEM_ICONTEXT=window.parent.FCK_TOOLBARITEM_ICONTEXT=2;var FCK_EDITMODE_WYSIWYG=window.parent.FCK_EDITMODE_WYSIWYG=0;var FCK_EDITMODE_SOURCE=window.parent.FCK_EDITMODE_SOURCE=1;var FCK_IMAGES_PATH="images/";var FCK_SPACER_PATH="images/spacer.gif";var CTRL=1000;var SHIFT=2000;var ALT=4000;var FCK_STYLE_BLOCK=0;var FCK_STYLE_INLINE=1;var FCK_STYLE_OBJECT=2;String.prototype.Contains=function(b){return(this.indexOf(b)>-1);};String.prototype.Equals=function(){var d=arguments;if(d.length==1&&d[0].pop){d=d[0];}for(var c=0;c<d.length;c++){if(this==d[c]){return true;}}return false;};String.prototype.IEquals=function(){var f=this.toUpperCase();var g=arguments;if(g.length==1&&g[0].pop){g=g[0];}for(var d=0;d<g.length;d++){if(f==g[d].toUpperCase()){return true;}}return false;};String.prototype.ReplaceAll=function(g,h){var i=this;for(var f=0;f<g.length;f++){i=i.replace(g[f],h[f]);}return i;};String.prototype.StartsWith=function(b){return(this.substr(0,b.length)==b);};String.prototype.EndsWith=function(h,i){var j=this.length;var k=h.length;if(k>j){return false;}if(i){var g=new RegExp(h+"$","i");return g.test(this);}else{return(k==0||this.substr(j-k,k)==h);}};String.prototype.Remove=function(f,g){var d="";if(f>0){d=this.substring(0,f);}if(f+g<this.length){d+=this.substring(f+g,this.length);}return d;};String.prototype.Trim=function(){return this.replace(/(^[ \t\n\r]*)|([ \t\n\r]*$)/g,"");};String.prototype.LTrim=function(){return this.replace(/^[ \t\n\r]*/g,"");};String.prototype.RTrim=function(){return this.replace(/[ \t\n\r]*$/g,"");};String.prototype.ReplaceNewLineChars=function(b){return this.replace(/\n/g,b);};String.prototype.Replace=function(f,g,d){if(typeof g=="function"){return this.replace(f,function(){return g.apply(d||this,arguments);});}else{return this.replace(f,g);}};Array.prototype.IndexOf=function(d){for(var c=0;c<this.length;c++){if(this[c]==d){return c;}}return -1;};var s=navigator.userAgent.toLowerCase();var FCKBrowserInfo={IsIE:
/*@cc_on!@*/
false,IsIE7:
/*@cc_on!@*/
false&&(parseInt(s.match(/msie (\d+)/)[1],10)>=7),IsIE6:
/*@cc_on!@*/
false&&(parseInt(s.match(/msie (\d+)/)[1],10)>=6),IsSafari:s.Contains(" applewebkit/"),IsOpera:!!window.opera,IsAIR:s.Contains(" adobeair/"),IsMac:s.Contains("macintosh")};(function(f){f.IsGecko=(navigator.product=="Gecko")&&!f.IsSafari&&!f.IsOpera;f.IsGeckoLike=(f.IsGecko||f.IsSafari||f.IsOpera);if(f.IsGecko){var g=s.match(/rv:(\d+\.\d+)/);var d=g&&parseFloat(g[1]);if(d){f.IsGecko10=(d<1.8);f.IsGecko19=(d>1.8);}}if(f.IsSafari){f.IsSafari3=(parseFloat(s.match(/ applewebkit\/(\d+)/)[1])<526);}})(FCKBrowserInfo);var FCKURLParams={};(function(){var h=document.location.search.substr(1).split("&");for(var g=0;g<h.length;g++){var i=h[g].split("=");var j=decodeURIComponent(i[0]);var k=decodeURIComponent(i[1]);FCKURLParams[j]=k;}})();var FCKEvents=function(b){this.Owner=b;this._RegisteredEvents={};};FCKEvents.prototype.AttachEvent=function(f,g){var d;if(!(d=this._RegisteredEvents[f])){this._RegisteredEvents[f]=[g];}else{if(d.IndexOf(g)==-1){d.push(g);}}};FCKEvents.prototype.FireEvent=function(i,j){var k=true;var l=this._RegisteredEvents[i];if(l){for(var h=0;h<l.length;h++){try{k=(l[h](this.Owner,j)&&k);}catch(m){if(m.number!=-2146823277){throw m;}}}}return k;};var FCKDataProcessor=function(){};FCKDataProcessor.prototype={ConvertToHtml:function(d){if(FCKConfig.FullPage){FCK.DocTypeDeclaration=d.match(FCKRegexLib.DocTypeTag);if(!FCKRegexLib.HasBodyTag.test(d)){d="<body>"+d+"</body>";}if(!FCKRegexLib.HtmlOpener.test(d)){d='<html dir="'+FCKConfig.ContentLangDirection+'">'+d+"</html>";}if(!FCKRegexLib.HeadOpener.test(d)){d=d.replace(FCKRegexLib.HtmlOpener,"$&<head><title></title></head>");}return d;}else{var c=FCKConfig.DocType+'<html dir="'+FCKConfig.ContentLangDirection+'"';if(FCKBrowserInfo.IsIE&&FCKConfig.DocType.length>0&&!FCKRegexLib.Html4DocType.test(FCKConfig.DocType)){c+=' style="overflow-y: scroll"';}c+="><head><title></title></head><body"+FCKConfig.GetBodyAttributes()+">"+d+"</body></html>";return c;}},ConvertToDataFormat:function(h,i,j,k){var g=FCKXHtml.GetXHTML(h,!i,k);if(j&&FCKRegexLib.EmptyOutParagraph.test(g)){return"";}return g;},FixHtml:function(b){return b;}};var FCK={Name:FCKURLParams["InstanceName"],Status:0,EditMode:0,Toolbar:null,HasFocus:false,DataProcessor:new FCKDataProcessor(),GetInstanceObject:(function(){var b=window;return function(a){return b[a];};})(),AttachToOnSelectionChange:function(b){this.Events.AttachEvent("OnSelectionChange",b);},GetLinkedFieldValue:function(){return this.LinkedField.value;},GetParentForm:function(){return this.LinkedField.form;},StartupValue:"",IsDirty:function(){if(this.EditMode==1){return(this.StartupValue!=this.EditingArea.Textarea.value);}else{if(!this.EditorDocument){return false;}return(this.StartupValue!=this.EditorDocument.body.innerHTML);}},ResetIsDirty:function(){if(this.EditMode==1){this.StartupValue=this.EditingArea.Textarea.value;}else{if(this.EditorDocument.body){this.StartupValue=this.EditorDocument.body.innerHTML;}}},StartEditor:function(){this.TempBaseTag=FCKConfig.BaseHref.length>0?'<base href="'+FCKConfig.BaseHref+'" _fcktemp="true"></base>':"";var b=FCK.KeystrokeHandler=new FCKKeystrokeHandler();b.OnKeystroke=_FCK_KeystrokeHandler_OnKeystroke;b.SetKeystrokes(FCKConfig.Keystrokes);if(FCKBrowserInfo.IsIE7){if((CTRL+86) in b.Keystrokes){b.SetKeystrokes([CTRL+86,true]);}if((SHIFT+45) in b.Keystrokes){b.SetKeystrokes([SHIFT+45,true]);}}b.SetKeystrokes([CTRL+8,true]);this.EditingArea=new FCKEditingArea(document.getElementById("xEditingArea"));this.EditingArea.FFSpellChecker=FCKConfig.FirefoxSpellChecker;this.SetData(this.GetLinkedFieldValue(),true);FCKTools.AddEventListener(document,"keydown",this._TabKeyHandler);this.AttachToOnSelectionChange(_FCK_PaddingNodeListener);if(FCKBrowserInfo.IsGecko){this.AttachToOnSelectionChange(this._ExecCheckEmptyBlock);}},Focus:function(){FCK.EditingArea.Focus();},SetStatus:function(b){this.Status=b;if(b==1){FCKFocusManager.AddWindow(window,true);if(FCKBrowserInfo.IsIE){FCKFocusManager.AddWindow(window.frameElement,true);}if(FCKConfig.StartupFocus){FCK.Focus();}}this.Events.FireEvent("OnStatusChange",b);},FixBody:function(){var k=FCKConfig.EnterMode;if(k!="p"&&k!="div"){return;}var l=this.EditorDocument;if(!l){return;}var m=l.body;if(!m){return;}FCKDomTools.TrimNode(m);var n=m.firstChild;var o;while(n){var p=false;switch(n.nodeType){case 1:var q=n.nodeName.toLowerCase();if(!FCKListsLib.BlockElements[q]&&q!="li"&&!n.getAttribute("_fckfakelement")&&n.getAttribute("_moz_dirty")==null){p=true;}break;case 3:if(o||n.nodeValue.Trim().length>0){p=true;}break;case 8:if(o){p=true;}break;}if(p){var j=n.parentNode;if(!o){o=j.insertBefore(l.createElement(k),n);}o.appendChild(j.removeChild(n));n=o.nextSibling;}else{if(o){FCKDomTools.TrimNode(o);o=null;}n=n.nextSibling;}}if(o){FCKDomTools.TrimNode(o);}},GetData:function(g){FCK.Events.FireEvent("OnBeforeGetData");if(FCK.EditMode==1){return FCK.EditingArea.Textarea.value;}this.FixBody();var h=FCK.EditorDocument;if(!h){return null;}var i=FCKConfig.FullPage;var f=FCK.DataProcessor.ConvertToDataFormat(i?h.documentElement:h.body,!i,FCKConfig.IgnoreEmptyParagraphValue,g);f=FCK.ProtectEventsRestore(f);if(FCKBrowserInfo.IsIE){f=f.replace(FCKRegexLib.ToReplace,"$1");}if(i){if(FCK.DocTypeDeclaration&&FCK.DocTypeDeclaration.length>0){f=FCK.DocTypeDeclaration+"\n"+f;}if(FCK.XmlDeclaration&&FCK.XmlDeclaration.length>0){f=FCK.XmlDeclaration+"\n"+f;}}f=FCKConfig.ProtectedSource.Revert(f);setTimeout(function(){FCK.Events.FireEvent("OnAfterGetData");},0);return f;},UpdateLinkedField:function(){var b=FCK.GetXHTML(FCKConfig.FormatOutput);if(FCKConfig.HtmlEncodeOutput){b=FCKTools.HTMLEncode(b);}FCK.LinkedField.value=b;FCK.Events.FireEvent("OnAfterLinkedFieldUpdate");},RegisteredDoubleClickHandlers:{},OnDoubleClick:function(f){var g=FCK.RegisteredDoubleClickHandlers[f.tagName.toUpperCase()];if(g){for(var d=0;d<g.length;d++){g[d](f);}}g=FCK.RegisteredDoubleClickHandlers["*"];if(g){for(var d=0;d<g.length;d++){g[d](f);}}},RegisterDoubleClickHandler:function(g,h){var i=h||"*";i=i.toUpperCase();var f;if(!(f=FCK.RegisteredDoubleClickHandlers[i])){FCK.RegisteredDoubleClickHandlers[i]=[g];}else{if(f.IndexOf(g)==-1){f.push(g);}}},OnAfterSetHTML:function(){FCKDocumentProcessor.Process(FCK.EditorDocument);FCKUndo.SaveUndoStep();FCK.Events.FireEvent("OnSelectionChange");FCK.Events.FireEvent("OnAfterSetHTML");},ProtectUrls:function(b){b=b.replace(FCKRegexLib.ProtectUrlsA,"$& _fcksavedurl=$1");b=b.replace(FCKRegexLib.ProtectUrlsImg,"$& _fcksavedurl=$1");b=b.replace(FCKRegexLib.ProtectUrlsArea,"$& _fcksavedurl=$1");return b;},ProtectEvents:function(b){return b.replace(FCKRegexLib.TagsWithEvent,_FCK_ProtectEvents_ReplaceTags);},ProtectEventsRestore:function(b){return b.replace(FCKRegexLib.ProtectedEvents,_FCK_ProtectEvents_RestoreEvents);},ProtectTags:function(f){var g=FCKConfig.ProtectedTags;if(FCKBrowserInfo.IsIE){g+=g.length>0?"|ABBR|XML|EMBED|OBJECT":"ABBR|XML|EMBED|OBJECT";}var d;if(g.length>0){d=new RegExp("<("+g+")(?!w|:)","gi");f=f.replace(d,"<FCK:$1");d=new RegExp("</("+g+")>","gi");f=f.replace(d,"</FCK:$1>");}g="META";if(FCKBrowserInfo.IsIE){g+="|HR";}d=new RegExp("<(("+g+")(?=\\s|>|/)[\\s\\S]*?)/?>","gi");f=f.replace(d,"<FCK:$1 />");return f;},SetData:function(f,g){this.EditingArea.Mode=FCK.EditMode;if(FCKBrowserInfo.IsIE&&FCK.EditorDocument){FCK.EditorDocument.detachEvent("onselectionchange",Doc_OnSelectionChange);}FCKTempBin.Reset();FCK.Selection.Release();if(FCK.EditMode==0){this._ForceResetIsDirty=(g===true);f=FCKConfig.ProtectedSource.Protect(f);f=FCK.DataProcessor.ConvertToHtml(f);f=f.replace(FCKRegexLib.InvalidSelfCloseTags,"$1></$2>");f=FCK.ProtectEvents(f);f=FCK.ProtectUrls(f);f=FCK.ProtectTags(f);if(FCK.TempBaseTag.length>0&&!FCKRegexLib.HasBaseTag.test(f)){f=f.replace(FCKRegexLib.HeadOpener,"$&"+FCK.TempBaseTag);}var d="";if(!FCKConfig.FullPage){d+=_FCK_GetEditorAreaStyleTags();}if(FCKBrowserInfo.IsIE){d+=FCK._GetBehaviorsStyle();}else{if(FCKConfig.ShowBorders){d+=FCKTools.GetStyleHtml(FCK_ShowTableBordersCSS,true);}}d+=FCKTools.GetStyleHtml(FCK_InternalCSS,true);f=f.replace(FCKRegexLib.HeadCloser,d+"$&");this.EditingArea.OnLoad=_FCK_EditingArea_OnLoad;this.EditingArea.Start(f);}else{FCK.EditorWindow=null;FCK.EditorDocument=null;FCKDomTools.PaddingNode=null;this.EditingArea.OnLoad=null;this.EditingArea.Start(f);this.EditingArea.Textarea._FCKShowContextMenu=true;FCK.EnterKeyHandler=null;if(g){this.ResetIsDirty();}FCK.KeystrokeHandler.AttachToElement(this.EditingArea.Textarea);this.EditingArea.Textarea.focus();FCK.Events.FireEvent("OnAfterSetHTML");}if(window.onresize){window.onresize();}},RedirectNamedCommands:{},ExecuteNamedCommand:function(g,h,i,f){if(!f){FCKUndo.SaveUndoStep();}if(!i&&FCK.RedirectNamedCommands[g]!=null){FCK.ExecuteRedirectedNamedCommand(g,h);}else{FCK.Focus();FCK.EditorDocument.execCommand(g,false,h);FCK.Events.FireEvent("OnSelectionChange");}if(!f){FCKUndo.SaveUndoStep();}},GetNamedCommandState:function(d){try{if(FCKBrowserInfo.IsSafari&&FCK.EditorWindow&&d.IEquals("Paste")){return 0;}if(!FCK.EditorDocument.queryCommandEnabled(d)){return -1;}else{return FCK.EditorDocument.queryCommandState(d)?1:0;}}catch(c){return 0;}},GetNamedCommandValue:function(g){var h="";var i=FCK.GetNamedCommandState(g);if(i==-1){return null;}try{h=this.EditorDocument.queryCommandValue(g);}catch(f){}return h?h:"";},Paste:function(b){if(FCK.Status!=2||!FCK.Events.FireEvent("OnPaste")){return false;}return b||FCK._ExecPaste();},PasteFromWord:function(){FCKDialog.OpenDialog("FCKDialog_Paste",FCKLang.PasteFromWord,"dialog/fck_paste.html",400,330,"Word");},Preview:function(){var i;if(FCKConfig.FullPage){if(FCK.TempBaseTag.length>0){i=FCK.TempBaseTag+FCK.GetXHTML();}else{i=FCK.GetXHTML();}}else{i=FCKConfig.DocType+'<html dir="'+FCKConfig.ContentLangDirection+'"><head>'+FCK.TempBaseTag+"<title>"+FCKLang.Preview+"</title>"+_FCK_GetEditorAreaStyleTags()+"</head><body"+FCKConfig.GetBodyAttributes()+">"+FCK.GetXHTML()+"</body></html>";}var j=FCKConfig.ScreenWidth*0.8;var k=FCKConfig.ScreenHeight*0.7;var l=(FCKConfig.ScreenWidth-j)/2;var m="";if(FCK_IS_CUSTOM_DOMAIN&&FCKBrowserInfo.IsIE){window._FCKHtmlToLoad=i;m='javascript:void( (function(){document.open() ;document.domain="'+document.domain+'" ;document.write( window.opener._FCKHtmlToLoad );document.close() ;window.opener._FCKHtmlToLoad = null ;})() )';}var h=window.open(m,null,"toolbar=yes,location=no,status=yes,menubar=yes,scrollbars=yes,resizable=yes,width="+j+",height="+k+",left="+l);if(!FCK_IS_CUSTOM_DOMAIN||!FCKBrowserInfo.IsIE){h.document.write(i);h.document.close();}},SwitchEditMode:function(g){var h=(FCK.EditMode==0);var i=FCK.IsDirty();var f;if(h){FCKCommands.GetCommand("ShowBlocks").SaveState();if(!g&&FCKBrowserInfo.IsIE){FCKUndo.SaveUndoStep();}f=FCK.GetXHTML(FCKConfig.FormatSource);if(FCKBrowserInfo.IsIE){FCKTempBin.ToHtml();}if(f==null){return false;}}else{f=this.EditingArea.Textarea.value;}FCK.EditMode=h?1:0;FCK.SetData(f,!i);FCK.Focus();FCKTools.RunFunction(FCK.ToolbarSet.RefreshModeState,FCK.ToolbarSet);return true;},InsertElement:function(g){if(typeof g=="string"){g=this.EditorDocument.createElement(g);}var h=g.nodeName.toLowerCase();FCKSelection.Restore();var i=new FCKDomRange(this.EditorWindow);i.MoveToSelection();i.DeleteContents();if(FCKListsLib.BlockElements[h]!=null){if(i.StartBlock){if(i.CheckStartOfBlock()){i.MoveToPosition(i.StartBlock,3);}else{if(i.CheckEndOfBlock()){i.MoveToPosition(i.StartBlock,4);}else{i.SplitBlock();}}}i.InsertNode(g);var f=FCKDomTools.GetNextSourceElement(g,false,null,["hr","br","param","img","area","input"],true);if(!f&&FCKConfig.EnterMode!="br"){f=this.EditorDocument.body.appendChild(this.EditorDocument.createElement(FCKConfig.EnterMode));if(FCKBrowserInfo.IsGeckoLike){FCKTools.AppendBogusBr(f);}}if(FCKListsLib.EmptyElements[h]==null){i.MoveToElementEditStart(g);}else{if(f){i.MoveToElementEditStart(f);}else{i.MoveToPosition(g,4);}}if(FCKBrowserInfo.IsGeckoLike){if(f){FCKDomTools.ScrollIntoView(f,false);}FCKDomTools.ScrollIntoView(g,false);}}else{i.InsertNode(g);i.SetStart(g,4);i.SetEnd(g,4);}i.Select();i.Release();this.Focus();return g;},_InsertBlockElement:function(b){},_IsFunctionKey:function(b){if(b>=16&&b<=20){return true;}if(b==27||(b>=33&&b<=40)){return true;}if(b==45){return true;}return false;},_KeyDownListener:function(b){if(!b){b=FCK.EditorWindow.event;}if(FCK.EditorWindow){if(!FCK._IsFunctionKey(b.keyCode)&&!(b.ctrlKey||b.metaKey)&&!(b.keyCode==46)){FCK._KeyDownUndo();}}return true;},_KeyDownUndo:function(){if(!FCKUndo.Typing){FCKUndo.SaveUndoStep();FCKUndo.Typing=true;FCK.Events.FireEvent("OnSelectionChange");}FCKUndo.TypesCount++;FCKUndo.Changed=1;if(FCKUndo.TypesCount>FCKUndo.MaxTypes){FCKUndo.TypesCount=0;FCKUndo.SaveUndoStep();}},_TabKeyHandler:function(a){if(!a){a=window.event;}var j=a.keyCode;if(j==9&&FCK.EditMode!=0){if(FCKBrowserInfo.IsIE){var k=document.selection.createRange();if(k.parentElement()!=FCK.EditingArea.Textarea){return true;}k.text="\t";k.select();}else{var o=[];var l=FCK.EditingArea.Textarea;var m=l.selectionStart;var n=l.selectionEnd;o.push(l.value.substr(0,m));o.push("\t");o.push(l.value.substr(n));l.value=o.join("");l.setSelectionRange(m+1,m+1);}if(a.preventDefault){return a.preventDefault();}return a.returnValue=false;}return true;}};FCK.Events=new FCKEvents(FCK);FCK.GetHTML=FCK.GetXHTML=FCK.GetData;FCK.SetHTML=FCK.SetData;FCK.InsertElementAndGetIt=FCK.CreateElement=FCK.InsertElement;function _FCK_ProtectEvents_ReplaceTags(b){return b.replace(FCKRegexLib.EventAttributes,_FCK_ProtectEvents_ReplaceEvents);}function _FCK_ProtectEvents_ReplaceEvents(d,c){return" "+c+'_fckprotectedatt="'+encodeURIComponent(d)+'"';}function _FCK_ProtectEvents_RestoreEvents(d,c){return decodeURIComponent(c);}function _FCK_MouseEventsListener(b){if(!b){b=window.event;}if(b.type=="mousedown"){FCK.MouseDownFlag=true;}else{if(b.type=="mouseup"){FCK.MouseDownFlag=false;}else{if(b.type=="mousemove"){FCK.Events.FireEvent("OnMouseMove",b);}}}}function _FCK_PaddingNodeListener(){if(FCKConfig.EnterMode.IEquals("br")){return;}FCKDomTools.EnforcePaddingNode(FCK.EditorDocument,FCKConfig.EnterMode);if(!FCKBrowserInfo.IsIE&&FCKDomTools.PaddingNode){var h=FCKSelection.GetSelection();if(h&&h.rangeCount==1){var i=h.getRangeAt(0);if(i.collapsed&&i.startContainer==FCK.EditorDocument.body&&i.startOffset==0){i.selectNodeContents(FCKDomTools.PaddingNode);i.collapse(true);h.removeAllRanges();h.addRange(i);}}}else{if(FCKDomTools.PaddingNode){var j=FCKSelection.GetParentElement();var k=FCKDomTools.PaddingNode;if(j&&j.nodeName.IEquals("body")){if(FCK.EditorDocument.body.childNodes.length==1&&FCK.EditorDocument.body.firstChild==k){if(FCKSelection._GetSelectionDocument(FCK.EditorDocument.selection)!=FCK.EditorDocument){return;}var i=FCK.EditorDocument.body.createTextRange();var g=false;if(!k.childNodes.firstChild){k.appendChild(FCKTools.GetElementDocument(k).createTextNode("\ufeff"));g=true;}i.moveToElementText(k);i.select();if(g){i.pasteHTML("");}}}}}}function _FCK_EditingArea_OnLoad(){FCK.EditorWindow=FCK.EditingArea.Window;FCK.EditorDocument=FCK.EditingArea.Document;if(FCKBrowserInfo.IsIE){FCKTempBin.ToElements();}FCK.InitializeBehaviors();FCK.MouseDownFlag=false;FCKTools.AddEventListener(FCK.EditorDocument,"mousemove",_FCK_MouseEventsListener);FCKTools.AddEventListener(FCK.EditorDocument,"mousedown",_FCK_MouseEventsListener);FCKTools.AddEventListener(FCK.EditorDocument,"mouseup",_FCK_MouseEventsListener);if(FCKBrowserInfo.IsSafari){FCKTools.AddEventListener(FCK.EditorDocument,"paste",function(i){var a=new FCKDomRange(FCK.EditorWindow);var g=FCK.EditorDocument.createTextNode("\ufeff");var h=FCK.EditorDocument.createElement("a");h.id="fck_paste_padding";h.innerHTML="&#65279;";a.MoveToSelection();a.DeleteContents();a.InsertNode(g);a.Collapse();a.InsertNode(h);a.MoveToPosition(h,3);a.Select();setTimeout(function(){g.parentNode.removeChild(g);h=FCK.EditorDocument.getElementById("fck_paste_padding");h.parentNode.removeChild(h);},0);});}if(FCKBrowserInfo.IsSafari){var b=function(a){if(!(a.ctrlKey||a.metaKey)){return;}if(FCK.EditMode!=0){return;}switch(a.keyCode){case 89:FCKUndo.Redo();break;case 90:FCKUndo.Undo();break;}};FCKTools.AddEventListener(FCK.EditorDocument,"keyup",b);}FCK.EnterKeyHandler=new FCKEnterKey(FCK.EditorWindow,FCKConfig.EnterMode,FCKConfig.ShiftEnterMode,FCKConfig.TabSpaces);FCK.KeystrokeHandler.AttachToElement(FCK.EditorDocument);if(FCK._ForceResetIsDirty){FCK.ResetIsDirty();}if(FCKBrowserInfo.IsIE&&FCK.HasFocus){FCK.EditorDocument.body.setActive();}FCK.OnAfterSetHTML();FCKCommands.GetCommand("ShowBlocks").RestoreState();if(FCK.Status!=0){return;}FCK.SetStatus(1);}function _FCK_GetEditorAreaStyleTags(){return FCKTools.GetStyleHtml(FCKConfig.EditorAreaCSS)+FCKTools.GetStyleHtml(FCKConfig.EditorAreaStyles);}function _FCK_KeystrokeHandler_OnKeystroke(f,g){if(FCK.Status!=2){return false;}if(FCK.EditMode==0){switch(g){case"Paste":return !FCK.Paste();case"Cut":FCKUndo.SaveUndoStep();return false;}}else{if(g.Equals("Paste","Undo","Redo","SelectAll","Cut")){return false;}}var d=FCK.Commands.GetCommand(g);if(d.GetState()==-1){return false;}return(d.Execute.apply(d,FCKTools.ArgumentsToArray(arguments,2))!==false);}(function(){var f=window.parent.document;var g=f.getElementById(FCK.Name);var d=0;while(g||d==0){if(g&&g.tagName.toLowerCase().Equals("input","textarea")){FCK.LinkedField=g;break;}g=f.getElementsByName(FCK.Name)[d++];}})();var FCKTempBin={Elements:[],AddElement:function(d){var c=this.Elements.length;this.Elements[c]=d;return c;},RemoveElement:function(d){var c=this.Elements[d];this.Elements[d]=null;return c;},Reset:function(){var b=0;while(b<this.Elements.length){this.Elements[b++]=null;}this.Elements.length=0;},ToHtml:function(){for(var b=0;b<this.Elements.length;b++){this.Elements[b]="<div>&nbsp;"+this.Elements[b].outerHTML+"</div>";this.Elements[b].isHtml=true;}},ToElements:function(){var d=FCK.EditorDocument.createElement("div");for(var c=0;c<this.Elements.length;c++){if(this.Elements[c].isHtml){d.innerHTML=this.Elements[c];this.Elements[c]=d.firstChild.removeChild(d.firstChild.lastChild);}}}};var FCKFocusManager=FCK.FocusManager={IsLocked:false,AddWindow:function(f,g){var d;if(FCKBrowserInfo.IsIE){d=f.nodeType==1?f:f.frameElement?f.frameElement:f.document;}else{if(FCKBrowserInfo.IsSafari){d=f;}else{d=f.document;}}FCKTools.AddEventListener(d,"blur",FCKFocusManager_Win_OnBlur);FCKTools.AddEventListener(d,"focus",g?FCKFocusManager_Win_OnFocus_Area:FCKFocusManager_Win_OnFocus);},RemoveWindow:function(b){if(FCKBrowserInfo.IsIE){oTarget=b.nodeType==1?b:b.frameElement?b.frameElement:b.document;}else{oTarget=b.document;}FCKTools.RemoveEventListener(oTarget,"blur",FCKFocusManager_Win_OnBlur);FCKTools.RemoveEventListener(oTarget,"focus",FCKFocusManager_Win_OnFocus_Area);FCKTools.RemoveEventListener(oTarget,"focus",FCKFocusManager_Win_OnFocus);},Lock:function(){this.IsLocked=true;},Unlock:function(){if(this._HasPendingBlur){FCKFocusManager._Timer=window.setTimeout(FCKFocusManager_FireOnBlur,100);}this.IsLocked=false;},_ResetTimer:function(){this._HasPendingBlur=false;if(this._Timer){window.clearTimeout(this._Timer);delete this._Timer;}}};function FCKFocusManager_Win_OnBlur(){if(typeof(FCK)!="undefined"&&FCK.HasFocus){FCKFocusManager._ResetTimer();FCKFocusManager._Timer=window.setTimeout(FCKFocusManager_FireOnBlur,100);}}function FCKFocusManager_FireOnBlur(){if(FCKFocusManager.IsLocked){FCKFocusManager._HasPendingBlur=true;}else{FCK.HasFocus=false;FCK.Events.FireEvent("OnBlur");}}function FCKFocusManager_Win_OnFocus_Area(){if(FCKFocusManager._IsFocusing){return;}FCKFocusManager._IsFocusing=true;FCK.Focus();FCKFocusManager_Win_OnFocus();FCKTools.RunFunction(function(){delete FCKFocusManager._IsFocusing;});}function FCKFocusManager_Win_OnFocus(){FCKFocusManager._ResetTimer();if(!FCK.HasFocus&&!FCKFocusManager.IsLocked){FCK.HasFocus=true;FCK.Events.FireEvent("OnFocus");}}(function(){var g=window.frameElement;var h=g.width;var i=g.height;if(/^\d+$/.test(h)){h+="px";}if(/^\d+$/.test(i)){i+="px";}var f=g.style;f.border=f.padding=f.margin=0;f.backgroundColor="transparent";f.backgroundImage="none";f.width=h;f.height=i;})();FCK.Description="FCKeditor for Gecko Browsers";FCK.InitializeBehaviors=function(){if(window.onresize){window.onresize();}FCKFocusManager.AddWindow(this.EditorWindow);this.ExecOnSelectionChange=function(){FCK.Events.FireEvent("OnSelectionChange");};this._ExecDrop=function(c){if(FCK.MouseDownFlag){FCK.MouseDownFlag=false;return;}if(FCKConfig.ForcePasteAsPlainText){if(c.dataTransfer){var d=c.dataTransfer.getData("Text");d=FCKTools.HTMLEncode(d);d=FCKTools.ProcessLineBreaks(window,FCKConfig,d);FCK.InsertHtml(d);}else{if(FCKConfig.ShowDropDialog){FCK.PasteAsPlainText();}}c.preventDefault();c.stopPropagation();}};this._ExecCheckCaret=function(g){if(FCK.EditMode!=0){return;}if(g.type=="keypress"){var h=g.keyCode;if(h<33||h>40){return;}}var i=function(b){if(b.nodeType!=1){return false;}var a=b.tagName.toLowerCase();return(FCKListsLib.BlockElements[a]||FCKListsLib.EmptyElements[a]);};var f=function(){var b=FCKSelection.GetSelection();var c=b.getRangeAt(0);if(!c||!c.collapsed){return;}var d=c.endContainer;if(d.nodeType!=3){return;}if(d.nodeValue.length!=c.endOffset){return;}var n=d.parentNode.tagName.toLowerCase();if(!(n=="a"||(!FCKBrowserInfo.IsOpera&&String(d.parentNode.contentEditable)=="false")||(!(FCKListsLib.BlockElements[n]||FCKListsLib.NonEmptyBlockElements[n])&&h==35))){return;}var o=FCKTools.GetNextTextNode(d,d.parentNode,i);if(o){return;}c=FCK.EditorDocument.createRange();o=FCKTools.GetNextTextNode(d,d.parentNode.parentNode,i);if(o){if(FCKBrowserInfo.IsOpera&&h==37){return;}c.setStart(o,0);c.setEnd(o,0);}else{while(d.parentNode&&d.parentNode!=FCK.EditorDocument.body&&d.parentNode!=FCK.EditorDocument.documentElement&&d==d.parentNode.lastChild&&(!FCKListsLib.BlockElements[d.parentNode.tagName.toLowerCase()]&&!FCKListsLib.NonEmptyBlockElements[d.parentNode.tagName.toLowerCase()])){d=d.parentNode;}if(FCKListsLib.BlockElements[n]||FCKListsLib.EmptyElements[n]||d==FCK.EditorDocument.body){c.setStart(d,d.childNodes.length);c.setEnd(d,d.childNodes.length);}else{var p=d.nextSibling;while(p){if(p.nodeType!=1){p=p.nextSibling;continue;}var q=p.tagName.toLowerCase();if(FCKListsLib.BlockElements[q]||FCKListsLib.EmptyElements[q]||FCKListsLib.NonEmptyBlockElements[q]){break;}p=p.nextSibling;}var a=FCK.EditorDocument.createTextNode("");if(p){d.parentNode.insertBefore(a,p);}else{d.parentNode.appendChild(a);}c.setStart(a,0);c.setEnd(a,0);}}b.removeAllRanges();b.addRange(c);FCK.Events.FireEvent("OnSelectionChange");};setTimeout(f,1);};this.ExecOnSelectionChangeTimer=function(){if(FCK.LastOnChangeTimer){window.clearTimeout(FCK.LastOnChangeTimer);}FCK.LastOnChangeTimer=window.setTimeout(FCK.ExecOnSelectionChange,100);};this.EditorDocument.addEventListener("mouseup",this.ExecOnSelectionChange,false);this.EditorDocument.addEventListener("keyup",this.ExecOnSelectionChangeTimer,false);this._DblClickListener=function(b){FCK.OnDoubleClick(b.target);b.stopPropagation();};this.EditorDocument.addEventListener("dblclick",this._DblClickListener,true);this.EditorDocument.addEventListener("keydown",this._KeyDownListener,false);if(FCKBrowserInfo.IsGecko){this.EditorWindow.addEventListener("dragdrop",this._ExecDrop,true);}else{if(FCKBrowserInfo.IsSafari){this.EditorDocument.addEventListener("dragover",function(b){if(!FCK.MouseDownFlag&&FCK.Config.ForcePasteAsPlainText){b.returnValue=false;}},true);this.EditorDocument.addEventListener("drop",this._ExecDrop,true);this.EditorDocument.addEventListener("mousedown",function(d){var c=d.srcElement;if(c.nodeName.IEquals("IMG","HR","INPUT","TEXTAREA","SELECT")){FCKSelection.SelectNode(c);}},true);this.EditorDocument.addEventListener("mouseup",function(b){if(b.srcElement.nodeName.IEquals("INPUT","TEXTAREA","SELECT")){b.preventDefault();}},true);this.EditorDocument.addEventListener("click",function(b){if(b.srcElement.nodeName.IEquals("INPUT","TEXTAREA","SELECT")){b.preventDefault();}},true);}}if(FCKBrowserInfo.IsGecko||FCKBrowserInfo.IsOpera){this.EditorDocument.addEventListener("keypress",this._ExecCheckCaret,false);this.EditorDocument.addEventListener("click",this._ExecCheckCaret,false);}FCK.ContextMenu._InnerContextMenu.SetMouseClickWindow(FCK.EditorWindow);FCK.ContextMenu._InnerContextMenu.AttachToElement(FCK.EditorDocument);};FCK.MakeEditable=function(){this.EditingArea.MakeEditable();};function Document_OnContextMenu(b){if(!b.target._FCKShowContextMenu){b.preventDefault();}}document.oncontextmenu=Document_OnContextMenu;FCK._BaseGetNamedCommandState=FCK.GetNamedCommandState;FCK.GetNamedCommandState=function(b){switch(b){case"Unlink":return FCKSelection.HasAncestorNode("A")?0:-1;default:return FCK._BaseGetNamedCommandState(b);}};FCK.RedirectNamedCommands={Print:true,Paste:true};FCK.ExecuteRedirectedNamedCommand=function(f,g){switch(f){case"Print":FCK.EditorWindow.print();break;case"Paste":try{if(FCKBrowserInfo.IsSafari){throw"";}if(FCK.Paste()){FCK.ExecuteNamedCommand("Paste",null,true);}}catch(d){if(FCKConfig.ForcePasteAsPlainText){FCK.PasteAsPlainText();}else{FCKDialog.OpenDialog("FCKDialog_Paste",FCKLang.Paste,"dialog/fck_paste.html",400,330,"Security");}}break;default:FCK.ExecuteNamedCommand(f,g);}};FCK._ExecPaste=function(){FCKUndo.SaveUndoStep();if(FCKConfig.ForcePasteAsPlainText){FCK.PasteAsPlainText();return false;}return true;};FCK.InsertHtml=function(k){var l=FCK.EditorDocument,j;k=FCKConfig.ProtectedSource.Protect(k);k=FCK.ProtectEvents(k);k=FCK.ProtectUrls(k);k=FCK.ProtectTags(k);FCKUndo.SaveUndoStep();if(FCKBrowserInfo.IsGecko){k=k.replace(/&nbsp;$/,'$&<span _fcktemp="1"/>');var m=new FCKDocumentFragment(this.EditorDocument);m.AppendHtml(k);var n=m.RootNode.lastChild;j=new FCKDomRange(this.EditorWindow);j.MoveToSelection();var p=m.RootNode.firstChild;while(p&&p.nodeType!=1){p=p.nextSibling;}if(p&&FCKListsLib.BlockElements[p.nodeName.toLowerCase()]){j.SplitBlock();}j.DeleteContents();j.InsertNode(m.RootNode);j.MoveToPosition(n,4);}else{l.execCommand("inserthtml",false,k);}this.Focus();if(!j){j=new FCKDomRange(this.EditorWindow);j.MoveToSelection();}var q=j.CreateBookmark();FCKDocumentProcessor.Process(l);try{j.MoveToBookmark(q);j.Select();}catch(o){}this.Events.FireEvent("OnSelectionChange");};FCK.PasteAsPlainText=function(){FCKTools.RunFunction(FCKDialog.OpenDialog,FCKDialog,["FCKDialog_Paste",FCKLang.PasteAsText,"dialog/fck_paste.html",400,330,"PlainText"]);};FCK.GetClipboardHTML=function(){return"";};FCK.CreateLink=function(j,k){var l=[];if(FCKSelection.GetSelection().isCollapsed){return l;}FCK.ExecuteNamedCommand("Unlink",null,false,!!k);if(j.length>0){var m="javascript:void(0);/*"+(new Date().getTime())+"*/";FCK.ExecuteNamedCommand("CreateLink",m,false,!!k);var n=this.EditorDocument.evaluate("//a[@href='"+m+"']",this.EditorDocument.body,null,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null);for(var i=0;i<n.snapshotLength;i++){var o=n.snapshotItem(i);o.href=j;l.push(o);}}return l;};FCK._FillEmptyBlock=function(d){if(!d||d.nodeType!=1){return;}var c=d.tagName.toLowerCase();if(c!="p"&&c!="div"){return;}if(d.firstChild){return;}FCKTools.AppendBogusBr(d);};FCK._ExecCheckEmptyBlock=function(){FCK._FillEmptyBlock(FCK.EditorDocument.body.firstChild);var d=FCKSelection.GetSelection();if(!d||d.rangeCount<1){return;}var c=d.getRangeAt(0);FCK._FillEmptyBlock(c.startContainer);};var FCKConfig=FCK.Config={};if(document.location.protocol=="file:"){FCKConfig.BasePath=decodeURIComponent(document.location.pathname.substr(1));FCKConfig.BasePath=FCKConfig.BasePath.replace(/\\/gi,"/");var sFullProtocol=document.location.href.match(/^(file\:\/{2,3})/)[1];if(FCKBrowserInfo.IsOpera){sFullProtocol+="localhost/";}FCKConfig.BasePath=sFullProtocol+FCKConfig.BasePath.substring(0,FCKConfig.BasePath.lastIndexOf("/")+1);}else{FCKConfig.BasePath=document.location.protocol+"//"+document.location.host+document.location.pathname.substring(0,document.location.pathname.lastIndexOf("/")+1);}FCKConfig.FullBasePath=FCKConfig.BasePath;FCKConfig.EditorPath=FCKConfig.BasePath.replace(/editor\/$/,"");try{FCKConfig.ScreenWidth=screen.width;FCKConfig.ScreenHeight=screen.height;}catch(e){FCKConfig.ScreenWidth=800;FCKConfig.ScreenHeight=600;}FCKConfig.ProcessHiddenField=function(){this.PageConfig={};var i=window.parent.document.getElementById(FCK.Name+"___Config");if(!i){return;}var j=i.value.split("&");for(var h=0;h<j.length;h++){if(j[h].length==0){continue;}var k=j[h].split("=");var l=decodeURIComponent(k[0]);var m=decodeURIComponent(k[1]);if(l=="CustomConfigurationsPath"){FCKConfig[l]=m;}else{if(m.toLowerCase()=="true"){this.PageConfig[l]=true;}else{if(m.toLowerCase()=="false"){this.PageConfig[l]=false;}else{if(m.length>0&&!isNaN(m)){this.PageConfig[l]=parseFloat(m);}else{this.PageConfig[l]=m;}}}}}};function FCKConfig_LoadPageConfig(){var d=FCKConfig.PageConfig;for(var c in d){FCKConfig[c]=d[c];}}function FCKConfig_PreProcess(){var f=FCKConfig;if(f.AllowQueryStringDebug){try{if((/fckdebug=true/i).test(window.top.location.search)){f.Debug=true;}}catch(d){}}if(!f.PluginsPath.EndsWith("/")){f.PluginsPath+="/";}var g=f.ToolbarComboPreviewCSS;if(!g||g.length==0){f.ToolbarComboPreviewCSS=f.EditorAreaCSS;}f.RemoveAttributesArray=(f.RemoveAttributes||"").split(",");if(!FCKConfig.SkinEditorCSS||FCKConfig.SkinEditorCSS.length==0){FCKConfig.SkinEditorCSS=FCKConfig.SkinPath+"fck_editor.css";}if(!FCKConfig.SkinDialogCSS||FCKConfig.SkinDialogCSS.length==0){FCKConfig.SkinDialogCSS=FCKConfig.SkinPath+"fck_dialog.css";}}FCKConfig.ToolbarSets={};FCKConfig.Plugins={};FCKConfig.Plugins.Items=[];FCKConfig.Plugins.Add=function(f,g,d){FCKConfig.Plugins.Items.push([f,g,d]);};FCKConfig.ProtectedSource={};FCKConfig.ProtectedSource._CodeTag=(new Date()).valueOf();FCKConfig.ProtectedSource.RegexEntries=[/<!--[\s\S]*?-->/g,/<script[\s\S]*?<\/script>/gi,/<noscript[\s\S]*?<\/noscript>/gi];FCKConfig.ProtectedSource.Add=function(b){this.RegexEntries.push(b);};FCKConfig.ProtectedSource.Protect=function(g){var h=this._CodeTag;function i(b){var a=FCKTempBin.AddElement(b);return"<!--{"+h+a+"}-->";}for(var f=0;f<this.RegexEntries.length;f++){g=g.replace(this.RegexEntries[f],i);}return g;};FCKConfig.ProtectedSource.Revert=function(g,h){function i(d,b,c){var a=h?FCKTempBin.RemoveElement(c):FCKTempBin.Elements[c];return FCKConfig.ProtectedSource.Revert(a,h);}var f=new RegExp("(<|&lt;)!--\\{"+this._CodeTag+"(\\d+)\\}--(>|&gt;)","g");return g.replace(f,i);};FCKConfig.GetBodyAttributes=function(){var b="";if(this.BodyId&&this.BodyId.length>0){b+=' id="'+this.BodyId+'"';}if(this.BodyClass&&this.BodyClass.length>0){b+=' class="'+this.BodyClass+'"';}return b;};FCKConfig.ApplyBodyAttributes=function(b){if(this.BodyId&&this.BodyId.length>0){b.id=FCKConfig.BodyId;}if(this.BodyClass&&this.BodyClass.length>0){b.className+=" "+FCKConfig.BodyClass;}};var FCKDebug={Output:function(){},OutputObject:function(){}};var FCKDomTools={MoveChildren:function(g,h,i){if(g==h){return;}var f;if(i){while((f=g.lastChild)){h.insertBefore(g.removeChild(f),h.firstChild);}}else{while((f=g.firstChild)){h.appendChild(g.removeChild(f));}}},MoveNode:function(f,g,d){if(d){g.insertBefore(FCKDomTools.RemoveNode(f),g.firstChild);}else{g.appendChild(FCKDomTools.RemoveNode(f));}},TrimNode:function(b){this.LTrimNode(b);this.RTrimNode(b);},LTrimNode:function(g){var h;while((h=g.firstChild)){if(h.nodeType==3){var i=h.nodeValue.LTrim();var f=h.nodeValue.length;if(i.length==0){g.removeChild(h);continue;}else{if(i.length<f){h.splitText(f-i.length);g.removeChild(g.firstChild);}}}break;}},RTrimNode:function(g){var h;while((h=g.lastChild)){if(h.nodeType==3){var i=h.nodeValue.RTrim();var f=h.nodeValue.length;if(i.length==0){h.parentNode.removeChild(h);continue;}else{if(i.length<f){h.splitText(i.length);g.lastChild.parentNode.removeChild(g.lastChild);}}}break;}if(!FCKBrowserInfo.IsIE&&!FCKBrowserInfo.IsOpera){h=g.lastChild;if(h&&h.nodeType==1&&h.nodeName.toLowerCase()=="br"){h.parentNode.removeChild(h);}}},RemoveNode:function(f,g){if(g){var d;while((d=f.firstChild)){f.parentNode.insertBefore(f.removeChild(d),f);}}return f.parentNode.removeChild(f);},GetFirstChild:function(f,g){if(typeof(g)=="string"){g=[g];}var d=f.firstChild;while(d){if(d.nodeType==1&&d.tagName.Equals.apply(d.tagName,g)){return d;}d=d.nextSibling;}return null;},GetLastChild:function(f,g){if(typeof(g)=="string"){g=[g];}var d=f.lastChild;while(d){if(d.nodeType==1&&(!g||d.tagName.Equals(g))){return d;}d=d.previousSibling;}return null;},GetPreviousSourceElement:function(g,h,i,f){if(!g){return null;}if(i&&g.nodeType==1&&g.nodeName.IEquals(i)){return null;}if(g.previousSibling){g=g.previousSibling;}else{return this.GetPreviousSourceElement(g.parentNode,h,i,f);}while(g){if(g.nodeType==1){if(i&&g.nodeName.IEquals(i)){break;}if(!f||!g.nodeName.IEquals(f)){return g;}}else{if(h&&g.nodeType==3&&g.nodeValue.RTrim().length>0){break;}}if(g.lastChild){g=g.lastChild;}else{return this.GetPreviousSourceElement(g,h,i,f);}}return null;},GetNextSourceElement:function(h,i,j,k,g){while((h=this.GetNextSourceNode(h,g))){if(h.nodeType==1){if(j&&h.nodeName.IEquals(j)){break;}if(k&&h.nodeName.IEquals(k)){return this.GetNextSourceElement(h,i,j,k);}return h;}else{if(i&&h.nodeType==3&&h.nodeValue.RTrim().length>0){break;}}}return null;},GetNextSourceNode:function(h,i,j,k){if(!h){return null;}var g;if(!i&&h.firstChild){g=h.firstChild;}else{if(k&&h==k){return null;}g=h.nextSibling;if(!g&&(!k||k!=h.parentNode)){return this.GetNextSourceNode(h.parentNode,true,j,k);}}if(j&&g&&g.nodeType!=j){return this.GetNextSourceNode(g,false,j,k);}return g;},GetPreviousSourceNode:function(h,i,j,k){if(!h){return null;}var g;if(!i&&h.lastChild){g=h.lastChild;}else{if(k&&h==k){return null;}g=h.previousSibling;if(!g&&(!k||k!=h.parentNode)){return this.GetPreviousSourceNode(h.parentNode,true,j,k);}}if(j&&g&&g.nodeType!=j){return this.GetPreviousSourceNode(g,false,j,k);}return g;},InsertAfterNode:function(d,c){return d.parentNode.insertBefore(c,d.nextSibling);},GetParents:function(d){var c=[];while(d){c.unshift(d);d=d.parentNode;}return c;},GetCommonParents:function(i,j){var k=this.GetParents(i);var l=this.GetParents(j);var m=[];for(var h=0;h<k.length;h++){if(k[h]==l[h]){m.push(k[h]);}}return m;},GetCommonParentNode:function(i,j,k){var l={};if(!k.pop){k=[k];}while(k.length>0){l[k.pop().toLowerCase()]=1;}var m=this.GetCommonParents(i,j);var h=null;while((h=m.pop())){if(l[h.nodeName.toLowerCase()]){return h;}}return null;},GetIndexOf:function(f){var g=f.parentNode?f.parentNode.firstChild:null;var d=-1;while(g){d++;if(g==f){return d;}g=g.nextSibling;}return -1;},PaddingNode:null,EnforcePaddingNode:function(g,h){try{if(!g||!g.body){return;}}catch(f){return;}this.CheckAndRemovePaddingNode(g,h,true);try{if(g.body.lastChild&&(g.body.lastChild.nodeType!=1||g.body.lastChild.tagName.toLowerCase()==h.toLowerCase())){return;}}catch(f){return;}var i=g.createElement(h);if(FCKBrowserInfo.IsGecko&&FCKListsLib.NonEmptyBlockElements[h]){FCKTools.AppendBogusBr(i);}this.PaddingNode=i;if(g.body.childNodes.length==1&&g.body.firstChild.nodeType==1&&g.body.firstChild.tagName.toLowerCase()=="br"&&(g.body.firstChild.getAttribute("_moz_dirty")!=null||g.body.firstChild.getAttribute("type")=="_moz")){g.body.replaceChild(i,g.body.firstChild);}else{g.body.appendChild(i);}},CheckAndRemovePaddingNode:function(h,i,j){var k=this.PaddingNode;if(!k){return;}try{if(k.parentNode!=h.body||k.tagName.toLowerCase()!=i||(k.childNodes.length>1)||(k.firstChild&&k.firstChild.nodeValue!="\xa0"&&String(k.firstChild.tagName).toLowerCase()!="br")){this.PaddingNode=null;return;}}catch(g){this.PaddingNode=null;return;}if(!j){if(k.parentNode.childNodes.length>1){k.parentNode.removeChild(k);}this.PaddingNode=null;}},HasAttribute:function(f,g){if(f.hasAttribute){return f.hasAttribute(g);}else{var d=f.attributes[g];return(d!=undefined&&d.specified);}},HasAttributes:function(g){var h=g.attributes;for(var f=0;f<h.length;f++){if(FCKBrowserInfo.IsIE){var i=h[f].nodeName;if(i.StartsWith("_fck")){continue;}if(i=="class"){if(g.className.length>0){return true;}continue;}}if(h[f].specified){return true;}}return false;},RemoveAttribute:function(d,c){if(FCKBrowserInfo.IsIE&&c.toLowerCase()=="class"){c="className";}return d.removeAttribute(c,0);},RemoveAttributes:function(f,g){for(var d=0;d<g.length;d++){this.RemoveAttribute(f,g[d]);}},GetAttributeValue:function(f,g){var d=g;if(typeof g=="string"){g=f.attributes[g];}else{d=g.nodeName;}if(g&&g.specified){if(d=="style"){return f.style.cssText;}else{if(d=="class"||d.indexOf("on")==0){return g.nodeValue;}else{return f.getAttribute(d,2);}}}return null;},Contains:function(d,c){if(d.contains&&c.nodeType==1){return d.contains(c);}while((c=c.parentNode)){if(c==d){return true;}}return false;},BreakParent:function(h,i,j){var k=j||new FCKDomRange(FCKTools.GetElementWindow(h));k.SetStart(h,4);k.SetEnd(i,4);var g=k.ExtractContents();k.InsertNode(h.parentNode.removeChild(h));g.InsertAfterNode(h);k.Release(!!j);},GetNodeAddress:function(j,k){var l=[];while(j&&j!=FCKTools.GetElementDocument(j).documentElement){var m=j.parentNode;var n=-1;for(var i=0;i<m.childNodes.length;i++){var o=m.childNodes[i];if(k===true&&o.nodeType==3&&o.previousSibling&&o.previousSibling.nodeType==3){continue;}n++;if(m.childNodes[i]==j){break;}}l.unshift(n);j=j.parentNode;}return l;},GetNodeFromAddress:function(p,q,r){var t=p.documentElement;for(var n=0;n<q.length;n++){var i=q[n];if(!r){t=t.childNodes[i];continue;}var j=-1;for(var o=0;o<t.childNodes.length;o++){var m=t.childNodes[o];if(r===true&&m.nodeType==3&&m.previousSibling&&m.previousSibling.nodeType==3){continue;}j++;if(j==i){t=m;break;}}}return t;},CloneElement:function(b){b=b.cloneNode(false);b.removeAttribute("id",false);return b;},ClearElementJSProperty:function(d,c){if(FCKBrowserInfo.IsIE){d.removeAttribute(c);}else{delete d[c];}},SetElementMarker:function(h,i,j,k){var g=String(parseInt(Math.random()*4294967295,10));i._FCKMarkerId=g;i[j]=k;if(!h[g]){h[g]={"element":i,"markers":{}};}h[g]["markers"][j]=k;},ClearElementMarkers:function(h,i,j){var k=i._FCKMarkerId;if(!k){return;}this.ClearElementJSProperty(i,"_FCKMarkerId");for(var g in h[k]["markers"]){this.ClearElementJSProperty(i,g);}if(j){delete h[k];}},ClearAllMarkers:function(d){for(var c in d){this.ClearElementMarkers(d,d[c]["element"],true);}},ListToArray:function(r,t,u,v,i){if(!r.nodeName.IEquals(["ul","ol"])){return[];}if(!v){v=0;}if(!u){u=[];}for(var p=0;p<r.childNodes.length;p++){var j=r.childNodes[p];if(!j.nodeName.IEquals("li")){continue;}var n={"parent":r,"indent":v,"contents":[]};if(!i){n.grandparent=r.parentNode;if(n.grandparent&&n.grandparent.nodeName.IEquals("li")){n.grandparent=n.grandparent.parentNode;}}else{n.grandparent=i;}if(t){this.SetElementMarker(t,j,"_FCK_ListArray_Index",u.length);}u.push(n);for(var q=0;q<j.childNodes.length;q++){var o=j.childNodes[q];if(o.nodeName.IEquals(["ul","ol"])){this.ListToArray(o,t,u,v+1,n.grandparent);}else{n.contents.push(o);}}}return u;},ArrayToList:function(B,C,D){if(D==undefined){D=0;}if(!B||B.length<D+1){return null;}var E=FCKTools.GetElementDocument(B[D].parent);var i=E.createDocumentFragment();var q=null;var r=D;var t=Math.max(B[D].indent,0);var u=null;while(true){var v=B[r];if(v.indent==t){if(!q||B[r].parent.nodeName!=q.nodeName){q=B[r].parent.cloneNode(false);i.appendChild(q);}u=E.createElement("li");q.appendChild(u);for(var A=0;A<v.contents.length;A++){u.appendChild(v.contents[A].cloneNode(true));}r++;}else{if(v.indent==Math.max(t,0)+1){var x=this.ArrayToList(B,null,r);u.appendChild(x.listNode);r=x.nextIndex;}else{if(v.indent==-1&&D==0&&v.grandparent){var u;if(v.grandparent.nodeName.IEquals(["ul","ol"])){u=E.createElement("li");}else{if(FCKConfig.EnterMode.IEquals(["div","p"])&&!v.grandparent.nodeName.IEquals("td")){u=E.createElement(FCKConfig.EnterMode);}else{u=E.createDocumentFragment();}}for(var A=0;A<v.contents.length;A++){u.appendChild(v.contents[A].cloneNode(true));}if(u.nodeType==11){if(u.lastChild&&u.lastChild.getAttribute&&u.lastChild.getAttribute("type")=="_moz"){u.removeChild(u.lastChild);}u.appendChild(E.createElement("br"));}if(u.nodeName.IEquals(FCKConfig.EnterMode)&&u.firstChild){this.TrimNode(u);if(FCKListsLib.BlockBoundaries[u.firstChild.nodeName.toLowerCase()]){var y=E.createDocumentFragment();while(u.firstChild){y.appendChild(u.removeChild(u.firstChild));}u=y;}}if(FCKBrowserInfo.IsGeckoLike&&u.nodeName.IEquals(["div","p"])){FCKTools.AppendBogusBr(u);}i.appendChild(u);q=null;r++;}else{return null;}}}if(B.length<=r||Math.max(B[r].indent,0)<t){break;}}if(C){var z=i.firstChild;while(z){if(z.nodeType==1){this.ClearElementMarkers(C,z);}z=this.GetNextSourceNode(z);}}return{"listNode":i,"nextIndex":r};},GetNextSibling:function(d,c){d=d.nextSibling;while(d&&!c&&d.nodeType!=1&&(d.nodeType!=3||d.nodeValue.length==0)){d=d.nextSibling;}return d;},GetPreviousSibling:function(d,c){d=d.previousSibling;while(d&&!c&&d.nodeType!=1&&(d.nodeType!=3||d.nodeValue.length==0)){d=d.previousSibling;}return d;},CheckIsEmptyElement:function(g,h){var i=g.firstChild;var f;while(i){if(i.nodeType==1){if(f||!FCKListsLib.InlineNonEmptyElements[i.nodeName.toLowerCase()]){return false;}if(!h||h(i)===true){f=i;}}else{if(i.nodeType==3&&i.nodeValue.length>0){return false;}}i=i.nextSibling;}return f?this.CheckIsEmptyElement(f,h):true;},SetElementStyles:function(g,h){var i=g.style;for(var f in h){i[f]=h[f];}},SetOpacity:function(d,c){if(FCKBrowserInfo.IsIE){c=Math.round(c*100);d.style.filter=(c>100?"":"progid:DXImageTransform.Microsoft.Alpha(opacity="+c+")");}else{d.style.opacity=c;}},GetCurrentElementStyle:function(d,c){if(FCKBrowserInfo.IsIE){return d.currentStyle[c];}else{return d.ownerDocument.defaultView.getComputedStyle(d,"").getPropertyValue(c);}},GetPositionedAncestor:function(d){var c=d;while(c!=FCKTools.GetElementDocument(c).documentElement){if(this.GetCurrentElementStyle(c,"position")!="static"){return c;}if(c==FCKTools.GetElementDocument(c).documentElement&&currentWindow!=w){c=currentWindow.frameElement;}else{c=c.parentNode;}}return null;},ScrollIntoView:function(j,k){var l=FCKTools.GetElementWindow(j);var m=FCKTools.GetViewPaneSize(l).Height;var n=m*-1;if(k===false){n+=j.offsetHeight||0;n+=parseInt(this.GetCurrentElementStyle(j,"marginBottom")||0,10)||0;}var o=FCKTools.GetDocumentPosition(l,j);n+=o.y;var i=FCKTools.GetScrollPosition(l).Y;if(n>0&&(n>i||n<i-m)){l.scrollTo(0,n);}},CheckIsEditable:function(f){var g=f.nodeName.toLowerCase();var d=FCK.DTD[g]||FCK.DTD.span;return(d["#"]&&!FCKListsLib.NonEditableElements[g]);},GetSelectedDivContainers:function(){var j=[];var k=new FCKDomRange(FCK.EditorWindow);k.MoveToSelection();var l=k.GetTouchedStartNode();var m=k.GetTouchedEndNode();var n=l;if(l==m){while(m.nodeType==1&&m.lastChild){m=m.lastChild;}m=FCKDomTools.GetNextSourceNode(m);}while(n&&n!=m){if(n.nodeType!=3||!/^[ \t\n]*$/.test(n.nodeValue)){var o=new FCKElementPath(n);var i=o.BlockLimit;if(i&&i.nodeName.IEquals("div")&&j.IndexOf(i)==-1){j.push(i);}}n=FCKDomTools.GetNextSourceNode(n);}return j;}};var FCKTools={};FCKTools.CreateBogusBR=function(d){var c=d.createElement("br");c.setAttribute("type","_moz");return c;};FCKTools.FixCssUrls=function(d,c){if(!d||d.length==0){return c;}return c.replace(/url\s*\(([\s'"]*)(.*?)([\s"']*)\)/g,function(i,h,b,a){if(/^\/|^\w?:/.test(b)){return i;}else{return"url("+h+d+b+a+")";}});};FCKTools._GetUrlFixedCss=function(f,g){var d=f.match(/^([^|]+)\|([\s\S]*)/);if(d){return FCKTools.FixCssUrls(d[1],d[2]);}else{return f;}};FCKTools.AppendStyleSheet=function(g,h){if(!h){return[];}if(typeof(h)=="string"){if(/[\\\/\.][^{}]*$/.test(h)){return this.AppendStyleSheet(g,h.split(","));}else{return[this.AppendStyleString(g,FCKTools._GetUrlFixedCss(h))];}}else{var i=[];for(var f=0;f<h.length;f++){i.push(this._AppendStyleSheet(g,h[f]));}return i;}};FCKTools.GetStyleHtml=(function(){var d=function(b,g){if(b.length==0){return"";}var a=g?' _fcktemp="true"':"";return'<style type="text/css"'+a+">"+b+"</style>";};var c=function(g,b){if(g.length==0){return"";}var a=b?' _fcktemp="true"':"";return'<link href="'+g+'" type="text/css" rel="stylesheet" '+a+"/>";};return function(a,h){if(!a){return"";}if(typeof(a)=="string"){if(/[\\\/\.][^{}]*$/.test(a)){return this.GetStyleHtml(a.split(","),h);}else{return d(this._GetUrlFixedCss(a),h);}}else{var b="";for(var i=0;i<a.length;i++){b+=c(a[i],h);}return b;}};})();FCKTools.GetElementDocument=function(b){return b.ownerDocument||b.document;};FCKTools.GetElementWindow=function(b){return this.GetDocumentWindow(this.GetElementDocument(b));};FCKTools.GetDocumentWindow=function(b){if(FCKBrowserInfo.IsSafari&&!b.parentWindow){this.FixDocumentParentWindow(window.top);}return b.parentWindow||b.defaultView;};FCKTools.FixDocumentParentWindow=function(d){if(d.document){d.document.parentWindow=d;}for(var c=0;c<d.frames.length;c++){FCKTools.FixDocumentParentWindow(d.frames[c]);}};FCKTools.HTMLEncode=function(b){if(!b){return"";}b=b.replace(/&/g,"&amp;");b=b.replace(/</g,"&lt;");b=b.replace(/>/g,"&gt;");return b;};FCKTools.HTMLDecode=function(b){if(!b){return"";}b=b.replace(/&gt;/g,">");b=b.replace(/&lt;/g,"<");b=b.replace(/&amp;/g,"&");return b;};FCKTools._ProcessLineBreaksForPMode=function(x,y,z,A,c){var i=0;var n="<p>";var q="</p>";var r="<br />";if(z){n="<li>";q="</li>";i=1;}while(A&&A!=x.FCK.EditorDocument.body){if(A.tagName.toLowerCase()=="p"){i=1;break;}A=A.parentNode;}for(var u=0;u<y.length;u++){var t=y.charAt(u);if(t=="\r"){continue;}if(t!="\n"){c.push(t);continue;}var v=y.charAt(u+1);if(v=="\r"){u++;v=y.charAt(u+1);}if(v=="\n"){u++;if(i){c.push(q);}c.push(n);i=1;}else{c.push(r);}}};FCKTools._ProcessLineBreaksForDivMode=function(r,t,u,v,c){var i=0;var n="<div>";var o="</div>";if(u){n="<li>";o="</li>";i=1;}while(v&&v!=r.FCK.EditorDocument.body){if(v.tagName.toLowerCase()=="div"){i=1;break;}v=v.parentNode;}for(var q=0;q<t.length;q++){var p=t.charAt(q);if(p=="\r"){continue;}if(p!="\n"){c.push(p);continue;}if(i){if(c[c.length-1]==n){c.push("&nbsp;");}c.push(o);}c.push(n);i=1;}if(i){c.push(o);}};FCKTools._ProcessLineBreaksForBrMode=function(r,t,u,v,c){var i=0;var n="<br />";var o="";if(u){n="<li>";o="</li>";i=1;}for(var q=0;q<t.length;q++){var p=t.charAt(q);if(p=="\r"){continue;}if(p!="\n"){c.push(p);continue;}if(i&&o.length){c.push(o);}c.push(n);i=1;}};FCKTools.ProcessLineBreaks=function(k,l,m){var n=l.EnterMode.toLowerCase();var o=[];var p=0;var q=new k.FCKDomRange(k.FCK.EditorWindow);q.MoveToSelection();var j=q._Range.startContainer;while(j&&j.nodeType!=1){j=j.parentNode;}if(j&&j.tagName.toLowerCase()=="li"){p=1;}if(n=="p"){this._ProcessLineBreaksForPMode(k,m,p,j,o);}else{if(n=="div"){this._ProcessLineBreaksForDivMode(k,m,p,j,o);}else{if(n=="br"){this._ProcessLineBreaksForBrMode(k,m,p,j,o);}}}return o.join("");};FCKTools.AddSelectOption=function(g,h,i){var f=FCKTools.GetElementDocument(g).createElement("OPTION");f.text=h;f.value=i;g.options.add(f);return f;};FCKTools.RunFunction=function(g,h,i,f){if(g){this.SetTimeout(g,0,h,i,f);}};FCKTools.SetTimeout=function(h,i,j,k,g){return(g||window).setTimeout(function(){if(k){h.apply(j,[].concat(k));}else{h.apply(j);}},i);};FCKTools.SetInterval=function(h,i,j,k,g){return(g||window).setInterval(function(){h.apply(j,k||[]);},i);};FCKTools.ConvertStyleSizeToHtml=function(b){return b.EndsWith("%")?b:parseInt(b,10);};FCKTools.ConvertHtmlSizeToStyle=function(b){return b.EndsWith("%")?b:(b+"px");};FCKTools.GetElementAscensor=function(g,h){var f=g;var i=","+h.toUpperCase()+",";while(f){if(i.indexOf(","+f.nodeName.toUpperCase()+",")!=-1){return f;}f=f.parentNode;}return null;};FCKTools.CreateEventListener=function(f,g){var d=function(){var a=[];for(var b=0;b<arguments.length;b++){a.push(arguments[b]);}f.apply(this,a.concat(g));};return d;};FCKTools.IsStrictMode=function(b){return("CSS1Compat"==(b.compatMode||(FCKBrowserInfo.IsSafari?"CSS1Compat":null)));};FCKTools.ArgumentsToArray=function(h,i,j){i=i||0;j=j||h.length;var k=[];for(var g=i;g<i+j&&g<h.length;g++){k.push(h[g]);}return k;};FCKTools.CloneObject=function(d){var c=function(){};c.prototype=d;return new c;};FCKTools.AppendBogusBr=function(f){if(!f){return;}var g=this.GetLastItem(f.getElementsByTagName("br"));if(!g||(g.getAttribute("type",2)!="_moz"&&g.getAttribute("_moz_dirty")==null)){var d=this.GetElementDocument(f);if(FCKBrowserInfo.IsOpera){f.appendChild(d.createTextNode(""));}else{f.appendChild(this.CreateBogusBR(d));}}};FCKTools.GetLastItem=function(b){if(b.length>0){return b[b.length-1];}return null;};FCKTools.GetDocumentPosition=function(q,j){var k=0;var l=0;var m=j;var n=null;var o=FCKTools.GetElementWindow(m);while(m&&!(o==q&&(m==q.document.body||m==q.document.documentElement))){k+=m.offsetLeft-m.scrollLeft;l+=m.offsetTop-m.scrollTop;if(!FCKBrowserInfo.IsOpera){var p=n;while(p&&p!=m){k-=p.scrollLeft;l-=p.scrollTop;p=p.parentNode;}}n=m;if(m.offsetParent){m=m.offsetParent;}else{if(o!=q){m=o.frameElement;n=null;if(m){o=m.contentWindow.parent;}}else{m=null;}}}if(FCKDomTools.GetCurrentElementStyle(q.document.body,"position")!="static"||(FCKBrowserInfo.IsIE&&FCKDomTools.GetPositionedAncestor(j)==null)){k+=q.document.body.offsetLeft;l+=q.document.body.offsetTop;}return{"x":k,"y":l};};FCKTools.GetWindowPosition=function(f,g){var h=this.GetDocumentPosition(f,g);var i=FCKTools.GetScrollPosition(f);h.x-=i.X;h.y-=i.Y;return h;};FCKTools.ProtectFormStyles=function(i){if(!i||i.nodeType!=1||i.tagName.toLowerCase()!="form"){return[];}var j=[];var k=["style","className"];for(var h=0;h<k.length;h++){var l=k[h];if(i.elements.namedItem(l)){var m=i.elements.namedItem(l);j.push([m,m.nextSibling]);i.removeChild(m);}}return j;};FCKTools.RestoreFormStyles=function(h,i){if(!h||h.nodeType!=1||h.tagName.toLowerCase()!="form"){return;}if(i.length>0){for(var g=i.length-1;g>=0;g--){var j=i[g][0];var k=i[g][1];if(k){h.insertBefore(j,k);}else{h.appendChild(j);}}}};FCKTools.GetNextNode=function(f,g){if(f.firstChild){return f.firstChild;}else{if(f.nextSibling){return f.nextSibling;}else{var d=f.parentNode;while(d){if(d==g){return null;}if(d.nextSibling){return d.nextSibling;}else{d=d.parentNode;}}}}return null;};FCKTools.GetNextTextNode=function(f,g,d){node=this.GetNextNode(f,g);if(d&&node&&d(node)){return null;}while(node&&node.nodeType!=3){node=this.GetNextNode(node,g);if(d&&node&&d(node)){return null;}}return node;};FCKTools.Merge=function(){var h=arguments;var j=h[0];for(var g=1;g<h.length;g++){var i=h[g];for(var k in i){j[k]=i[k];}}return j;};FCKTools.IsArray=function(b){return(b instanceof Array);};FCKTools.AppendLengthProperty=function(g,h){var f=0;for(var i in g){f++;}return g[h||"length"]=f;};FCKTools.NormalizeCssText=function(d){var c=document.createElement("span");c.style.cssText=d;return c.style.cssText;};FCKTools.Bind=function(d,c){return function(){return c.apply(d,arguments);};};FCKTools.GetVoidUrl=function(){if(FCK_IS_CUSTOM_DOMAIN){return"javascript: void( function(){document.open();document.write('<html><head><title></title></head><body></body></html>');document.domain = '"+FCK_RUNTIME_DOMAIN+"';document.close();}() ) ;";}if(FCKBrowserInfo.IsIE){if(FCKBrowserInfo.IsIE7||!FCKBrowserInfo.IsIE6){return"";}else{return"javascript: '';";}}return"javascript: void(0);";};FCKTools.ResetStyles=function(b){b.style.cssText="margin:0;padding:0;border:0;background-color:transparent;background-image:none;";};FCKTools.CancelEvent=function(b){if(b){b.preventDefault();}};FCKTools.DisableSelection=function(b){if(FCKBrowserInfo.IsGecko){b.style.MozUserSelect="none";}else{if(FCKBrowserInfo.IsSafari){b.style.KhtmlUserSelect="none";}else{b.style.userSelect="none";}}};FCKTools._AppendStyleSheet=function(f,g){var d=f.createElement("LINK");d.rel="stylesheet";d.type="text/css";d.href=g;f.getElementsByTagName("HEAD")[0].appendChild(d);return d;};FCKTools.AppendStyleString=function(f,g){if(!g){return null;}var d=f.createElement("STYLE");d.appendChild(f.createTextNode(g));f.getElementsByTagName("HEAD")[0].appendChild(d);return d;};FCKTools.ClearElementAttributes=function(d){for(var c=0;c<d.attributes.length;c++){d.removeAttribute(d.attributes[c].name,0);}};FCKTools.GetAllChildrenIds=function(f){var g=[];var d=function(b){for(var c=0;c<b.childNodes.length;c++){var a=b.childNodes[c].id;if(a&&a.length>0){g[g.length]=a;}d(b.childNodes[c]);}};d(f);return g;};FCKTools.RemoveOuterTags=function(g){var f=g.ownerDocument.createDocumentFragment();for(var d=0;d<g.childNodes.length;d++){f.appendChild(g.childNodes[d].cloneNode(true));}g.parentNode.replaceChild(f,g);};FCKTools.CreateXmlObject=function(d){switch(d){case"XmlHttp":return new XMLHttpRequest();case"DOMDocument":var c=(new DOMParser()).parseFromString("<tmp></tmp>","text/xml");FCKDomTools.RemoveNode(c.firstChild);return c;}return null;};FCKTools.GetScrollPosition=function(b){return{X:b.pageXOffset,Y:b.pageYOffset};};FCKTools.AddEventListener=function(f,g,d){f.addEventListener(g,d,false);};FCKTools.RemoveEventListener=function(f,g,d){f.removeEventListener(g,d,false);};FCKTools.AddEventListenerEx=function(g,h,i,f){g.addEventListener(h,function(a){i.apply(g,[a].concat(f||[]));},false);};FCKTools.GetViewPaneSize=function(b){return{Width:b.innerWidth,Height:b.innerHeight};};FCKTools.SaveStyles=function(g){var h=FCKTools.ProtectFormStyles(g);var i={};if(g.className.length>0){i.Class=g.className;g.className="";}var f=g.getAttribute("style");if(f&&f.length>0){i.Inline=f;g.setAttribute("style","",0);}FCKTools.RestoreFormStyles(g,h);return i;};FCKTools.RestoreStyles=function(f,g){var d=FCKTools.ProtectFormStyles(f);f.className=g.Class||"";if(g.Inline){f.setAttribute("style",g.Inline,0);}else{f.removeAttribute("style",0);}FCKTools.RestoreFormStyles(f,d);};FCKTools.RegisterDollarFunction=function(b){b.$=function(a){return b.document.getElementById(a);};};FCKTools.AppendElement=function(d,c){return d.appendChild(d.ownerDocument.createElement(c));};FCKTools.GetElementPosition=function(k,l){var m={X:0,Y:0};var n=l||window;var o=FCKTools.GetElementWindow(k);var p=null;while(k){var q=o.getComputedStyle(k,"").position;if(q&&q!="static"&&k.style.zIndex!=FCKConfig.FloatingPanelsZIndex){break;}m.X+=k.offsetLeft-k.scrollLeft;m.Y+=k.offsetTop-k.scrollTop;if(!FCKBrowserInfo.IsOpera){var c=p;while(c&&c!=k){m.X-=c.scrollLeft;m.Y-=c.scrollTop;c=c.parentNode;}}p=k;if(k.offsetParent){k=k.offsetParent;}else{if(o!=n){k=o.frameElement;p=null;if(k){o=FCKTools.GetElementWindow(k);}}else{m.X+=k.scrollLeft;m.Y+=k.scrollTop;break;}}}return m;};var FCKeditorAPI;function InitializeAPI(){var A=window.parent;if(!(FCKeditorAPI=A.FCKeditorAPI)){var B='window.FCKeditorAPI = {Version : "2.6.6",VersionBuild : "25427",Instances : window.FCKeditorAPI && window.FCKeditorAPI.Instances || {},GetInstance : function( name ){return this.Instances[ name ];},_FormSubmit : function(){for ( var name in FCKeditorAPI.Instances ){var oEditor = FCKeditorAPI.Instances[ name ] ;if ( oEditor.GetParentForm && oEditor.GetParentForm() == this )oEditor.UpdateLinkedField() ;}this._FCKOriginalSubmit() ;},_FunctionQueue	: window.FCKeditorAPI && window.FCKeditorAPI._FunctionQueue || {Functions : new Array(),IsRunning : false,Add : function( f ){this.Functions.push( f );if ( !this.IsRunning )this.StartNext();},StartNext : function(){var aQueue = this.Functions ;if ( aQueue.length > 0 ){this.IsRunning = true;aQueue[0].call();}else this.IsRunning = false;},Remove : function( f ){var aQueue = this.Functions;var i = 0, fFunc;while( (fFunc = aQueue[ i ]) ){if ( fFunc == f )aQueue.splice( i,1 );i++ ;}this.StartNext();}}}';if(A.execScript){A.execScript(B,"JavaScript");}else{if(FCKBrowserInfo.IsGecko10){eval.call(A,B);}else{if(FCKBrowserInfo.IsAIR){FCKAdobeAIR.FCKeditorAPI_Evaluate(A,B);}else{if(FCKBrowserInfo.IsSafari){var C=A.document;var D=C.createElement("script");D.appendChild(C.createTextNode(B));C.documentElement.appendChild(D);}else{A.eval(B);}}}}FCKeditorAPI=A.FCKeditorAPI;FCKeditorAPI.__Instances=FCKeditorAPI.Instances;}FCKeditorAPI.Instances[FCK.Name]=FCK;}function _AttachFormSubmitToAPI(){var b=FCK.GetParentForm();if(b){FCKTools.AddEventListener(b,"submit",FCK.UpdateLinkedField);if(!b._FCKOriginalSubmit&&(typeof(b.submit)=="function"||(!b.submit.tagName&&!b.submit.length))){b._FCKOriginalSubmit=b.submit;b.submit=FCKeditorAPI._FormSubmit;}}}function FCKeditorAPI_Cleanup(){if(window.FCKConfig&&FCKConfig.MsWebBrowserControlCompat&&!window.FCKUnloadFlag){return;}delete FCKeditorAPI.Instances[FCK.Name];}function FCKeditorAPI_ConfirmCleanup(){if(window.FCKConfig&&FCKConfig.MsWebBrowserControlCompat){window.FCKUnloadFlag=true;}}FCKTools.AddEventListener(window,"unload",FCKeditorAPI_Cleanup);FCKTools.AddEventListener(window,"beforeunload",FCKeditorAPI_ConfirmCleanup);var FCKImagePreloader=function(){this._Images=[];};FCKImagePreloader.prototype={AddImages:function(b){if(typeof(b)=="string"){b=b.split(";");}this._Images=this._Images.concat(b);},Start:function(){var f=this._Images;this._PreloadCount=f.length;for(var d=0;d<f.length;d++){var g=document.createElement("img");FCKTools.AddEventListenerEx(g,"load",_FCKImagePreloader_OnImage,this);FCKTools.AddEventListenerEx(g,"error",_FCKImagePreloader_OnImage,this);g.src=f[d];_FCKImagePreloader_ImageCache.push(g);}}};var _FCKImagePreloader_ImageCache=[];function _FCKImagePreloader_OnImage(d,c){if((--c._PreloadCount)==0&&c.OnComplete){c.OnComplete();}}var FCKRegexLib={AposEntity:/&apos;/gi,ObjectElements:/^(?:IMG|TABLE|TR|TD|TH|INPUT|SELECT|TEXTAREA|HR|OBJECT|A|UL|OL|LI)$/i,NamedCommands:/^(?:Cut|Copy|Paste|Print|SelectAll|RemoveFormat|Unlink|Undo|Redo|Bold|Italic|Underline|StrikeThrough|Subscript|Superscript|JustifyLeft|JustifyCenter|JustifyRight|JustifyFull|Outdent|Indent|InsertOrderedList|InsertUnorderedList|InsertHorizontalRule)$/i,BeforeBody:/(^[\s\S]*\<body[^\>]*\>)/i,AfterBody:/(\<\/body\>[\s\S]*$)/i,ToReplace:/___fcktoreplace:([\w]+)/ig,MetaHttpEquiv:/http-equiv\s*=\s*["']?([^"' ]+)/i,HasBaseTag:/<base /i,HasBodyTag:/<body[\s|>]/i,HtmlOpener:/<html\s?[^>]*>/i,HeadOpener:/<head\s?[^>]*>/i,HeadCloser:/<\/head\s*>/i,FCK_Class:/\s*FCK__[^ ]*(?=\s+|$)/,ElementName:/(^[a-z_:][\w.\-:]*\w$)|(^[a-z_]$)/,ForceSimpleAmpersand:/___FCKAmp___/g,SpaceNoClose:/\/>/g,EmptyParagraph:/^<(p|div|address|h\d|center)(?=[ >])[^>]*>\s*(<\/\1>)?$/,EmptyOutParagraph:/^<(p|div|address|h\d|center)(?=[ >])[^>]*>(?:\s*|&nbsp;|&#160;)(<\/\1>)?$/,TagBody:/></,GeckoEntitiesMarker:/#\?-\:/g,ProtectUrlsImg:/<img(?=\s).*?\ssrc=((?:(?:\s*)("|').*?\2)|(?:[^"'][^ >]+))/gi,ProtectUrlsA:/<a(?=\s).*?\shref=((?:(?:\s*)("|').*?\2)|(?:[^"'][^ >]+))/gi,ProtectUrlsArea:/<area(?=\s).*?\shref=((?:(?:\s*)("|').*?\2)|(?:[^"'][^ >]+))/gi,Html4DocType:/HTML 4\.0 Transitional/i,DocTypeTag:/<!DOCTYPE[^>]*>/i,HtmlDocType:/DTD HTML/,TagsWithEvent:/<[^\>]+ on\w+[\s\r\n]*=[\s\r\n]*?('|")[\s\S]+?\>/g,EventAttributes:/\s(on\w+)[\s\r\n]*=[\s\r\n]*?('|")([\s\S]*?)\2/g,ProtectedEvents:/\s\w+_fckprotectedatt="([^"]+)"/g,StyleProperties:/\S+\s*:/g,InvalidSelfCloseTags:/(<(?!base|meta|link|hr|br|param|img|area|input)([a-zA-Z0-9:]+)[^>]*)\/>/gi,StyleVariableAttName:/#\(\s*("|')(.+?)\1[^\)]*\s*\)/g,RegExp:/^\/(.*)\/([gim]*)$/,HtmlTag:/<[^\s<>](?:"[^"]*"|'[^']*'|[^<])*>/};var FCKListsLib={BlockElements:{address:1,blockquote:1,center:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,marquee:1,noscript:1,ol:1,p:1,pre:1,script:1,table:1,ul:1},NonEmptyBlockElements:{p:1,div:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,address:1,pre:1,ol:1,ul:1,li:1,td:1,th:1},InlineChildReqElements:{abbr:1,acronym:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1},InlineNonEmptyElements:{a:1,abbr:1,acronym:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1},EmptyElements:{base:1,col:1,meta:1,link:1,hr:1,br:1,param:1,img:1,area:1,input:1},PathBlockElements:{address:1,blockquote:1,dl:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,p:1,pre:1,li:1,dt:1,de:1},PathBlockLimitElements:{body:1,div:1,td:1,th:1,caption:1,form:1},StyleBlockElements:{address:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,p:1,pre:1},StyleObjectElements:{img:1,hr:1,li:1,table:1,tr:1,td:1,embed:1,object:1,ol:1,ul:1},NonEditableElements:{button:1,option:1,script:1,iframe:1,textarea:1,object:1,embed:1,map:1,applet:1},BlockBoundaries:{p:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,address:1,pre:1,ol:1,ul:1,li:1,dt:1,de:1,table:1,thead:1,tbody:1,tfoot:1,tr:1,th:1,td:1,caption:1,col:1,colgroup:1,blockquote:1,body:1},ListBoundaries:{p:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,address:1,pre:1,ol:1,ul:1,li:1,dt:1,de:1,table:1,thead:1,tbody:1,tfoot:1,tr:1,th:1,td:1,caption:1,col:1,colgroup:1,blockquote:1,body:1,br:1}};var FCKLanguageManager=FCK.Language={AvailableLanguages:{af:"Afrikaans",ar:"Arabic",bg:"Bulgarian",bn:"Bengali/Bangla",bs:"Bosnian",ca:"Catalan",cs:"Czech",da:"Danish",de:"German",el:"Greek",en:"English","en-au":"English (Australia)","en-ca":"English (Canadian)","en-uk":"English (United Kingdom)",eo:"Esperanto",es:"Spanish",et:"Estonian",eu:"Basque",fa:"Persian",fi:"Finnish",fo:"Faroese",fr:"French","fr-ca":"French (Canada)",gl:"Galician",gu:"Gujarati",he:"Hebrew",hi:"Hindi",hr:"Croatian",hu:"Hungarian",is:"Icelandic",it:"Italian",ja:"Japanese",km:"Khmer",ko:"Korean",lt:"Lithuanian",lv:"Latvian",mn:"Mongolian",ms:"Malay",nb:"Norwegian Bokmal",nl:"Dutch",no:"Norwegian",pl:"Polish",pt:"Portuguese (Portugal)","pt-br":"Portuguese (Brazil)",ro:"Romanian",ru:"Russian",sk:"Slovak",sl:"Slovenian",sr:"Serbian (Cyrillic)","sr-latn":"Serbian (Latin)",sv:"Swedish",th:"Thai",tr:"Turkish",uk:"Ukrainian",vi:"Vietnamese",zh:"Chinese Traditional","zh-cn":"Chinese Simplified"},GetActiveLanguage:function(){if(FCKConfig.AutoDetectLanguage){var b;if(navigator.userLanguage){b=navigator.userLanguage.toLowerCase();}else{if(navigator.language){b=navigator.language.toLowerCase();}else{return FCKConfig.DefaultLanguage;}}if(b.length>=5){b=b.substr(0,5);if(this.AvailableLanguages[b]){return b;}}if(b.length>=2){b=b.substr(0,2);if(this.AvailableLanguages[b]){return b;}}}return this.DefaultLanguage;},TranslateElements:function(k,l,m,n){var o=k.getElementsByTagName(l);var p,q;for(var i=0;i<o.length;i++){if((p=o[i].getAttribute("fckLang"))){if((q=FCKLang[p])){if(n){q=FCKTools.HTMLEncode(q);}o[i][m]=q;}}}},TranslatePage:function(b){this.TranslateElements(b,"INPUT","value");this.TranslateElements(b,"SPAN","innerHTML");this.TranslateElements(b,"LABEL","innerHTML");this.TranslateElements(b,"OPTION","innerHTML",true);this.TranslateElements(b,"LEGEND","innerHTML");},Initialize:function(){if(this.AvailableLanguages[FCKConfig.DefaultLanguage]){this.DefaultLanguage=FCKConfig.DefaultLanguage;}else{this.DefaultLanguage="en";}this.ActiveLanguage={};this.ActiveLanguage.Code=this.GetActiveLanguage();this.ActiveLanguage.Name=this.AvailableLanguages[this.ActiveLanguage.Code];}};var FCKXHtmlEntities={};FCKXHtmlEntities.Initialize=function(){if(FCKXHtmlEntities.Entities){return;}var h="";var i,k;if(FCKConfig.ProcessHTMLEntities){FCKXHtmlEntities.Entities={" ":"nbsp","¡":"iexcl","¢":"cent","£":"pound","¤":"curren","¥":"yen","¦":"brvbar","§":"sect","¨":"uml","©":"copy","ª":"ordf","«":"laquo","¬":"not","":"shy","®":"reg","¯":"macr","°":"deg","±":"plusmn","²":"sup2","³":"sup3","´":"acute","µ":"micro","¶":"para","·":"middot","¸":"cedil","¹":"sup1","º":"ordm","»":"raquo","¼":"frac14","½":"frac12","¾":"frac34","¿":"iquest","×":"times","÷":"divide","ƒ":"fnof","•":"bull","…":"hellip","′":"prime","″":"Prime","‾":"oline","⁄":"frasl","℘":"weierp","ℑ":"image","ℜ":"real","™":"trade","ℵ":"alefsym","←":"larr","↑":"uarr","→":"rarr","↓":"darr","↔":"harr","↵":"crarr","⇐":"lArr","⇑":"uArr","⇒":"rArr","⇓":"dArr","⇔":"hArr","∀":"forall","∂":"part","∃":"exist","∅":"empty","∇":"nabla","∈":"isin","∉":"notin","∋":"ni","∏":"prod","∑":"sum","−":"minus","∗":"lowast","√":"radic","∝":"prop","∞":"infin","∠":"ang","∧":"and","∨":"or","∩":"cap","∪":"cup","∫":"int","∴":"there4","∼":"sim","≅":"cong","≈":"asymp","≠":"ne","≡":"equiv","≤":"le","≥":"ge","⊂":"sub","⊃":"sup","⊄":"nsub","⊆":"sube","⊇":"supe","⊕":"oplus","⊗":"otimes","⊥":"perp","⋅":"sdot","\u2308":"lceil","\u2309":"rceil","\u230a":"lfloor","\u230b":"rfloor","\u2329":"lang","\u232a":"rang","◊":"loz","♠":"spades","♣":"clubs","♥":"hearts","♦":"diams",'"':"quot",">":"gt","ˆ":"circ","˜":"tilde"," ":"ensp"," ":"emsp"," ":"thinsp","":"zwnj","":"zwj","":"lrm","":"rlm","–":"ndash","—":"mdash","‘":"lsquo","’":"rsquo","‚":"sbquo","“":"ldquo","”":"rdquo","„":"bdquo","†":"dagger","‡":"Dagger","‰":"permil","‹":"lsaquo","›":"rsaquo","€":"euro"};for(k in FCKXHtmlEntities.Entities){h+=k;}if(FCKConfig.IncludeLatinEntities){i={"À":"Agrave","Á":"Aacute","Â":"Acirc","Ã":"Atilde","Ä":"Auml","Å":"Aring","Æ":"AElig","Ç":"Ccedil","È":"Egrave","É":"Eacute","Ê":"Ecirc","Ë":"Euml","Ì":"Igrave","Í":"Iacute","Î":"Icirc","Ï":"Iuml","Ð":"ETH","Ñ":"Ntilde","Ò":"Ograve","Ó":"Oacute","Ô":"Ocirc","Õ":"Otilde","Ö":"Ouml","Ø":"Oslash","Ù":"Ugrave","Ú":"Uacute","Û":"Ucirc","Ü":"Uuml","Ý":"Yacute","Þ":"THORN","ß":"szlig","à":"agrave","á":"aacute","â":"acirc","ã":"atilde","ä":"auml","å":"aring","æ":"aelig","ç":"ccedil","è":"egrave","é":"eacute","ê":"ecirc","ë":"euml","ì":"igrave","í":"iacute","î":"icirc","ï":"iuml","ð":"eth","ñ":"ntilde","ò":"ograve","ó":"oacute","ô":"ocirc","õ":"otilde","ö":"ouml","ø":"oslash","ù":"ugrave","ú":"uacute","û":"ucirc","ü":"uuml","ý":"yacute","þ":"thorn","ÿ":"yuml","Œ":"OElig","œ":"oelig","Š":"Scaron","š":"scaron","Ÿ":"Yuml"};for(k in i){FCKXHtmlEntities.Entities[k]=i[k];h+=k;}i=null;}if(FCKConfig.IncludeGreekEntities){i={"Α":"Alpha","Β":"Beta","Γ":"Gamma","Δ":"Delta","Ε":"Epsilon","Ζ":"Zeta","Η":"Eta","Θ":"Theta","Ι":"Iota","Κ":"Kappa","Λ":"Lambda","Μ":"Mu","Ν":"Nu","Ξ":"Xi","Ο":"Omicron","Π":"Pi","Ρ":"Rho","Σ":"Sigma","Τ":"Tau","Υ":"Upsilon","Φ":"Phi","Χ":"Chi","Ψ":"Psi","Ω":"Omega","α":"alpha","β":"beta","γ":"gamma","δ":"delta","ε":"epsilon","ζ":"zeta","η":"eta","θ":"theta","ι":"iota","κ":"kappa","λ":"lambda","μ":"mu","ν":"nu","ξ":"xi","ο":"omicron","π":"pi","ρ":"rho","ς":"sigmaf","σ":"sigma","τ":"tau","υ":"upsilon","φ":"phi","χ":"chi","ψ":"psi","ω":"omega","\u03d1":"thetasym","\u03d2":"upsih","\u03d6":"piv"};for(k in i){FCKXHtmlEntities.Entities[k]=i[k];h+=k;}i=null;}}else{FCKXHtmlEntities.Entities={">":"gt"};h=">";h+=" ";}var j="["+h+"]";if(FCKConfig.ProcessNumericEntities){j="[^ -~]|"+j;}var g=FCKConfig.AdditionalNumericEntities;if(g&&g.length>0){j+="|"+FCKConfig.AdditionalNumericEntities;}FCKXHtmlEntities.EntitiesRegex=new RegExp(j,"g");};var FCKXHtml={};FCKXHtml.CurrentJobNum=0;FCKXHtml.GetXHTML=function(j,k,l){FCKDomTools.CheckAndRemovePaddingNode(FCKTools.GetElementDocument(j),FCKConfig.EnterMode);FCKXHtmlEntities.Initialize();this._NbspEntity=(FCKConfig.ProcessHTMLEntities?"nbsp":"#160");var m=FCK.IsDirty();FCKXHtml.SpecialBlocks=[];this.XML=FCKTools.CreateXmlObject("DOMDocument");this.MainNode=this.XML.appendChild(this.XML.createElement("xhtml"));FCKXHtml.CurrentJobNum++;if(k){this._AppendNode(this.MainNode,j);}else{this._AppendChildNodes(this.MainNode,j,false);}if(FCKBrowserInfo.IsIE){FCKXHtml._RemoveXHtmlJobProperties(j);}var n=this._GetMainXmlString();this.XML=null;if(FCKBrowserInfo.IsSafari){n=n.replace(/^<xhtml.*?>/,"<xhtml>");}n=n.substr(7,n.length-15).Trim();if(FCKConfig.DocType.length>0&&FCKRegexLib.HtmlDocType.test(FCKConfig.DocType)){n=n.replace(FCKRegexLib.SpaceNoClose,">");}else{n=n.replace(FCKRegexLib.SpaceNoClose," />");}if(FCKConfig.ForceSimpleAmpersand){n=n.replace(FCKRegexLib.ForceSimpleAmpersand,"&");}if(l){n=FCKCodeFormatter.Format(n);}for(var i=0;i<FCKXHtml.SpecialBlocks.length;i++){var o=new RegExp("___FCKsi___"+i);n=n.replace(o,FCKXHtml.SpecialBlocks[i]);}n=n.replace(FCKRegexLib.GeckoEntitiesMarker,"&");if(!m){FCK.ResetIsDirty();}FCKDomTools.EnforcePaddingNode(FCKTools.GetElementDocument(j),FCKConfig.EnterMode);return n;};FCKXHtml._AppendAttribute=function(h,i,j){try{if(j==undefined||j==null){j="";}else{if(j.replace){if(FCKConfig.ForceSimpleAmpersand){j=j.replace(/&/g,"___FCKAmp___");}j=j.replace(FCKXHtmlEntities.EntitiesRegex,FCKXHtml_GetEntity);}}var k=this.XML.createAttribute(i);k.value=j;h.attributes.setNamedItem(k);}catch(g){}};FCKXHtml._AppendChildNodes=function(i,j,k){var l=j.firstChild;while(l){this._AppendNode(i,l);l=l.nextSibling;}if(k&&j.tagName&&j.tagName.toLowerCase()!="pre"){FCKDomTools.TrimNode(i);if(FCKConfig.FillEmptyBlocks){var m=i.lastChild;if(m&&m.nodeType==1&&m.nodeName=="br"){this._AppendEntity(i,this._NbspEntity);}}}if(i.childNodes.length==0){if(k&&FCKConfig.FillEmptyBlocks){this._AppendEntity(i,this._NbspEntity);return i;}var h=i.nodeName;if(FCKListsLib.InlineChildReqElements[h]){return null;}if(!FCKListsLib.EmptyElements[h]){i.appendChild(this.XML.createTextNode(""));}}return i;};FCKXHtml._AppendNode=function(j,k){if(!k){return false;}switch(k.nodeType){case 1:if(FCKBrowserInfo.IsGecko&&k.tagName.toLowerCase()=="br"&&k.parentNode.tagName.toLowerCase()=="pre"){var l="\r";if(k==k.parentNode.firstChild){l+="\r";}return FCKXHtml._AppendNode(j,this.XML.createTextNode(l));}if(k.getAttribute("_fckfakelement")){return FCKXHtml._AppendNode(j,FCK.GetRealElement(k));}if(FCKBrowserInfo.IsGecko&&(k.hasAttribute("_moz_editor_bogus_node")||k.getAttribute("type")=="_moz")){if(k.nextSibling){return false;}else{k.removeAttribute("_moz_editor_bogus_node");k.removeAttribute("type");}}if(k.getAttribute("_fcktemp")){return false;}var m=k.tagName.toLowerCase();if(FCKBrowserInfo.IsIE){if(k.scopeName&&k.scopeName!="HTML"&&k.scopeName!="FCK"){m=k.scopeName.toLowerCase()+":"+m;}}else{if(m.StartsWith("fck:")){m=m.Remove(0,4);}}if(!FCKRegexLib.ElementName.test(m)){return false;}if(k._fckxhtmljob&&k._fckxhtmljob==FCKXHtml.CurrentJobNum){return false;}var o=this.XML.createElement(m);FCKXHtml._AppendAttributes(j,k,o,m);k._fckxhtmljob=FCKXHtml.CurrentJobNum;var i=FCKXHtml.TagProcessors[m];if(i){o=i(o,k,j);}else{o=this._AppendChildNodes(o,k,Boolean(FCKListsLib.NonEmptyBlockElements[m]));}if(!o){return false;}j.appendChild(o);break;case 3:if(k.parentNode&&k.parentNode.nodeName.IEquals("pre")){return this._AppendTextNode(j,k.nodeValue);}return this._AppendTextNode(j,k.nodeValue.ReplaceNewLineChars(" "));case 8:if(FCKBrowserInfo.IsIE&&!k.innerHTML){break;}try{j.appendChild(this.XML.createComment(k.nodeValue));}catch(n){}break;default:j.appendChild(this.XML.createComment("Element not supported - Type: "+k.nodeType+" Name: "+k.nodeName));break;}return true;};FCKXHtml._AppendSpecialItem=function(b){return"___FCKsi___"+(FCKXHtml.SpecialBlocks.push(b)-1);};FCKXHtml._AppendEntity=function(d,c){d.appendChild(this.XML.createTextNode("#?-:"+c+";"));};FCKXHtml._AppendTextNode=function(f,g){var d=g.length>0;if(d){f.appendChild(this.XML.createTextNode(g.replace(FCKXHtmlEntities.EntitiesRegex,FCKXHtml_GetEntity)));}return d;};function FCKXHtml_GetEntity(d){var c=FCKXHtmlEntities.Entities[d]||("#"+d.charCodeAt(0));return"#?-:"+c+";";}FCKXHtml.TagProcessors={a:function(f,g){if(g.innerHTML.Trim().length==0&&!g.name){return false;}var d=g.getAttribute("_fcksavedurl");if(d!=null){FCKXHtml._AppendAttribute(f,"href",d);}if(FCKBrowserInfo.IsIE){if(g.name){FCKXHtml._AppendAttribute(f,"name",g.name);}}f=FCKXHtml._AppendChildNodes(f,g,false);return f;},area:function(h,i){var j=i.getAttribute("_fcksavedurl");if(j!=null){FCKXHtml._AppendAttribute(h,"href",j);}if(FCKBrowserInfo.IsIE){if(!h.attributes.getNamedItem("coords")){var k=i.getAttribute("coords",2);if(k&&k!="0,0,0"){FCKXHtml._AppendAttribute(h,"coords",k);}}if(!h.attributes.getNamedItem("shape")){var g=i.getAttribute("shape",2);if(g&&g.length>0){FCKXHtml._AppendAttribute(h,"shape",g.toLowerCase());}}}return h;},body:function(d,c){d=FCKXHtml._AppendChildNodes(d,c,false);d.removeAttribute("spellcheck");return d;},iframe:function(f,g){var d=g.innerHTML;if(FCKBrowserInfo.IsGecko){d=FCKTools.HTMLDecode(d);}d=d.replace(/\s_fcksavedurl="[^"]*"/g,"");f.appendChild(FCKXHtml.XML.createTextNode(FCKXHtml._AppendSpecialItem(d)));return f;},img:function(f,g){if(!f.attributes.getNamedItem("alt")){FCKXHtml._AppendAttribute(f,"alt","");}var d=g.getAttribute("_fcksavedurl");if(d!=null){FCKXHtml._AppendAttribute(f,"src",d);}if(g.style.width){f.removeAttribute("width");}if(g.style.height){f.removeAttribute("height");}return f;},li:function(g,h,i){if(i.nodeName.IEquals(["ul","ol"])){return FCKXHtml._AppendChildNodes(g,h,true);}var f=FCKXHtml.XML.createElement("ul");h._fckxhtmljob=null;do{FCKXHtml._AppendNode(f,h);do{h=FCKDomTools.GetNextSibling(h);}while(h&&h.nodeType==3&&h.nodeValue.Trim().length==0);}while(h&&h.nodeName.toLowerCase()=="li");return f;},ol:function(g,h,i){if(h.innerHTML.Trim().length==0){return false;}var f=i.lastChild;if(f&&f.nodeType==3){f=f.previousSibling;}if(f&&f.nodeName.toUpperCase()=="LI"){h._fckxhtmljob=null;FCKXHtml._AppendNode(f,h);return false;}g=FCKXHtml._AppendChildNodes(g,h);return g;},pre:function(f,g){var d=g.firstChild;if(d&&d.nodeType==3){f.appendChild(FCKXHtml.XML.createTextNode(FCKXHtml._AppendSpecialItem("\r\n")));}FCKXHtml._AppendChildNodes(f,g,true);return f;},script:function(d,c){if(!d.attributes.getNamedItem("type")){FCKXHtml._AppendAttribute(d,"type","text/javascript");}d.appendChild(FCKXHtml.XML.createTextNode(FCKXHtml._AppendSpecialItem(c.text)));return d;},span:function(d,c){if(c.innerHTML.length==0){return false;}d=FCKXHtml._AppendChildNodes(d,c,false);return d;},style:function(f,g){if(!f.attributes.getNamedItem("type")){FCKXHtml._AppendAttribute(f,"type","text/css");}var d=g.innerHTML;if(FCKBrowserInfo.IsIE){d=d.replace(/^(\r\n|\n|\r)/,"");}f.appendChild(FCKXHtml.XML.createTextNode(FCKXHtml._AppendSpecialItem(d)));return f;},title:function(d,c){d.appendChild(FCKXHtml.XML.createTextNode(FCK.EditorDocument.title));return d;}};FCKXHtml.TagProcessors.ul=FCKXHtml.TagProcessors.ol;FCKXHtml._GetMainXmlString=function(){return(new XMLSerializer()).serializeToString(this.MainNode);};FCKXHtml._AppendAttributes=function(k,l,n){var o=l.attributes;for(var m=0;m<o.length;m++){var p=o[m];if(p.specified){var q=p.nodeName.toLowerCase();var j;if(q.StartsWith("_fck")){continue;}else{if(q.indexOf("_moz")==0){continue;}else{if(q=="class"){j=p.nodeValue.replace(FCKRegexLib.FCK_Class,"");if(j.length==0){continue;}}else{if(p.nodeValue===true){j=q;}else{j=l.getAttribute(q,2);}}}}this._AppendAttribute(n,q,j);}}};if(FCKBrowserInfo.IsOpera){FCKXHtml.TagProcessors["head"]=function(d,c){FCKXHtml.XML._HeadElement=d;d=FCKXHtml._AppendChildNodes(d,c,true);return d;};FCKXHtml.TagProcessors["meta"]=function(g,h,i){if(h.parentNode.nodeName.toLowerCase()!="head"){var f=FCKXHtml.XML._HeadElement;if(f&&i!=f){delete h._fckxhtmljob;FCKXHtml._AppendNode(f,h);return null;}}return g;};}if(FCKBrowserInfo.IsGecko){FCKXHtml.TagProcessors["link"]=function(d,c){if(c.href.substr(0,9).toLowerCase()=="chrome://"){return false;}return d;};}var FCKCodeFormatter={};FCKCodeFormatter.Init=function(){var b=this.Regex={};b.BlocksOpener=/\<(P|DIV|H1|H2|H3|H4|H5|H6|ADDRESS|PRE|OL|UL|LI|DL|DT|DD|TITLE|META|LINK|BASE|SCRIPT|LINK|TD|TH|AREA|OPTION)[^\>]*\>/gi;b.BlocksCloser=/\<\/(P|DIV|H1|H2|H3|H4|H5|H6|ADDRESS|PRE|OL|UL|LI|DL|DT|DD|TITLE|META|LINK|BASE|SCRIPT|LINK|TD|TH|AREA|OPTION)[^\>]*\>/gi;b.NewLineTags=/\<(BR|HR)[^\>]*\>/gi;b.MainTags=/\<\/?(HTML|HEAD|BODY|FORM|TABLE|TBODY|THEAD|TR)[^\>]*\>/gi;b.LineSplitter=/\s*\n+\s*/g;b.IncreaseIndent=/^\<(HTML|HEAD|BODY|FORM|TABLE|TBODY|THEAD|TR|UL|OL|DL)[ \/\>]/i;b.DecreaseIndent=/^\<\/(HTML|HEAD|BODY|FORM|TABLE|TBODY|THEAD|TR|UL|OL|DL)[ \>]/i;b.FormatIndentatorRemove=new RegExp("^"+FCKConfig.FormatIndentator);b.ProtectedTags=/(<PRE[^>]*>)([\s\S]*?)(<\/PRE>)/gi;};FCKCodeFormatter._ProtectData=function(g,h,i,f){return h+"___FCKpd___"+(FCKCodeFormatter.ProtectedData.push(i)-1)+f;};FCKCodeFormatter.Format=function(j){if(!this.Regex){this.Init();}FCKCodeFormatter.ProtectedData=[];var l=j.replace(this.Regex.ProtectedTags,FCKCodeFormatter._ProtectData);l=l.replace(this.Regex.BlocksOpener,"\n$&");l=l.replace(this.Regex.BlocksCloser,"$&\n");l=l.replace(this.Regex.NewLineTags,"$&\n");l=l.replace(this.Regex.MainTags,"\n$&\n");var m="";var n=l.split(this.Regex.LineSplitter);l="";for(var q=0;q<n.length;q++){var o=n[q];if(o.length==0){continue;}if(this.Regex.DecreaseIndent.test(o)){m=m.replace(this.Regex.FormatIndentatorRemove,"");}l+=m+o+"\n";if(this.Regex.IncreaseIndent.test(o)){m+=FCKConfig.FormatIndentator;}}for(var i=0;i<FCKCodeFormatter.ProtectedData.length;i++){var p=new RegExp("___FCKpd___"+i);l=l.replace(p,FCKCodeFormatter.ProtectedData[i].replace(/\$/g,"$$$$"));}return l.Trim();};var FCKUndo={};FCKUndo.SavedData=[];FCKUndo.CurrentIndex=-1;FCKUndo.TypesCount=0;FCKUndo.Changed=false;FCKUndo.MaxTypes=25;FCKUndo.Typing=false;FCKUndo.SaveLocked=false;FCKUndo._GetBookmark=function(){FCKSelection.Restore();var g=new FCKDomRange(FCK.EditorWindow);try{g.MoveToSelection();}catch(f){return null;}if(FCKBrowserInfo.IsIE){var h=g.CreateBookmark();var i=FCK.EditorDocument.body.innerHTML;g.MoveToBookmark(h);return[h,i];}return g.CreateBookmark2();};FCKUndo._SelectBookmark=function(f){if(!f){return;}var g=new FCKDomRange(FCK.EditorWindow);if(f instanceof Object){if(FCKBrowserInfo.IsIE){g.MoveToBookmark(f[0]);}else{g.MoveToBookmark2(f);}try{g.Select();}catch(d){g.MoveToPosition(FCK.EditorDocument.body,4);g.Select();}}};FCKUndo._CompareCursors=function(f,g){for(var d=0;d<Math.min(f.length,g.length);d++){if(f[d]<g[d]){return -1;}else{if(f[d]>g[d]){return 1;}}}if(f.length<g.length){return -1;}else{if(f.length>g.length){return 1;}}return 0;};FCKUndo._CheckIsBookmarksEqual=function(i,j){if(!(i&&j)){return false;}if(FCKBrowserInfo.IsIE){var k=i[1].search(i[0].StartId);var l=j[1].search(j[0].StartId);var m=i[1].search(i[0].EndId);var h=j[1].search(j[0].EndId);return k==l&&m==h;}else{return this._CompareCursors(i.Start,j.Start)==0&&this._CompareCursors(i.End,j.End)==0;}};FCKUndo.SaveUndoStep=function(){if(FCK.EditMode!=0||this.SaveLocked){return;}if(this.SavedData.length){this.Changed=true;}var d=FCK.EditorDocument.body.innerHTML;var c=this._GetBookmark();this.SavedData=this.SavedData.slice(0,this.CurrentIndex+1);if(this.CurrentIndex>0&&d==this.SavedData[this.CurrentIndex][0]&&this._CheckIsBookmarksEqual(c,this.SavedData[this.CurrentIndex][1])){return;}else{if(this.CurrentIndex==0&&this.SavedData.length&&d==this.SavedData[0][0]){this.SavedData[0][1]=c;return;}}if(this.CurrentIndex+1>=FCKConfig.MaxUndoLevels){this.SavedData.shift();}else{this.CurrentIndex++;}this.SavedData[this.CurrentIndex]=[d,c];FCK.Events.FireEvent("OnSelectionChange");};FCKUndo.CheckUndoState=function(){return(this.Changed||this.CurrentIndex>0);};FCKUndo.CheckRedoState=function(){return(this.CurrentIndex<(this.SavedData.length-1));};FCKUndo.Undo=function(){if(this.CheckUndoState()){if(this.CurrentIndex==(this.SavedData.length-1)){this.SaveUndoStep();}this._ApplyUndoLevel(--this.CurrentIndex);FCK.Events.FireEvent("OnSelectionChange");}};FCKUndo.Redo=function(){if(this.CheckRedoState()){this._ApplyUndoLevel(++this.CurrentIndex);FCK.Events.FireEvent("OnSelectionChange");}};FCKUndo._ApplyUndoLevel=function(d){var c=this.SavedData[d];if(!c){return;}if(FCKBrowserInfo.IsIE){if(c[1]&&c[1][1]){FCK.SetInnerHtml(c[1][1]);}else{FCK.SetInnerHtml(c[0]);}}else{FCK.EditorDocument.body.innerHTML=c[0];}this._SelectBookmark(c[1]);this.TypesCount=0;this.Changed=false;this.Typing=false;};var FCKEditingArea=function(b){this.TargetElement=b;this.Mode=0;if(FCK.IECleanup){FCK.IECleanup.AddItem(this,FCKEditingArea_Cleanup);}};FCKEditingArea.prototype.Start=function(x,y){var z=this.TargetElement;var A=FCKTools.GetElementDocument(z);while(z.firstChild){z.removeChild(z.firstChild);}if(this.Mode==0){if(FCK_IS_CUSTOM_DOMAIN){x='<script>document.domain="'+FCK_RUNTIME_DOMAIN+'";<\/script>'+x;}if(FCKBrowserInfo.IsIE){x=x.replace(/(<base[^>]*?)\s*\/?>(?!\s*<\/base>)/gi,"$1></base>");}else{if(!y){var n=x.match(FCKRegexLib.BeforeBody);var o=x.match(FCKRegexLib.AfterBody);if(n&&o){var p=x.substr(n[1].length,x.length-n[1].length-o[1].length);x=n[1]+"&nbsp;"+o[1];if(FCKBrowserInfo.IsGecko&&(p.length==0||FCKRegexLib.EmptyParagraph.test(p))){p='<br type="_moz">';}this._BodyHTML=p;}else{this._BodyHTML=x;}}}var q=this.IFrame=A.createElement("iframe");var r='<script type="text/javascript" _fcktemp="true">window.onerror=function(){return true;};<\/script>';q.frameBorder=0;q.style.width=q.style.height="100%";if(FCK_IS_CUSTOM_DOMAIN&&FCKBrowserInfo.IsIE){window._FCKHtmlToLoad=x.replace(/<head>/i,"<head>"+r);q.src='javascript:void( (function(){document.open() ;document.domain="'+document.domain+'" ;document.write( window.parent._FCKHtmlToLoad );document.close() ;window.parent._FCKHtmlToLoad = null ;})() )';}else{if(!FCKBrowserInfo.IsGecko){q.src="javascript:void(0)";}}z.appendChild(q);this.Window=q.contentWindow;if(!FCK_IS_CUSTOM_DOMAIN||!FCKBrowserInfo.IsIE){var t=this.Window.document;t.open();t.write(x.replace(/<head>/i,"<head>"+r));t.close();}if(FCKBrowserInfo.IsAIR){FCKAdobeAIR.EditingArea_Start(t,x);}if(FCKBrowserInfo.IsGecko10&&!y){this.Start(x,true);return;}if(q.readyState&&q.readyState!="completed"){var u=this;setTimeout(function(){try{u.Window.document.documentElement.doScroll("left");}catch(a){setTimeout(arguments.callee,0);return;}u.Window._FCKEditingArea=u;FCKEditingArea_CompleteStart.call(u.Window);},0);}else{this.Window._FCKEditingArea=this;if(FCKBrowserInfo.IsGecko10){this.Window.setTimeout(FCKEditingArea_CompleteStart,500);}else{FCKEditingArea_CompleteStart.call(this.Window);}}}else{var v=this.Textarea=A.createElement("textarea");v.className="SourceField";v.dir="ltr";FCKDomTools.SetElementStyles(v,{width:"100%",height:"100%",border:"none",resize:"none",outline:"none"});z.appendChild(v);v.value=x;FCKTools.RunFunction(this.OnLoad);}};function FCKEditingArea_CompleteStart(){if(!this.document.body){this.setTimeout(FCKEditingArea_CompleteStart,50);return;}var b=this._FCKEditingArea;b.Document=b.Window.document;b.MakeEditable();FCKTools.RunFunction(b.OnLoad);}FCKEditingArea.prototype.MakeEditable=function(){var d=this.Document;if(FCKBrowserInfo.IsIE){d.body.disabled=true;d.body.contentEditable=true;d.body.removeAttribute("disabled");}else{try{d.body.spellcheck=(this.FFSpellChecker!==false);if(this._BodyHTML){d.body.innerHTML=this._BodyHTML;d.body.offsetLeft;this._BodyHTML=null;}d.designMode="on";d.execCommand("enableObjectResizing",false,!FCKConfig.DisableObjectResizing);d.execCommand("enableInlineTableEditing",false,!FCKConfig.DisableFFTableHandles);}catch(c){FCKTools.AddEventListener(this.Window.frameElement,"DOMAttrModified",FCKEditingArea_Document_AttributeNodeModified);}}};function FCKEditingArea_Document_AttributeNodeModified(d){var c=d.currentTarget.contentWindow._FCKEditingArea;if(c._timer){window.clearTimeout(c._timer);}c._timer=FCKTools.SetTimeout(FCKEditingArea_MakeEditableByMutation,1000,c);}function FCKEditingArea_MakeEditableByMutation(){delete this._timer;FCKTools.RemoveEventListener(this.Window.frameElement,"DOMAttrModified",FCKEditingArea_Document_AttributeNodeModified);this.MakeEditable();}FCKEditingArea.prototype.Focus=function(){try{if(this.Mode==0){if(FCKBrowserInfo.IsIE){this._FocusIE();}else{this.Window.focus();}}else{var d=FCKTools.GetElementDocument(this.Textarea);if((!d.hasFocus||d.hasFocus())&&d.activeElement==this.Textarea){return;}this.Textarea.focus();}}catch(c){}};FCKEditingArea.prototype._FocusIE=function(){this.Document.body.setActive();this.Window.focus();var f=this.Document.selection.createRange();var g=f.parentElement();var d=g.nodeName.toLowerCase();if(g.childNodes.length>0||!(FCKListsLib.BlockElements[d]||FCKListsLib.NonEmptyBlockElements[d])){return;}f=new FCKDomRange(this.Window);f.MoveToElementEditStart(g);f.Select();};function FCKEditingArea_Cleanup(){if(this.Document){this.Document.selection.empty();this.Document.body.innerHTML="";}this.TargetElement=null;this.IFrame=null;this.Document=null;this.Textarea=null;if(this.Window){this.Window._FCKEditingArea=null;this.Window=null;}}var FCKKeystrokeHandler=function(b){this.Keystrokes={};this.CancelCtrlDefaults=(b!==false);};FCKKeystrokeHandler.prototype.AttachToElement=function(b){FCKTools.AddEventListenerEx(b,"keydown",_FCKKeystrokeHandler_OnKeyDown,this);if(FCKBrowserInfo.IsGecko10||FCKBrowserInfo.IsOpera||(FCKBrowserInfo.IsGecko&&FCKBrowserInfo.IsMac)){FCKTools.AddEventListenerEx(b,"keypress",_FCKKeystrokeHandler_OnKeyPress,this);}};FCKKeystrokeHandler.prototype.SetKeystrokes=function(){for(var c=0;c<arguments.length;c++){var d=arguments[c];if(!d){continue;}if(typeof(d[0])=="object"){this.SetKeystrokes.apply(this,d);}else{if(d.length==1){delete this.Keystrokes[d[0]];}else{this.Keystrokes[d[0]]=d[1]===true?true:d;}}}};function _FCKKeystrokeHandler_OnKeyDown(j,k){var l=j.keyCode||j.which;var m=0;if(j.ctrlKey||j.metaKey){m+=CTRL;}if(j.shiftKey){m+=SHIFT;}if(j.altKey){m+=ALT;}var n=l+m;var o=k._CancelIt=false;var i=k.Keystrokes[n];if(i){if(i===true||!(k.OnKeystroke&&k.OnKeystroke.apply(k,i))){return true;}o=true;}if(o||(k.CancelCtrlDefaults&&m==CTRL&&(l<33||l>40))){k._CancelIt=true;if(j.preventDefault){return j.preventDefault();}j.returnValue=false;j.cancelBubble=true;return false;}return true;}function _FCKKeystrokeHandler_OnKeyPress(d,c){if(c._CancelIt){if(d.preventDefault){return d.preventDefault();}return false;}return true;}FCK.DTD=(function(){var M=FCKTools.Merge;var u,G,E,H,I,J,y,C,K,F,L,A,B,x,v,z,D;u={isindex:1,fieldset:1};v={input:1,button:1,select:1,textarea:1,label:1};x=M({a:1},v);y=M({iframe:1},x);z={hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1};A={ins:1,del:1,script:1};B=M({b:1,acronym:1,bdo:1,"var":1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1},A);C=M({sub:1,img:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1},B);D=M({p:1},C);E=M({iframe:1},C,v);F={img:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,"var":1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1};G=M({a:1},E);H={tr:1};I={"#":1};J=M({param:1},F);K=M({form:1},u,y,z,D);L={li:1};return{col:{},tr:{td:1,th:1},img:{},colgroup:{col:1},noscript:K,td:K,br:{},th:K,center:K,kbd:G,button:M(D,z),basefont:{},h5:G,h4:G,samp:G,h6:G,ol:L,h1:G,h3:G,option:I,h2:G,form:M(u,y,z,D),select:{optgroup:1,option:1},font:E,ins:K,menu:L,abbr:G,label:G,table:{thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1},code:G,script:I,tfoot:H,cite:G,li:K,input:{},iframe:K,strong:E,textarea:I,noframes:K,big:E,small:E,span:E,hr:{},dt:G,sub:E,optgroup:{option:1},param:{},bdo:G,"var":E,div:K,object:J,sup:E,dd:K,strike:E,area:{},dir:L,map:M({area:1,form:1,p:1},u,A,z),applet:J,dl:{dt:1,dd:1},del:K,isindex:{},fieldset:M({legend:1},F),thead:H,ul:L,acronym:G,b:E,a:E,blockquote:K,caption:G,i:E,u:E,tbody:H,s:G,address:M(y,D),tt:E,legend:G,q:G,pre:M(B,x),p:G,em:E,dfn:G};})();var FCKStyle=function(b){this.Element=(b.Element||"span").toLowerCase();this._StyleDesc=b;};FCKStyle.prototype={GetType:function(){var d=this.GetType_$;if(d!=undefined){return d;}var c=this.Element;if(c=="#"||FCKListsLib.StyleBlockElements[c]){d=0;}else{if(FCKListsLib.StyleObjectElements[c]){d=2;}else{d=1;}}return(this.GetType_$=d);},ApplyToSelection:function(d){var c=new FCKDomRange(d);c.MoveToSelection();this.ApplyToRange(c,true);},ApplyToRange:function(f,g,d){switch(this.GetType()){case 0:this.ApplyToRange=this._ApplyBlockStyle;break;case 1:this.ApplyToRange=this._ApplyInlineStyle;break;default:return;}this.ApplyToRange(f,g,d);},ApplyToObject:function(b){if(!b){return;}this.BuildElement(null,b);},RemoveFromSelection:function(d){var c=new FCKDomRange(d);c.MoveToSelection();this.RemoveFromRange(c,true);},RemoveFromRange:function(a,b,c){var B;var i=this._GetAttribsForComparison();var j=this._GetOverridesForComparison();if(a.CheckIsCollapsed()){var B=a.CreateBookmark(true);var A=a.GetBookmarkNode(B,true);var C=new FCKElementPath(A.parentNode);var D=[];var E=!FCKDomTools.GetNextSibling(A);var F=E||!FCKDomTools.GetPreviousSibling(A);var H;var I=-1;for(var X=0;X<C.Elements.length;X++){var J=C.Elements[X];if(this.CheckElementRemovable(J)){if(F&&!FCKDomTools.CheckIsEmptyElement(J,function(d){return(d!=A);})){H=J;I=D.length-1;}else{var K=J.nodeName.toLowerCase();if(K==this.Element){for(var L in i){if(FCKDomTools.HasAttribute(J,L)){switch(L){case"style":this._RemoveStylesFromElement(J);break;case"class":if(FCKDomTools.GetAttributeValue(J,L)!=this.GetFinalAttributeValue(L)){continue;}default:FCKDomTools.RemoveAttribute(J,L);}}}}this._RemoveOverrides(J,j[K]);if(this.GetType()==1){this._RemoveNoAttribElement(J);}}}else{if(F){D.push(J);}}F=F&&((E&&!FCKDomTools.GetNextSibling(J))||(!E&&!FCKDomTools.GetPreviousSibling(J)));if(H&&(!F||(X==C.Elements.length-1))){var M=FCKDomTools.RemoveNode(A);for(var Z=0;Z<=I;Z++){var N=FCKDomTools.CloneElement(D[Z]);N.appendChild(M);M=N;}if(E){FCKDomTools.InsertAfterNode(H,M);}else{H.parentNode.insertBefore(M,H);}F=false;H=null;}}if(b){a.SelectBookmark(B);}if(c){a.MoveToBookmark(B);}return;}a.Expand("inline_elements");B=a.CreateBookmark(true);var O=a.GetBookmarkNode(B,true);var P=a.GetBookmarkNode(B,false);a.Release(true);var C=new FCKElementPath(O);var Q=C.Elements;var J;for(var X=1;X<Q.length;X++){J=Q[X];if(J==C.Block||J==C.BlockLimit){break;}if(this.CheckElementRemovable(J)){FCKDomTools.BreakParent(O,J,a);}}C=new FCKElementPath(P);Q=C.Elements;for(var X=1;X<Q.length;X++){J=Q[X];if(J==C.Block||J==C.BlockLimit){break;}T=J.nodeName.toLowerCase();if(this.CheckElementRemovable(J)){FCKDomTools.BreakParent(P,J,a);}}var S=FCKDomTools.GetNextSourceNode(O,true);while(S){var R=FCKDomTools.GetNextSourceNode(S);if(S.nodeType==1){var T=S.nodeName.toLowerCase();var U=(T==this.Element);if(U){for(var L in i){if(FCKDomTools.HasAttribute(S,L)){switch(L){case"style":this._RemoveStylesFromElement(S);break;case"class":if(FCKDomTools.GetAttributeValue(S,L)!=this.GetFinalAttributeValue(L)){continue;}default:FCKDomTools.RemoveAttribute(S,L);}}}}else{U=!!j[T];}if(U){this._RemoveOverrides(S,j[T]);this._RemoveNoAttribElement(S);}}if(R==P){break;}S=R;}this._FixBookmarkStart(O);if(b){a.SelectBookmark(B);}if(c){a.MoveToBookmark(B);}},CheckElementRemovable:function(r,t){if(!r){return false;}var u=r.nodeName.toLowerCase();if(u==this.Element){if(!t&&!FCKDomTools.HasAttributes(r)){return true;}var v=this._GetAttribsForComparison();var i=(v._length==0);for(var m in v){if(m=="_length"){continue;}if(this._CompareAttributeValues(m,FCKDomTools.GetAttributeValue(r,m),(this.GetFinalAttributeValue(m)||""))){i=true;if(!t){break;}}else{i=false;if(t){return false;}}}if(i){return true;}}var n=this._GetOverridesForComparison()[u];if(n){if(!(v=n.Attributes)){return true;}for(var q=0;q<v.length;q++){var o=v[q][0];if(FCKDomTools.HasAttribute(r,o)){var p=v[q][1];if(p==null||(typeof p=="string"&&FCKDomTools.GetAttributeValue(r,o)==p)||p.test(FCKDomTools.GetAttributeValue(r,o))){return true;}}}}return false;},CheckActive:function(g){switch(this.GetType()){case 0:return this.CheckElementRemovable(g.Block||g.BlockLimit,true);case 1:var h=g.Elements;for(var f=0;f<h.length;f++){var i=h[f];if(i==g.Block||i==g.BlockLimit){continue;}if(this.CheckElementRemovable(i,true)){return true;}}}return false;},RemoveFromElement:function(k){var l=this._GetAttribsForComparison();var m=this._GetOverridesForComparison();var n=k.getElementsByTagName(this.Element);for(var i=n.length-1;i>=0;i--){var o=n[i];for(var p in l){if(FCKDomTools.HasAttribute(o,p)){switch(p){case"style":this._RemoveStylesFromElement(o);break;case"class":if(FCKDomTools.GetAttributeValue(o,p)!=this.GetFinalAttributeValue(p)){continue;}default:FCKDomTools.RemoveAttribute(o,p);}}}this._RemoveOverrides(o,m[this.Element]);this._RemoveNoAttribElement(o);}for(var q in m){if(q!=this.Element){n=k.getElementsByTagName(q);for(var i=n.length-1;i>=0;i--){var o=n[i];this._RemoveOverrides(o,m[q]);this._RemoveNoAttribElement(o);}}}},_RemoveStylesFromElement:function(g){var h=g.style.cssText;var i=this.GetFinalStyleValue();if(h.length>0&&i.length==0){return;}i="(^|;)\\s*("+i.replace(/\s*([^ ]+):.*?(;|$)/g,"$1|").replace(/\|$/,"")+"):[^;]+";var f=new RegExp(i,"gi");h=h.replace(f,"").Trim();if(h.length==0||h==";"){FCKDomTools.RemoveAttribute(g,"style");}else{g.style.cssText=h.replace(f,"");}},_RemoveOverrides:function(i,j){var k=j&&j.Attributes;if(k){for(var h=0;h<k.length;h++){var l=k[h][0];if(FCKDomTools.HasAttribute(i,l)){var m=k[h][1];if(m==null||(m.test&&m.test(FCKDomTools.GetAttributeValue(i,l)))||(typeof m=="string"&&FCKDomTools.GetAttributeValue(i,l)==m)){FCKDomTools.RemoveAttribute(i,l);}}}}},_RemoveNoAttribElement:function(f){if(!FCKDomTools.HasAttributes(f)){var g=f.firstChild;var d=f.lastChild;FCKDomTools.RemoveNode(f,true);this._MergeSiblings(g);if(g!=d){this._MergeSiblings(d);}}},BuildElement:function(i,j){var k=j||i.createElement(this.Element);var l=this._StyleDesc.Attributes;var m;if(l){for(var h in l){m=this.GetFinalAttributeValue(h);if(h.toLowerCase()=="class"){k.className=m;}else{k.setAttribute(h,m);}}}if(this._GetStyleText().length>0){k.style.cssText=this.GetFinalStyleValue();}return k;},_CompareAttributeValues:function(f,g,d){if(f=="style"&&g&&d){g=g.replace(/;$/,"").toLowerCase();d=d.replace(/;$/,"").toLowerCase();}return(g==d||((g===null||g==="")&&(d===null||d==="")));},GetFinalAttributeValue:function(d){var c=this._StyleDesc.Attributes;var c=c?c[d]:null;if(!c&&d=="style"){return this.GetFinalStyleValue();}if(c&&this._Variables){c=c.Replace(FCKRegexLib.StyleVariableAttName,this._GetVariableReplace,this);}return c;},GetFinalStyleValue:function(){var b=this._GetStyleText();if(b.length>0&&this._Variables){b=b.Replace(FCKRegexLib.StyleVariableAttName,this._GetVariableReplace,this);b=FCKTools.NormalizeCssText(b);}return b;},_GetVariableReplace:function(){return this._Variables[arguments[2]]||arguments[0];},SetVariable:function(f,g){var d=this._Variables;if(!d){d=this._Variables={};}this._Variables[f]=g;},_FromPre:function(i,j,k){var l=j.innerHTML;l=l.replace(/(\r\n|\r)/g,"\n");l=l.replace(/^[ \t]*\n/,"");l=l.replace(/\n$/,"");l=l.replace(/^[ \t]+|[ \t]+$/g,function(c,a,b){if(c.length==1){return"&nbsp;";}else{if(a==0){return new Array(c.length).join("&nbsp;")+" ";}else{return" "+new Array(c.length).join("&nbsp;");}}});var m=new FCKHtmlIterator(l);var h=[];m.Each(function(b,a){if(!b){a=a.replace(/\n/g,"<br>");a=a.replace(/[ \t]{2,}/g,function(c){return new Array(c.length).join("&nbsp;")+" ";});}h.push(a);});k.innerHTML=h.join("");return k;},_ToPre:function(j,k,l){var m=k.innerHTML.Trim();m=m.replace(/[ \t\r\n]*(<br[^>]*>)[ \t\r\n]*/gi,"<br />");var n=new FCKHtmlIterator(m);var o=[];n.Each(function(b,a){if(!b){a=a.replace(/([ \t\n\r]+|&nbsp;)/g," ");}else{if(b&&a=="<br />"){a="\n";}}o.push(a);});if(FCKBrowserInfo.IsIE){var i=j.createElement("div");i.appendChild(l);l.outerHTML="<pre>\n"+o.join("")+"</pre>";l=i.removeChild(i.firstChild);}else{l.innerHTML=o.join("");}return l;},_CheckAndMergePre:function(f,g){if(f!=FCKDomTools.GetPreviousSourceElement(g,true)){return;}var d=f.innerHTML.replace(/\n$/,"")+"\n\n"+g.innerHTML.replace(/^\n/,"");if(FCKBrowserInfo.IsIE){g.outerHTML="<pre>"+d+"</pre>";}else{g.innerHTML=d;}FCKDomTools.RemoveNode(f);},_CheckAndSplitPre:function(g){var h;var i=g.firstChild;i=i&&i.nextSibling;while(i){var f=i.nextSibling;if(f&&f.nextSibling&&i.nodeName.IEquals("br")&&f.nodeName.IEquals("br")){FCKDomTools.RemoveNode(i);i=f.nextSibling;FCKDomTools.RemoveNode(f);h=FCKDomTools.InsertAfterNode(h||g,FCKDomTools.CloneElement(g));continue;}if(h){i=i.previousSibling;FCKDomTools.MoveNode(i.nextSibling,h);}i=i.nextSibling;}},_ApplyBlockStyle:function(z,A,B){var C;if(A){C=z.CreateBookmark();}var o=new FCKDomRangeIterator(z);o.EnforceRealBlocks=true;var p;var q=z.Window.document;var r;while((p=o.GetNextParagraph())){var t=this.BuildElement(q);var u=t.nodeName.IEquals("pre");var v=p.nodeName.IEquals("pre");var x=u&&!v;var y=!u&&v;if(x){t=this._ToPre(q,p,t);}else{if(y){t=this._FromPre(q,p,t);}else{FCKDomTools.MoveChildren(p,t);}}p.parentNode.insertBefore(t,p);FCKDomTools.RemoveNode(p);if(u){if(r){this._CheckAndMergePre(r,t);}r=t;}else{if(y){this._CheckAndSplitPre(t);}}}if(A){z.SelectBookmark(C);}if(B){z.MoveToBookmark(C);}},_ApplyInlineStyle:function(u,v,x){var y=u.Window.document;if(u.CheckIsCollapsed()){var z=this.BuildElement(y);u.InsertNode(z);u.MoveToPosition(z,2);u.Select();return;}var A=this.Element;var B=FCK.DTD[A]||FCK.DTD.span;var C=this._GetAttribsForComparison();var D;u.Expand("inline_elements");var E=u.CreateBookmark(true);var F=u.GetBookmarkNode(E,true);var G=u.GetBookmarkNode(E,false);u.Release(true);var H=FCKDomTools.GetNextSourceNode(F,true);while(H){var I=false;var J=H.nodeType;var K=J==1?H.nodeName.toLowerCase():null;if(!K||B[K]){if((FCK.DTD[H.parentNode.nodeName.toLowerCase()]||FCK.DTD.span)[A]||!FCK.DTD[A]){if(!u.CheckHasRange()){u.SetStart(H,3);}if(J!=1||H.childNodes.length==0){var L=H;var M=L.parentNode;while(L==M.lastChild&&B[M.nodeName.toLowerCase()]){L=M;}u.SetEnd(L,4);if(L==L.parentNode.lastChild&&!B[L.parentNode.nodeName.toLowerCase()]){I=true;}}else{u.SetEnd(H,3);}}else{I=true;}}else{I=true;}H=FCKDomTools.GetNextSourceNode(H);if(H==G){H=null;I=true;}if(I&&u.CheckHasRange()&&!u.CheckIsCollapsed()){D=this.BuildElement(y);u.ExtractContents().AppendTo(D);if(D.innerHTML.RTrim().length>0){u.InsertNode(D);this.RemoveFromElement(D);this._MergeSiblings(D,this._GetAttribsForComparison());if(!FCKBrowserInfo.IsIE){D.normalize();}}u.Release(true);}}this._FixBookmarkStart(F);if(v){u.SelectBookmark(E);}if(x){u.MoveToBookmark(E);}},_FixBookmarkStart:function(d){var c;while((c=d.nextSibling)){if(c.nodeType==1&&FCKListsLib.InlineNonEmptyElements[c.nodeName.toLowerCase()]){if(!c.firstChild){FCKDomTools.RemoveNode(c);}else{FCKDomTools.MoveNode(d,c,true);}continue;}if(c.nodeType==3&&c.length==0){FCKDomTools.RemoveNode(c);continue;}break;}},_MergeSiblings:function(d,c){if(!d||d.nodeType!=1||!FCKListsLib.InlineNonEmptyElements[d.nodeName.toLowerCase()]){return;}this._MergeNextSibling(d,c);this._MergePreviousSibling(d,c);},_MergeNextSibling:function(h,i){var j=h.nextSibling;var k=(j&&j.nodeType==1&&j.getAttribute("_fck_bookmark"));if(k){j=j.nextSibling;}if(j&&j.nodeType==1&&j.nodeName==h.nodeName){if(!i){i=this._CreateElementAttribsForComparison(h);}if(this._CheckAttributesMatch(j,i)){var g=h.lastChild;if(k){FCKDomTools.MoveNode(h.nextSibling,h);}FCKDomTools.MoveChildren(j,h);FCKDomTools.RemoveNode(j);if(g){this._MergeNextSibling(g);}}}},_MergePreviousSibling:function(h,i){var j=h.previousSibling;var k=(j&&j.nodeType==1&&j.getAttribute("_fck_bookmark"));if(k){j=j.previousSibling;}if(j&&j.nodeType==1&&j.nodeName==h.nodeName){if(!i){i=this._CreateElementAttribsForComparison(h);}if(this._CheckAttributesMatch(j,i)){var g=h.firstChild;if(k){FCKDomTools.MoveNode(h.previousSibling,h,true);}FCKDomTools.MoveChildren(j,h,true);FCKDomTools.RemoveNode(j);if(g){this._MergePreviousSibling(g);}}}},_GetStyleText:function(){var f=this._StyleDesc.Styles;var g=(this._StyleDesc.Attributes?this._StyleDesc.Attributes["style"]||"":"");if(g.length>0){g+=";";}for(var d in f){g+=d+":"+f[d]+";";}if(g.length>0&&!(/#\(/.test(g))){g=FCKTools.NormalizeCssText(g);}return(this._GetStyleText=function(){return g;})();},_GetAttribsForComparison:function(){var f=this._GetAttribsForComparison_$;if(f){return f;}f={};var g=this._StyleDesc.Attributes;if(g){for(var d in g){f[d.toLowerCase()]=g[d].toLowerCase();}}if(this._GetStyleText().length>0){f["style"]=this._GetStyleText().toLowerCase();}FCKTools.AppendLengthProperty(f,"_length");return(this._GetAttribsForComparison_$=f);},_GetOverridesForComparison:function(){var p=this._GetOverridesForComparison_$;if(p){return p;}p={};var q=this._StyleDesc.Overrides;if(q){if(!FCKTools.IsArray(q)){q=[q];}for(var o=0;o<q.length;o++){var r=q[o];var t;var i;var l;if(typeof r=="string"){t=r.toLowerCase();}else{t=r.Element?r.Element.toLowerCase():this.Element;l=r.Attributes;}i=p[t]||(p[t]={});if(l){var m=(i.Attributes=i.Attributes||[]);for(var n in l){m.push([n.toLowerCase(),l[n]]);}}}}return(this._GetOverridesForComparison_$=p);},_CreateElementAttribsForComparison:function(h){var i={};var j=0;for(var g=0;g<h.attributes.length;g++){var k=h.attributes[g];if(k.specified){i[k.nodeName.toLowerCase()]=FCKDomTools.GetAttributeValue(h,k).toLowerCase();j++;}}i._length=j;return i;},_CheckAttributesMatch:function(k,l){var m=k.attributes;var n=0;for(var i=0;i<m.length;i++){var o=m[i];if(o.specified){var p=o.nodeName.toLowerCase();var q=l[p];if(!q){break;}if(q!=FCKDomTools.GetAttributeValue(k,o).toLowerCase()){break;}n++;}}return(n==l._length);}};var FCKStyles=FCK.Styles={_Callbacks:{},_ObjectStyles:{},ApplyStyle:function(b){if(typeof b=="string"){b=this.GetStyles()[b];}if(b){if(b.GetType()==2){b.ApplyToObject(FCKSelection.GetSelectedElement());}else{b.ApplyToSelection(FCK.EditorWindow);}FCK.Events.FireEvent("OnSelectionChange");}},RemoveStyle:function(b){if(typeof b=="string"){b=this.GetStyles()[b];}if(b){b.RemoveFromSelection(FCK.EditorWindow);FCK.Events.FireEvent("OnSelectionChange");}},AttachStyleStateChange:function(g,h,i){var f=this._Callbacks[g];if(!f){f=this._Callbacks[g]=[];}f.push([h,i]);},CheckSelectionChanges:function(){var r=FCKSelection.GetBoundaryParentElement(true);if(!r){return;}var t=new FCKElementPath(r);var u=this.GetStyles();for(var v in u){var i=this._Callbacks[v];if(i){var m=u[v];var n=m.CheckActive(t);if(n!=(m._LastState||null)){m._LastState=n;for(var q=0;q<i.length;q++){var o=i[q][0];var p=i[q][1];o.call(p||window,v,n);}}}}},CheckStyleInSelection:function(b){return false;},_GetRemoveFormatTagsRegex:function(){var b=new RegExp("^(?:"+FCKConfig.RemoveFormatTags.replace(/,/g,"|")+")$","i");return(this._GetRemoveFormatTagsRegex=function(){return b;})&&b;},RemoveAll:function(){var u=new FCKDomRange(FCK.EditorWindow);u.MoveToSelection();if(u.CheckIsCollapsed()){return;}u.Expand("inline_elements");var v=u.CreateBookmark(true);var x=u.GetBookmarkNode(v,true);var y=u.GetBookmarkNode(v,false);u.Release(true);var i=this._GetRemoveFormatTagsRegex();var n=new FCKElementPath(x);var o=n.Elements;var p;for(var t=1;t<o.length;t++){p=o[t];if(p==n.Block||p==n.BlockLimit){break;}if(i.test(p.nodeName)){FCKDomTools.BreakParent(x,p,u);}}n=new FCKElementPath(y);o=n.Elements;for(var t=1;t<o.length;t++){p=o[t];if(p==n.Block||p==n.BlockLimit){break;}elementName=p.nodeName.toLowerCase();if(i.test(p.nodeName)){FCKDomTools.BreakParent(y,p,u);}}var q=FCKDomTools.GetNextSourceNode(x,true,1);while(q){if(q==y){break;}var r=FCKDomTools.GetNextSourceNode(q,false,1);if(i.test(q.nodeName)){FCKDomTools.RemoveNode(q,true);}else{FCKDomTools.RemoveAttributes(q,FCKConfig.RemoveAttributesArray);}q=r;}u.SelectBookmark(v);FCK.Events.FireEvent("OnSelectionChange");},GetStyle:function(b){return this.GetStyles()[b];},GetStyles:function(){var b=this._GetStyles;if(!b){b=this._GetStyles=FCKTools.Merge(this._LoadStylesCore(),this._LoadStylesCustom(),this._LoadStylesXml());}return b;},CheckHasObjectStyle:function(b){return !!this._ObjectStyles[b];},_LoadStylesCore:function(){var g={};var h=FCKConfig.CoreStyles;for(var i in h){var f=g["_FCK_"+i]=new FCKStyle(h[i]);f.IsCore=true;}return g;},_LoadStylesCustom:function(){var g={};var h=FCKConfig.CustomStyles;if(h){for(var i in h){var f=g[i]=new FCKStyle(h[i]);f.Name=i;}}return g;},_LoadStylesXml:function(){var A={};var B=FCKConfig.StylesXmlPath;if(!B||B.length==0){return A;}var C=new FCKXml();C.LoadUrl(B);var D=FCKXml.TransformToObject(C.SelectSingleNode("Styles"));var E=D.$Style;if(!E){return A;}for(var i=0;i<E.length;i++){var F=E[i];var G=(F.element||"").toLowerCase();if(G.length==0){throw ('The element name is required. Error loading "'+B+'"');}var H={Element:G,Attributes:{},Styles:{},Overrides:[]};var I=F.$Attribute||[];for(var j=0;j<I.length;j++){H.Attributes[I[j].name]=I[j].value;}var J=F.$Style||[];for(j=0;j<J.length;j++){H.Styles[J[j].name]=J[j].value;}var K=F.$Override;if(K){for(j=0;j<K.length;j++){var L=K[j];var M={Element:L.element};var N=L.$Attribute;if(N){M.Attributes={};for(var k=0;k<N.length;k++){var O=N[k].value||null;if(O){var P=O&&FCKRegexLib.RegExp.exec(O);if(P){O=new RegExp(P[1],P[2]||"");}}M.Attributes[N[k].name]=O;}}H.Overrides.push(M);}}var Q=new FCKStyle(H);Q.Name=F.name||G;if(Q.GetType()==2){this._ObjectStyles[G]=true;}A[Q.Name]=Q;}return A;}};var FCKListHandler={OutdentListItem:function(B){var C=B.parentNode;if(C.tagName.toUpperCase().Equals("UL","OL")){var D=FCKTools.GetElementDocument(B);var E=new FCKDocumentFragment(D);var p=E.RootNode;var q=false;var r=FCKDomTools.GetFirstChild(B,["UL","OL"]);if(r){q=true;var t;while((t=r.firstChild)){p.appendChild(r.removeChild(t));}FCKDomTools.RemoveNode(r);}var u;var v=false;while((u=B.nextSibling)){if(!q&&u.nodeType==1&&u.nodeName.toUpperCase()=="LI"){v=q=true;}p.appendChild(u.parentNode.removeChild(u));if(!v&&u.nodeType==1&&u.nodeName.toUpperCase().Equals("UL","OL")){FCKDomTools.RemoveNode(u,true);}}var x=C.parentNode.tagName.toUpperCase();var y=(x=="LI");if(y||x.Equals("UL","OL")){if(q){var r=C.cloneNode(false);E.AppendTo(r);B.appendChild(r);}else{if(y){E.InsertAfterNode(C.parentNode);}else{E.InsertAfterNode(C);}}if(y){FCKDomTools.InsertAfterNode(C.parentNode,C.removeChild(B));}else{FCKDomTools.InsertAfterNode(C,C.removeChild(B));}}else{if(q){var z=C.cloneNode(false);E.AppendTo(z);FCKDomTools.InsertAfterNode(C,z);}var A=D.createElement(FCKConfig.EnterMode=="p"?"p":"div");FCKDomTools.MoveChildren(C.removeChild(B),A);FCKDomTools.InsertAfterNode(C,A);if(FCKConfig.EnterMode=="br"){if(FCKBrowserInfo.IsGecko){A.parentNode.insertBefore(FCKTools.CreateBogusBR(D),A);}else{FCKDomTools.InsertAfterNode(A,FCKTools.CreateBogusBR(D));}FCKDomTools.RemoveNode(A,true);}}if(this.CheckEmptyList(C)){FCKDomTools.RemoveNode(C,true);}}},CheckEmptyList:function(b){return(FCKDomTools.GetFirstChild(b,"LI")==null);},CheckListHasContents:function(d){var c=d.firstChild;while(c){switch(c.nodeType){case 1:if(!c.nodeName.IEquals("UL","LI")){return true;}break;case 3:if(c.nodeValue.Trim().length>0){return true;}}c=c.nextSibling;}return false;}};var FCKElementPath=function(i){var j=null;var k=null;var l=[];var m=i;while(m){if(m.nodeType==1){if(!this.LastElement){this.LastElement=m;}var h=m.nodeName.toLowerCase();if(FCKBrowserInfo.IsIE&&m.scopeName!="HTML"){h=m.scopeName.toLowerCase()+":"+h;}if(!k){if(!j&&FCKListsLib.PathBlockElements[h]!=null){j=m;}if(FCKListsLib.PathBlockLimitElements[h]!=null){if(!j&&h=="div"&&!FCKElementPath._CheckHasBlock(m)){j=m;}else{k=m;}}}l.push(m);if(h=="body"){break;}}m=m.parentNode;}this.Block=j;this.BlockLimit=k;this.Elements=l;};FCKElementPath._CheckHasBlock=function(h){var i=h.childNodes;for(var g=0,k=i.length;g<k;g++){var j=i[g];if(j.nodeType==1&&FCKListsLib.BlockElements[j.nodeName.toLowerCase()]){return true;}}return false;};var FCKDomRange=function(b){this.Window=b;this._Cache={};};FCKDomRange.prototype={_UpdateElementInfo:function(){var h=this._Range;if(!h){this.Release(true);}else{var i=h.startContainer;var j=new FCKElementPath(i);this.StartNode=i.nodeType==3?i:i.childNodes[h.startOffset];this.StartContainer=i;this.StartBlock=j.Block;this.StartBlockLimit=j.BlockLimit;if(h.collapsed){this.EndNode=this.StartNode;this.EndContainer=this.StartContainer;this.EndBlock=this.StartBlock;this.EndBlockLimit=this.StartBlockLimit;}else{var k=h.endContainer;if(i!=k){j=new FCKElementPath(k);}var g=k;if(h.endOffset==0){while(g&&!g.previousSibling){g=g.parentNode;}if(g){g=g.previousSibling;}}else{if(g.nodeType==1){g=g.childNodes[h.endOffset-1];}}this.EndNode=g;this.EndContainer=k;this.EndBlock=j.Block;this.EndBlockLimit=j.BlockLimit;}}this._Cache={};},CreateRange:function(){return new FCKW3CRange(this.Window.document);},DeleteContents:function(){if(this._Range){this._Range.deleteContents();this._UpdateElementInfo();}},ExtractContents:function(){if(this._Range){var b=this._Range.extractContents();this._UpdateElementInfo();return b;}return null;},CheckIsCollapsed:function(){if(this._Range){return this._Range.collapsed;}return false;},Collapse:function(b){if(this._Range){this._Range.collapse(b);}this._UpdateElementInfo();},Clone:function(){var b=FCKTools.CloneObject(this);if(this._Range){b._Range=this._Range.cloneRange();}return b;},MoveToNodeContents:function(b){if(!this._Range){this._Range=this.CreateRange();}this._Range.selectNodeContents(b);this._UpdateElementInfo();},MoveToElementStart:function(b){this.SetStart(b,1);this.SetEnd(b,1);},MoveToElementEditStart:function(d){var c;while(d&&d.nodeType==1){if(FCKDomTools.CheckIsEditable(d)){c=d;}else{if(c){break;}}d=d.firstChild;}if(c){this.MoveToElementStart(c);}},InsertNode:function(b){if(this._Range){this._Range.insertNode(b);}},CheckIsEmpty:function(){if(this.CheckIsCollapsed()){return true;}var b=this.Window.document.createElement("div");this._Range.cloneContents().AppendTo(b);FCKDomTools.TrimNode(b);return(b.innerHTML.length==0);},CheckStartOfBlock:function(){var j=this._Cache;var k=j.IsStartOfBlock;if(k!=undefined){return k;}var l=this.StartBlock||this.StartBlockLimit;var m=this._Range.startContainer;var n=this._Range.startOffset;var o;if(n>0){if(m.nodeType==3){var i=m.nodeValue.substr(0,n).Trim();if(i.length!=0){return j.IsStartOfBlock=false;}}else{o=m.childNodes[n-1];}}if(!o){o=FCKDomTools.GetPreviousSourceNode(m,true,null,l);}while(o){switch(o.nodeType){case 1:if(!FCKListsLib.InlineChildReqElements[o.nodeName.toLowerCase()]){return j.IsStartOfBlock=false;}break;case 3:if(o.nodeValue.Trim().length>0){return j.IsStartOfBlock=false;}}o=FCKDomTools.GetPreviousSourceNode(o,false,null,l);}return j.IsStartOfBlock=true;},CheckEndOfBlock:function(p){var q=this._Cache.IsEndOfBlock;if(q!=undefined){return q;}var r=this.EndBlock||this.EndBlockLimit;var t=this._Range.endContainer;var k=this._Range.endOffset;var l;if(t.nodeType==3){var m=t.nodeValue;if(k<m.length){m=m.substr(k);if(m.Trim().length!=0){return this._Cache.IsEndOfBlock=false;}}}else{l=t.childNodes[k];}if(!l){l=FCKDomTools.GetNextSourceNode(t,true,null,r);}var n=false;while(l){switch(l.nodeType){case 1:var o=l.nodeName.toLowerCase();if(FCKListsLib.InlineChildReqElements[o]){break;}if(o=="br"&&!n){n=true;break;}return this._Cache.IsEndOfBlock=false;case 3:if(l.nodeValue.Trim().length>0){return this._Cache.IsEndOfBlock=false;}}l=FCKDomTools.GetNextSourceNode(l,false,null,r);}if(p){this.Select();}return this._Cache.IsEndOfBlock=true;},CreateBookmark:function(i){var j={StartId:(new Date()).valueOf()+Math.floor(Math.random()*1000)+"S",EndId:(new Date()).valueOf()+Math.floor(Math.random()*1000)+"E"};var k=this.Window.document;var l;var m;var h;if(!this.CheckIsCollapsed()){m=k.createElement("span");m.style.display="none";m.id=j.EndId;m.setAttribute("_fck_bookmark",true);m.innerHTML="&nbsp;";h=this.Clone();h.Collapse(false);h.InsertNode(m);}l=k.createElement("span");l.style.display="none";l.id=j.StartId;l.setAttribute("_fck_bookmark",true);l.innerHTML="&nbsp;";h=this.Clone();h.Collapse(true);h.InsertNode(l);if(i){j.StartNode=l;j.EndNode=m;}if(m){this.SetStart(l,4);this.SetEnd(m,3);}else{this.MoveToPosition(l,4);}return j;},GetBookmarkNode:function(f,g){var d=this.Window.document;if(g){return f.StartNode||d.getElementById(f.StartId);}else{return f.EndNode||d.getElementById(f.EndId);}},MoveToBookmark:function(g,h){var i=this.GetBookmarkNode(g,true);var f=this.GetBookmarkNode(g,false);this.SetStart(i,3);if(!h){FCKDomTools.RemoveNode(i);}if(f){this.SetEnd(f,3);if(!h){FCKDomTools.RemoveNode(f);}}else{this.Collapse(true);}this._UpdateElementInfo();},CreateBookmark2:function(){if(!this._Range){return{"Start":0,"End":0};}var j={"Start":[this._Range.startOffset],"End":[this._Range.endOffset]};var k=this._Range.startContainer.previousSibling;var l=this._Range.endContainer.previousSibling;var m=this._Range.startContainer;var n=this._Range.endContainer;while(k&&k.nodeType==3&&m.nodeType==3){j.Start[0]+=k.length;m=k;k=k.previousSibling;}while(l&&l.nodeType==3&&n.nodeType==3){j.End[0]+=l.length;n=l;l=l.previousSibling;}if(m.nodeType==1&&m.childNodes[j.Start[0]]&&m.childNodes[j.Start[0]].nodeType==3){var o=m.childNodes[j.Start[0]];var i=0;while(o.previousSibling&&o.previousSibling.nodeType==3){o=o.previousSibling;i+=o.length;}m=o;j.Start[0]=i;}if(n.nodeType==1&&n.childNodes[j.End[0]]&&n.childNodes[j.End[0]].nodeType==3){var o=n.childNodes[j.End[0]];var i=0;while(o.previousSibling&&o.previousSibling.nodeType==3){o=o.previousSibling;i+=o.length;}n=o;j.End[0]=i;}j.Start=FCKDomTools.GetNodeAddress(m,true).concat(j.Start);j.End=FCKDomTools.GetNodeAddress(n,true).concat(j.End);return j;},MoveToBookmark2:function(h){var i=FCKDomTools.GetNodeFromAddress(this.Window.document,h.Start.slice(0,-1),true);var j=FCKDomTools.GetNodeFromAddress(this.Window.document,h.End.slice(0,-1),true);this.Release(true);this._Range=new FCKW3CRange(this.Window.document);var k=h.Start[h.Start.length-1];var g=h.End[h.End.length-1];while(i.nodeType==3&&k>i.length){if(!i.nextSibling||i.nextSibling.nodeType!=3){break;}k-=i.length;i=i.nextSibling;}while(j.nodeType==3&&g>j.length){if(!j.nextSibling||j.nextSibling.nodeType!=3){break;}g-=j.length;j=j.nextSibling;}this._Range.setStart(i,k);this._Range.setEnd(j,g);this._UpdateElementInfo();},MoveToPosition:function(d,c){this.SetStart(d,c);this.Collapse(true);},SetStart:function(g,h,i){var f=this._Range;if(!f){f=this._Range=this.CreateRange();}switch(h){case 1:f.setStart(g,0);break;case 2:f.setStart(g,g.childNodes.length);break;case 3:f.setStartBefore(g);break;case 4:f.setStartAfter(g);}if(!i){this._UpdateElementInfo();}},SetEnd:function(g,h,i){var f=this._Range;if(!f){f=this._Range=this.CreateRange();}switch(h){case 1:f.setEnd(g,0);break;case 2:f.setEnd(g,g.childNodes.length);break;case 3:f.setEndBefore(g);break;case 4:f.setEndAfter(g);}if(!i){this._UpdateElementInfo();}},Expand:function(i){var j,h;switch(i){case"inline_elements":if(this._Range.startOffset==0){j=this._Range.startContainer;if(j.nodeType!=1){j=j.previousSibling?null:j.parentNode;}if(j){while(FCKListsLib.InlineNonEmptyElements[j.nodeName.toLowerCase()]){this._Range.setStartBefore(j);if(j!=j.parentNode.firstChild){break;}j=j.parentNode;}}}j=this._Range.endContainer;var k=this._Range.endOffset;if((j.nodeType==3&&k>=j.nodeValue.length)||(j.nodeType==1&&k>=j.childNodes.length)||(j.nodeType!=1&&j.nodeType!=3)){if(j.nodeType!=1){j=j.nextSibling?null:j.parentNode;}if(j){while(FCKListsLib.InlineNonEmptyElements[j.nodeName.toLowerCase()]){this._Range.setEndAfter(j);if(j!=j.parentNode.lastChild){break;}j=j.parentNode;}}}break;case"block_contents":case"list_contents":var l=FCKListsLib.BlockBoundaries;if(i=="list_contents"||FCKConfig.EnterMode=="br"){l=FCKListsLib.ListBoundaries;}if(this.StartBlock&&FCKConfig.EnterMode!="br"&&i=="block_contents"){this.SetStart(this.StartBlock,1);}else{j=this._Range.startContainer;if(j.nodeType==1){var m=j.childNodes[this._Range.startOffset];if(m){j=FCKDomTools.GetPreviousSourceNode(m,true);}else{j=j.lastChild||j;}}while(j&&(j.nodeType!=1||(j!=this.StartBlockLimit&&!l[j.nodeName.toLowerCase()]))){this._Range.setStartBefore(j);j=j.previousSibling||j.parentNode;}}if(this.EndBlock&&FCKConfig.EnterMode!="br"&&i=="block_contents"&&this.EndBlock.nodeName.toLowerCase()!="li"){this.SetEnd(this.EndBlock,2);}else{j=this._Range.endContainer;if(j.nodeType==1){j=j.childNodes[this._Range.endOffset]||j.lastChild;}while(j&&(j.nodeType!=1||(j!=this.StartBlockLimit&&!l[j.nodeName.toLowerCase()]))){this._Range.setEndAfter(j);j=j.nextSibling||j.parentNode;}if(j&&j.nodeName.toLowerCase()=="br"){this._Range.setEndAfter(j);}}this._UpdateElementInfo();}},SplitBlock:function(k){var l=k||FCKConfig.EnterMode;if(!this._Range){this.MoveToSelection();}if(this.StartBlockLimit==this.EndBlockLimit){var m=this.StartBlock;var n=this.EndBlock;var o=null;if(l!="br"){if(!m){m=this.FixBlock(true,l);n=this.EndBlock;}if(!n){n=this.FixBlock(false,l);}}var p=(m!=null&&this.CheckStartOfBlock());var q=(n!=null&&this.CheckEndOfBlock());if(!this.CheckIsEmpty()){this.DeleteContents();}if(m&&n&&m==n){if(q){o=new FCKElementPath(this.StartContainer);this.MoveToPosition(n,4);n=null;}else{if(p){o=new FCKElementPath(this.StartContainer);this.MoveToPosition(m,3);m=null;}else{this.SetEnd(m,2);var j=this.ExtractContents();n=m.cloneNode(false);n.removeAttribute("id",false);j.AppendTo(n);FCKDomTools.InsertAfterNode(m,n);this.MoveToPosition(m,4);if(FCKBrowserInfo.IsGecko&&!m.nodeName.IEquals(["ul","ol"])){FCKTools.AppendBogusBr(m);}}}}return{PreviousBlock:m,NextBlock:n,WasStartOfBlock:p,WasEndOfBlock:q,ElementPath:o};}return null;},FixBlock:function(g,h){var i=this.CreateBookmark();this.Collapse(g);this.Expand("block_contents");var f=this.Window.document.createElement(h);this.ExtractContents().AppendTo(f);FCKDomTools.TrimNode(f);if(FCKDomTools.CheckIsEmptyElement(f,function(a){return a.getAttribute("_fck_bookmark")!="true";})&&FCKBrowserInfo.IsGeckoLike){FCKTools.AppendBogusBr(f);}this.InsertNode(f);this.MoveToBookmark(i);return f;},Release:function(b){if(!b){this.Window=null;}this.StartNode=null;this.StartContainer=null;this.StartBlock=null;this.StartBlockLimit=null;this.EndNode=null;this.EndContainer=null;this.EndBlock=null;this.EndBlockLimit=null;this._Range=null;this._Cache=null;},CheckHasRange:function(){return !!this._Range;},GetTouchedStartNode:function(){var d=this._Range;var c=d.startContainer;if(d.collapsed||c.nodeType!=1){return c;}return c.childNodes[d.startOffset]||c;},GetTouchedEndNode:function(){var d=this._Range;var c=d.endContainer;if(d.collapsed||c.nodeType!=1){return c;}return c.childNodes[d.endOffset-1]||c;}};FCKDomRange.prototype.MoveToSelection=function(){this.Release(true);var b=this.Window.getSelection();if(b&&b.rangeCount>0){this._Range=FCKW3CRange.CreateFromRange(this.Window.document,b.getRangeAt(0));this._UpdateElementInfo();}else{if(this.Window.document){this.MoveToElementStart(this.Window.document.body);}}};FCKDomRange.prototype.Select=function(){var h=this._Range;if(h){var i=h.startContainer;if(h.collapsed&&i.nodeType==1&&i.childNodes.length==0){i.appendChild(h._Document.createTextNode(""));}var j=this.Window.document.createRange();j.setStart(i,h.startOffset);try{j.setEnd(h.endContainer,h.endOffset);}catch(k){if(k.toString().Contains("NS_ERROR_ILLEGAL_VALUE")){h.collapse(true);j.setEnd(h.endContainer,h.endOffset);}else{throw (k);}}var g=this.Window.getSelection();g.removeAllRanges();g.addRange(j);}};FCKDomRange.prototype.SelectBookmark=function(h){var i=this.Window.document.createRange();var j=this.GetBookmarkNode(h,true);var k=this.GetBookmarkNode(h,false);i.setStart(j.parentNode,FCKDomTools.GetIndexOf(j));FCKDomTools.RemoveNode(j);if(k){i.setEnd(k.parentNode,FCKDomTools.GetIndexOf(k));FCKDomTools.RemoveNode(k);}var g=this.Window.getSelection();g.removeAllRanges();g.addRange(i);};var FCKDomRangeIterator=function(b){this.Range=b;this.ForceBrBreak=false;this.EnforceRealBlocks=false;};FCKDomRangeIterator.CreateFromSelection=function(d){var c=new FCKDomRange(d);c.MoveToSelection();return new FCKDomRangeIterator(c);};FCKDomRangeIterator.prototype={GetNextParagraph:function(){var F;var G;var H;var I;var r;var t=this.ForceBrBreak?FCKListsLib.ListBoundaries:FCKListsLib.BlockBoundaries;if(!this._LastNode){var G=this.Range.Clone();G.Expand(this.ForceBrBreak?"list_contents":"block_contents");this._NextNode=G.GetTouchedStartNode();this._LastNode=G.GetTouchedEndNode();G=null;}var u=this._NextNode;var v=this._LastNode;this._NextNode=null;while(u){var x=false;var y=(u.nodeType!=1);var z=false;if(!y){var A=u.nodeName.toLowerCase();if(t[A]&&(!FCKBrowserInfo.IsIE||u.scopeName=="HTML")){if(A=="br"){y=true;}else{if(!G&&u.childNodes.length==0&&A!="hr"){F=u;H=u==v;break;}}if(G){G.SetEnd(u,3,true);if(A!="br"){this._NextNode=FCKDomTools.GetNextSourceNode(u,true,null,v)||u;}}x=true;}else{if(u.firstChild){if(!G){G=new FCKDomRange(this.Range.Window);G.SetStart(u,3,true);}u=u.firstChild;continue;}y=true;}}else{if(u.nodeType==3){if(/^[\r\n\t ]+$/.test(u.nodeValue)){y=false;}}}if(y&&!G){G=new FCKDomRange(this.Range.Window);G.SetStart(u,3,true);}H=((!x||y)&&u==v);if(G&&!x){while(!u.nextSibling&&!H){var B=u.parentNode;if(t[B.nodeName.toLowerCase()]){x=true;H=H||(B==v);break;}u=B;y=true;H=(u==v);z=true;}}if(y){G.SetEnd(u,4,true);}if((x||H)&&G){G._UpdateElementInfo();if(G.StartNode==G.EndNode&&G.StartNode.parentNode==G.StartBlockLimit&&G.StartNode.getAttribute&&G.StartNode.getAttribute("_fck_bookmark")){G=null;}else{break;}}if(H){break;}u=FCKDomTools.GetNextSourceNode(u,z,null,v);}if(!F){if(!G){this._NextNode=null;return null;}F=G.StartBlock;if(!F&&!this.EnforceRealBlocks&&G.StartBlockLimit.nodeName.IEquals("DIV","TH","TD")&&G.CheckStartOfBlock()&&G.CheckEndOfBlock()){F=G.StartBlockLimit;}else{if(!F||(this.EnforceRealBlocks&&F.nodeName.toLowerCase()=="li")){F=this.Range.Window.document.createElement(FCKConfig.EnterMode=="p"?"p":"div");G.ExtractContents().AppendTo(F);FCKDomTools.TrimNode(F);G.InsertNode(F);I=true;r=true;}else{if(F.nodeName.toLowerCase()!="li"){if(!G.CheckStartOfBlock()||!G.CheckEndOfBlock()){F=F.cloneNode(false);G.ExtractContents().AppendTo(F);FCKDomTools.TrimNode(F);var C=G.SplitBlock();I=!C.WasStartOfBlock;r=!C.WasEndOfBlock;G.InsertNode(F);}}else{if(!H){this._NextNode=F==v?null:FCKDomTools.GetNextSourceNode(G.EndNode,true,null,v);return F;}}}}}if(I){var D=F.previousSibling;if(D&&D.nodeType==1){if(D.nodeName.toLowerCase()=="br"){D.parentNode.removeChild(D);}else{if(D.lastChild&&D.lastChild.nodeName.IEquals("br")){D.removeChild(D.lastChild);}}}}if(r){var E=F.lastChild;if(E&&E.nodeType==1&&E.nodeName.toLowerCase()=="br"){F.removeChild(E);}}if(!this._NextNode){this._NextNode=(H||F==v)?null:FCKDomTools.GetNextSourceNode(F,true,null,v);}return F;}};var FCKDocumentFragment=function(d,c){this.RootNode=c||d.createDocumentFragment();};FCKDocumentFragment.prototype={AppendTo:function(b){b.appendChild(this.RootNode);},AppendHtml:function(d){var c=this.RootNode.ownerDocument.createElement("div");c.innerHTML=d;FCKDomTools.MoveChildren(c,this.RootNode);},InsertAfterNode:function(b){FCKDomTools.InsertAfterNode(b,this.RootNode);}};var FCKW3CRange=function(b){this._Document=b;this.startContainer=null;this.startOffset=null;this.endContainer=null;this.endOffset=null;this.collapsed=true;};FCKW3CRange.CreateRange=function(b){return new FCKW3CRange(b);};FCKW3CRange.CreateFromRange=function(f,g){var d=FCKW3CRange.CreateRange(f);d.setStart(g.startContainer,g.startOffset);d.setEnd(g.endContainer,g.endOffset);return d;};FCKW3CRange.prototype={_UpdateCollapsed:function(){this.collapsed=(this.startContainer==this.endContainer&&this.startOffset==this.endOffset);},setStart:function(d,c){this.startContainer=d;this.startOffset=c;if(!this.endContainer){this.endContainer=d;this.endOffset=c;}this._UpdateCollapsed();},setEnd:function(d,c){this.endContainer=d;this.endOffset=c;if(!this.startContainer){this.startContainer=d;this.startOffset=c;}this._UpdateCollapsed();},setStartAfter:function(b){this.setStart(b.parentNode,FCKDomTools.GetIndexOf(b)+1);},setStartBefore:function(b){this.setStart(b.parentNode,FCKDomTools.GetIndexOf(b));},setEndAfter:function(b){this.setEnd(b.parentNode,FCKDomTools.GetIndexOf(b)+1);},setEndBefore:function(b){this.setEnd(b.parentNode,FCKDomTools.GetIndexOf(b));},collapse:function(b){if(b){this.endContainer=this.startContainer;this.endOffset=this.startOffset;}else{this.startContainer=this.endContainer;this.startOffset=this.endOffset;}this.collapsed=true;},selectNodeContents:function(b){this.setStart(b,0);this.setEnd(b,b.nodeType==3?b.data.length:b.childNodes.length);},insertNode:function(f){var g=this.startContainer;var d=this.startOffset;if(g.nodeType==3){g.splitText(d);if(g==this.endContainer){this.setEnd(g.nextSibling,this.endOffset-this.startOffset);}FCKDomTools.InsertAfterNode(g,f);return;}else{g.insertBefore(f,g.childNodes[d]||null);if(g==this.endContainer){this.endOffset++;this.collapsed=false;}}},deleteContents:function(){if(this.collapsed){return;}this._ExecContentsAction(0);},extractContents:function(){var b=new FCKDocumentFragment(this._Document);if(!this.collapsed){this._ExecContentsAction(1,b);}return b;},cloneContents:function(){var b=new FCKDocumentFragment(this._Document);if(!this.collapsed){this._ExecContentsAction(2,b);}return b;},_ExecContentsAction:function(C,D){var E=this.startContainer;var F=this.endContainer;var H=this.startOffset;var J=this.endOffset;var K=false;var L=false;if(F.nodeType==3){F=F.splitText(J);}else{if(F.childNodes.length>0){if(J>F.childNodes.length-1){F=FCKDomTools.InsertAfterNode(F.lastChild,this._Document.createTextNode(""));L=true;}else{F=F.childNodes[J];}}}if(E.nodeType==3){E.splitText(H);if(E==F){F=E.nextSibling;}}else{if(H==0){E=E.insertBefore(this._Document.createTextNode(""),E.firstChild);K=true;}else{if(H>E.childNodes.length-1){E=E.appendChild(this._Document.createTextNode(""));K=true;}else{E=E.childNodes[H].previousSibling;}}}var M=FCKDomTools.GetParents(E);var N=FCKDomTools.GetParents(F);var k,i,j;for(k=0;k<M.length;k++){i=M[k];j=N[k];if(i!=j){break;}}var R,G,I,W,T;if(D){R=D.RootNode;}for(var A=k;A<M.length;A++){G=M[A];if(R&&G!=E){I=R.appendChild(G.cloneNode(G==E));}W=G.nextSibling;while(W){if(W==N[A]||W==F){break;}T=W.nextSibling;if(C==2){R.appendChild(W.cloneNode(true));}else{W.parentNode.removeChild(W);if(C==1){R.appendChild(W);}}W=T;}if(R){R=I;}}if(D){R=D.RootNode;}for(var B=k;B<N.length;B++){G=N[B];if(C>0&&G!=F){I=R.appendChild(G.cloneNode(G==F));}if(!M[B]||G.parentNode!=M[B].parentNode){W=G.previousSibling;while(W){if(W==M[B]||W==E){break;}T=W.previousSibling;if(C==2){R.insertBefore(W.cloneNode(true),R.firstChild);}else{W.parentNode.removeChild(W);if(C==1){R.insertBefore(W,R.firstChild);}}W=T;}}if(R){R=I;}}if(C==2){var S=this.startContainer;if(S.nodeType==3){S.data+=S.nextSibling.data;S.parentNode.removeChild(S.nextSibling);}var U=this.endContainer;if(U.nodeType==3&&U.nextSibling){U.data+=U.nextSibling.data;U.parentNode.removeChild(U.nextSibling);}}else{if(i&&j&&(E.parentNode!=i.parentNode||F.parentNode!=j.parentNode)){var V=FCKDomTools.GetIndexOf(j);if(K&&j.parentNode==E.parentNode){V--;}this.setStart(j.parentNode,V);}this.collapse(true);}if(K){E.parentNode.removeChild(E);}if(L&&F.parentNode){F.parentNode.removeChild(F);}},cloneRange:function(){return FCKW3CRange.CreateFromRange(this._Document,this);}};var FCKEnterKey=function(h,i,j,k){this.Window=h;this.EnterMode=i||"p";this.ShiftEnterMode=j||"br";var g=new FCKKeystrokeHandler(false);g._EnterKey=this;g.OnKeystroke=FCKEnterKey_OnKeystroke;g.SetKeystrokes([[13,"Enter"],[SHIFT+13,"ShiftEnter"],[8,"Backspace"],[CTRL+8,"CtrlBackspace"],[46,"Delete"]]);this.TabText="";if(k>0||FCKBrowserInfo.IsSafari){while(k--){this.TabText+="\xa0";}g.SetKeystrokes([9,"Tab"]);}g.AttachToElement(h.document);};function FCKEnterKey_OnKeystroke(g,h){var i=this._EnterKey;try{switch(h){case"Enter":return i.DoEnter();break;case"ShiftEnter":return i.DoShiftEnter();break;case"Backspace":return i.DoBackspace();break;case"Delete":return i.DoDelete();break;case"Tab":return i.DoTab();break;case"CtrlBackspace":return i.DoCtrlBackspace();break;}}catch(f){}return false;}FCKEnterKey.prototype.DoEnter=function(h,i){FCKUndo.SaveUndoStep();this._HasShift=(i===true);var j=FCKSelection.GetParentElement();var k=new FCKElementPath(j);var g=h||this.EnterMode;if(g=="br"||k.Block&&k.Block.tagName.toLowerCase()=="pre"){return this._ExecuteEnterBr();}else{return this._ExecuteEnterBlock(g);}};FCKEnterKey.prototype.DoShiftEnter=function(){return this.DoEnter(this.ShiftEnterMode,true);};FCKEnterKey.prototype.DoBackspace=function(){var z=false;var A=new FCKDomRange(this.Window);A.MoveToSelection();if(FCKBrowserInfo.IsIE&&this._CheckIsAllContentsIncluded(A,this.Window.document.body)){this._FixIESelectAllBug(A);return true;}var B=A.CheckIsCollapsed();if(!B){if(FCKBrowserInfo.IsIE&&this.Window.document.selection.type.toLowerCase()=="control"){var C=this.Window.document.selection.createRange();for(var y=C.length-1;y>=0;y--){var i=C.item(y);i.parentNode.removeChild(i);}return true;}return false;}if(FCKBrowserInfo.IsIE){var p=FCKDomTools.GetPreviousSourceElement(A.StartNode,true);if(p&&p.nodeName.toLowerCase()=="br"){var q=A.Clone();q.SetStart(p,4);if(q.CheckIsEmpty()){p.parentNode.removeChild(p);return true;}}}var r=A.StartBlock;var t=A.EndBlock;if(A.StartBlockLimit==A.EndBlockLimit&&r&&t){if(!B){var u=A.CheckEndOfBlock();A.DeleteContents();if(r!=t){A.SetStart(t,1);A.SetEnd(t,1);}A.Select();z=(r==t);}if(A.CheckStartOfBlock()){var v=A.StartBlock;var x=FCKDomTools.GetPreviousSourceElement(v,true,["BODY",A.StartBlockLimit.nodeName],["UL","OL"]);z=this._ExecuteBackspace(A,x,v);}else{if(FCKBrowserInfo.IsGeckoLike){A.Select();}}}A.Release();return z;};FCKEnterKey.prototype.DoCtrlBackspace=function(){FCKUndo.SaveUndoStep();var b=new FCKDomRange(this.Window);b.MoveToSelection();if(FCKBrowserInfo.IsIE&&this._CheckIsAllContentsIncluded(b,this.Window.document.body)){this._FixIESelectAllBug(b);return true;}return false;};FCKEnterKey.prototype._ExecuteBackspace=function(p,q,r){var t=false;if(!q&&r&&r.nodeName.IEquals("LI")&&r.parentNode.parentNode.nodeName.IEquals("LI")){this._OutdentWithSelection(r,p);return true;}if(q&&q.nodeName.IEquals("LI")){var k=FCKDomTools.GetLastChild(q,["UL","OL"]);while(k){q=FCKDomTools.GetLastChild(k,"LI");k=FCKDomTools.GetLastChild(q,["UL","OL"]);}}if(q&&r){if(r.nodeName.IEquals("LI")&&!q.nodeName.IEquals("LI")){this._OutdentWithSelection(r,p);return true;}var l=r.parentNode;var m=q.nodeName.toLowerCase();if(FCKListsLib.EmptyElements[m]!=null||m=="table"){FCKDomTools.RemoveNode(q);t=true;}else{FCKDomTools.RemoveNode(r);while(l.innerHTML.Trim().length==0){var n=l.parentNode;n.removeChild(l);l=n;}FCKDomTools.LTrimNode(r);FCKDomTools.RTrimNode(q);p.SetStart(q,2,true);p.Collapse(true);var o=p.CreateBookmark(true);if(!r.tagName.IEquals(["TABLE"])){FCKDomTools.MoveChildren(r,q);}p.SelectBookmark(o);t=true;}}return t;};FCKEnterKey.prototype.DoDelete=function(){FCKUndo.SaveUndoStep();var i=false;var j=new FCKDomRange(this.Window);j.MoveToSelection();if(FCKBrowserInfo.IsIE&&this._CheckIsAllContentsIncluded(j,this.Window.document.body)){this._FixIESelectAllBug(j);return true;}if(j.CheckIsCollapsed()&&j.CheckEndOfBlock(FCKBrowserInfo.IsGeckoLike)){var k=j.StartBlock;var l=FCKTools.GetElementAscensor(k,"td");var m=FCKDomTools.GetNextSourceElement(k,true,[j.StartBlockLimit.nodeName],["UL","OL","TR"],true);if(l){var h=FCKTools.GetElementAscensor(m,"td");if(h!=l){return true;}}i=this._ExecuteBackspace(j,k,m);}j.Release();return i;};FCKEnterKey.prototype.DoTab=function(){var f=new FCKDomRange(this.Window);f.MoveToSelection();var g=f._Range.startContainer;while(g){if(g.nodeType==1){var d=g.tagName.toLowerCase();if(d=="tr"||d=="td"||d=="th"||d=="tbody"||d=="table"){return false;}else{break;}}g=g.parentNode;}if(this.TabText){f.DeleteContents();f.InsertNode(this.Window.document.createTextNode(this.TabText));f.Collapse(false);f.Select();}return true;};FCKEnterKey.prototype._ExecuteEnterBlock=function(D,E){var F=E||new FCKDomRange(this.Window);var G=F.SplitBlock(D);if(G){var i=G.PreviousBlock;var r=G.NextBlock;var t=G.WasStartOfBlock;var u=G.WasEndOfBlock;if(r){if(r.parentNode.nodeName.IEquals("li")){FCKDomTools.BreakParent(r,r.parentNode);FCKDomTools.MoveNode(r,r.nextSibling,true);}}else{if(i&&i.parentNode.nodeName.IEquals("li")){FCKDomTools.BreakParent(i,i.parentNode);F.MoveToElementEditStart(i.nextSibling);FCKDomTools.MoveNode(i,i.previousSibling);}}if(!t&&!u){if(r.nodeName.IEquals("li")&&r.firstChild&&r.firstChild.nodeName.IEquals(["ul","ol"])){r.insertBefore(FCKTools.GetElementDocument(r).createTextNode("\xa0"),r.firstChild);}if(r){F.MoveToElementEditStart(r);}}else{if(t&&u&&i.tagName.toUpperCase()=="LI"){F.MoveToElementStart(i);this._OutdentWithSelection(i,F);F.Release();return true;}var v;if(i){var x=i.tagName.toUpperCase();if(!this._HasShift&&!(/^H[1-6]$/).test(x)){v=FCKDomTools.CloneElement(i);}}else{if(r){v=FCKDomTools.CloneElement(r);}}if(!v){v=this.Window.document.createElement(D);}var y=G.ElementPath;if(y){for(var C=0,B=y.Elements.length;C<B;C++){var z=y.Elements[C];if(z==y.Block||z==y.BlockLimit){break;}if(FCKListsLib.InlineChildReqElements[z.nodeName.toLowerCase()]){z=FCKDomTools.CloneElement(z);FCKDomTools.MoveChildren(v,z);v.appendChild(z);}}}if(FCKBrowserInfo.IsGeckoLike){FCKTools.AppendBogusBr(v);}F.InsertNode(v);if(FCKBrowserInfo.IsIE){F.MoveToElementEditStart(v);F.Select();}F.MoveToElementEditStart(t&&!u?r:v);}if(FCKBrowserInfo.IsGeckoLike){if(r){var A=this.Window.document.createElement("span");A.innerHTML="&nbsp;";F.InsertNode(A);FCKDomTools.ScrollIntoView(A,false);F.DeleteContents();}else{FCKDomTools.ScrollIntoView(r||v,false);}}F.Select();}F.Release();return true;};FCKEnterKey.prototype._ExecuteEnterBr=function(p){var q=new FCKDomRange(this.Window);q.MoveToSelection();if(q.StartBlockLimit==q.EndBlockLimit){q.DeleteContents();q.MoveToSelection();var r=q.CheckStartOfBlock();var t=q.CheckEndOfBlock();var k=q.StartBlock?q.StartBlock.tagName.toUpperCase():"";var l=this._HasShift;var m=false;if(!l&&k=="LI"){return this._ExecuteEnterBlock(null,q);}if(!l&&t&&(/^H[1-6]$/).test(k)){FCKDomTools.InsertAfterNode(q.StartBlock,this.Window.document.createElement("br"));if(FCKBrowserInfo.IsGecko){FCKDomTools.InsertAfterNode(q.StartBlock,this.Window.document.createTextNode(""));}q.SetStart(q.StartBlock.nextSibling,FCKBrowserInfo.IsIE?3:1);}else{var n;m=k.IEquals("pre");if(m){n=this.Window.document.createTextNode(FCKBrowserInfo.IsIE?"\r":"\n");}else{n=this.Window.document.createElement("br");}q.InsertNode(n);if(FCKBrowserInfo.IsGecko){FCKDomTools.InsertAfterNode(n,this.Window.document.createTextNode(""));}if(t&&FCKBrowserInfo.IsGeckoLike){FCKTools.AppendBogusBr(n.parentNode);}if(FCKBrowserInfo.IsIE){q.SetStart(n,4);}else{q.SetStart(n.nextSibling,1);}if(!FCKBrowserInfo.IsIE){var o=null;if(FCKBrowserInfo.IsOpera){o=this.Window.document.createElement("span");}else{o=this.Window.document.createElement("br");}n.parentNode.insertBefore(o,n.nextSibling);FCKDomTools.ScrollIntoView(o,false);o.parentNode.removeChild(o);}}q.Collapse(true);q.Select(m);}q.Release();return true;};FCKEnterKey.prototype._OutdentWithSelection=function(f,g){var d=g.CreateBookmark();FCKListHandler.OutdentListItem(f);g.MoveToBookmark(d);g.Select();};FCKEnterKey.prototype._CheckIsAllContentsIncluded=function(h,i){var j=false;var k=false;if(h.StartContainer==i||h.StartContainer==i.firstChild){j=(h._Range.startOffset==0);}if(h.EndContainer==i||h.EndContainer==i.lastChild){var g=h.EndContainer.nodeType==3?h.EndContainer.length:h.EndContainer.childNodes.length;k=(h._Range.endOffset==g);}return j&&k;};FCKEnterKey.prototype._FixIESelectAllBug=function(f){var g=this.Window.document;g.body.innerHTML="";var d;if(FCKConfig.EnterMode.IEquals(["div","p"])){d=g.createElement(FCKConfig.EnterMode);g.body.appendChild(d);}else{d=g.body;}f.MoveToNodeContents(d);f.Collapse(true);f.Select();f.Release();};var FCKDocumentProcessor={};FCKDocumentProcessor._Items=[];FCKDocumentProcessor.AppendNew=function(){var b={};this._Items.push(b);return b;};FCKDocumentProcessor.Process=function(g){var h=FCK.IsDirty();var i,f=0;while((i=this._Items[f++])){i.ProcessDocument(g);}if(!h){FCK.ResetIsDirty();}};var FCKDocumentProcessor_CreateFakeImage=function(f,g){var d=FCKTools.GetElementDocument(g).createElement("IMG");d.className=f;d.src=FCKConfig.BasePath+"images/spacer.gif";d.setAttribute("_fckfakelement","true",0);d.setAttribute("_fckrealelement",FCKTempBin.AddElement(g),0);return d;};if(FCKBrowserInfo.IsIE||FCKBrowserInfo.IsOpera){var FCKAnchorsProcessor=FCKDocumentProcessor.AppendNew();FCKAnchorsProcessor.ProcessDocument=function(h){var i=h.getElementsByTagName("A");var j;var g=i.length-1;while(g>=0&&(j=i[g--])){if(j.name.length>0){if(j.innerHTML!==""){if(FCKBrowserInfo.IsIE){j.className+=" FCK__AnchorC";}}else{var k=FCKDocumentProcessor_CreateFakeImage("FCK__Anchor",j.cloneNode(true));k.setAttribute("_fckanchor","true",0);j.parentNode.insertBefore(k,j);j.parentNode.removeChild(j);}}}};}var FCKPageBreaksProcessor=FCKDocumentProcessor.AppendNew();FCKPageBreaksProcessor.ProcessDocument=function(h){var i=h.getElementsByTagName("DIV");var j;var g=i.length-1;while(g>=0&&(j=i[g--])){if(j.style.pageBreakAfter=="always"&&j.childNodes.length==1&&j.childNodes[0].style&&j.childNodes[0].style.display=="none"){var k=FCKDocumentProcessor_CreateFakeImage("FCK__PageBreak",j.cloneNode(true));j.parentNode.insertBefore(k,j);j.parentNode.removeChild(j);}}};var FCKEmbedAndObjectProcessor=(function(){var g=[];var h=function(d){var a=d.cloneNode(true);var b;var c=b=FCKDocumentProcessor_CreateFakeImage("FCK__UnknownObject",a);FCKEmbedAndObjectProcessor.RefreshView(c,d);for(var l=0;l<g.length;l++){b=g[l](d,b)||b;}if(b!=c){FCKTempBin.RemoveElement(c.getAttribute("_fckrealelement"));}d.parentNode.replaceChild(b,d);};var i=function(d,a){var b=a.getElementsByTagName(d);for(var c=b.length-1;c>=0;c--){h(b[c]);}};var f=function(a){i("object",a);i("embed",a);};return FCKTools.Merge(FCKDocumentProcessor.AppendNew(),{ProcessDocument:function(a){if(FCKBrowserInfo.IsGecko){FCKTools.RunFunction(f,this,[a]);}else{f(a);}},RefreshView:function(a,b){if(b.getAttribute("width")>0){a.style.width=FCKTools.ConvertHtmlSizeToStyle(b.getAttribute("width"));}if(b.getAttribute("height")>0){a.style.height=FCKTools.ConvertHtmlSizeToStyle(b.getAttribute("height"));}},AddCustomHandler:function(a){g.push(a);}});})();FCK.GetRealElement=function(d){var c=FCKTempBin.Elements[d.getAttribute("_fckrealelement")];if(d.getAttribute("_fckflash")){if(d.style.width.length>0){c.width=FCKTools.ConvertStyleSizeToHtml(d.style.width);}if(d.style.height.length>0){c.height=FCKTools.ConvertStyleSizeToHtml(d.style.height);}}return c;};if(FCKBrowserInfo.IsIE){FCKDocumentProcessor.AppendNew().ProcessDocument=function(h){var i=h.getElementsByTagName("HR");var j;var g=i.length-1;while(g>=0&&(j=i[g--])){var k=h.createElement("hr");k.mergeAttributes(j,true);FCKDomTools.InsertAfterNode(j,k);j.parentNode.removeChild(j);}};}FCKDocumentProcessor.AppendNew().ProcessDocument=function(h){var i=h.getElementsByTagName("INPUT");var j;var g=i.length-1;while(g>=0&&(j=i[g--])){if(j.type=="hidden"){var k=FCKDocumentProcessor_CreateFakeImage("FCK__InputHidden",j.cloneNode(true));k.setAttribute("_fckinputhidden","true",0);j.parentNode.insertBefore(k,j);j.parentNode.removeChild(j);}}};FCKEmbedAndObjectProcessor.AddCustomHandler(function(d,c){if(!(d.nodeName.IEquals("embed")&&(d.type=="application/x-shockwave-flash"||/\.swf|\.flv($|#|\?)/i.test(d.src)))){return;}c.className="FCK__Flash";c.setAttribute("_fckflash","true",0);});if(FCKBrowserInfo.IsSafari){FCKDocumentProcessor.AppendNew().ProcessDocument=function(f){var g=f.getElementsByClassName?f.getElementsByClassName("Apple-style-span"):Array.prototype.filter.call(f.getElementsByTagName("span"),function(a){return a.className=="Apple-style-span";});for(var d=g.length-1;d>=0;d--){FCKDomTools.RemoveNode(g[d],true);}};}var FCKSelection=FCK.Selection={GetParentBlock:function(){var b=this.GetParentElement();while(b){if(FCKListsLib.BlockBoundaries[b.nodeName.toLowerCase()]){break;}b=b.parentNode;}return b;},ApplyStyle:function(b){FCKStyles.ApplyStyle(new FCKStyle(b));}};FCKSelection.GetType=function(){var g="Text";var h;try{h=this.GetSelection();}catch(f){}if(h&&h.rangeCount==1){var i=h.getRangeAt(0);if(i.startContainer==i.endContainer&&(i.endOffset-i.startOffset)==1&&i.startContainer.nodeType==1&&FCKListsLib.StyleObjectElements[i.startContainer.childNodes[i.startOffset].nodeName.toLowerCase()]){g="Control";}}return g;};FCKSelection.GetSelectedElement=function(){var f=!!FCK.EditorWindow&&this.GetSelection();if(!f||f.rangeCount<1){return null;}var g=f.getRangeAt(0);if(g.startContainer!=g.endContainer||g.startContainer.nodeType!=1||g.startOffset!=g.endOffset-1){return null;}var d=g.startContainer.childNodes[g.startOffset];if(d.nodeType!=1){return null;}return d;};FCKSelection.GetParentElement=function(){if(this.GetType()=="Control"){return FCKSelection.GetSelectedElement().parentNode;}else{var k=this.GetSelection();if(k){if(k.anchorNode&&k.anchorNode==k.focusNode){var l=k.getRangeAt(0);if(l.collapsed||l.startContainer.nodeType==3){return k.anchorNode.parentNode;}else{return k.anchorNode;}}var m=new FCKElementPath(k.anchorNode);var n=new FCKElementPath(k.focusNode);var o=null;var p=null;if(m.Elements.length>n.Elements.length){o=m.Elements;p=n.Elements;}else{o=n.Elements;p=m.Elements;}var q=o.length-p.length;for(var i=0;i<p.length;i++){if(o[q+i]==p[i]){return p[i];}}return null;}}return null;};FCKSelection.GetBoundaryParentElement=function(g){if(!FCK.EditorWindow){return null;}if(this.GetType()=="Control"){return FCKSelection.GetSelectedElement().parentNode;}else{var h=this.GetSelection();if(h&&h.rangeCount>0){var i=h.getRangeAt(g?0:(h.rangeCount-1));var f=g?i.startContainer:i.endContainer;return(f.nodeType==1?f:f.parentNode);}}return null;};FCKSelection.SelectNode=function(f){var g=FCK.EditorDocument.createRange();g.selectNode(f);var d=this.GetSelection();d.removeAllRanges();d.addRange(g);};FCKSelection.Collapse=function(d){var c=this.GetSelection();if(d==null||d===true){c.collapseToStart();}else{c.collapseToEnd();}};FCKSelection.HasAncestorNode=function(f){var g=this.GetSelectedElement();if(!g&&FCK.EditorWindow){try{g=this.GetSelection().getRangeAt(0).startContainer;}catch(d){}}while(g){if(g.nodeType==1&&g.nodeName.IEquals(f)){return true;}g=g.parentNode;}return false;};FCKSelection.MoveToAncestorNode=function(f){var g;var d=this.GetSelectedElement();if(!d){d=this.GetSelection().getRangeAt(0).startContainer;}while(d){if(d.nodeName.IEquals(f)){return d;}d=d.parentNode;}return null;};FCKSelection.Delete=function(){var d=this.GetSelection();for(var c=0;c<d.rangeCount;c++){d.getRangeAt(c).deleteContents();}return d;};FCKSelection.GetSelection=function(){return FCK.EditorWindow.getSelection();};FCKSelection.Save=function(){};FCKSelection.Restore=function(){};FCKSelection.Release=function(){};var FCKTableHandler={};FCKTableHandler.InsertRow=function(f){var g=FCKSelection.MoveToAncestorNode("TR");if(!g){return;}var d=g.cloneNode(true);g.parentNode.insertBefore(d,g);FCKTableHandler.ClearRow(f?d:g);};FCKTableHandler.DeleteRows=function(i){if(!i){var j=FCKTableHandler.GetSelectedCells();var k=[];for(var h=0;h<j.length;h++){var l=j[h].parentNode;k[l.rowIndex]=l;}for(var h=k.length;h>=0;h--){if(k[h]){FCKTableHandler.DeleteRows(k[h]);}}return;}var m=FCKTools.GetElementAscensor(i,"TABLE");if(m.rows.length==1){FCKTableHandler.DeleteTable(m);return;}i.parentNode.removeChild(i);};FCKTableHandler.DeleteTable=function(b){if(!b){b=FCKSelection.GetSelectedElement();if(!b||b.tagName!="TABLE"){b=FCKSelection.MoveToAncestorNode("TABLE");}}if(!b){return;}FCKSelection.SelectNode(b);FCKSelection.Collapse();if(b.parentNode.childNodes.length==1){b.parentNode.parentNode.removeChild(b.parentNode);}else{b.parentNode.removeChild(b);}};FCKTableHandler.InsertColumn=function(k){var l=null;var m=this.GetSelectedCells();if(m&&m.length){l=m[k?0:(m.length-1)];}if(!l){return;}var n=FCKTools.GetElementAscensor(l,"TABLE");var o=l.cellIndex;for(var i=0;i<n.rows.length;i++){var p=n.rows[i];if(p.cells.length<(o+1)){continue;}l=p.cells[o].cloneNode(false);if(FCKBrowserInfo.IsGeckoLike){FCKTools.AppendBogusBr(l);}var q=p.cells[o];p.insertBefore(l,(k?q:q.nextSibling));}};FCKTableHandler.DeleteColumns=function(i){if(!i){var j=FCKTableHandler.GetSelectedCells();for(var h=j.length;h>=0;h--){if(j[h]){FCKTableHandler.DeleteColumns(j[h]);}}return;}if(!i){return;}var k=FCKTools.GetElementAscensor(i,"TABLE");var l=i.cellIndex;for(var h=k.rows.length-1;h>=0;h--){var m=k.rows[h];if(l==0&&m.cells.length==1){FCKTableHandler.DeleteRows(m);continue;}if(m.cells[l]){m.removeChild(m.cells[l]);}}};FCKTableHandler.InsertCell=function(h,i){var j=null;var k=this.GetSelectedCells();if(k&&k.length){j=k[i?0:(k.length-1)];}if(!j){return null;}var g=FCK.EditorDocument.createElement("TD");g.setAttribute("class","td-info");if(FCKBrowserInfo.IsGeckoLike){FCKTools.AppendBogusBr(g);}if(!i&&j.cellIndex==j.parentNode.cells.length-1){j.parentNode.appendChild(g);}else{j.parentNode.insertBefore(g,i?j:j.nextSibling);}return g;};FCKTableHandler.DeleteCell=function(b){if(b.parentNode.cells.length==1){FCKTableHandler.DeleteRows(b.parentNode);return;}b.parentNode.removeChild(b);};FCKTableHandler.DeleteCells=function(){var d=FCKTableHandler.GetSelectedCells();for(var c=d.length-1;c>=0;c--){FCKTableHandler.DeleteCell(d[c]);}};FCKTableHandler._MarkCells=function(f,g){for(var d=0;d<f.length;d++){f[d][g]=true;}};FCKTableHandler._UnmarkCells=function(f,g){for(var d=0;d<f.length;d++){FCKDomTools.ClearElementJSProperty(f[d],g);}};FCKTableHandler._ReplaceCellsByMarker=function(h,i,j){for(var k=0;k<h.length;k++){for(var g=0;g<h[k].length;g++){if(h[k][g][i]){h[k][g]=j;}}}};FCKTableHandler._GetMarkerGeometry=function(p,q,r,t){var i=0;var l=0;var m=0;var n=0;for(var o=r;p[q][o]&&p[q][o][t];o++){i++;}for(var o=r-1;p[q][o]&&p[q][o][t];o--){i++;m++;}for(var o=q;p[o]&&p[o][r]&&p[o][r][t];o++){l++;}for(var o=q-1;p[o]&&p[o][r]&&p[o][r][t];o--){l++;n++;}return{"width":i,"height":l,"x":m,"y":n};};FCKTableHandler.CheckIsSelectionRectangular=function(){var p=FCKTableHandler.GetSelectedCells();if(p.length<1){return false;}for(var o=0;o<p.length;o++){if(p[o].parentNode.parentNode!=p[0].parentNode.parentNode){return false;}}this._MarkCells(p,"_CellSelected");var q=this._CreateTableMap(p[0]);var r=p[0].parentNode.rowIndex;var t=this._GetCellIndexSpan(q,r,p[0]);var g=this._GetMarkerGeometry(q,r,t,"_CellSelected");var i=t-g.x;var m=r-g.y;if(g.width>=g.height){for(t=i;t<i+g.width;t++){r=m+(t-i)%g.height;if(!q[r]||!q[r][t]){this._UnmarkCells(p,"_CellSelected");return false;}var n=this._GetMarkerGeometry(q,r,t,"_CellSelected");if(n.width!=g.width||n.height!=g.height){this._UnmarkCells(p,"_CellSelected");return false;}}}else{for(r=m;r<m+g.height;r++){t=i+(r-m)%g.width;if(!q[r]||!q[r][t]){this._UnmarkCells(p,"_CellSelected");return false;}var n=this._GetMarkerGeometry(q,r,t,"_CellSelected");if(n.width!=g.width||n.height!=g.height){this._UnmarkCells(p,"_CellSelected");return false;}}}this._UnmarkCells(p,"_CellSelected");return true;};FCKTableHandler.MergeCells=function(){var B=this.GetSelectedCells();if(B.length<2){return;}var C=B[0];var D=this._CreateTableMap(C);var E=C.parentNode.rowIndex;var i=this._GetCellIndexSpan(D,E,C);this._MarkCells(B,"_SelectedCells");var j=this._GetMarkerGeometry(D,E,i,"_SelectedCells");var r=i-j.x;var t=E-j.y;var u=FCKTools.GetElementDocument(C).createDocumentFragment();for(var z=0;z<j.height;z++){var v=0;for(var A=0;A<j.width;A++){var x=D[t+z][r+A];while(x.childNodes.length>0){var y=x.removeChild(x.firstChild);if(y.nodeType!=1||(y.getAttribute("type",2)!="_moz"&&y.getAttribute("_moz_dirty")!=null)){u.appendChild(y);v++;}}}if(v>0){u.appendChild(FCK.EditorDocument.createElement("br"));}}this._ReplaceCellsByMarker(D,"_SelectedCells",C);this._UnmarkCells(B,"_SelectedCells");this._InstallTableMap(D,C.parentNode.parentNode.parentNode);C.appendChild(u);if(FCKBrowserInfo.IsGeckoLike&&(!C.firstChild)){FCKTools.AppendBogusBr(C);}this._MoveCaretToCell(C,false);};FCKTableHandler.MergeRight=function(){var h=this.GetMergeRightTarget();if(h==null){return;}var i=h.refCell;var j=h.tableMap;var k=h.nextCell;var g=FCK.EditorDocument.createDocumentFragment();while(k&&k.childNodes&&k.childNodes.length>0){g.appendChild(k.removeChild(k.firstChild));}k.parentNode.removeChild(k);i.appendChild(g);this._MarkCells([k],"_Replace");this._ReplaceCellsByMarker(j,"_Replace",i);this._InstallTableMap(j,i.parentNode.parentNode.parentNode);this._MoveCaretToCell(i,false);};FCKTableHandler.MergeDown=function(){var h=this.GetMergeDownTarget();if(h==null){return;}var i=h.refCell;var j=h.tableMap;var k=h.nextCell;var g=FCKTools.GetElementDocument(i).createDocumentFragment();while(k&&k.childNodes&&k.childNodes.length>0){g.appendChild(k.removeChild(k.firstChild));}if(g.firstChild){g.insertBefore(FCK.EditorDocument.createElement("br"),g.firstChild);}i.appendChild(g);this._MarkCells([k],"_Replace");this._ReplaceCellsByMarker(j,"_Replace",i);this._InstallTableMap(j,i.parentNode.parentNode.parentNode);this._MoveCaretToCell(i,false);};FCKTableHandler.HorizontalSplitCell=function(){var D=FCKTableHandler.GetSelectedCells();if(D.length!=1){return;}var E=D[0];var F=this._CreateTableMap(E);var G=E.parentNode.rowIndex;var I=FCKTableHandler._GetCellIndexSpan(F,G,E);var J=isNaN(E.colSpan)?1:E.colSpan;if(J>1){var K=Math.ceil(J/2);var i=FCK.EditorDocument.createElement(E.nodeName);i.setAttribute("class","td-info");if(FCKBrowserInfo.IsGeckoLike){FCKTools.AppendBogusBr(i);}var j=I+K;var r=I+J;var x=isNaN(E.rowSpan)?1:E.rowSpan;for(var H=G;H<G+x;H++){for(var A=j;A<r;A++){F[H][A]=i;}}}else{var y=[];for(var A=0;A<F.length;A++){var z=F[A].slice(0,I);if(F[A].length<=I){y.push(z);continue;}if(F[A][I]==E){z.push(E);var C=FCK.EditorDocument.createElement(E.nodeName);C.setAttribute("class","td-info");z.push(C);if(FCKBrowserInfo.IsGeckoLike){FCKTools.AppendBogusBr(C);}}else{z.push(F[A][I]);z.push(F[A][I]);}for(var B=I+1;B<F[A].length;B++){z.push(F[A][B]);}y.push(z);}F=y;}this._InstallTableMap(F,E.parentNode.parentNode.parentNode);};FCKTableHandler.VerticalSplitCell=function(){var G=FCKTableHandler.GetSelectedCells();if(G.length!=1){return;}var H=G[0];var I=this._CreateTableMap(H);var J=H.parentNode.rowIndex;var K=FCKTableHandler._GetCellIndexSpan(I,J,H);var i=isNaN(H.colSpan)?1:H.colSpan;var u=H.rowSpan;if(isNaN(u)){u=1;}if(u>1){H.rowSpan=Math.ceil(u/2);var v=J+Math.ceil(u/2);var x=I[v];var y=null;for(var F=K+1;F<x.length;F++){if(x[F].parentNode.rowIndex==v){y=x[F];break;}}var z=FCK.EditorDocument.createElement(H.nodeName);z.setAttribute("class","td-info");z.rowSpan=Math.floor(u/2);if(i>1){z.colSpan=i;}if(FCKBrowserInfo.IsGeckoLike){FCKTools.AppendBogusBr(z);}H.parentNode.parentNode.parentNode.rows[v].insertBefore(z,y);}else{var A=H.parentNode.sectionRowIndex+1;var B=FCK.EditorDocument.createElement("tr");var C=H.parentNode.parentNode;if(C.rows.length>A){C.insertBefore(B,C.rows[A]);}else{C.appendChild(B);}for(var F=0;F<I[J].length;){var D=I[J][F].colSpan;if(isNaN(D)||D<1){D=1;}if(F==K){F+=D;continue;}var E=I[J][F].rowSpan;if(isNaN(E)){E=1;}I[J][F].rowSpan=E+1;F+=D;}var z=FCK.EditorDocument.createElement(H.nodeName);z.setAttribute("class","td-info");if(i>1){z.colSpan=i;}if(FCKBrowserInfo.IsGeckoLike){FCKTools.AppendBogusBr(z);}B.appendChild(z);}};FCKTableHandler._GetCellIndexSpan=function(h,i,k){if(h.length<i+1){return null;}var c=h[i];for(var j=0;j<c.length;j++){if(c[j]==k){return j;}}return null;};FCKTableHandler._GetCellLocation=function(g,h){for(var c=0;c<g.length;c++){for(var i=0;i<g[c].length;i++){if(g[c][i]==h){return[c,i];}}}return null;};FCKTableHandler._CreateTableMap=function(y){var z=(y.nodeName=="TABLE"?y:y.parentNode.parentNode.parentNode);var A=z.rows;var B=-1;var C=[];for(var v=0;v<A.length;v++){B++;if(!C[B]){C[B]=[];}var u=-1;for(var x=0;x<A[v].cells.length;x++){var c=A[v].cells[x];u++;while(C[B][u]){u++;}var i=isNaN(c.colSpan)?1:c.colSpan;var j=isNaN(c.rowSpan)?1:c.rowSpan;for(var r=0;r<j;r++){if(!C[B+r]){C[B+r]=[];}for(var t=0;t<i;t++){C[B+r][u+t]=A[v].cells[x];}}u+=i-1;}}return C;};FCKTableHandler._InstallTableMap=function(j,l){var m=FCKBrowserInfo.IsIE?"_fckrowspan":"rowSpan";for(var p=0;p<j.length;p++){for(var q=0;q<j[p].length;q++){var n=j[p][q];if(n.parentNode){n.parentNode.removeChild(n);}n.colSpan=n[m]=1;}}var o=0;for(var p=0;p<j.length;p++){for(var q=0;q<j[p].length;q++){var n=j[p][q];if(!n){continue;}if(q>o){o=q;}if(n._colScanned===true){continue;}if(j[p][q-1]==n){n.colSpan++;}if(j[p][q+1]!=n){n._colScanned=true;}}}for(var p=0;p<=o;p++){for(var q=0;q<j.length;q++){if(!j[q]){continue;}var n=j[q][p];if(!n||n._rowScanned===true){continue;}if(j[q-1]&&j[q-1][p]==n){n[m]++;}if(!j[q+1]||j[q+1][p]!=n){n._rowScanned=true;}}}for(var p=0;p<j.length;p++){for(var q=0;q<j[p].length;q++){var n=j[p][q];FCKDomTools.ClearElementJSProperty(n,"_colScanned");FCKDomTools.ClearElementJSProperty(n,"_rowScanned");}}for(var p=0;p<j.length;p++){var i=FCK.EditorDocument.createElement("tr");for(var q=0;q<j[p].length;){var n=j[p][q];if(j[p-1]&&j[p-1][q]==n){q+=n.colSpan;continue;}i.appendChild(n);if(m!="rowSpan"){n.rowSpan=n[m];n.removeAttribute(m);}q+=n.colSpan;if(n.colSpan==1){n.removeAttribute("colspan");}if(n.rowSpan==1){n.removeAttribute("rowspan");}}if(FCKBrowserInfo.IsIE){l.rows[p].replaceNode(i);}else{l.rows[p].innerHTML="";FCKDomTools.MoveChildren(i,l.rows[p]);}}};FCKTableHandler._MoveCaretToCell=function(f,g){var d=new FCKDomRange(FCK.EditorWindow);d.MoveToNodeContents(f);d.Collapse(g);d.Select();};FCKTableHandler.ClearRow=function(f){var g=f.cells;for(var d=0;d<g.length;d++){g[d].innerHTML="";if(FCKBrowserInfo.IsGeckoLike){FCKTools.AppendBogusBr(g[d]);}}};FCKTableHandler.GetMergeRightTarget=function(){var p=this.GetSelectedCells();if(p.length!=1){return null;}var q=p[0];var r=this._CreateTableMap(q);var t=q.parentNode.rowIndex;var k=this._GetCellIndexSpan(r,t,q);var l=k+(isNaN(q.colSpan)?1:q.colSpan);var m=r[t][l];if(!m){return null;}this._MarkCells([q,m],"_SizeTest");var n=this._GetMarkerGeometry(r,t,k,"_SizeTest");var o=this._GetMarkerGeometry(r,t,l,"_SizeTest");this._UnmarkCells([q,m],"_SizeTest");if(n.height!=o.height||n.y!=o.y){return null;}return{"refCell":q,"nextCell":m,"tableMap":r};};FCKTableHandler.GetMergeDownTarget=function(){var p=this.GetSelectedCells();if(p.length!=1){return null;}var q=p[0];var r=this._CreateTableMap(q);var t=q.parentNode.rowIndex;var k=this._GetCellIndexSpan(r,t,q);var l=t+(isNaN(q.rowSpan)?1:q.rowSpan);if(!r[l]){return null;}var m=r[l][k];if(!m){return null;}if(q.parentNode.parentNode!=m.parentNode.parentNode){return null;}this._MarkCells([q,m],"_SizeTest");var n=this._GetMarkerGeometry(r,t,k,"_SizeTest");var o=this._GetMarkerGeometry(r,l,k,"_SizeTest");this._UnmarkCells([q,m],"_SizeTest");if(n.width!=o.width||n.x!=o.x){return null;}return{"refCell":q,"nextCell":m,"tableMap":r};};FCKTableHandler.GetSelectedCells=function(){var i=[];var j=FCKSelection.GetSelection();if(j.rangeCount==1&&j.anchorNode.nodeType==3){var k=FCKTools.GetElementAscensor(j.anchorNode,"TD,TH");if(k){i[0]=k;}return i;}for(var h=0;h<j.rangeCount;h++){var l=j.getRangeAt(h);var m;if(l.startContainer.tagName.Equals("TD","TH")){m=l.startContainer;}else{m=l.startContainer.childNodes[l.startOffset];}if(m.nodeName.Equals("TD","TH")){i[i.length]=m;}}return i;};var FCKXml=function(){this.Error=false;};FCKXml.GetAttribute=function(g,h,i){var f=g.attributes.getNamedItem(h);return f?f.value:i;};FCKXml.TransformToObject=function(p){if(!p){return null;}var q={};var r=p.attributes;for(var o=0;o<r.length;o++){var t=r[o];q[t.name]=t.value;}var i=p.childNodes;for(o=0;o<i.length;o++){var l=i[o];if(l.nodeType==1){var m="$"+l.nodeName;var n=q[m];if(!n){n=q[m]=[];}n.push(this.TransformToObject(l));}}return q;};FCKXml.prototype={LoadUrl:function(h){this.Error=false;var i;var j=FCKTools.CreateXmlObject("XmlHttp");j.open("GET",h,false);j.send(null);if(j.status==200||j.status==304||(j.status==0&&j.readyState==4)){i=j.responseXML;if(!i){i=(new DOMParser()).parseFromString(j.responseText,"text/xml");}}else{i=null;}if(i){try{var k=i.firstChild;}catch(g){i=(new DOMParser()).parseFromString(j.responseText,"text/xml");}}if(!i||!i.firstChild){this.Error=true;if(window.confirm('Error loading "'+h+'" (HTTP Status: '+j.status+").\r\nDo you want to see the server response dump?")){alert(j.responseText);}}this.DOMDocument=i;},SelectNodes:function(h,i){if(this.Error){return[];}var j=[];var k=this.DOMDocument.evaluate(h,i?i:this.DOMDocument,this.DOMDocument.createNSResolver(this.DOMDocument.documentElement),XPathResult.ORDERED_NODE_ITERATOR_TYPE,null);if(k){var g=k.iterateNext();while(g){j[j.length]=g;g=k.iterateNext();}}return j;},SelectSingleNode:function(f,g){if(this.Error){return null;}var d=this.DOMDocument.evaluate(f,g?g:this.DOMDocument,this.DOMDocument.createNSResolver(this.DOMDocument.documentElement),9,null);if(d&&d.singleNodeValue){return d.singleNodeValue;}else{return null;}}};FCKSelection.IsGridNode=function(){var c=this.GetSelectedElement();if(!c&&FCK.EditorWindow){try{c=this.GetSelection().getRangeAt(0).startContainer;}catch(d){}}while(c){if(c.nodeType==1&&c.nodeName.IEquals("TABLE")){if(c.getAttribute("isgrid")){return true;}return false;}c=c.parentNode;if(!c){break;}}return false;};var FCKNamedCommand=function(b){this.Name=b;};FCKNamedCommand.prototype.Execute=function(){FCK.ExecuteNamedCommand(this.Name);};FCKNamedCommand.prototype.GetState=function(){if(FCK.EditMode!=0){return -1;}return FCK.GetNamedCommandState(this.Name);};var FCKStyleCommand=function(){};FCKStyleCommand.prototype={Name:"Style",Execute:function(d,c){FCKUndo.SaveUndoStep();if(c.Selected){FCK.Styles.RemoveStyle(c.Style);}else{FCK.Styles.ApplyStyle(c.Style);}FCKUndo.SaveUndoStep();FCK.Focus();FCK.Events.FireEvent("OnSelectionChange");},GetState:function(){if(FCK.EditMode!=0||!FCK.EditorDocument){return -1;}if(FCKSelection.GetType()=="Control"){var b=FCKSelection.GetSelectedElement();if(!b||!FCKStyles.CheckHasObjectStyle(b.nodeName.toLowerCase())){return -1;}}return 0;}};var FCKDialogCommand=function(k,l,m,n,o,p,q,j){this.Name=k;this.Title=l;this.Url=m;this.Width=n;this.Height=o;this.CustomValue=j;this.GetStateFunction=p;this.GetStateParam=q;this.Resizable=false;};FCKDialogCommand.prototype.Execute=function(){FCKDialog.OpenDialog("FCKDialog_"+this.Name,this.Title,this.Url,this.Width,this.Height,this.CustomValue,this.Resizable);};FCKDialogCommand.prototype.GetState=function(){if(this.GetStateFunction){return this.GetStateFunction(this.GetStateParam);}else{return FCK.EditMode==0?0:-1;}};var FCKUndefinedCommand=function(){this.Name="Undefined";};FCKUndefinedCommand.prototype.Execute=function(){alert(FCKLang.NotImplemented);};FCKUndefinedCommand.prototype.GetState=function(){return 0;};var FCKFormatBlockCommand=function(){};FCKFormatBlockCommand.prototype={Name:"FormatBlock",Execute:FCKStyleCommand.prototype.Execute,GetState:function(){return FCK.EditorDocument?0:-1;}};var FCKFontNameCommand=function(){};FCKFontNameCommand.prototype={Name:"FontName",Execute:FCKStyleCommand.prototype.Execute,GetState:FCKFormatBlockCommand.prototype.GetState};var FCKFontSizeCommand=function(){};FCKFontSizeCommand.prototype={Name:"FontSize",Execute:FCKStyleCommand.prototype.Execute,GetState:FCKFormatBlockCommand.prototype.GetState};var FCKPreviewCommand=function(){this.Name="Preview";};FCKPreviewCommand.prototype.Execute=function(){FCK.Preview();};FCKPreviewCommand.prototype.GetState=function(){return 0;};var FCKSaveCommand=function(){this.Name="Save";};FCKSaveCommand.prototype.Execute=function(){var d=FCK.GetParentForm();if(typeof(d.onsubmit)=="function"){var c=d.onsubmit();if(c!=null&&c===false){return;}}if(typeof(d.submit)=="function"){d.submit();}else{d.submit.click();}};FCKSaveCommand.prototype.GetState=function(){return 0;};var FCKNewPageCommand=function(){this.Name="NewPage";};FCKNewPageCommand.prototype.Execute=function(){FCKUndo.SaveUndoStep();FCK.SetData("");FCKUndo.Typing=true;FCK.Focus();};FCKNewPageCommand.prototype.GetState=function(){return 0;};var FCKSourceCommand=function(){this.Name="Source";};FCKSourceCommand.prototype.Execute=function(){if(FCKConfig.SourcePopup){var d=FCKConfig.ScreenWidth*0.65;var c=FCKConfig.ScreenHeight*0.65;FCKDialog.OpenDialog("FCKDialog_Source",FCKLang.Source,"dialog/fck_source.html",d,c,null,true);}else{FCK.SwitchEditMode();}};FCKSourceCommand.prototype.GetState=function(){return(FCK.EditMode==0?0:1);};var FCKUndoCommand=function(){this.Name="Undo";};FCKUndoCommand.prototype.Execute=function(){FCKUndo.Undo();};FCKUndoCommand.prototype.GetState=function(){if(FCK.EditMode!=0){return -1;}return(FCKUndo.CheckUndoState()?0:-1);};var FCKRedoCommand=function(){this.Name="Redo";};FCKRedoCommand.prototype.Execute=function(){FCKUndo.Redo();};FCKRedoCommand.prototype.GetState=function(){if(FCK.EditMode!=0){return -1;}return(FCKUndo.CheckRedoState()?0:-1);};var FCKPageBreakCommand=function(){this.Name="PageBreak";};FCKPageBreakCommand.prototype.Execute=function(){FCKUndo.SaveUndoStep();var f=FCK.EditorDocument.createElement("DIV");f.style.pageBreakAfter="always";f.innerHTML='<span style="DISPLAY:none">&nbsp;</span>';var g=FCKDocumentProcessor_CreateFakeImage("FCK__PageBreak",f);var h=new FCKDomRange(FCK.EditorWindow);h.MoveToSelection();var i=h.SplitBlock();h.InsertNode(g);FCK.Events.FireEvent("OnSelectionChange");};FCKPageBreakCommand.prototype.GetState=function(){if(FCK.EditMode!=0){return -1;}return 0;};var FCKUnlinkCommand=function(){this.Name="Unlink";};FCKUnlinkCommand.prototype.Execute=function(){FCKUndo.SaveUndoStep();if(FCKBrowserInfo.IsGeckoLike){var b=FCK.Selection.MoveToAncestorNode("A");if(b){FCKTools.RemoveOuterTags(b);}return;}FCK.ExecuteNamedCommand(this.Name);};FCKUnlinkCommand.prototype.GetState=function(){if(FCK.EditMode!=0){return -1;}var f=FCK.GetNamedCommandState(this.Name);if(f==0&&FCK.EditMode==0){var g=FCKSelection.MoveToAncestorNode("A");var d=(g&&g.name.length>0&&g.href.length==0);if(d){f=-1;}}return f;};var FCKVisitLinkCommand=function(){this.Name="VisitLink";};FCKVisitLinkCommand.prototype={GetState:function(){if(FCK.EditMode!=0){return -1;}var d=FCK.GetNamedCommandState("Unlink");if(d==0){var c=FCKSelection.MoveToAncestorNode("A");if(!c.href){d=-1;}}return d;},Execute:function(){var h=FCKSelection.MoveToAncestorNode("A");var i=h.getAttribute("_fcksavedurl")||h.getAttribute("href",2);if(!/:\/\//.test(i)){var j=FCKConfig.BaseHref;var k=FCK.GetInstanceObject("parent");if(!j){j=k.document.location.href;j=j.substring(0,j.lastIndexOf("/")+1);}if(/^\//.test(i)){try{j=j.match(/^.*:\/\/+[^\/]+/)[0];}catch(g){j=k.document.location.protocol+"://"+k.parent.document.location.host;}}i=j+i;}if(!window.open(i,"_blank")){alert(FCKLang.VisitLinkBlocked);}}};var FCKSelectAllCommand=function(){this.Name="SelectAll";};FCKSelectAllCommand.prototype.Execute=function(){if(FCK.EditMode==0){FCK.ExecuteNamedCommand("SelectAll");}else{var b=FCK.EditingArea.Textarea;if(FCKBrowserInfo.IsIE){b.createTextRange().execCommand("SelectAll");}else{b.selectionStart=0;b.selectionEnd=b.value.length;}b.focus();}};FCKSelectAllCommand.prototype.GetState=function(){if(FCK.EditMode!=0){return -1;}return 0;};var FCKPasteCommand=function(){this.Name="Paste";};FCKPasteCommand.prototype={Execute:function(){if(FCKBrowserInfo.IsIE){FCK.Paste();}else{FCK.ExecuteNamedCommand("Paste");}},GetState:function(){if(FCK.EditMode!=0){return -1;}return FCK.GetNamedCommandState("Paste");}};var FCKRuleCommand=function(){this.Name="Rule";};FCKRuleCommand.prototype={Execute:function(){FCKUndo.SaveUndoStep();FCK.InsertElement("hr");},GetState:function(){if(FCK.EditMode!=0){return -1;}return FCK.GetNamedCommandState("InsertHorizontalRule");}};var FCKCutCopyCommand=function(b){this.Name=b?"Cut":"Copy";};FCKCutCopyCommand.prototype={Execute:function(){var g=false;if(FCKBrowserInfo.IsIE){var h=function(){g=true;};var i="on"+this.Name.toLowerCase();FCK.EditorDocument.body.attachEvent(i,h);FCK.ExecuteNamedCommand(this.Name);FCK.EditorDocument.body.detachEvent(i,h);}else{try{FCK.ExecuteNamedCommand(this.Name);g=true;}catch(f){}}if(!g){alert(FCKLang["PasteError"+this.Name]);}},GetState:function(){return FCK.EditMode!=0?-1:FCK.GetNamedCommandState("Cut");}};var FCKAnchorDeleteCommand=function(){this.Name="AnchorDelete";};FCKAnchorDeleteCommand.prototype={Execute:function(){if(FCK.Selection.GetType()=="Control"){FCK.Selection.Delete();}else{var b=FCK.Selection.GetSelectedElement();if(b){if(b.tagName=="IMG"&&b.getAttribute("_fckanchor")){oAnchor=FCK.GetRealElement(b);}else{b=null;}}if(!b){oAnchor=FCK.Selection.MoveToAncestorNode("A");if(oAnchor){FCK.Selection.SelectNode(oAnchor);}}if(oAnchor.href.length!=0){oAnchor.removeAttribute("name");if(FCKBrowserInfo.IsIE){oAnchor.className=oAnchor.className.replace(FCKRegexLib.FCK_Class,"");}return;}if(b){b.parentNode.removeChild(b);return;}if(oAnchor.innerHTML.length==0){oAnchor.parentNode.removeChild(oAnchor);return;}FCKTools.RemoveOuterTags(oAnchor);}if(FCKBrowserInfo.IsGecko){FCK.Selection.Collapse(true);}},GetState:function(){if(FCK.EditMode!=0){return -1;}return FCK.GetNamedCommandState("Unlink");}};var FCKDeleteDivCommand=function(){};FCKDeleteDivCommand.prototype={GetState:function(){if(FCK.EditMode!=0){return -1;}var d=FCKSelection.GetParentElement();var c=new FCKElementPath(d);return c.BlockLimit&&c.BlockLimit.nodeName.IEquals("div")?0:-1;},Execute:function(){FCKUndo.SaveUndoStep();var g=FCKDomTools.GetSelectedDivContainers();var h=new FCKDomRange(FCK.EditorWindow);h.MoveToSelection();var i=h.CreateBookmark();for(var f=0;f<g.length;f++){FCKDomTools.RemoveNode(g[f],true);}h.MoveToBookmark(i);h.Select();}};var FCKNbsp=function(){this.Name="Non Breaking Space";};FCKNbsp.prototype={Execute:function(){FCK.InsertHtml("&nbsp;");},GetState:function(){return(FCK.EditMode!=0?-1:0);}};var FCKShowBlockCommand=function(d,c){this.Name=d;if(c!=undefined){this._SavedState=c;}else{this._SavedState=null;}};FCKShowBlockCommand.prototype.Execute=function(){var g=this.GetState();if(g==-1){return;}var h=FCK.EditorDocument.body;if(g==1){h.className=h.className.replace(/(^| )FCK__ShowBlocks/g,"");}else{h.className+=" FCK__ShowBlocks";}if(FCKBrowserInfo.IsIE){try{FCK.EditorDocument.selection.createRange().select();}catch(f){}}else{var i=FCK.EditorWindow.getSelection().focusNode;if(i){if(i.nodeType!=1){i=i.parentNode;}FCKDomTools.ScrollIntoView(i,false);}}FCK.Events.FireEvent("OnSelectionChange");};FCKShowBlockCommand.prototype.GetState=function(){if(FCK.EditMode!=0){return -1;}if(!FCK.EditorDocument){return 0;}if(/FCK__ShowBlocks(?:\s|$)/.test(FCK.EditorDocument.body.className)){return 1;}return 0;};FCKShowBlockCommand.prototype.SaveState=function(){this._SavedState=this.GetState();};FCKShowBlockCommand.prototype.RestoreState=function(){if(this._SavedState!=null&&this.GetState()!=this._SavedState){this.Execute();}};var FCKSpellCheckCommand=function(){this.Name="SpellCheck";this.IsEnabled=(FCKConfig.SpellChecker!="ieSpell");};FCKSpellCheckCommand.prototype.Execute=function(){switch(FCKConfig.SpellChecker){case"SpellerPages":FCKDialog.OpenDialog("FCKDialog_SpellCheck","Spell Check","dialog/fck_spellerpages.html",440,480);break;case"WSC":FCKDialog.OpenDialog("FCKDialog_SpellCheck","Spell Check","wsc/w.html",530,480);}};FCKSpellCheckCommand.prototype.GetState=function(){if(FCK.EditMode!=0){return -1;}return this.IsEnabled?0:-1;};var FCKTextColorCommand=function(d){this.Name=d=="ForeColor"?"TextColor":"BGColor";this.Type=d;var c;if(FCKBrowserInfo.IsIE){c=window;}else{if(FCK.ToolbarSet._IFrame){c=FCKTools.GetElementWindow(FCK.ToolbarSet._IFrame);}else{c=window.parent;}}this._Panel=new FCKPanel(c);this._Panel.AppendStyleSheet(FCKConfig.SkinEditorCSS);this._Panel.MainNode.className="FCK_Panel";this._CreatePanelBody(this._Panel.Document,this._Panel.MainNode);FCK.ToolbarSet.ToolbarItems.GetItem(this.Name).RegisterPanel(this._Panel);FCKTools.DisableSelection(this._Panel.Document.body);};FCKTextColorCommand.prototype.Execute=function(f,g,d){this._Panel.Show(f,g,d);};FCKTextColorCommand.prototype.SetColor=function(d){FCKUndo.SaveUndoStep();var c=FCKStyles.GetStyle("_FCK_"+(this.Type=="ForeColor"?"Color":"BackColor"));if(!d||d.length==0){FCK.Styles.RemoveStyle(c);}else{c.SetVariable("Color",d);FCKStyles.ApplyStyle(c);}FCKUndo.SaveUndoStep();FCK.Focus();FCK.Events.FireEvent("OnSelectionChange");};FCKTextColorCommand.prototype.GetState=function(){if(FCK.EditMode!=0){return -1;}return 0;};function FCKTextColorCommand_OnMouseOver(){this.className="ColorSelected";}function FCKTextColorCommand_OnMouseOut(){this.className="ColorDeselected";}function FCKTextColorCommand_OnClick(f,g,d){this.className="ColorDeselected";g.SetColor(d);g._Panel.Hide();}function FCKTextColorCommand_AutoOnClick(d,c){this.className="ColorDeselected";c.SetColor("");c._Panel.Hide();}function FCKTextColorCommand_MoreOnClick(d,c){this.className="ColorDeselected";c._Panel.Hide();FCKDialog.OpenDialog("FCKDialog_Color",FCKLang.DlgColorTitle,"dialog/fck_colorselector.html",410,320,FCKTools.Bind(c,c.SetColor));}FCKTextColorCommand.prototype._CreatePanelBody=function(z,A){function y(){var a=z.createElement("DIV");a.className="ColorDeselected";FCKTools.AddEventListenerEx(a,"mouseover",FCKTextColorCommand_OnMouseOver);FCKTools.AddEventListenerEx(a,"mouseout",FCKTextColorCommand_OnMouseOut);return a;}var C=A.appendChild(z.createElement("TABLE"));C.className="ForceBaseFont";C.style.tableLayout="fixed";C.cellPadding=0;C.cellSpacing=0;C.border=0;C.width=150;var i=C.insertRow(-1).insertCell(-1);i.colSpan=8;var B=i.appendChild(y());B.innerHTML='<table cellspacing="0" cellpadding="0" width="100%" border="0">\n			<tr>\n				<td><div class="ColorBoxBorder"><div class="ColorBox" style="background-color: #000000"></div></div></td>\n				<td nowrap width="100%" align="center">'+FCKLang.ColorAutomatic+"</td>\n			</tr>\n		</table>";FCKTools.AddEventListenerEx(B,"click",FCKTextColorCommand_AutoOnClick,this);if(!FCKBrowserInfo.IsIE){B.style.width="96%";}var p=FCKConfig.FontColors.toString().split(",");var q=0;while(q<p.length){var r=C.insertRow(-1);for(var x=0;x<8;x++,q++){if(q<p.length){var t=p[q].split("/");var u="#"+t[0];var v=t[1]||u;}B=r.insertCell(-1).appendChild(y());B.innerHTML='<div class="ColorBoxBorder"><div class="ColorBox" style="background-color: '+u+'"></div></div>';if(q>=p.length){B.style.visibility="hidden";}else{FCKTools.AddEventListenerEx(B,"click",FCKTextColorCommand_OnClick,[this,v]);}}}if(FCKConfig.EnableMoreFontColors){i=C.insertRow(-1).insertCell(-1);i.colSpan=8;B=i.appendChild(y());B.innerHTML='<table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td nowrap align="center">'+FCKLang.ColorMoreColors+"</td></tr></table>";FCKTools.AddEventListenerEx(B,"click",FCKTextColorCommand_MoreOnClick,this);if(!FCKBrowserInfo.IsIE){B.style.width="96%";}}};var FCKPastePlainTextCommand=function(){this.Name="PasteText";};FCKPastePlainTextCommand.prototype.Execute=function(){FCK.PasteAsPlainText();};FCKPastePlainTextCommand.prototype.GetState=function(){if(FCK.EditMode!=0){return -1;}return FCK.GetNamedCommandState("Paste");};var FCKPasteWordCommand=function(){this.Name="PasteWord";};FCKPasteWordCommand.prototype.Execute=function(){FCK.PasteFromWord();};FCKPasteWordCommand.prototype.GetState=function(){if(FCK.EditMode!=0||FCKConfig.ForcePasteAsPlainText){return -1;}else{return FCK.GetNamedCommandState("Paste");}};var FCKTableCommand=function(b){this.Name=b;};FCKTableCommand.prototype.Execute=function(){FCKUndo.SaveUndoStep();if(!FCKBrowserInfo.IsGecko){switch(this.Name){case"TableMergeRight":return FCKTableHandler.MergeRight();case"TableMergeDown":return FCKTableHandler.MergeDown();}}switch(this.Name){case"TableInsertRowAfter":return FCKTableHandler.InsertRow(false);case"TableInsertRowBefore":return FCKTableHandler.InsertRow(true);case"TableDeleteRows":return FCKTableHandler.DeleteRows();case"TableInsertColumnAfter":return FCKTableHandler.InsertColumn(false);case"TableInsertColumnBefore":return FCKTableHandler.InsertColumn(true);case"TableDeleteColumns":return FCKTableHandler.DeleteColumns();case"TableInsertCellAfter":return FCKTableHandler.InsertCell(null,false);case"TableInsertCellBefore":return FCKTableHandler.InsertCell(null,true);case"TableDeleteCells":return FCKTableHandler.DeleteCells();case"TableMergeCells":return FCKTableHandler.MergeCells();case"TableHorizontalSplitCell":return FCKTableHandler.HorizontalSplitCell();case"TableVerticalSplitCell":return FCKTableHandler.VerticalSplitCell();case"TableDelete":return FCKTableHandler.DeleteTable();default:return alert(FCKLang.UnknownCommand.replace(/%1/g,this.Name));}};FCKTableCommand.prototype.GetState=function(){if(FCK.EditorDocument!=null&&FCKSelection.HasAncestorNode("TABLE")){switch(this.Name){case"TableHorizontalSplitCell":case"TableVerticalSplitCell":if(FCKTableHandler.GetSelectedCells().length==1){return 0;}else{return -1;}case"TableMergeCells":if(FCKTableHandler.CheckIsSelectionRectangular()&&FCKTableHandler.GetSelectedCells().length>1){return 0;}else{return -1;}case"TableMergeRight":return FCKTableHandler.GetMergeRightTarget()?0:-1;case"TableMergeDown":return FCKTableHandler.GetMergeDownTarget()?0:-1;default:return 0;}}else{return -1;}};var FCKFitWindow=function(){this.Name="FitWindow";};FCKFitWindow.prototype.Execute=function(){var x=window.frameElement;var y=x.style;var z=parent;var A=z.document.documentElement;var n=z.document.body;var o=n.style;var p;var q,v;if(FCK.EditMode==0){q=new FCKDomRange(FCK.EditorWindow);q.MoveToSelection();v=FCKTools.GetScrollPosition(FCK.EditorWindow);}else{var r=FCK.EditingArea.Textarea;q=!FCKBrowserInfo.IsIE&&[r.selectionStart,r.selectionEnd];v=[r.scrollLeft,r.scrollTop];}if(!this.IsMaximized){if(FCKBrowserInfo.IsIE){z.attachEvent("onresize",FCKFitWindow_Resize);}else{z.addEventListener("resize",FCKFitWindow_Resize,true);}this._ScrollPos=FCKTools.GetScrollPosition(z);p=x;while((p=p.parentNode)){if(p.nodeType==1){p._fckSavedStyles=FCKTools.SaveStyles(p);p.style.zIndex=FCKConfig.FloatingPanelsZIndex-1;}}if(FCKBrowserInfo.IsIE){this.documentElementOverflow=A.style.overflow;A.style.overflow="hidden";o.overflow="hidden";}else{o.overflow="hidden";o.width="0px";o.height="0px";}this._EditorFrameStyles=FCKTools.SaveStyles(x);var t=FCKTools.GetViewPaneSize(z);y.position="absolute";x.offsetLeft;y.zIndex=FCKConfig.FloatingPanelsZIndex-1;y.left="0px";y.top="0px";y.width=t.Width+"px";y.height=t.Height+"px";if(!FCKBrowserInfo.IsIE){y.borderRight=y.borderBottom="9999px solid white";y.backgroundColor="white";}z.scrollTo(0,0);var u=FCKTools.GetWindowPosition(z,x);if(u.x!=0){y.left=(-1*u.x)+"px";}if(u.y!=0){y.top=(-1*u.y)+"px";}this.IsMaximized=true;}else{if(FCKBrowserInfo.IsIE){z.detachEvent("onresize",FCKFitWindow_Resize);}else{z.removeEventListener("resize",FCKFitWindow_Resize,true);}p=x;while((p=p.parentNode)){if(p._fckSavedStyles){FCKTools.RestoreStyles(p,p._fckSavedStyles);p._fckSavedStyles=null;}}if(FCKBrowserInfo.IsIE){A.style.overflow=this.documentElementOverflow;}FCKTools.RestoreStyles(x,this._EditorFrameStyles);z.scrollTo(this._ScrollPos.X,this._ScrollPos.Y);this.IsMaximized=false;}FCKToolbarItems.GetItem("FitWindow").RefreshState();if(FCK.EditMode==0){FCK.EditingArea.MakeEditable();}FCK.Focus();if(FCK.EditMode==0){q.Select();FCK.EditorWindow.scrollTo(v.X,v.Y);}else{if(!FCKBrowserInfo.IsIE){r.selectionStart=q[0];r.selectionEnd=q[1];}r.scrollLeft=v[0];r.scrollTop=v[1];}};FCKFitWindow.prototype.GetState=function(){if(FCKConfig.ToolbarLocation!="In"){return -1;}else{return(this.IsMaximized?1:0);}};function FCKFitWindow_Resize(){var d=FCKTools.GetViewPaneSize(parent);var c=window.frameElement.style;c.width=d.Width+"px";c.height=d.Height+"px";}var FCKListCommand=function(d,c){this.Name=d;this.TagName=c;};FCKListCommand.prototype={GetState:function(){if(FCK.EditMode!=0||!FCK.EditorWindow){return -1;}var d=FCKSelection.GetBoundaryParentElement(true);var c=d;while(c){if(c.nodeName.IEquals(["ul","ol"])){break;}c=c.parentNode;}if(c&&c.nodeName.IEquals(this.TagName)){return 1;}else{return 0;}},Execute:function(){FCKUndo.SaveUndoStep();var A=FCK.EditorDocument;var B=new FCKDomRange(FCK.EditorWindow);B.MoveToSelection();var C=this.GetState();if(C==0){FCKDomTools.TrimNode(A.body);if(!A.body.firstChild){var D=A.createElement("p");A.body.appendChild(D);B.MoveToNodeContents(D);}}var E=B.CreateBookmark();var F=[];var G={};var H=new FCKDomRangeIterator(B);var I;H.ForceBrBreak=(C==0);var J=true;var K=null;while(J){while((I=H.GetNextParagraph())){var L=new FCKElementPath(I);var M=null;var N=false;var O=L.BlockLimit;for(var i=L.Elements.length-1;i>=0;i--){var P=L.Elements[i];if(P.nodeName.IEquals(["ol","ul"])){if(O._FCK_ListGroupObject){O._FCK_ListGroupObject=null;}var Q=P._FCK_ListGroupObject;if(Q){Q.contents.push(I);}else{Q={"root":P,"contents":[I]};F.push(Q);FCKDomTools.SetElementMarker(G,P,"_FCK_ListGroupObject",Q);}N=true;break;}}if(N){continue;}var R=O;if(R._FCK_ListGroupObject){R._FCK_ListGroupObject.contents.push(I);}else{var Q={"root":R,"contents":[I]};FCKDomTools.SetElementMarker(G,R,"_FCK_ListGroupObject",Q);F.push(Q);}}if(FCKBrowserInfo.IsIE){J=false;}else{if(K==null){K=[];var T=FCKSelection.GetSelection();if(T&&F.length==0){K.push(T.getRangeAt(0));}for(var i=1;T&&i<T.rangeCount;i++){K.push(T.getRangeAt(i));}}if(K.length<1){J=false;}else{var U=FCKW3CRange.CreateFromRange(A,K.shift());B._Range=U;B._UpdateElementInfo();if(B.StartNode.nodeName.IEquals("td")){B.SetStart(B.StartNode,1);}if(B.EndNode.nodeName.IEquals("td")){B.SetEnd(B.EndNode,2);}H=new FCKDomRangeIterator(B);H.ForceBrBreak=(C==0);}}}var W=[];while(F.length>0){var Q=F.shift();if(C==0){if(Q.root.nodeName.IEquals(["ul","ol"])){this._ChangeListType(Q,G,W);}else{this._CreateList(Q,W);}}else{if(C==1&&Q.root.nodeName.IEquals(["ul","ol"])){this._RemoveList(Q,G);}}}for(var i=0;i<W.length;i++){var M=W[i];var Y=false;var a=M;while(!Y){a=a.nextSibling;if(a&&a.nodeType==3&&a.nodeValue.search(/^[\n\r\t ]*$/)==0){continue;}Y=true;}if(a&&a.nodeName.IEquals(this.TagName)){a.parentNode.removeChild(a);while(a.firstChild){M.appendChild(a.removeChild(a.firstChild));}}Y=false;a=M;while(!Y){a=a.previousSibling;if(a&&a.nodeType==3&&a.nodeValue.search(/^[\n\r\t ]*$/)==0){continue;}Y=true;}if(a&&a.nodeName.IEquals(this.TagName)){a.parentNode.removeChild(a);while(a.lastChild){M.insertBefore(a.removeChild(a.lastChild),M.firstChild);}}}FCKDomTools.ClearAllMarkers(G);B.MoveToBookmark(E);B.Select();FCK.Focus();FCK.Events.FireEvent("OnSelectionChange");},_ChangeListType:function(r,t,u){var v=FCKDomTools.ListToArray(r.root,t);var i=[];for(var q=0;q<r.contents.length;q++){var m=r.contents[q];m=FCKTools.GetElementAscensor(m,"li");if(!m||m._FCK_ListItem_Processed){continue;}i.push(m);FCKDomTools.SetElementMarker(t,m,"_FCK_ListItem_Processed",true);}var n=FCKTools.GetElementDocument(r.root).createElement(this.TagName);for(var q=0;q<i.length;q++){var o=i[q]._FCK_ListArray_Index;v[o].parent=n;}var p=FCKDomTools.ArrayToList(v,t);for(var q=0;q<p.listNode.childNodes.length;q++){if(p.listNode.childNodes[q].nodeName.IEquals(this.TagName)){u.push(p.listNode.childNodes[q]);}}r.root.parentNode.replaceChild(p.listNode,r.root);},_CreateList:function(B,C){var D=B.contents;var E=FCKTools.GetElementDocument(B.root);var i=[];if(D.length==1&&D[0]==B.root){var q=E.createElement("div");while(D[0].firstChild){q.appendChild(D[0].removeChild(D[0].firstChild));}D[0].appendChild(q);D[0]=q;}var r=B.contents[0].parentNode;for(var A=0;A<D.length;A++){r=FCKDomTools.GetCommonParents(r,D[A].parentNode).pop();}for(var A=0;A<D.length;A++){var t=D[A];while(t.parentNode){if(t.parentNode==r){i.push(t);break;}t=t.parentNode;}}if(i.length<1){return;}var u=i[i.length-1].nextSibling;var v=E.createElement(this.TagName);C.push(v);while(i.length){var x=i.shift();var y=E.createDocumentFragment();while(x.firstChild){y.appendChild(x.removeChild(x.firstChild));}x.parentNode.removeChild(x);var z=E.createElement("li");z.appendChild(y);v.appendChild(z);}r.insertBefore(v,u);},_RemoveList:function(u,v){var x=FCKDomTools.ListToArray(u.root,v);var y=[];for(var t=0;t<u.contents.length;t++){var i=u.contents[t];i=FCKTools.GetElementAscensor(i,"li");if(!i||i._FCK_ListItem_Processed){continue;}y.push(i);FCKDomTools.SetElementMarker(v,i,"_FCK_ListItem_Processed",true);}var n=null;for(var t=0;t<y.length;t++){var o=y[t]._FCK_ListArray_Index;x[o].indent=-1;n=o;}for(var t=n+1;t<x.length;t++){if(x[t].indent>x[t-1].indent+1){var p=x[t-1].indent+1-x[t].indent;var q=x[t].indent;while(x[t]&&x[t].indent>=q){x[t].indent+=p;t++;}t--;}}var r=FCKDomTools.ArrayToList(x,v);if(u.root.nextSibling==null||u.root.nextSibling.nodeName.IEquals("br")){if(r.listNode.lastChild.nodeName.IEquals("br")){r.listNode.removeChild(r.listNode.lastChild);}}u.root.parentNode.replaceChild(r.listNode,u.root);}};var FCKJustifyCommand=function(f){this.AlignValue=f;var g=FCKConfig.ContentLangDirection.toLowerCase();this.IsDefaultAlign=(f=="left"&&g=="ltr")||(f=="right"&&g=="rtl");var d=this._CssClassName=(function(){var a=FCKConfig.JustifyClasses;if(a){switch(f){case"left":return a[0]||null;case"center":return a[1]||null;case"right":return a[2]||null;case"justify":return a[3]||null;}}return null;})();if(d&&d.length>0){this._CssClassRegex=new RegExp("(?:^|\\s+)"+d+"(?=$|\\s)");}};FCKJustifyCommand._GetClassNameRegex=function(){var h=FCKJustifyCommand._ClassRegex;if(h!=undefined){return h;}var i=[];var j=FCKConfig.JustifyClasses;if(j){for(var g=0;g<4;g++){var k=j[g];if(k&&k.length>0){i.push(k);}}}if(i.length>0){h=new RegExp("(?:^|\\s+)(?:"+i.join("|")+")(?=$|\\s)");}else{h=null;}return FCKJustifyCommand._ClassRegex=h;};FCKJustifyCommand.prototype={Execute:function(){FCKUndo.SaveUndoStep();var k=new FCKDomRange(FCK.EditorWindow);k.MoveToSelection();var l=this.GetState();if(l==-1){return;}var m=k.CreateBookmark();var n=this._CssClassName;var o=new FCKDomRangeIterator(k);var p;while((p=o.GetNextParagraph())){p.removeAttribute("align");if(n){var q=p.className.replace(FCKJustifyCommand._GetClassNameRegex(),"");if(l==0){if(q.length>0){q+=" ";}p.className=q+n;}else{if(q.length==0){FCKDomTools.RemoveAttribute(p,"class");}}}else{var j=p.style;if(l==0){j.textAlign=this.AlignValue;}else{j.textAlign="";if(j.cssText.length==0){p.removeAttribute("style");}}}}k.MoveToBookmark(m);k.Select();FCK.Focus();FCK.Events.FireEvent("OnSelectionChange");},GetState:function(){if(FCK.EditMode!=0||!FCK.EditorWindow){return -1;}var f=new FCKElementPath(FCKSelection.GetBoundaryParentElement(true));var g=f.Block||f.BlockLimit;if(!g||g.nodeName.toLowerCase()=="body"){return 0;}var d;if(FCKBrowserInfo.IsIE){d=g.currentStyle.textAlign;}else{d=FCK.EditorWindow.getComputedStyle(g,"").getPropertyValue("text-align");}d=d.replace(/(-moz-|-webkit-|start|auto)/i,"");if((!d&&this.IsDefaultAlign)||d==this.AlignValue){return 1;}return 0;}};var FCKIndentCommand=function(d,c){this.Name=d;this.Offset=c;this.IndentCSSProperty=FCKConfig.ContentLangDirection.IEquals("ltr")?"marginLeft":"marginRight";};FCKIndentCommand._InitIndentModeParameters=function(){if(FCKConfig.IndentClasses&&FCKConfig.IndentClasses.length>0){this._UseIndentClasses=true;this._IndentClassMap={};for(var b=0;b<FCKConfig.IndentClasses.length;b++){this._IndentClassMap[FCKConfig.IndentClasses[b]]=b+1;}this._ClassNameRegex=new RegExp("(?:^|\\s+)("+FCKConfig.IndentClasses.join("|")+")(?=$|\\s)");}else{this._UseIndentClasses=false;}};FCKIndentCommand.prototype={Execute:function(){FCKUndo.SaveUndoStep();var f=new FCKDomRange(FCK.EditorWindow);f.MoveToSelection();var g=f.CreateBookmark();var d=FCKDomTools.GetCommonParentNode(f.StartNode||f.StartContainer,f.EndNode||f.EndContainer,["ul","ol"]);if(d){this._IndentList(f,d);}else{this._IndentBlock(f);}f.MoveToBookmark(g);f.Select();FCK.Focus();FCK.Events.FireEvent("OnSelectionChange");},GetState:function(){if(FCK.EditMode!=0||!FCK.EditorWindow){return -1;}if(FCKIndentCommand._UseIndentClasses==undefined){FCKIndentCommand._InitIndentModeParameters();}var p=FCKSelection.GetBoundaryParentElement(true);var q=FCKSelection.GetBoundaryParentElement(false);var r=FCKDomTools.GetCommonParentNode(p,q,["ul","ol"]);if(r){if(this.Name.IEquals("outdent")){return 0;}var t=FCKTools.GetElementAscensor(p,"li");if(!t||!t.previousSibling){return -1;}return 0;}if(!FCKIndentCommand._UseIndentClasses&&this.Name.IEquals("indent")){return 0;}var k=new FCKElementPath(p);var l=k.Block||k.BlockLimit;if(!l){return -1;}if(FCKIndentCommand._UseIndentClasses){var m=l.className.match(FCKIndentCommand._ClassNameRegex);var n=0;if(m!=null){m=m[1];n=FCKIndentCommand._IndentClassMap[m];}if((this.Name=="outdent"&&n==0)||(this.Name=="indent"&&n==FCKConfig.IndentClasses.length)){return -1;}return 0;}else{var o=parseInt(l.style[this.IndentCSSProperty],10);if(isNaN(o)){o=0;}if(o<=0){return -1;}return 0;}},_IndentBlock:function(p){var q=new FCKDomRangeIterator(p);q.EnforceRealBlocks=true;p.Expand("block_contents");var r=FCKDomTools.GetCommonParents(p.StartContainer,p.EndContainer);var t=r[r.length-1];var k;while((k=q.GetNextParagraph())){if(!(k==t||k.parentNode==t)){continue;}if(FCKIndentCommand._UseIndentClasses){var l=k.className.match(FCKIndentCommand._ClassNameRegex);var m=0;if(l!=null){l=l[1];m=FCKIndentCommand._IndentClassMap[l];}if(this.Name.IEquals("outdent")){m--;}else{if(this.Name.IEquals("indent")){m++;}}m=Math.min(m,FCKConfig.IndentClasses.length);m=Math.max(m,0);var n=k.className.replace(FCKIndentCommand._ClassNameRegex,"");if(m<1){k.className=n;}else{k.className=(n.length>0?n+" ":"")+FCKConfig.IndentClasses[m-1];}}else{var o=parseInt(k.style[this.IndentCSSProperty],10);if(isNaN(o)){o=0;}o+=this.Offset;o=Math.max(o,0);o=Math.ceil(o/this.Offset)*this.Offset;k.style[this.IndentCSSProperty]=o?o+FCKConfig.IndentUnit:"";if(k.getAttribute("style")==""){k.removeAttribute("style");}}}},_IndentList:function(F,G){var H=F.StartContainer;var I=F.EndContainer;while(H&&H.parentNode!=G){H=H.parentNode;}while(I&&I.parentNode!=G){I=I.parentNode;}if(!H||!I){return;}var i=H;var t=[];var u=false;while(u==false){if(i==I){u=true;}t.push(i);i=i.nextSibling;}if(t.length<1){return;}var v=FCKDomTools.GetParents(G);for(var E=0;E<v.length;E++){if(v[E].nodeName.IEquals(["ul","ol"])){G=v[E];break;}}var x=this.Name.IEquals("indent")?1:-1;var y=t[0];var z=t[t.length-1];var A={};var B=FCKDomTools.ListToArray(G,A);var C=B[z._FCK_ListArray_Index].indent;for(var E=y._FCK_ListArray_Index;E<=z._FCK_ListArray_Index;E++){B[E].indent+=x;}for(var E=z._FCK_ListArray_Index+1;E<B.length&&B[E].indent>C;E++){B[E].indent+=x;}var D=FCKDomTools.ArrayToList(B);if(D){G.parentNode.replaceChild(D.listNode,G);}FCKDomTools.ClearAllMarkers(A);}};var FCKBlockQuoteCommand=function(){};FCKBlockQuoteCommand.prototype={Execute:function(){FCKUndo.SaveUndoStep();var c=this.GetState();var d=new FCKDomRange(FCK.EditorWindow);d.MoveToSelection();var i=d.CreateBookmark();if(FCKBrowserInfo.IsIE){var A=d.GetBookmarkNode(i,true);var B=d.GetBookmarkNode(i,false);var C;if(A&&A.parentNode.nodeName.IEquals("blockquote")&&!A.previousSibling){C=A;while((C=C.nextSibling)){if(FCKListsLib.BlockElements[C.nodeName.toLowerCase()]){FCKDomTools.MoveNode(A,C,true);}}}if(B&&B.parentNode.nodeName.IEquals("blockquote")&&!B.previousSibling){C=B;while((C=C.nextSibling)){if(FCKListsLib.BlockElements[C.nodeName.toLowerCase()]){if(C.firstChild==A){FCKDomTools.InsertAfterNode(A,B);}else{FCKDomTools.MoveNode(B,C,true);}}}}}var D=new FCKDomRangeIterator(d);var E;if(c==0){var F=[];while((E=D.GetNextParagraph())){F.push(E);}if(F.length<1){para=d.Window.document.createElement(FCKConfig.EnterMode.IEquals("p")?"p":"div");d.InsertNode(para);para.appendChild(d.Window.document.createTextNode("\ufeff"));d.MoveToBookmark(i);d.MoveToNodeContents(para);d.Collapse(true);i=d.CreateBookmark();F.push(para);}var G=F[0].parentNode;var H=[];for(var a=0;a<F.length;a++){E=F[a];G=FCKDomTools.GetCommonParents(E.parentNode,G).pop();}while(G.nodeName.IEquals("table","tbody","tr","ol","ul")){G=G.parentNode;}var I=null;while(F.length>0){E=F.shift();while(E.parentNode!=G){E=E.parentNode;}if(E!=I){H.push(E);}I=E;}while(H.length>0){E=H.shift();if(E.nodeName.IEquals("blockquote")){var J=FCKTools.GetElementDocument(E).createDocumentFragment();while(E.firstChild){J.appendChild(E.removeChild(E.firstChild));F.push(J.lastChild);}E.parentNode.replaceChild(J,E);}else{F.push(E);}}var K=d.Window.document.createElement("blockquote");G.insertBefore(K,F[0]);while(F.length>0){E=F.shift();K.appendChild(E);}}else{if(c==1){var L=[];var M={};while((E=D.GetNextParagraph())){var N=null;var O=null;while(E.parentNode){if(E.parentNode.nodeName.IEquals("blockquote")){N=E.parentNode;O=E;break;}E=E.parentNode;}if(N&&O&&!O._fckblockquotemoveout){L.push(O);FCKDomTools.SetElementMarker(M,O,"_fckblockquotemoveout",true);}}FCKDomTools.ClearAllMarkers(M);var P=[];var Q=[],M={};var R=function(f){for(var b=0;b<f.childNodes.length;b++){if(FCKListsLib.BlockElements[f.childNodes[b].nodeName.toLowerCase()]){return false;}}return true;};while(L.length>0){var T=L.shift();var K=T.parentNode;if(T==T.parentNode.firstChild){K.parentNode.insertBefore(K.removeChild(T),K);}else{if(T==T.parentNode.lastChild){K.parentNode.insertBefore(K.removeChild(T),K.nextSibling);}else{FCKDomTools.BreakParent(T,T.parentNode,d);}}if(!K._fckbqprocessed){Q.push(K);FCKDomTools.SetElementMarker(M,K,"_fckbqprocessed",true);}P.push(T);}for(var a=Q.length-1;a>=0;a--){var K=Q[a];if(R(K)){FCKDomTools.RemoveNode(K);}}FCKDomTools.ClearAllMarkers(M);if(FCKConfig.EnterMode.IEquals("br")){while(P.length){var T=P.shift();var S=true;if(T.nodeName.IEquals("div")){var J=FCKTools.GetElementDocument(T).createDocumentFragment();var U=S&&T.previousSibling&&!FCKListsLib.BlockBoundaries[T.previousSibling.nodeName.toLowerCase()];if(S&&U){J.appendChild(FCKTools.GetElementDocument(T).createElement("br"));}var W=T.nextSibling&&!FCKListsLib.BlockBoundaries[T.nextSibling.nodeName.toLowerCase()];while(T.firstChild){J.appendChild(T.removeChild(T.firstChild));}if(W){J.appendChild(FCKTools.GetElementDocument(T).createElement("br"));}T.parentNode.replaceChild(J,T);S=false;}}}}}d.MoveToBookmark(i);d.Select();FCK.Focus();FCK.Events.FireEvent("OnSelectionChange");},GetState:function(){if(FCK.EditMode!=0||!FCK.EditorWindow){return -1;}var f=new FCKElementPath(FCKSelection.GetBoundaryParentElement(true));var g=f.Block||f.BlockLimit;if(!g||g.nodeName.toLowerCase()=="body"){return 0;}for(var d=0;d<f.Elements.length;d++){if(f.Elements[d].nodeName.IEquals("blockquote")){return 1;}}return 0;}};var FCKCoreStyleCommand=function(b){this.Name="CoreStyle";this.StyleName="_FCK_"+b;this.IsActive=false;FCKStyles.AttachStyleStateChange(this.StyleName,this._OnStyleStateChange,this);};FCKCoreStyleCommand.prototype={Execute:function(){FCKUndo.SaveUndoStep();if(this.IsActive){FCKStyles.RemoveStyle(this.StyleName);}else{FCKStyles.ApplyStyle(this.StyleName);}FCK.Focus();FCK.Events.FireEvent("OnSelectionChange");},GetState:function(){if(FCK.EditMode!=0){return -1;}return this.IsActive?1:0;},_OnStyleStateChange:function(d,c){this.IsActive=c;}};var FCKRemoveFormatCommand=function(){this.Name="RemoveFormat";};FCKRemoveFormatCommand.prototype={Execute:function(){FCKStyles.RemoveAll();FCK.Focus();FCK.Events.FireEvent("OnSelectionChange");},GetState:function(){return FCK.EditorWindow?0:-1;}};var FCKCommands=FCK.Commands={};FCKCommands.LoadedCommands={};FCKCommands.RegisterCommand=function(d,c){this.LoadedCommands[d]=c;};FCKCommands.GetCommand=function(d){var c=FCKCommands.LoadedCommands[d];if(c){return c;}switch(d){case"Bold":case"Italic":case"Underline":case"StrikeThrough":case"Subscript":case"Superscript":c=new FCKCoreStyleCommand(d);break;case"RemoveFormat":c=new FCKRemoveFormatCommand();break;case"DocProps":c=new FCKDialogCommand("DocProps",FCKLang.DocProps,"dialog/fck_docprops.html",400,380,FCKCommands.GetFullPageState);break;case"Templates":c=new FCKDialogCommand("Templates",FCKLang.DlgTemplatesTitle,"dialog/fck_template.html",380,450);break;case"Link":c=new FCKDialogCommand("Link",FCKLang.DlgLnkWindowTitle,"dialog/fck_link.html",400,300);break;case"Unlink":c=new FCKUnlinkCommand();break;case"VisitLink":c=new FCKVisitLinkCommand();break;case"Anchor":c=new FCKDialogCommand("Anchor",FCKLang.DlgAnchorTitle,"dialog/fck_anchor.html",370,160);break;case"AnchorDelete":c=new FCKAnchorDeleteCommand();break;case"BulletedList":c=new FCKDialogCommand("BulletedList",FCKLang.BulletedListProp,"dialog/fck_listprop.html?UL",370,160);break;case"NumberedList":c=new FCKDialogCommand("NumberedList",FCKLang.NumberedListProp,"dialog/fck_listprop.html?OL",370,160);break;case"About":c=new FCKDialogCommand("About",FCKLang.About,"dialog/fck_about.html",420,330,function(){return 0;});break;case"Find":c=new FCKDialogCommand("Find",FCKLang.DlgFindAndReplaceTitle,"dialog/fck_replace.html",340,230,null,null,"Find");break;case"Replace":c=new FCKDialogCommand("Replace",FCKLang.DlgFindAndReplaceTitle,"dialog/fck_replace.html",340,230,null,null,"Replace");break;case"Image":c=new FCKDialogCommand("Image",FCKLang.DlgImgTitle,"dialog/fck_image.html",450,390);break;case"Flash":c=new FCKDialogCommand("Flash",FCKLang.DlgFlashTitle,"dialog/fck_flash.html",450,390);break;case"SpecialChar":c=new FCKDialogCommand("SpecialChar",FCKLang.DlgSpecialCharTitle,"dialog/fck_specialchar.html",400,290);break;case"Smiley":c=new FCKDialogCommand("Smiley",FCKLang.DlgSmileyTitle,"dialog/fck_smiley.html",FCKConfig.SmileyWindowWidth,FCKConfig.SmileyWindowHeight);break;case"Table":c=new FCKDialogCommand("Table",FCKLang.DlgTableTitle,"dialog/fck_table.html",480,250);break;case"TableProp":c=new FCKDialogCommand("Table",FCKLang.DlgTableTitle,"dialog/fck_table.html?Parent",480,250);break;case"TableCellProp":c=new FCKDialogCommand("TableCell",FCKLang.DlgCellTitle,"dialog/fck_tablecell.html",550,240);break;case"Style":c=new FCKStyleCommand();break;case"FontName":c=new FCKFontNameCommand();break;case"FontSize":c=new FCKFontSizeCommand();break;case"FontFormat":c=new FCKFormatBlockCommand();break;case"Source":c=new FCKSourceCommand();break;case"Preview":c=new FCKPreviewCommand();break;case"Save":c=new FCKSaveCommand();break;case"NewPage":c=new FCKNewPageCommand();break;case"PageBreak":c=new FCKPageBreakCommand();break;case"Rule":c=new FCKRuleCommand();break;case"Nbsp":c=new FCKNbsp();break;case"TextColor":c=new FCKTextColorCommand("ForeColor");break;case"BGColor":c=new FCKTextColorCommand("BackColor");break;case"Paste":c=new FCKPasteCommand();break;case"PasteText":c=new FCKPastePlainTextCommand();break;case"PasteWord":c=new FCKPasteWordCommand();break;case"JustifyLeft":c=new FCKJustifyCommand("left");break;case"JustifyCenter":c=new FCKJustifyCommand("center");break;case"JustifyRight":c=new FCKJustifyCommand("right");break;case"JustifyFull":c=new FCKJustifyCommand("justify");break;case"Indent":c=new FCKIndentCommand("indent",FCKConfig.IndentLength);break;case"Outdent":c=new FCKIndentCommand("outdent",FCKConfig.IndentLength*-1);break;case"Blockquote":c=new FCKBlockQuoteCommand();break;case"CreateDiv":c=new FCKDialogCommand("CreateDiv",FCKLang.CreateDiv,"dialog/fck_div.html",380,210,null,null,true);break;case"EditDiv":c=new FCKDialogCommand("EditDiv",FCKLang.EditDiv,"dialog/fck_div.html",380,210,null,null,false);break;case"DeleteDiv":c=new FCKDeleteDivCommand();break;case"TableInsertRowAfter":c=new FCKTableCommand("TableInsertRowAfter");break;case"TableInsertRowBefore":c=new FCKTableCommand("TableInsertRowBefore");break;case"TableDeleteRows":c=new FCKTableCommand("TableDeleteRows");break;case"TableInsertColumnAfter":c=new FCKTableCommand("TableInsertColumnAfter");break;case"TableInsertColumnBefore":c=new FCKTableCommand("TableInsertColumnBefore");break;case"TableDeleteColumns":c=new FCKTableCommand("TableDeleteColumns");break;case"TableInsertCellAfter":c=new FCKTableCommand("TableInsertCellAfter");break;case"TableInsertCellBefore":c=new FCKTableCommand("TableInsertCellBefore");break;case"TableDeleteCells":c=new FCKTableCommand("TableDeleteCells");break;case"TableMergeCells":c=new FCKTableCommand("TableMergeCells");break;case"TableMergeRight":c=new FCKTableCommand("TableMergeRight");break;case"TableMergeDown":c=new FCKTableCommand("TableMergeDown");break;case"TableHorizontalSplitCell":c=new FCKTableCommand("TableHorizontalSplitCell");break;case"TableVerticalSplitCell":c=new FCKTableCommand("TableVerticalSplitCell");break;case"TableDelete":c=new FCKTableCommand("TableDelete");break;case"Form":c=new FCKDialogCommand("Form",FCKLang.Form,"dialog/fck_form.html",380,210);break;case"Checkbox":c=new FCKDialogCommand("Checkbox",FCKLang.Checkbox,"dialog/fck_checkbox.html",380,200);break;case"Radio":c=new FCKDialogCommand("Radio",FCKLang.RadioButton,"dialog/fck_radiobutton.html",380,200);break;case"TextField":c=new FCKDialogCommand("TextField",FCKLang.TextField,"dialog/fck_textfield.html",380,210);break;case"Textarea":c=new FCKDialogCommand("Textarea",FCKLang.Textarea,"dialog/fck_textarea.html",380,210);break;case"HiddenField":c=new FCKDialogCommand("HiddenField",FCKLang.HiddenField,"dialog/fck_hiddenfield.html",380,190);break;case"Button":c=new FCKDialogCommand("Button",FCKLang.Button,"dialog/fck_button.html",380,210);break;case"Select":c=new FCKDialogCommand("Select",FCKLang.SelectionField,"dialog/fck_select.html",400,340);break;case"ImageButton":c=new FCKDialogCommand("ImageButton",FCKLang.ImageButton,"dialog/fck_image.html?ImageButton",450,390);break;case"SpellCheck":c=new FCKSpellCheckCommand();break;case"FitWindow":c=new FCKFitWindow();break;case"Undo":c=new FCKUndoCommand();break;case"Redo":c=new FCKRedoCommand();break;case"Copy":c=new FCKCutCopyCommand(false);break;case"Cut":c=new FCKCutCopyCommand(true);break;case"SelectAll":c=new FCKSelectAllCommand();break;case"InsertOrderedList":c=new FCKListCommand("insertorderedlist","ol");break;case"InsertUnorderedList":c=new FCKListCommand("insertunorderedlist","ul");break;case"ShowBlocks":c=new FCKShowBlockCommand("ShowBlocks",FCKConfig.StartupShowBlocks?1:0);break;case"Undefined":c=new FCKUndefinedCommand();break;case"Scayt":c=FCKScayt.CreateCommand();break;case"ScaytContext":c=FCKScayt.CreateContextCommand();break;default:if(FCKRegexLib.NamedCommands.test(d)){c=new FCKNamedCommand(d);}else{alert(FCKLang.UnknownCommand.replace(/%1/g,d));return null;}}FCKCommands.LoadedCommands[d]=c;return c;};FCKCommands.GetFullPageState=function(){return FCKConfig.FullPage?0:-1;};FCKCommands.GetBooleanState=function(b){return b?-1:0;};var FCKPanel=function(i){this.IsRTL=(FCKLang.Dir=="rtl");this.IsContextMenu=false;this._LockCounter=0;this._Window=i||window;var j;if(FCKBrowserInfo.IsIE){this._Popup=this._Window.createPopup();var k=this._Window.document;if(FCK_IS_CUSTOM_DOMAIN&&!FCKBrowserInfo.IsIE7){k.domain=FCK_ORIGINAL_DOMAIN;document.domain=FCK_ORIGINAL_DOMAIN;}j=this.Document=this._Popup.document;if(FCK_IS_CUSTOM_DOMAIN){j.domain=FCK_RUNTIME_DOMAIN;k.domain=FCK_RUNTIME_DOMAIN;document.domain=FCK_RUNTIME_DOMAIN;}FCK.IECleanup.AddItem(this,FCKPanel_Cleanup);}else{var l=this._IFrame=this._Window.document.createElement("iframe");FCKTools.ResetStyles(l);l.src="javascript:void(0)";l.allowTransparency=true;l.frameBorder="0";l.scrolling="no";l.style.width=l.style.height="0px";FCKDomTools.SetElementStyles(l,{position:"absolute",zIndex:FCKConfig.FloatingPanelsZIndex});this._Window.document.body.appendChild(l);var m=l.contentWindow;j=this.Document=m.document;var h="";if(FCKBrowserInfo.IsSafari){h='<base href="'+window.document.location+'">';}j.open();j.write("<html><head>"+h+'</head><body style="margin:0px;padding:0px;"></body></html>');j.close();if(FCKBrowserInfo.IsAIR){FCKAdobeAIR.Panel_Contructor(j,window.document.location);}FCKTools.AddEventListenerEx(m,"focus",FCKPanel_Window_OnFocus,this);FCKTools.AddEventListenerEx(m,"blur",FCKPanel_Window_OnBlur,this);}j.dir=FCKLang.Dir;FCKTools.AddEventListener(j,"contextmenu",FCKTools.CancelEvent);this.MainNode=j.body.appendChild(j.createElement("DIV"));this.MainNode.style.cssFloat=this.IsRTL?"right":"left";};FCKPanel.prototype.AppendStyleSheet=function(b){FCKTools.AppendStyleSheet(this.Document,b);};FCKPanel.prototype.Preload=function(d,g,f){if(this._Popup){this._Popup.show(d,g,0,0,f);}};FCKPanel.prototype.ResizeForSubpanel=function(i,k,l){if(!FCKBrowserInfo.IsIE7){return false;}if(!this._Popup.isOpen){this.Subpanel=null;return false;}if(k==0&&l==0){if(this.Subpanel!==i){return false;}this.Subpanel=null;this.IncreasedX=0;}else{this.Subpanel=i;if((this.IncreasedX>=k)&&(this.IncreasedY>=l)){return false;}this.IncreasedX=Math.max(this.IncreasedX,k);this.IncreasedY=Math.max(this.IncreasedY,l);}var j=this.ShowRect.x;var o=this.IncreasedX;if(this.IsRTL){j=j-o;}var m=this.ShowRect.w+o;var n=Math.max(this.ShowRect.h,this.IncreasedY);if(this.ParentPanel){this.ParentPanel.ResizeForSubpanel(this,m,n);}this._Popup.show(j,this.ShowRect.y,m,n,this.RelativeElement);return this.IsRTL;};FCKPanel.prototype.Show=function(x,z,D,E,F){var G;var q=this.MainNode;if(this._Popup){this._Popup.show(x,z,0,0,D);FCKDomTools.SetElementStyles(q,{B:E?E+"px":"",C:F?F+"px":""});G=q.offsetWidth;if(FCKBrowserInfo.IsIE7){if(this.ParentPanel&&this.ParentPanel.ResizeForSubpanel(this,G,q.offsetHeight)){FCKTools.RunFunction(this.Show,this,[x,z,D]);return;}}if(this.IsRTL){if(this.IsContextMenu){x=x-G+1;}else{if(D){x=(x*-1)+D.offsetWidth-G;}}}if(FCKBrowserInfo.IsIE7){this.ShowRect={x:x,y:z,w:G,h:q.offsetHeight};this.IncreasedX=0;this.IncreasedY=0;this.RelativeElement=D;}this._PopupArgs=[x,z,G,q.offsetHeight,D];this._Popup.show(x,z,G,q.offsetHeight,D);if(this.OnHide){if(this._Timer){CheckPopupOnHide.call(this,true);}this._Timer=FCKTools.SetInterval(CheckPopupOnHide,100,this);}}else{if(typeof(FCK.ToolbarSet.CurrentInstance.FocusManager)!="undefined"){FCK.ToolbarSet.CurrentInstance.FocusManager.Lock();}if(this.ParentPanel){this.ParentPanel.Lock();FCKPanel_Window_OnBlur(null,this.ParentPanel);}if(FCKBrowserInfo.IsGecko&&FCKBrowserInfo.IsMac){this._IFrame.scrolling="";FCKTools.RunFunction(function(){this._IFrame.scrolling="no";},this);}if(FCK.ToolbarSet.CurrentInstance.GetInstanceObject("FCKPanel")._OpenedPanel&&FCK.ToolbarSet.CurrentInstance.GetInstanceObject("FCKPanel")._OpenedPanel!=this){FCK.ToolbarSet.CurrentInstance.GetInstanceObject("FCKPanel")._OpenedPanel.Hide(false,true);}FCKDomTools.SetElementStyles(q,{B:E?E+"px":"",C:F?F+"px":""});G=q.offsetWidth;if(!E){this._IFrame.width=1;}if(!F){this._IFrame.height=1;}G=q.offsetWidth||q.firstChild.offsetWidth;var r=FCKTools.GetDocumentPosition(this._Window,D.nodeType==9?(FCKTools.IsStrictMode(D)?D.documentElement:D.body):D);var t=FCKDomTools.GetPositionedAncestor(this._IFrame.parentNode);if(t){var u=FCKTools.GetDocumentPosition(FCKTools.GetElementWindow(t),t);r.x-=u.x;r.y-=u.y;}if(this.IsRTL&&!this.IsContextMenu){x=(x*-1);}x+=r.x;z+=r.y;if(this.IsRTL){if(this.IsContextMenu){x=x-G+1;}else{if(D){x=x+D.offsetWidth-G;}}}else{var v=FCKTools.GetViewPaneSize(this._Window);var y=FCKTools.GetScrollPosition(this._Window);var A=v.Height+y.Y;var B=v.Width+y.X;if((x+G)>B){x-=x+G-B;}if((z+q.offsetHeight)>A){z-=z+q.offsetHeight-A;}}FCKDomTools.SetElementStyles(this._IFrame,{left:x+"px",top:z+"px"});this._IFrame.contentWindow.focus();this._IsOpened=true;var C=this;this._resizeTimer=setTimeout(function(){var a=q.offsetWidth||q.firstChild.offsetWidth;var b=q.offsetHeight;C._IFrame.style.width=a+"px";C._IFrame.style.height=b+"px";},0);FCK.ToolbarSet.CurrentInstance.GetInstanceObject("FCKPanel")._OpenedPanel=this;}FCKTools.RunFunction(this.OnShow,this);};FCKPanel.prototype.Hide=function(d,c){if(this._Popup){this._Popup.hide();}else{if(!this._IsOpened||this._LockCounter>0){return;}if(typeof(FCKFocusManager)!="undefined"&&!c){FCKFocusManager.Unlock();}this._IFrame.style.width=this._IFrame.style.height="0px";this._IsOpened=false;if(this._resizeTimer){clearTimeout(this._resizeTimer);this._resizeTimer=null;}if(this.ParentPanel){this.ParentPanel.Unlock();}if(!d){FCKTools.RunFunction(this.OnHide,this);}}};FCKPanel.prototype.CheckIsOpened=function(){if(this._Popup){return this._Popup.isOpen;}else{return this._IsOpened;}};FCKPanel.prototype.CreateChildPanel=function(){var d=this._Popup?FCKTools.GetDocumentWindow(this.Document):this._Window;var c=new FCKPanel(d);c.ParentPanel=this;return c;};FCKPanel.prototype.Lock=function(){this._LockCounter++;};FCKPanel.prototype.Unlock=function(){if(--this._LockCounter==0&&!this.HasFocus){this.Hide();}};function FCKPanel_Window_OnFocus(c,d){d.HasFocus=true;}function FCKPanel_Window_OnBlur(c,d){d.HasFocus=false;if(d._LockCounter==0){FCKTools.RunFunction(d.Hide,d);}}function CheckPopupOnHide(b){if(b||!this._Popup.isOpen){window.clearInterval(this._Timer);this._Timer=null;if(this._Popup&&this.ParentPanel&&!b){this.ParentPanel.ResizeForSubpanel(this,0,0);}FCKTools.RunFunction(this.OnHide,this);}}function FCKPanel_Cleanup(){this._Popup=null;this._Window=null;this.Document=null;this.MainNode=null;this.RelativeElement=null;}var FCKIcon=function(d){var c=d?typeof(d):"undefined";switch(c){case"number":this.Path=FCKConfig.SkinPath+"fck_strip.gif";this.Size=16;this.Position=d;break;case"undefined":this.Path=FCK_SPACER_PATH;break;case"string":this.Path=d;break;default:this.Path=d[0];this.Size=d[1];this.Position=d[2];}};FCKIcon.prototype.CreateIconElement=function(g){var h,f;if(this.Position){var i="-"+((this.Position-1)*this.Size)+"px";if(FCKBrowserInfo.IsIE){h=g.createElement("DIV");f=h.appendChild(g.createElement("IMG"));f.src=this.Path;f.style.top=i;}else{h=g.createElement("IMG");h.src=FCK_SPACER_PATH;h.style.backgroundPosition="0px "+i;h.style.backgroundImage='url("'+this.Path+'")';}}else{if(FCKBrowserInfo.IsIE){h=g.createElement("DIV");f=h.appendChild(g.createElement("IMG"));f.src=this.Path?this.Path:FCK_SPACER_PATH;}else{h=g.createElement("IMG");h.src=this.Path?this.Path:FCK_SPACER_PATH;}}h.className="TB_Button_Image";return h;};var FCKToolbarButtonUI=function(i,j,k,l,m,h){this.Name=i;this.Label=j||i;this.Tooltip=k||this.Label;this.Style=m||0;this.State=h||0;this.Icon=new FCKIcon(l);if(FCK.IECleanup){FCK.IECleanup.AddItem(this,FCKToolbarButtonUI_Cleanup);}};FCKToolbarButtonUI.prototype._CreatePaddingElement=function(d){var c=d.createElement("IMG");c.className="TB_Button_Padding";c.src=FCK_SPACER_PATH;return c;};FCKToolbarButtonUI.prototype.Create=function(j){var k=FCKTools.GetElementDocument(j);var l=this.MainElement=k.createElement("DIV");l.title=this.Tooltip;if(FCKBrowserInfo.IsGecko){l.onmousedown=FCKTools.CancelEvent;}FCKTools.AddEventListenerEx(l,"mouseover",FCKToolbarButtonUI_OnMouseOver,this);FCKTools.AddEventListenerEx(l,"mouseout",FCKToolbarButtonUI_OnMouseOut,this);FCKTools.AddEventListenerEx(l,"click",FCKToolbarButtonUI_OnClick,this);this.ChangeState(this.State,true);if(this.Style==0&&!this.ShowArrow){l.appendChild(this.Icon.CreateIconElement(k));}else{var m=l.appendChild(k.createElement("TABLE"));m.cellPadding=0;m.cellSpacing=0;var n=m.insertRow(-1);var o=n.insertCell(-1);if(this.Style==0||this.Style==2){o.appendChild(this.Icon.CreateIconElement(k));}else{o.appendChild(this._CreatePaddingElement(k));}if(this.Style==1||this.Style==2){o=n.insertCell(-1);o.className="TB_Button_Text";o.noWrap=true;o.appendChild(k.createTextNode(this.Label));}if(this.ShowArrow){if(this.Style!=0){n.insertCell(-1).appendChild(this._CreatePaddingElement(k));}o=n.insertCell(-1);var i=o.appendChild(k.createElement("IMG"));i.src=FCKConfig.SkinPath+"images/toolbar.buttonarrow.gif";i.width=5;i.height=3;}o=n.insertCell(-1);o.appendChild(this._CreatePaddingElement(k));}j.appendChild(l);};FCKToolbarButtonUI.prototype.ChangeState=function(f,g){if(!g&&this.State==f){return;}var d=this.MainElement;if(!d){return;}switch(parseInt(f,10)){case 0:d.className="TB_Button_Off";break;case 1:d.className="TB_Button_On";break;case -1:d.className="TB_Button_Disabled";break;}this.State=f;};function FCKToolbarButtonUI_OnMouseOver(d,c){if(c.State==0){this.className="TB_Button_Off_Over";}else{if(c.State==1){this.className="TB_Button_On_Over";}}}function FCKToolbarButtonUI_OnMouseOut(d,c){if(c.State==0){this.className="TB_Button_Off";}else{if(c.State==1){this.className="TB_Button_On";}}}function FCKToolbarButtonUI_OnClick(d,c){if(c.OnClick&&c.State!=-1){c.OnClick(c);}}function FCKToolbarButtonUI_Cleanup(){this.MainElement=null;}var FCKToolbarButton=function(j,k,l,m,n,o,i){this.CommandName=j;this.Label=k;this.Tooltip=l;this.Style=m;this.SourceView=n?true:false;this.ContextSensitive=o?true:false;if(i==null){this.IconPath=FCKConfig.SkinPath+"toolbar/"+j.toLowerCase()+".gif";}else{if(typeof(i)=="number"){this.IconPath=[FCKConfig.SkinPath+"fck_strip.gif",16,i];}else{this.IconPath=i;}}};FCKToolbarButton.prototype.Create=function(b){this._UIButton=new FCKToolbarButtonUI(this.CommandName,this.Label,this.Tooltip,this.IconPath,this.Style);this._UIButton.OnClick=this.Click;this._UIButton._ToolbarButton=this;this._UIButton.Create(b);};FCKToolbarButton.prototype.RefreshState=function(){var d=this._UIButton;if(!d){return;}var c=FCK.ToolbarSet.CurrentInstance.Commands.GetCommand(this.CommandName).GetState();if(c==d.State){return;}d.ChangeState(c);};FCKToolbarButton.prototype.Click=function(){var b=this._ToolbarButton||this;FCK.ToolbarSet.CurrentInstance.Commands.GetCommand(b.CommandName).Execute();};FCKToolbarButton.prototype.Enable=function(){this.RefreshState();};FCKToolbarButton.prototype.Disable=function(){this._UIButton.ChangeState(-1);};var FCKSpecialCombo=function(h,i,j,k,g){this.FieldWidth=i||100;this.PanelWidth=j||150;this.PanelMaxHeight=k||150;this.Label="&nbsp;";this.Caption=h;this.Tooltip=h;this.Style=2;this.Enabled=true;this.Items={};this._Panel=new FCKPanel(g||window);this._Panel.AppendStyleSheet(FCKConfig.SkinEditorCSS);this._PanelBox=this._Panel.MainNode.appendChild(this._Panel.Document.createElement("DIV"));this._PanelBox.className="SC_Panel";this._PanelBox.style.width=this.PanelWidth+"px";this._PanelBox.innerHTML='<table cellpadding="0" cellspacing="0" width="100%" style="TABLE-LAYOUT: fixed"><tr><td nowrap></td></tr></table>';this._ItemsHolderEl=this._PanelBox.getElementsByTagName("TD")[0];if(FCK.IECleanup){FCK.IECleanup.AddItem(this,FCKSpecialCombo_Cleanup);}};function FCKSpecialCombo_ItemOnMouseOver(){this.className+=" SC_ItemOver";}function FCKSpecialCombo_ItemOnMouseOut(){this.className=this.originalClass;}function FCKSpecialCombo_ItemOnClick(f,g,d){this.className=this.originalClass;g._Panel.Hide();g.SetLabel(this.FCKItemLabel);if(typeof(g.OnSelect)=="function"){g.OnSelect(d,this);}}FCKSpecialCombo.prototype.ClearItems=function(){if(this.Items){this.Items={};}var b=this._ItemsHolderEl;while(b.firstChild){b.removeChild(b.firstChild);}};FCKSpecialCombo.prototype.AddItem=function(h,i,j,k){var g=this._ItemsHolderEl.appendChild(this._Panel.Document.createElement("DIV"));g.className=g.originalClass="SC_Item";g.innerHTML=i;g.FCKItemLabel=j||h;g.Selected=false;if(FCKBrowserInfo.IsIE){g.style.width="100%";}if(k){g.style.backgroundColor=k;}FCKTools.AddEventListenerEx(g,"mouseover",FCKSpecialCombo_ItemOnMouseOver);FCKTools.AddEventListenerEx(g,"mouseout",FCKSpecialCombo_ItemOnMouseOut);FCKTools.AddEventListenerEx(g,"click",FCKSpecialCombo_ItemOnClick,[this,h]);this.Items[h.toString().toLowerCase()]=g;return g;};FCKSpecialCombo.prototype.SelectItem=function(b){if(typeof b=="string"){b=this.Items[b.toString().toLowerCase()];}if(b){b.className=b.originalClass="SC_ItemSelected";b.Selected=true;}};FCKSpecialCombo.prototype.SelectItemByLabel=function(g,h){for(var i in this.Items){var f=this.Items[i];if(f.FCKItemLabel==g){f.className=f.originalClass="SC_ItemSelected";f.Selected=true;if(h){this.SetLabel(g);}}}};FCKSpecialCombo.prototype.DeselectAll=function(d){for(var c in this.Items){if(!this.Items[c]){continue;}this.Items[c].className=this.Items[c].originalClass="SC_Item";this.Items[c].Selected=false;}if(d){this.SetLabel("");}};FCKSpecialCombo.prototype.SetLabelById=function(d){d=d?d.toString().toLowerCase():"";var c=this.Items[d];this.SetLabel(c?c.FCKItemLabel:"");};FCKSpecialCombo.prototype.SetLabel=function(d){d=(!d||d.length==0)?"&nbsp;":d;if(d==this.Label){return;}this.Label=d;var c=this._LabelEl;if(c){c.innerHTML=d;FCKTools.DisableSelection(c);}};FCKSpecialCombo.prototype.SetEnabled=function(b){this.Enabled=b;if(this._OuterTable){this._OuterTable.className=b?"":"SC_FieldDisabled";}};FCKSpecialCombo.prototype.Create=function(j){var k=FCKTools.GetElementDocument(j);var l=this._OuterTable=j.appendChild(k.createElement("TABLE"));l.cellPadding=0;l.cellSpacing=0;l.insertRow(-1);var m;var n;switch(this.Style){case 0:m="TB_ButtonType_Icon";n=false;break;case 1:m="TB_ButtonType_Text";n=false;break;case 2:n=true;break;}if(this.Caption&&this.Caption.length>0&&n){var o=l.rows[0].insertCell(-1);o.innerHTML=this.Caption;o.className="SC_FieldCaption";}var i=FCKTools.AppendElement(l.rows[0].insertCell(-1),"div");if(n){i.className="SC_Field";i.style.width=this.FieldWidth+"px";i.innerHTML='<table width="100%" cellpadding="0" cellspacing="0" style="TABLE-LAYOUT: fixed;"><tbody><tr><td class="SC_FieldLabel"><label>&nbsp;</label></td><td class="SC_FieldButton">&nbsp;</td></tr></tbody></table>';this._LabelEl=i.getElementsByTagName("label")[0];this._LabelEl.innerHTML=this.Label;}else{i.className="TB_Button_Off";i.innerHTML='<table title="'+this.Tooltip+'" class="'+m+'" cellspacing="0" cellpadding="0" border="0"><tr><td><img class="TB_Button_Padding" src="'+FCK_SPACER_PATH+'" /></td><td class="TB_Text">'+this.Caption+'</td><td><img class="TB_Button_Padding" src="'+FCK_SPACER_PATH+'" /></td><td class="TB_ButtonArrow"><img src="'+FCKConfig.SkinPath+'images/toolbar.buttonarrow.gif" width="5" height="3"></td><td><img class="TB_Button_Padding" src="'+FCK_SPACER_PATH+'" /></td></tr></table>';}FCKTools.AddEventListenerEx(i,"mouseover",FCKSpecialCombo_OnMouseOver,this);FCKTools.AddEventListenerEx(i,"mouseout",FCKSpecialCombo_OnMouseOut,this);FCKTools.AddEventListenerEx(i,"click",FCKSpecialCombo_OnClick,this);FCKTools.DisableSelection(this._Panel.Document.body);};function FCKSpecialCombo_Cleanup(){this._LabelEl=null;this._OuterTable=null;this._ItemsHolderEl=null;this._PanelBox=null;if(this.Items){for(var b in this.Items){this.Items[b]=null;}}}function FCKSpecialCombo_OnMouseOver(d,c){if(c.Enabled){switch(c.Style){case 0:this.className="TB_Button_On_Over";break;case 1:this.className="TB_Button_On_Over";break;case 2:this.className="SC_Field SC_FieldOver";break;}}}function FCKSpecialCombo_OnMouseOut(d,c){switch(c.Style){case 0:this.className="TB_Button_Off";break;case 1:this.className="TB_Button_Off";break;case 2:this.className="SC_Field";break;}}function FCKSpecialCombo_OnClick(l,i){if(i.Enabled){var j=i._Panel;var k=i._PanelBox;var m=i._ItemsHolderEl;var h=i.PanelMaxHeight;if(i.OnBeforeClick){i.OnBeforeClick(i);}if(FCKBrowserInfo.IsIE){j.Preload(0,this.offsetHeight,this);}if(m.offsetHeight>h){k.style.height=h+"px";}else{k.style.height="";}j.Show(0,this.offsetHeight,this);}}var FCKToolbarSpecialCombo=function(){this.SourceView=false;this.ContextSensitive=true;this.FieldWidth=null;this.PanelWidth=null;this.PanelMaxHeight=null;};FCKToolbarSpecialCombo.prototype.DefaultLabel="";function FCKToolbarSpecialCombo_OnSelect(d,c){FCK.ToolbarSet.CurrentInstance.Commands.GetCommand(this.CommandName).Execute(d,c);}FCKToolbarSpecialCombo.prototype.Create=function(b){this._Combo=new FCKSpecialCombo(this.GetLabel(),this.FieldWidth,this.PanelWidth,this.PanelMaxHeight,FCKBrowserInfo.IsIE?window:FCKTools.GetElementWindow(b).parent);this._Combo.Tooltip=this.Tooltip;this._Combo.Style=this.Style;this.CreateItems(this._Combo);this._Combo.Create(b);this._Combo.CommandName=this.CommandName;this._Combo.OnSelect=FCKToolbarSpecialCombo_OnSelect;};function FCKToolbarSpecialCombo_RefreshActiveItems(d,c){d.DeselectAll();d.SelectItem(c);d.SetLabelById(c);}FCKToolbarSpecialCombo.prototype.RefreshState=function(){var d;var c=FCK.ToolbarSet.CurrentInstance.Commands.GetCommand(this.CommandName).GetState();if(c!=-1){d=1;if(this.RefreshActiveItems){this.RefreshActiveItems(this._Combo,c);}else{if(this._LastValue!==c){this._LastValue=c;if(!c||c.length==0){this._Combo.DeselectAll();this._Combo.SetLabel(this.DefaultLabel);}else{FCKToolbarSpecialCombo_RefreshActiveItems(this._Combo,c);}}}}else{d=-1;}if(d==this.State){return;}if(d==-1){this._Combo.DeselectAll();this._Combo.SetLabel("");}this.State=d;this._Combo.SetEnabled(d!=-1);};FCKToolbarSpecialCombo.prototype.Enable=function(){this.RefreshState();};FCKToolbarSpecialCombo.prototype.Disable=function(){this.State=-1;this._Combo.DeselectAll();this._Combo.SetLabel("");this._Combo.SetEnabled(false);};var FCKToolbarStyleCombo=function(d,c){if(d===false){return;}this.CommandName="Style";this.Label=this.GetLabel();this.Tooltip=d?d:this.Label;this.Style=c?c:2;this.DefaultLabel=FCKConfig.DefaultStyleLabel||"";};FCKToolbarStyleCombo.prototype=new FCKToolbarSpecialCombo;FCKToolbarStyleCombo.prototype.GetLabel=function(){return FCKLang.Style;};FCKToolbarStyleCombo.prototype.GetStyles=function(){var g={};var h=FCK.ToolbarSet.CurrentInstance.Styles.GetStyles();for(var i in h){var f=h[i];if(!f.IsCore){g[i]=f;}}return g;};FCKToolbarStyleCombo.prototype.CreateItems=function(j){var k=j._Panel.Document;FCKTools.AppendStyleSheet(k,FCKConfig.ToolbarComboPreviewCSS);FCKTools.AppendStyleString(k,FCKConfig.EditorAreaStyles);k.body.className+=" ForceBaseFont";FCKConfig.ApplyBodyAttributes(k.body);var l=this.GetStyles();for(var m in l){var n=l[m];var o=n.GetType()==2?m:FCKToolbarStyleCombo_BuildPreview(n,n.Label||m);var i=j.AddItem(m,o);i.Style=n;}j.OnBeforeClick=this.StyleCombo_OnBeforeClick;};FCKToolbarStyleCombo.prototype.RefreshActiveItems=function(k){var l=FCK.ToolbarSet.CurrentInstance.Selection.GetBoundaryParentElement(true);if(l){var m=new FCKElementPath(l);var n=m.Elements;for(var o=0;o<n.length;o++){for(var i in k.Items){var p=k.Items[i];var q=p.Style;if(q.CheckElementRemovable(n[o],true)){k.SetLabel(q.Label||q.Name);return;}}}}k.SetLabel(this.DefaultLabel);};FCKToolbarStyleCombo.prototype.StyleCombo_OnBeforeClick=function(k){k.DeselectAll();var l;var m;var n;var o=FCK.ToolbarSet.CurrentInstance.Selection;if(o.GetType()=="Control"){l=o.GetSelectedElement();n=l.nodeName.toLowerCase();}else{l=o.GetBoundaryParentElement(true);m=new FCKElementPath(l);}for(var i in k.Items){var p=k.Items[i];var q=p.Style;if((n&&q.Element==n)||(!n&&q.GetType()!=2)){p.style.display="";if((m&&q.CheckActive(m))||(!m&&q.CheckElementRemovable(l,true))){k.SelectItem(q.Name);}}else{p.style.display="none";}}};function FCKToolbarStyleCombo_BuildPreview(j,k){var l=j.GetType();var m=[];if(l==0){m.push('<div class="BaseFont">');}var n=j.Element;if(n=="bdo"){n="span";}m=["<",n];var o=j._StyleDesc.Attributes;if(o){for(var i in o){m.push(" ",i,'="',j.GetFinalAttributeValue(i),'"');}}if(j._GetStyleText().length>0){m.push(' style="',j.GetFinalStyleValue(),'"');}m.push(">",k,"</",n,">");if(l==0){m.push("</div>");}return m.join("");}var FCKToolbarFontFormatCombo=function(d,c){if(d===false){return;}this.CommandName="FontFormat";this.Label=this.GetLabel();this.Tooltip=d?d:this.Label;this.Style=c?c:2;this.NormalLabel="Normal";this.PanelWidth=190;this.DefaultLabel=FCKConfig.DefaultFontFormatLabel||"";};FCKToolbarFontFormatCombo.prototype=new FCKToolbarStyleCombo(false);FCKToolbarFontFormatCombo.prototype.GetLabel=function(){return FCKLang.FontFormat;};FCKToolbarFontFormatCombo.prototype.GetStyles=function(){var j={};var k=FCKLang["FontFormats"].split(";");var l={p:k[0],pre:k[1],address:k[2],h1:k[3],h2:k[4],h3:k[5],h4:k[6],h5:k[7],h6:k[8],div:k[9]||(k[0]+" (DIV)")};var m=FCKConfig.FontFormats.split(";");for(var i=0;i<m.length;i++){var n=m[i];var o=FCKStyles.GetStyle("_FCK_"+n);if(o){o.Label=l[n];j["_FCK_"+n]=o;}else{alert("The FCKConfig.CoreStyles['"+n+"'] setting was not found. Please check the fckconfig.js file");}}return j;};FCKToolbarFontFormatCombo.prototype.RefreshActiveItems=function(j){var k=FCK.ToolbarSet.CurrentInstance.Selection.GetBoundaryParentElement(true);if(k){var l=new FCKElementPath(k);var m=l.Block;if(m){for(var i in j.Items){var n=j.Items[i];var o=n.Style;if(o.CheckElementRemovable(m)){j.SetLabel(o.Label);return;}}}}j.SetLabel(this.DefaultLabel);};FCKToolbarFontFormatCombo.prototype.StyleCombo_OnBeforeClick=function(j){j.DeselectAll();var k=FCK.ToolbarSet.CurrentInstance.Selection.GetBoundaryParentElement(true);if(k){var l=new FCKElementPath(k);var m=l.Block;for(var i in j.Items){var n=j.Items[i];var o=n.Style;if(o.CheckElementRemovable(m)){j.SelectItem(n);return;}}}};var FCKToolbarFontsCombo=function(d,c){this.CommandName="FontName";this.Label=this.GetLabel();this.Tooltip=d?d:this.Label;this.Style=c?c:2;this.DefaultLabel=FCKConfig.DefaultFontLabel||"";};FCKToolbarFontsCombo.prototype=new FCKToolbarFontFormatCombo(false);FCKToolbarFontsCombo.prototype.GetLabel=function(){return FCKLang.Font;};FCKToolbarFontsCombo.prototype.GetStyles=function(){var k=FCKStyles.GetStyle("_FCK_FontFace");if(!k){alert("The FCKConfig.CoreStyles['Size'] setting was not found. Please check the fckconfig.js file");return{};}var l={};var m=FCKConfig.FontNames.split(";");for(var i=0;i<m.length;i++){var n=m[i].split("/");var o=n[0];var p=n[1]||o;var q=FCKTools.CloneObject(k);q.SetVariable("Font",o);q.Label=p;l[p]=q;}return l;};FCKToolbarFontsCombo.prototype.RefreshActiveItems=FCKToolbarStyleCombo.prototype.RefreshActiveItems;FCKToolbarFontsCombo.prototype.StyleCombo_OnBeforeClick=function(i){i.DeselectAll();var j=FCKSelection.GetBoundaryParentElement(true);if(j){var k=new FCKElementPath(j);for(var h in i.Items){var l=i.Items[h];var m=l.Style;if(m.CheckActive(k)){i.SelectItem(l);return;}}}};var FCKToolbarFontSizeCombo=function(d,c){this.CommandName="FontSize";this.Label=this.GetLabel();this.Tooltip=d?d:this.Label;this.Style=c?c:2;this.DefaultLabel=FCKConfig.DefaultFontSizeLabel||"";this.FieldWidth=70;};FCKToolbarFontSizeCombo.prototype=new FCKToolbarFontFormatCombo(false);FCKToolbarFontSizeCombo.prototype.GetLabel=function(){return FCKLang.FontSize;};FCKToolbarFontSizeCombo.prototype.GetStyles=function(){var k=FCKStyles.GetStyle("_FCK_Size");if(!k){alert("The FCKConfig.CoreStyles['FontFace'] setting was not found. Please check the fckconfig.js file");return{};}var l={};var m=FCKConfig.FontSizes.split(";");for(var i=0;i<m.length;i++){var n=m[i].split("/");var o=n[0];var p=n[1]||o;var q=FCKTools.CloneObject(k);q.SetVariable("Size",o);q.Label=p;l[p]=q;}return l;};FCKToolbarFontSizeCombo.prototype.RefreshActiveItems=FCKToolbarStyleCombo.prototype.RefreshActiveItems;FCKToolbarFontSizeCombo.prototype.StyleCombo_OnBeforeClick=FCKToolbarFontsCombo.prototype.StyleCombo_OnBeforeClick;var FCKToolbarPanelButton=function(j,k,l,m,n){this.CommandName=j;var o;if(n==null){o=FCKConfig.SkinPath+"toolbar/"+j.toLowerCase()+".gif";}else{if(typeof(n)=="number"){o=[FCKConfig.SkinPath+"fck_strip.gif",16,n];}}var i=this._UIButton=new FCKToolbarButtonUI(j,k,l,o,m);i._FCKToolbarPanelButton=this;i.ShowArrow=true;i.OnClick=FCKToolbarPanelButton_OnButtonClick;};FCKToolbarPanelButton.prototype.TypeName="FCKToolbarPanelButton";FCKToolbarPanelButton.prototype.Create=function(d){d.className+="Menu";this._UIButton.Create(d);var c=FCK.ToolbarSet.CurrentInstance.Commands.GetCommand(this.CommandName)._Panel;this.RegisterPanel(c);};FCKToolbarPanelButton.prototype.RegisterPanel=function(f){if(f._FCKToolbarPanelButton){return;}f._FCKToolbarPanelButton=this;var g=f.Document.body.appendChild(f.Document.createElement("div"));g.style.position="absolute";g.style.top="0px";var d=f._FCKToolbarPanelButtonLineDiv=g.appendChild(f.Document.createElement("IMG"));d.className="TB_ConnectionLine";d.style.position="absolute";d.src=FCK_SPACER_PATH;f.OnHide=FCKToolbarPanelButton_OnPanelHide;};function FCKToolbarPanelButton_OnButtonClick(h){var i=this._FCKToolbarPanelButton;var k=i._UIButton.MainElement;i._UIButton.ChangeState(1);var j=FCK.ToolbarSet.CurrentInstance.Commands.GetCommand(i.CommandName);var g=j._Panel;g._FCKToolbarPanelButtonLineDiv.style.width=(k.offsetWidth-2)+"px";j.Execute(0,k.offsetHeight-1,k);}function FCKToolbarPanelButton_OnPanelHide(){var b=this._FCKToolbarPanelButton;b._UIButton.ChangeState(0);}FCKToolbarPanelButton.prototype.RefreshState=FCKToolbarButton.prototype.RefreshState;FCKToolbarPanelButton.prototype.Enable=FCKToolbarButton.prototype.Enable;FCKToolbarPanelButton.prototype.Disable=FCKToolbarButton.prototype.Disable;var FCKScayt;(function(){var E=[];var F=(FCK&&FCK.EditorWindow&&FCK.EditorWindow.parent.parent.scayt)?true:false;var G=false;var I=false;function B(d){if(F){return;}F=true;var i=FCK.EditorWindow.parent.parent;var j=function(){window.scayt=i.scayt;D();var k=FCKToolbarItems.LoadedItems["ScaytCombobox"];k&&k.SetEnabled(scyt_control&&scyt_control.disabled);z();};if(i.scayt){j();return;}if(FCK.Config.ScaytCustomUrl){FCK.Config.ScaytCustomUrl=new String(FCK.Config.ScaytCustomUrl).replace(new RegExp("^http[s]*://"),"");}var c=document.location.protocol;var f=FCK.Config.ScaytCustomUrl||"svc.spellchecker.net/spellcheck3/lf/scayt/scayt4.js";var g=c+"//"+f;var h=b(g).path+"/";var a=i.window.CKEDITOR||(i.window.CKEDITOR={});a._djScaytConfig={I:h,addOnLoad:function(){j();},isDebug:false};if(d){E.push(d);}C(g);}function C(a){if(!a){return false;}var c=FCK.EditorWindow.parent.parent;var d=c.document.createElement("script");d.type="text/javascript";d.src=a;c.document.getElementsByTagName("head")[0].appendChild(d);return true;}function b(c){var a=c.match(/(.*)[\/\\]([^\/\\]+\.\w+)$/);return a?{path:a[1],file:a[2]}:c;}function u(){var c={};var d=FCK.EditorWindow.parent.parent;c.srcNodeRef=FCK.EditingArea.IFrame;c.customerid=FCK.Config.ScaytCustomerid;c.customDictionaryName=FCK.Config.ScaytCustomDictionaryName;c.userDictionaryName=FCK.Config.ScaytUserDictionaryName;c.defLang=FCK.Config.ScaytDefLang;var f=d.scayt;var a=window.scayt_control=new f(c);}function D(){u();var c=window.scayt_control;if(c){c.setDisabled(false);I=true;G=!c.disabled;var f=FCKToolbarItems.LoadedItems["ScaytCombobox"];f&&f.Enable();x();}for(var a=0;a<E.length;a++){try{E[a].call(this);}catch(d){}}}var A=function(){name="Scayt";};A.prototype.Execute=function(c){switch(c){case"Options":case"Langs":case"About":if(F&&I&&!G){y("SCAYT is not enabled");break;}if(F&&I){FCKDialog.OpenDialog("Scayt","SCAYT Settings","dialog/fck_scayt.html?"+c.toLowerCase(),343,343);}break;default:if(!F){var a=this;B(function(){a.SetEnabled(!window.scayt_control.disabled);});return true;}else{if(I){if(G){this.Disable();}else{this.Enable();}x();}}}if(!F){return y("SCAYT is not loaded")||false;}if(!I){return y("SCAYT is not ready")||false;}return true;};A.prototype.Enable=function(){window.scayt_control.setDisabled(false);G=true;};A.prototype.Disable=function(){window.scayt_control.setDisabled(true);G=false;};A.prototype.SetEnabled=function(a){if(a){this.Enable();}else{this.Disable();}x();return true;};A.prototype.GetState=function(){return 0;};function x(){var a=FCKToolbarItems.GetItem("SpellCheck");if(!a||!a._Combo||!a._Combo._OuterTable){return;}var c=a._Combo._OuterTable.getElementsByTagName("img")[1];var d=a._Combo.Items["trigger"];if(G){c.style.opacity="1";d.innerHTML=t();}else{c.style.opacity="0.5";d.innerHTML=t();}}function t(){if(!I){return"<b>Enable SCAYT</b>";}return G?"<b>Disable SCAYT</b>":"<b>Enable SCAYT</b>";}var H=function(c,a){this.Command=FCKCommands.GetCommand("Scayt");this.CommandName="Scayt";this.Label=this.GetLabel();this.Tooltip=FCKLang.ScaytTitle;this.Style=1;};H.prototype=new FCKToolbarSpecialCombo;H.prototype.CreateItems=function(){this._Combo.AddItem("Trigger","<b>Enable SCAYT</b>");this._Combo.AddItem("Options",FCKLang.ScaytTitleOptions||"Options");this._Combo.AddItem("Langs",FCKLang.ScaytTitleLangs||"Languages");this._Combo.AddItem("About",FCKLang.ScaytTitleAbout||"About");};H.prototype.GetLabel=function(){var a=FCKConfig.SkinPath+"fck_strip.gif";return FCKBrowserInfo.IsIE?'<div class="TB_Button_Image"><img src="'+a+'" style="top:-192px"></div>':'<img class="TB_Button_Image" src="'+FCK_SPACER_PATH+'" style="background-position: 0px -192px;background-image: url('+a+');">';};function y(a){a&&alert(a);}var v=function(){name="ScaytContext";};v.prototype.Execute=function(c){var a=c&&c.action,f=a&&c.node,g=window.scayt_control;if(f){switch(a){case"Suggestion":g.replace(f,c.suggestion);break;case"Ignore":g.ignore(f);break;case"Ignore All":g.ignoreAll(f);break;case"Add Word":var d=FCK.EditorWindow.parent.parent;d.scayt.addWordToUserDictionary(f);break;}}};function z(){FCK.ContextMenu.RegisterListener({AddItems:function(h){var a=FCK.EditorWindow.parent.parent;var g=window.scayt_control,d=a.scayt;if(!g){return;}var c=g.getScaytNode();if(!c){return;}var f=d.getSuggestion(g.getWord(c),g.getLang());if(!f||!f.length){return;}h.AddSeparator();var j=FCK.Config.ScaytMaxSuggestions||5;var k=(j==-1)?f.length:j;for(var i=0;i<k;i+=1){if(f[i]){h.AddItem("ScaytContext",f[i],null,false,{"action":"Suggestion","node":c,"suggestion":f[i]});}}h.AddSeparator();h.AddItem("ScaytContext","Ignore",null,false,{"action":"Ignore","node":c});h.AddItem("ScaytContext","Ignore All",null,false,{"action":"Ignore All","node":c});h.AddItem("ScaytContext","Add Word",null,false,{"action":"Add Word","node":c});try{if(I&&G){g.fireOnContextMenu(null,FCK.ContextMenu._InnerContextMenu);}}catch(l){}}});FCK.Events.AttachEvent("OnPaste",function(){window.scayt_control.refresh();return true;});}FCK.Events.AttachEvent("OnAfterSetHTML",function(){if(FCKConfig.SpellChecker=="SCAYT"){if(!F&&FCK.Config.ScaytAutoStartup){B();}if(FCK.EditMode==0&&F&&I){u();}x();}});FCK.Events.AttachEvent("OnBeforeGetData",function(){I&&window.scayt_control.reset();});FCK.Events.AttachEvent("OnAfterGetData",function(){I&&window.scayt_control.refresh();});FCKScayt={CreateCommand:function(){return new A();},CreateContextCommand:function(){return new v();},CreateToolbarItem:function(){return new H();}};})();var FCKToolbarItems={};FCKToolbarItems.LoadedItems={};FCKToolbarItems.RegisterItem=function(d,c){this.LoadedItems[d]=c;};FCKToolbarItems.GetItem=function(d){var c=FCKToolbarItems.LoadedItems[d];if(c){return c;}switch(d){case"Source":c=new FCKToolbarButton("Source",FCKLang.Source,null,2,true,true,1);break;case"DocProps":c=new FCKToolbarButton("DocProps",FCKLang.DocProps,null,null,null,null,2);break;case"Save":c=new FCKToolbarButton("Save",FCKLang.Save,null,null,true,null,3);break;case"NewPage":c=new FCKToolbarButton("NewPage",FCKLang.NewPage,null,null,true,null,4);break;case"Preview":c=new FCKToolbarButton("Preview",FCKLang.Preview,null,null,true,null,5);break;case"Templates":c=new FCKToolbarButton("Templates",FCKLang.Templates,null,null,null,null,6);break;case"About":c=new FCKToolbarButton("About",FCKLang.About,null,null,true,null,47);break;case"Cut":c=new FCKToolbarButton("Cut",FCKLang.Cut,null,null,false,true,7);break;case"Copy":c=new FCKToolbarButton("Copy",FCKLang.Copy,null,null,false,true,8);break;case"Paste":c=new FCKToolbarButton("Paste",FCKLang.Paste,null,null,false,true,9);break;case"PasteText":c=new FCKToolbarButton("PasteText",FCKLang.PasteText,null,null,false,true,10);break;case"PasteWord":c=new FCKToolbarButton("PasteWord",FCKLang.PasteWord,null,null,false,true,11);break;case"Print":c=new FCKToolbarButton("Print",FCKLang.Print,null,null,false,true,12);break;case"Undo":c=new FCKToolbarButton("Undo",FCKLang.Undo,null,null,false,true,14);break;case"Redo":c=new FCKToolbarButton("Redo",FCKLang.Redo,null,null,false,true,15);break;case"SelectAll":c=new FCKToolbarButton("SelectAll",FCKLang.SelectAll,null,null,true,null,18);break;case"RemoveFormat":c=new FCKToolbarButton("RemoveFormat",FCKLang.RemoveFormat,null,null,false,true,19);break;case"FitWindow":c=new FCKToolbarButton("FitWindow",FCKLang.FitWindow,null,null,true,true,66);break;case"Bold":c=new FCKToolbarButton("Bold",FCKLang.Bold,null,null,false,true,20);break;case"Italic":c=new FCKToolbarButton("Italic",FCKLang.Italic,null,null,false,true,21);break;case"Underline":c=new FCKToolbarButton("Underline",FCKLang.Underline,null,null,false,true,22);break;case"StrikeThrough":c=new FCKToolbarButton("StrikeThrough",FCKLang.StrikeThrough,null,null,false,true,23);break;case"Subscript":c=new FCKToolbarButton("Subscript",FCKLang.Subscript,null,null,false,true,24);break;case"Superscript":c=new FCKToolbarButton("Superscript",FCKLang.Superscript,null,null,false,true,25);break;case"OrderedList":c=new FCKToolbarButton("InsertOrderedList",FCKLang.NumberedListLbl,FCKLang.NumberedList,null,false,true,26);break;case"UnorderedList":c=new FCKToolbarButton("InsertUnorderedList",FCKLang.BulletedListLbl,FCKLang.BulletedList,null,false,true,27);break;case"Outdent":c=new FCKToolbarButton("Outdent",FCKLang.DecreaseIndent,null,null,false,true,28);break;case"Indent":c=new FCKToolbarButton("Indent",FCKLang.IncreaseIndent,null,null,false,true,29);break;case"Blockquote":c=new FCKToolbarButton("Blockquote",FCKLang.Blockquote,null,null,false,true,73);break;case"CreateDiv":c=new FCKToolbarButton("CreateDiv",FCKLang.CreateDiv,null,null,false,true,74);break;case"Link":c=new FCKToolbarButton("Link",FCKLang.InsertLinkLbl,FCKLang.InsertLink,null,false,true,34);break;case"Unlink":c=new FCKToolbarButton("Unlink",FCKLang.RemoveLink,null,null,false,true,35);break;case"Anchor":c=new FCKToolbarButton("Anchor",FCKLang.Anchor,null,null,null,null,36);break;case"Image":c=new FCKToolbarButton("Image",FCKLang.InsertImageLbl,FCKLang.InsertImage,null,false,true,37);break;case"Flash":c=new FCKToolbarButton("Flash",FCKLang.InsertFlashLbl,FCKLang.InsertFlash,null,false,true,38);break;case"Table":c=new FCKToolbarButton("Table",FCKLang.InsertTableLbl,FCKLang.InsertTable,null,false,true,39);break;case"SpecialChar":c=new FCKToolbarButton("SpecialChar",FCKLang.InsertSpecialCharLbl,FCKLang.InsertSpecialChar,null,false,true,42);break;case"Smiley":c=new FCKToolbarButton("Smiley",FCKLang.InsertSmileyLbl,FCKLang.InsertSmiley,null,false,true,41);break;case"PageBreak":c=new FCKToolbarButton("PageBreak",FCKLang.PageBreakLbl,FCKLang.PageBreak,null,false,true,43);break;case"Rule":c=new FCKToolbarButton("Rule",FCKLang.InsertLineLbl,FCKLang.InsertLine,null,false,true,40);break;case"JustifyLeft":c=new FCKToolbarButton("JustifyLeft",FCKLang.LeftJustify,null,null,false,true,30);break;case"JustifyCenter":c=new FCKToolbarButton("JustifyCenter",FCKLang.CenterJustify,null,null,false,true,31);break;case"JustifyRight":c=new FCKToolbarButton("JustifyRight",FCKLang.RightJustify,null,null,false,true,32);break;case"JustifyFull":c=new FCKToolbarButton("JustifyFull",FCKLang.BlockJustify,null,null,false,true,33);break;case"Style":c=new FCKToolbarStyleCombo();break;case"FontName":c=new FCKToolbarFontsCombo();break;case"FontSize":c=new FCKToolbarFontSizeCombo();break;case"FontFormat":c=new FCKToolbarFontFormatCombo();break;case"TextColor":c=new FCKToolbarPanelButton("TextColor",FCKLang.TextColor,null,null,45);break;case"BGColor":c=new FCKToolbarPanelButton("BGColor",FCKLang.BGColor,null,null,46);break;case"Find":c=new FCKToolbarButton("Find",FCKLang.Find,null,null,null,null,16);break;case"Replace":c=new FCKToolbarButton("Replace",FCKLang.Replace,null,null,null,null,17);break;case"Form":c=new FCKToolbarButton("Form",FCKLang.Form,null,null,null,null,48);break;case"Checkbox":c=new FCKToolbarButton("Checkbox",FCKLang.Checkbox,null,null,null,null,49);break;case"Radio":c=new FCKToolbarButton("Radio",FCKLang.RadioButton,null,null,null,null,50);break;case"TextField":c=new FCKToolbarButton("TextField",FCKLang.TextField,null,null,null,null,51);break;case"Textarea":c=new FCKToolbarButton("Textarea",FCKLang.Textarea,null,null,null,null,52);break;case"HiddenField":c=new FCKToolbarButton("HiddenField",FCKLang.HiddenField,null,null,null,null,56);break;case"Button":c=new FCKToolbarButton("Button",FCKLang.Button,null,null,null,null,54);break;case"Select":c=new FCKToolbarButton("Select",FCKLang.SelectionField,null,null,null,null,53);break;case"ImageButton":c=new FCKToolbarButton("ImageButton",FCKLang.ImageButton,null,null,null,null,55);break;case"ShowBlocks":c=new FCKToolbarButton("ShowBlocks",FCKLang.ShowBlocks,null,null,null,true,72);break;case"SpellCheck":if(FCKConfig.SpellChecker=="SCAYT"){c=FCKScayt.CreateToolbarItem();}else{c=new FCKToolbarButton("SpellCheck",FCKLang.SpellCheck,null,null,null,null,13);}break;default:alert(FCKLang.UnknownToolbarItem.replace(/%1/g,d));return null;}FCKToolbarItems.LoadedItems[d]=c;return c;};var FCKToolbar=function(){this.Items=[];};FCKToolbar.prototype.AddItem=function(b){return this.Items[this.Items.length]=b;};FCKToolbar.prototype.AddButton=function(j,k,l,m,n,o){if(typeof(m)=="number"){m=[this.DefaultIconsStrip,this.DefaultIconSize,m];}var i=new FCKToolbarButtonUI(j,k,l,m,n,o);i._FCKToolbar=this;i.OnClick=FCKToolbar_OnItemClick;return this.AddItem(i);};function FCKToolbar_OnItemClick(d){var c=d._FCKToolbar;if(c.OnItemClick){c.OnItemClick(c,d);}}FCKToolbar.prototype.AddSeparator=function(){this.AddItem(new FCKToolbarSeparator());};FCKToolbar.prototype.Create=function(i){var j=FCKTools.GetElementDocument(i);var l=j.createElement("table");l.className="TB_Toolbar";l.style.styleFloat=l.style.cssFloat=(FCKLang.Dir=="ltr"?"left":"right");l.dir=FCKLang.Dir;l.cellPadding=0;l.cellSpacing=0;var k=l.insertRow(-1);var m;if(!this.HideStart){m=k.insertCell(-1);m.appendChild(j.createElement("div")).className="TB_Start";}for(var h=0;h<this.Items.length;h++){this.Items[h].Create(k.insertCell(-1));}if(!this.HideEnd){m=k.insertCell(-1);m.appendChild(j.createElement("div")).className="TB_End";}i.appendChild(l);};var FCKToolbarSeparator=function(){};FCKToolbarSeparator.prototype.Create=function(b){FCKTools.AppendElement(b,"div").className="TB_Separator";};var FCKToolbarBreak=function(){};FCKToolbarBreak.prototype.Create=function(d){var c=d.ownerDocument.createElement("div");c.style.clear=c.style.cssFloat=FCKLang.Dir=="rtl"?"right":"left";d.appendChild(c);};function FCKToolbarSet_Create(A){var B;var C=A||FCKConfig.ToolbarLocation;switch(C){case"In":document.getElementById("xToolbarRow").style.display="";B=new FCKToolbarSet(document);break;case"None":B=new FCKToolbarSet(document);break;default:FCK.Events.AttachEvent("OnBlur",FCK_OnBlur);FCK.Events.AttachEvent("OnFocus",FCK_OnFocus);var D;var E=C.match(/^Out:(.+)\((\w+)\)$/);if(E){if(FCKBrowserInfo.IsAIR){FCKAdobeAIR.ToolbarSet_GetOutElement(window,E);}else{D=eval("parent."+E[1]).document.getElementById(E[2]);}}else{E=C.match(/^Out:(\w+)$/);if(E){D=parent.document.getElementById(E[1]);}}if(!D){alert('Invalid value for "ToolbarLocation"');return arguments.callee("In");}B=D.__FCKToolbarSet;if(B){break;}var F=FCKTools.GetElementDocument(D).createElement("iframe");F.src="javascript:void(0)";F.frameBorder=0;F.width="100%";F.height="10";D.appendChild(F);F.unselectable="on";var G=F.contentWindow.document;var H="";if(FCKBrowserInfo.IsSafari){H='<base href="'+window.document.location+'">';}G.open();G.write("<html><head>"+H+'<script type="text/javascript"> var adjust = function() { window.frameElement.height = document.body.scrollHeight ; }; window.onresize = window.onload = function(){var timer = null;var lastHeight = -1;var lastChange = 0;var poller = function(){var currentHeight = document.body.scrollHeight || 0;var currentTime = (new Date()).getTime();if (currentHeight != lastHeight){lastChange = currentTime;adjust();lastHeight = document.body.scrollHeight;}if (lastChange < currentTime - 1000) clearInterval(timer);};timer = setInterval(poller, 100);}<\/script></head><body style="overflow: hidden">'+document.getElementById("xToolbarSpace").innerHTML+"</body></html>");G.close();if(FCKBrowserInfo.IsAIR){FCKAdobeAIR.ToolbarSet_InitOutFrame(G);}FCKTools.AddEventListener(G,"contextmenu",FCKTools.CancelEvent);FCKTools.AppendStyleSheet(G,FCKConfig.SkinEditorCSS);B=D.__FCKToolbarSet=new FCKToolbarSet(G);B._IFrame=F;if(FCK.IECleanup){FCK.IECleanup.AddItem(D,FCKToolbarSet_Target_Cleanup);}}B.CurrentInstance=FCK;if(!B.ToolbarItems){B.ToolbarItems=FCKToolbarItems;}FCK.AttachToOnSelectionChange(B.RefreshItemsState);return B;}function FCK_OnBlur(d){var c=d.ToolbarSet;if(c.CurrentInstance==d){c.Disable();}}function FCK_OnFocus(f){var g=f.ToolbarSet;var d=f||FCK;g.CurrentInstance.FocusManager.RemoveWindow(g._IFrame.contentWindow);g.CurrentInstance=d;d.FocusManager.AddWindow(g._IFrame.contentWindow,true);g.Enable();}function FCKToolbarSet_Cleanup(){this._TargetElement=null;this._IFrame=null;}function FCKToolbarSet_Target_Cleanup(){this.__FCKToolbarSet=null;}var FCKToolbarSet=function(f){this._Document=f;this._TargetElement=f.getElementById("xToolbar");var g=f.getElementById("xExpandHandle");var d=f.getElementById("xCollapseHandle");g.title=FCKLang.ToolbarExpand;FCKTools.AddEventListener(g,"click",FCKToolbarSet_Expand_OnClick);d.title=FCKLang.ToolbarCollapse;FCKTools.AddEventListener(d,"click",FCKToolbarSet_Collapse_OnClick);if(!FCKConfig.ToolbarCanCollapse||FCKConfig.ToolbarStartExpanded){this.Expand();}else{this.Collapse();}d.style.display=FCKConfig.ToolbarCanCollapse?"":"none";if(FCKConfig.ToolbarCanCollapse){d.style.display="";}else{f.getElementById("xTBLeftBorder").style.display="";}this.Toolbars=[];this.IsLoaded=false;if(FCK.IECleanup){FCK.IECleanup.AddItem(this,FCKToolbarSet_Cleanup);}};function FCKToolbarSet_Expand_OnClick(){FCK.ToolbarSet.Expand();}function FCKToolbarSet_Collapse_OnClick(){FCK.ToolbarSet.Collapse();}FCKToolbarSet.prototype.Expand=function(){this._ChangeVisibility(false);};FCKToolbarSet.prototype.Collapse=function(){this._ChangeVisibility(true);};FCKToolbarSet.prototype._ChangeVisibility=function(b){this._Document.getElementById("xCollapsed").style.display=b?"":"none";this._Document.getElementById("xExpanded").style.display=b?"none":"";if(window.onresize){FCKTools.RunFunction(window.onresize);}};FCKToolbarSet.prototype.Load=function(j){this.Name=j;this.Items=[];this.ItemsWysiwygOnly=[];this.ItemsContextSensitive=[];this._TargetElement.innerHTML="";var l=FCKConfig.ToolbarSets[j];if(!l){alert(FCKLang.UnknownToolbarSet.replace(/%1/g,j));return;}this.Toolbars=[];for(var k=0;k<l.length;k++){var m=l[k];if(!m){continue;}var n;if(typeof(m)=="string"){if(m=="/"){n=new FCKToolbarBreak();}}else{n=new FCKToolbar();for(var q=0;q<m.length;q++){var o=m[q];if(o=="-"){n.AddSeparator();}else{var p=FCKToolbarItems.GetItem(o);if(p){n.AddItem(p);this.Items.push(p);if(!p.SourceView){this.ItemsWysiwygOnly.push(p);}if(p.ContextSensitive){this.ItemsContextSensitive.push(p);}}}}}n.Create(this._TargetElement);this.Toolbars[this.Toolbars.length]=n;}FCKTools.DisableSelection(this._Document.getElementById("xCollapseHandle").parentNode);if(FCK.Status!=2){FCK.Events.AttachEvent("OnStatusChange",this.RefreshModeState);}else{this.RefreshModeState();}this.IsLoaded=true;this.IsEnabled=true;FCKTools.RunFunction(this.OnLoad);};FCKToolbarSet.prototype.Enable=function(){if(this.IsEnabled){return;}this.IsEnabled=true;var d=this.Items;for(var c=0;c<d.length;c++){d[c].RefreshState();}};FCKToolbarSet.prototype.Disable=function(){if(!this.IsEnabled){return;}this.IsEnabled=false;var d=this.Items;for(var c=0;c<d.length;c++){d[c].Disable();}};FCKToolbarSet.prototype.RefreshModeState=function(h){if(FCK.Status!=2){return;}var i=h?h.ToolbarSet:this;var j=i.ItemsWysiwygOnly;if(FCK.EditMode==0){for(var k=0;k<j.length;k++){j[k].Enable();}i.RefreshItemsState(h);}else{i.RefreshItemsState(h);for(var g=0;g<j.length;g++){j[g].Disable();}}};FCKToolbarSet.prototype.RefreshItemsState=function(f){var g=(f?f.ToolbarSet:this).ItemsContextSensitive;for(var d=0;d<g.length;d++){g[d].RefreshState();}};var FCKDialog=(function(){var k;var l;var m;var n=window.parent;while(n.parent&&n.parent!=n){try{if(n.parent.document.domain!=document.domain){break;}if(n.parent.document.getElementsByTagName("frameset").length>0){break;}}catch(o){break;}n=n.parent;}var p=n.document;var q=function(){if(!l){l=FCKConfig.FloatingPanelsZIndex+999;}return ++l;};var j=function(){if(!m){return;}var a=FCKTools.IsStrictMode(p)?p.documentElement:p.body;FCKDomTools.SetElementStyles(m,{"width":Math.max(a.scrollWidth,a.clientWidth,p.scrollWidth||0)-1+"px","height":Math.max(a.scrollHeight,a.clientHeight,p.scrollHeight||0)-1+"px"});};return{OpenDialog:function(g,z,B,h,A,f,i){if(!k){this.DisplayMainCover();}var C={Title:z,Page:B,Editor:window,CustomValue:f,TopWindow:n};FCK.ToolbarSet.CurrentInstance.Selection.Save(true);var D=FCKTools.GetViewPaneSize(n);var E={"X":0,"Y":0};var a=FCKBrowserInfo.IsIE&&(!FCKBrowserInfo.IsIE7||!FCKTools.IsStrictMode(n.document));if(a){E=FCKTools.GetScrollPosition(n);}var b=Math.max(E.Y+(D.Height-A-20)/2,0);var c=Math.max(E.X+(D.Width-h-20)/2,0);var d=p.createElement("iframe");FCKTools.ResetStyles(d);d.src=FCKConfig.BasePath+"fckdialog.html";d.frameBorder=0;d.allowTransparency=true;FCKDomTools.SetElementStyles(d,{"position":(a)?"absolute":"fixed","top":b+"px","left":c+"px","width":h+"px","height":A+"px","zIndex":q()});d._DialogArguments=C;p.body.appendChild(d);d._ParentDialog=k;k=d;},OnDialogClose:function(a){var b=a.frameElement;FCKDomTools.RemoveNode(b);if(b._ParentDialog){k=b._ParentDialog;b._ParentDialog.contentWindow.SetEnabled(true);}else{if(!FCKBrowserInfo.IsIE){FCK.Focus();}this.HideMainCover();setTimeout(function(){k=null;},0);FCK.ToolbarSet.CurrentInstance.Selection.Release();}},DisplayMainCover:function(){m=p.createElement("div");FCKTools.ResetStyles(m);FCKDomTools.SetElementStyles(m,{"position":"absolute","zIndex":q(),"top":"0px","left":"0px","backgroundColor":FCKConfig.BackgroundBlockerColor});FCKDomTools.SetOpacity(m,FCKConfig.BackgroundBlockerOpacity);if(FCKBrowserInfo.IsIE&&!FCKBrowserInfo.IsIE7){var a=p.createElement("iframe");FCKTools.ResetStyles(a);a.hideFocus=true;a.frameBorder=0;a.src=FCKTools.GetVoidUrl();FCKDomTools.SetElementStyles(a,{"width":"100%","height":"100%","position":"absolute","left":"0px","top":"0px","filter":"progid:DXImageTransform.Microsoft.Alpha(opacity=0)"});m.appendChild(a);}FCKTools.AddEventListener(n,"resize",j);j();p.body.appendChild(m);FCKFocusManager.Lock();var b=FCK.ToolbarSet.CurrentInstance.GetInstanceObject("frameElement");b._fck_originalTabIndex=b.tabIndex;b.tabIndex=-1;},HideMainCover:function(){FCKDomTools.RemoveNode(m);FCKFocusManager.Unlock();var a=FCK.ToolbarSet.CurrentInstance.GetInstanceObject("frameElement");a.tabIndex=a._fck_originalTabIndex;FCKDomTools.ClearElementJSProperty(a,"_fck_originalTabIndex");},GetCover:function(){return m;}};})();var FCKMenuItem=function(i,j,k,l,m,h){this.Name=j;this.Label=k||j;this.IsDisabled=m;this.Icon=new FCKIcon(l);this.SubMenu=new FCKMenuBlockPanel();this.SubMenu.Parent=i;this.SubMenu.OnClick=FCKTools.CreateEventListener(FCKMenuItem_SubMenu_OnClick,this);this.CustomData=h;if(FCK.IECleanup){FCK.IECleanup.AddItem(this,FCKMenuItem_Cleanup);}};FCKMenuItem.prototype.AddItem=function(h,i,j,k,g){this.HasSubMenu=true;return this.SubMenu.AddItem(h,i,j,k,g);};FCKMenuItem.prototype.AddSeparator=function(){this.SubMenu.AddSeparator();};FCKMenuItem.prototype.Create=function(i){var j=this.HasSubMenu;var k=FCKTools.GetElementDocument(i);var h=this.MainElement=i.insertRow(-1);h.className=this.IsDisabled?"MN_Item_Disabled":"MN_Item";if(!this.IsDisabled){FCKTools.AddEventListenerEx(h,"mouseover",FCKMenuItem_OnMouseOver,[this]);FCKTools.AddEventListenerEx(h,"click",FCKMenuItem_OnClick,[this]);if(!j){FCKTools.AddEventListenerEx(h,"mouseout",FCKMenuItem_OnMouseOut,[this]);}}var l=h.insertCell(-1);l.className="MN_Icon";l.appendChild(this.Icon.CreateIconElement(k));l=h.insertCell(-1);l.className="MN_Label";l.noWrap=true;l.appendChild(k.createTextNode(this.Label));l=h.insertCell(-1);if(j){l.className="MN_Arrow";var m=l.appendChild(k.createElement("IMG"));m.src=FCK_IMAGES_PATH+"arrow_"+FCKLang.Dir+".gif";m.width=4;m.height=7;this.SubMenu.Create();this.SubMenu.Panel.OnHide=FCKTools.CreateEventListener(FCKMenuItem_SubMenu_OnHide,this);}};FCKMenuItem.prototype.Activate=function(){this.MainElement.className="MN_Item_Over";if(this.HasSubMenu){this.SubMenu.Show(this.MainElement.offsetWidth+2,-2,this.MainElement);}FCKTools.RunFunction(this.OnActivate,this);};FCKMenuItem.prototype.Deactivate=function(){this.MainElement.className="MN_Item";if(this.HasSubMenu){this.SubMenu.Hide();}};function FCKMenuItem_SubMenu_OnClick(d,c){FCKTools.RunFunction(c.OnClick,c,[d]);}function FCKMenuItem_SubMenu_OnHide(b){b.Deactivate();}function FCKMenuItem_OnClick(d,c){if(c.HasSubMenu){c.Activate();}else{c.Deactivate();FCKTools.RunFunction(c.OnClick,c,[c]);}}function FCKMenuItem_OnMouseOver(d,c){c.Activate();}function FCKMenuItem_OnMouseOut(d,c){c.Deactivate();}function FCKMenuItem_Cleanup(){this.MainElement=null;}var FCKMenuBlock=function(){this._Items=[];};FCKMenuBlock.prototype.Count=function(){return this._Items.length;};FCKMenuBlock.prototype.AddItem=function(i,j,k,l,m){var h=new FCKMenuItem(this,i,j,k,l,m);h.OnClick=FCKTools.CreateEventListener(FCKMenuBlock_Item_OnClick,this);h.OnActivate=FCKTools.CreateEventListener(FCKMenuBlock_Item_OnActivate,this);this._Items.push(h);return h;};FCKMenuBlock.prototype.AddSeparator=function(){this._Items.push(new FCKMenuSeparator());};FCKMenuBlock.prototype.RemoveAllItems=function(){this._Items=[];var b=this._ItemsTable;if(b){while(b.rows.length>0){b.deleteRow(0);}}};FCKMenuBlock.prototype.Create=function(i){if(!this._ItemsTable){if(FCK.IECleanup){FCK.IECleanup.AddItem(this,FCKMenuBlock_Cleanup);}this._Window=FCKTools.GetElementWindow(i);var j=FCKTools.GetElementDocument(i);var k=i.appendChild(j.createElement("table"));k.cellPadding=0;k.cellSpacing=0;FCKTools.DisableSelection(k);var l=k.insertRow(-1).insertCell(-1);l.className="MN_Menu";var m=this._ItemsTable=l.appendChild(j.createElement("table"));m.cellPadding=0;m.cellSpacing=0;}for(var h=0;h<this._Items.length;h++){this._Items[h].Create(this._ItemsTable);}};function FCKMenuBlock_Item_OnClick(d,c){if(c.Hide){c.Hide();}FCKTools.RunFunction(c.OnClick,c,[d]);}function FCKMenuBlock_Item_OnActivate(d){var c=d._ActiveItem;if(c&&c!=this){if(!FCKBrowserInfo.IsIE&&c.HasSubMenu&&!this.HasSubMenu){d._Window.focus();d.Panel.HasFocus=true;}c.Deactivate();}d._ActiveItem=this;}function FCKMenuBlock_Cleanup(){this._Window=null;this._ItemsTable=null;}var FCKMenuSeparator=function(){};FCKMenuSeparator.prototype.Create=function(g){var h=FCKTools.GetElementDocument(g);var f=g.insertRow(-1);var i=f.insertCell(-1);i.className="MN_Separator MN_Icon";i=f.insertCell(-1);i.className="MN_Separator";i.appendChild(h.createElement("DIV")).className="MN_Separator_Line";i=f.insertCell(-1);i.className="MN_Separator";i.appendChild(h.createElement("DIV")).className="MN_Separator_Line";};var FCKMenuBlockPanel=function(){FCKMenuBlock.call(this);};FCKMenuBlockPanel.prototype=new FCKMenuBlock();FCKMenuBlockPanel.prototype.Create=function(){var b=this.Panel=(this.Parent&&this.Parent.Panel?this.Parent.Panel.CreateChildPanel():new FCKPanel());b.AppendStyleSheet(FCKConfig.SkinEditorCSS);FCKMenuBlock.prototype.Create.call(this,b.MainNode);};FCKMenuBlockPanel.prototype.Show=function(d,g,f){if(!this.Panel.CheckIsOpened()){this.Panel.Show(d,g,f);}};FCKMenuBlockPanel.prototype.Hide=function(){if(this.Panel.CheckIsOpened()){this.Panel.Hide();}};var FCKContextMenu=function(g,h){this.CtrlDisable=false;var i=this._Panel=new FCKPanel(g);i.AppendStyleSheet(FCKConfig.SkinEditorCSS);i.IsContextMenu=true;if(FCKBrowserInfo.IsGecko){i.Document.addEventListener("draggesture",function(a){a.preventDefault();return false;},true);}var f=this._MenuBlock=new FCKMenuBlock();f.Panel=i;f.OnClick=FCKTools.CreateEventListener(FCKContextMenu_MenuBlock_OnClick,this);this._Redraw=true;};FCKContextMenu.prototype.SetMouseClickWindow=function(b){if(!FCKBrowserInfo.IsIE){this._Document=b.document;if(FCKBrowserInfo.IsOpera&&!("oncontextmenu" in document.createElement("foo"))){this._Document.addEventListener("mousedown",FCKContextMenu_Document_OnMouseDown,false);this._Document.addEventListener("mouseup",FCKContextMenu_Document_OnMouseUp,false);}this._Document.addEventListener("contextmenu",FCKContextMenu_Document_OnContextMenu,false);}};FCKContextMenu.prototype.AddItem=function(i,j,k,l,m){var h=this._MenuBlock.AddItem(i,j,k,l,m);this._Redraw=true;return h;};FCKContextMenu.prototype.AddSeparator=function(){this._MenuBlock.AddSeparator();this._Redraw=true;};FCKContextMenu.prototype.RemoveAllItems=function(){this._MenuBlock.RemoveAllItems();this._Redraw=true;};FCKContextMenu.prototype.AttachToElement=function(b){if(FCKBrowserInfo.IsIE){FCKTools.AddEventListenerEx(b,"contextmenu",FCKContextMenu_AttachedElement_OnContextMenu,this);}else{b._FCKContextMenu=this;}};function FCKContextMenu_Document_OnContextMenu(c){if(FCKConfig.BrowserContextMenu){return true;}var d=c.target;while(d){if(d._FCKContextMenu){if(d._FCKContextMenu.CtrlDisable&&(c.ctrlKey||c.metaKey)){return true;}FCKTools.CancelEvent(c);FCKContextMenu_AttachedElement_OnContextMenu(c,d._FCKContextMenu,d);return false;}d=d.parentNode;}return true;}var FCKContextMenu_OverrideButton;function FCKContextMenu_Document_OnMouseDown(k){if(!k||k.button!=2){return false;}if(FCKConfig.BrowserContextMenu){return true;}var h=k.target;while(h){if(h._FCKContextMenu){if(h._FCKContextMenu.CtrlDisable&&(k.ctrlKey||k.metaKey)){return true;}var i=FCKContextMenu_OverrideButton;if(!i){var j=FCKTools.GetElementDocument(k.target);i=FCKContextMenu_OverrideButton=j.createElement("input");i.type="button";var g=j.createElement("p");j.body.appendChild(g);g.appendChild(i);}i.style.cssText="position:absolute;top:"+(k.clientY-2)+"px;left:"+(k.clientX-2)+"px;width:5px;height:5px;opacity:0.01";}h=h.parentNode;}return false;}function FCKContextMenu_Document_OnMouseUp(d){if(FCKConfig.BrowserContextMenu){return true;}var f=FCKContextMenu_OverrideButton;if(f){var g=f.parentNode;g.parentNode.removeChild(g);FCKContextMenu_OverrideButton=undefined;if(d&&d.button==2){FCKContextMenu_Document_OnContextMenu(d);return false;}}return true;}function FCKContextMenu_AttachedElement_OnContextMenu(h,j,l){if((j.CtrlDisable&&(h.ctrlKey||h.metaKey))||FCKConfig.BrowserContextMenu){return true;}var m=l||this;if(j.OnBeforeOpen){j.OnBeforeOpen.call(j,m);}if(j._MenuBlock.Count()==0){return false;}if(j._Redraw){j._MenuBlock.Create(j._Panel.MainNode);j._Redraw=false;}FCKTools.DisableSelection(j._Panel.Document.body);var i=0;var k=0;if(FCKBrowserInfo.IsIE){i=h.screenX;k=h.screenY;}else{if(FCKBrowserInfo.IsSafari){i=h.clientX;k=h.clientY;}else{i=h.pageX;k=h.pageY;}}j._Panel.Show(i,k,h.currentTarget||null);return false;}function FCKContextMenu_MenuBlock_OnClick(d,c){c._Panel.Hide();FCKTools.RunFunction(c.OnItemClick,c,d);}FCK.ContextMenu={};FCK.ContextMenu.Listeners=[];FCK.ContextMenu.RegisterListener=function(b){if(b){this.Listeners.push(b);}};function FCK_ContextMenu_Init(){var f=FCK.ContextMenu._InnerContextMenu=new FCKContextMenu(FCKBrowserInfo.IsIE?window:window.parent,FCKLang.Dir);f.CtrlDisable=FCKConfig.BrowserContextMenuOnCtrl;f.OnBeforeOpen=FCK_ContextMenu_OnBeforeOpen;f.OnItemClick=FCK_ContextMenu_OnItemClick;var g=FCK.ContextMenu;for(var d=0;d<FCKConfig.ContextMenu.length;d++){g.RegisterListener(FCK_ContextMenu_GetListener(FCKConfig.ContextMenu[d]));}}function FCK_ContextMenu_GetListener(b){switch(b){case"Generic":return{AddItems:function(f,a,g){f.AddItem("Cut",FCKLang.Cut,7,FCKCommands.GetCommand("Cut").GetState()==-1);f.AddItem("Copy",FCKLang.Copy,8,FCKCommands.GetCommand("Copy").GetState()==-1);f.AddItem("Paste",FCKLang.Paste,9,FCKCommands.GetCommand("Paste").GetState()==-1);}};case"Table":return{AddItems:function(j,a,m){var i=(m=="TABLE");var k=(!i&&FCKSelection.HasAncestorNode("TABLE")&&!FCKSelection.IsGridNode());if(k){j.AddSeparator();var l=j.AddItem("Cell",FCKLang.CellCM);l.AddItem("TableInsertCellBefore",FCKLang.InsertCellBefore,69);l.AddItem("TableInsertCellAfter",FCKLang.InsertCellAfter,58);l.AddItem("TableDeleteCells",FCKLang.DeleteCells,59);if(FCKBrowserInfo.IsGecko){l.AddItem("TableMergeCells",FCKLang.MergeCells,60,FCKCommands.GetCommand("TableMergeCells").GetState()==-1);}else{l.AddItem("TableMergeRight",FCKLang.MergeRight,60,FCKCommands.GetCommand("TableMergeRight").GetState()==-1);l.AddItem("TableMergeDown",FCKLang.MergeDown,60,FCKCommands.GetCommand("TableMergeDown").GetState()==-1);}l.AddItem("TableHorizontalSplitCell",FCKLang.HorizontalSplitCell,61,FCKCommands.GetCommand("TableHorizontalSplitCell").GetState()==-1);l.AddItem("TableVerticalSplitCell",FCKLang.VerticalSplitCell,61,FCKCommands.GetCommand("TableVerticalSplitCell").GetState()==-1);l.AddSeparator();l.AddItem("TableCellProp",FCKLang.CellProperties,57,FCKCommands.GetCommand("TableCellProp").GetState()==-1);j.AddSeparator();l=j.AddItem("Row",FCKLang.RowCM);l.AddItem("TableInsertRowBefore",FCKLang.InsertRowBefore,70);l.AddItem("TableInsertRowAfter",FCKLang.InsertRowAfter,62);l.AddItem("TableDeleteRows",FCKLang.DeleteRows,63);j.AddSeparator();l=j.AddItem("Column",FCKLang.ColumnCM);l.AddItem("TableInsertColumnBefore",FCKLang.InsertColumnBefore,71);l.AddItem("TableInsertColumnAfter",FCKLang.InsertColumnAfter,64);l.AddItem("TableDeleteColumns",FCKLang.DeleteColumns,65);}if(i||k){j.AddSeparator();j.AddItem("TableDelete",FCKLang.TableDelete);j.AddItem("TableProp",FCKLang.TableProperties,39);}}};case"Link":return{AddItems:function(i,a,m){var j=(m=="A"||FCKSelection.HasAncestorNode("A"));if(j||FCK.GetNamedCommandState("Unlink")!=-1){var k=FCKSelection.MoveToAncestorNode("A");var l=(k&&k.name.length>0&&k.href.length==0);if(l){return;}i.AddSeparator();i.AddItem("VisitLink",FCKLang.VisitLink);i.AddSeparator();if(j){i.AddItem("Link",FCKLang.EditLink,34);}i.AddItem("Unlink",FCKLang.RemoveLink,35);}}};case"Image":return{AddItems:function(f,a,g){if(g=="IMG"&&!a.getAttribute("_fckfakelement")){f.AddSeparator();f.AddItem("Image",FCKLang.ImageProperties,37);}}};case"Anchor":return{AddItems:function(h,a,k){var i=FCKSelection.MoveToAncestorNode("A");var j=(i&&i.name.length>0);if(j||(k=="IMG"&&a.getAttribute("_fckanchor"))){h.AddSeparator();h.AddItem("Anchor",FCKLang.AnchorProp,36);h.AddItem("AnchorDelete",FCKLang.AnchorDelete);}}};case"Flash":return{AddItems:function(f,a,g){if(g=="IMG"&&a.getAttribute("_fckflash")){f.AddSeparator();f.AddItem("Flash",FCKLang.FlashProperties,38);}}};case"Form":return{AddItems:function(f,a,g){if(FCKSelection.HasAncestorNode("FORM")){f.AddSeparator();f.AddItem("Form",FCKLang.FormProp,48);}}};case"Checkbox":return{AddItems:function(f,a,g){if(g=="INPUT"&&a.type=="checkbox"){f.AddSeparator();f.AddItem("Checkbox",FCKLang.CheckboxProp,49);}}};case"Radio":return{AddItems:function(f,a,g){if(g=="INPUT"&&a.type=="radio"){f.AddSeparator();f.AddItem("Radio",FCKLang.RadioButtonProp,50);}}};case"TextField":return{AddItems:function(f,a,g){if(g=="INPUT"&&(a.type=="text"||a.type=="password")){f.AddSeparator();f.AddItem("TextField",FCKLang.TextFieldProp,51);}}};case"HiddenField":return{AddItems:function(f,a,g){if(g=="IMG"&&a.getAttribute("_fckinputhidden")){f.AddSeparator();f.AddItem("HiddenField",FCKLang.HiddenFieldProp,56);}}};case"ImageButton":return{AddItems:function(f,a,g){if(g=="INPUT"&&a.type=="image"){f.AddSeparator();f.AddItem("ImageButton",FCKLang.ImageButtonProp,55);}}};case"Button":return{AddItems:function(f,a,g){if(g=="INPUT"&&(a.type=="button"||a.type=="submit"||a.type=="reset")){f.AddSeparator();f.AddItem("Button",FCKLang.ButtonProp,54);}}};case"Select":return{AddItems:function(f,a,g){if(g=="SELECT"){f.AddSeparator();f.AddItem("Select",FCKLang.SelectionFieldProp,53);}}};case"Textarea":return{AddItems:function(f,a,g){if(g=="TEXTAREA"){f.AddSeparator();f.AddItem("Textarea",FCKLang.TextareaProp,52);}}};case"BulletedList":return{AddItems:function(f,a,g){if(FCKSelection.HasAncestorNode("UL")){f.AddSeparator();f.AddItem("BulletedList",FCKLang.BulletedListProp,27);}}};case"NumberedList":return{AddItems:function(f,a,g){if(FCKSelection.HasAncestorNode("OL")){f.AddSeparator();f.AddItem("NumberedList",FCKLang.NumberedListProp,26);}}};case"DivContainer":return{AddItems:function(g,a,h){var i=FCKDomTools.GetSelectedDivContainers();if(i.length>0){g.AddSeparator();g.AddItem("EditDiv",FCKLang.EditDiv,75);g.AddItem("DeleteDiv",FCKLang.DeleteDiv,76);}}};}return null;}function FCK_ContextMenu_OnBeforeOpen(){FCK.Events.FireEvent("OnSelectionChange");var h,g;if((h=FCKSelection.GetSelectedElement())){g=h.tagName;}var i=FCK.ContextMenu._InnerContextMenu;i.RemoveAllItems();var j=FCK.ContextMenu.Listeners;for(var k=0;k<j.length;k++){j[k].AddItems(i,h,g);}}function FCK_ContextMenu_OnItemClick(b){if(!FCKBrowserInfo.IsIE){FCK.Focus();}FCKCommands.GetCommand(b.Name).Execute(b.CustomData);}var FCKHtmlIterator=function(b){this._sourceHtml=b;};FCKHtmlIterator.prototype={Next:function(){var g=this._sourceHtml;if(g==null){return null;}var h=FCKRegexLib.HtmlTag.exec(g);var i=false;var f="";if(h){if(h.index>0){f=g.substr(0,h.index);this._sourceHtml=g.substr(h.index);}else{i=true;f=h[0];this._sourceHtml=g.substr(h[0].length);}}else{f=g;this._sourceHtml=null;}return{"isTag":i,"value":f};},Each:function(d){var c;while((c=this.Next())){d(c.isTag,c.value);}}};var FCKHtmlIterator=function(b){this._sourceHtml=b;};FCKHtmlIterator.prototype={Next:function(){var g=this._sourceHtml;if(g==null){return null;}var h=FCKRegexLib.HtmlTag.exec(g);var i=false;var f="";if(h){if(h.index>0){f=g.substr(0,h.index);this._sourceHtml=g.substr(h.index);}else{i=true;f=h[0];this._sourceHtml=g.substr(h[0].length);}}else{f=g;this._sourceHtml=null;}return{"isTag":i,"value":f};},Each:function(d){var c;while((c=this.Next())){d(c.isTag,c.value);}}};var FCKPlugin=function(f,g,d){this.Name=f;this.BasePath=d?d:FCKConfig.PluginsPath;this.Path=this.BasePath+f+"/";if(!g||g.length==0){this.AvailableLangs=[];}else{this.AvailableLangs=g.split(",");}};FCKPlugin.prototype.Load=function(){if(this.AvailableLangs.length>0){var b;if(this.AvailableLangs.IndexOf(FCKLanguageManager.ActiveLanguage.Code)>=0){b=FCKLanguageManager.ActiveLanguage.Code;}else{b=this.AvailableLangs[0];}LoadScript(this.Path+"lang/"+b+".js");}LoadScript(this.Path+"fckplugin.js");};var FCKPlugins=FCK.Plugins={};FCKPlugins.ItemsCount=0;FCKPlugins.Items={};FCKPlugins.Load=function(){var h=FCKPlugins.Items;for(var g=0;g<FCKConfig.Plugins.Items.length;g++){var i=FCKConfig.Plugins.Items[g];var j=h[i[0]]=new FCKPlugin(i[0],i[1],i[2]);FCKPlugins.ItemsCount++;}for(var k in h){h[k].Load();}FCKPlugins.Load=null;};