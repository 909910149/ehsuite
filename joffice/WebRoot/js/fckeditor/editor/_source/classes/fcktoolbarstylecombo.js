var FCKToolbarStyleCombo=function(c,d){if(c===false){return;}this.CommandName="Style";this.Label=this.GetLabel();this.Tooltip=c?c:this.Label;this.Style=d?d:FCK_TOOLBARITEM_ICONTEXT;this.DefaultLabel=FCKConfig.DefaultStyleLabel||"";};FCKToolbarStyleCombo.prototype=new FCKToolbarSpecialCombo;FCKToolbarStyleCombo.prototype.GetLabel=function(){return FCKLang.Style;};FCKToolbarStyleCombo.prototype.GetStyles=function(){var g={};var e=FCK.ToolbarSet.CurrentInstance.Styles.GetStyles();for(var f in e){var h=e[f];if(!h.IsCore){g[f]=h;}}return g;};FCKToolbarStyleCombo.prototype.CreateItems=function(j){var n=j._Panel.Document;FCKTools.AppendStyleSheet(n,FCKConfig.ToolbarComboPreviewCSS);FCKTools.AppendStyleString(n,FCKConfig.EditorAreaStyles);n.body.className+=" ForceBaseFont";FCKConfig.ApplyBodyAttributes(n.body);var k=this.GetStyles();for(var h in k){var m=k[h];var i=m.GetType()==FCK_STYLE_OBJECT?h:FCKToolbarStyleCombo_BuildPreview(m,m.Label||h);var l=j.AddItem(h,i);l.Style=m;}j.OnBeforeClick=this.StyleCombo_OnBeforeClick;};FCKToolbarStyleCombo.prototype.RefreshActiveItems=function(k){var p=FCK.ToolbarSet.CurrentInstance.Selection.GetBoundaryParentElement(true);if(p){var l=new FCKElementPath(p);var n=l.Elements;for(var m=0;m<n.length;m++){for(var i in k.Items){var o=k.Items[i];var e=o.Style;if(e.CheckElementRemovable(n[m],true)){k.SetLabel(e.Label||e.Name);return;}}}}k.SetLabel(this.DefaultLabel);};FCKToolbarStyleCombo.prototype.StyleCombo_OnBeforeClick=function(k){k.DeselectAll();var n;var l;var i;var o=FCK.ToolbarSet.CurrentInstance.Selection;if(o.GetType()=="Control"){n=o.GetSelectedElement();i=n.nodeName.toLowerCase();}else{n=o.GetBoundaryParentElement(true);l=new FCKElementPath(n);}for(var j in k.Items){var m=k.Items[j];var p=m.Style;if((i&&p.Element==i)||(!i&&p.GetType()!=FCK_STYLE_OBJECT)){m.style.display="";if((l&&p.CheckActive(l))||(!l&&p.CheckElementRemovable(n,true))){k.SelectItem(p.Name);}}else{m.style.display="none";}}};function FCKToolbarStyleCombo_BuildPreview(l,n){var k=l.GetType();var m=[];if(k==FCK_STYLE_BLOCK){m.push('<div class="BaseFont">');}var i=l.Element;if(i=="bdo"){i="span";}m=["<",i];var j=l._StyleDesc.Attributes;if(j){for(var h in j){m.push(" ",h,'="',l.GetFinalAttributeValue(h),'"');}}if(l._GetStyleText().length>0){m.push(' style="',l.GetFinalStyleValue(),'"');}m.push(">",n,"</",i,">");if(k==FCK_STYLE_BLOCK){m.push("</div>");}return m.join("");}