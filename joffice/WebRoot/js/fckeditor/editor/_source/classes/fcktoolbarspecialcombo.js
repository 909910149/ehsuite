var FCKToolbarSpecialCombo=function(){this.SourceView=false;this.ContextSensitive=true;this.FieldWidth=null;this.PanelWidth=null;this.PanelMaxHeight=null;};FCKToolbarSpecialCombo.prototype.DefaultLabel="";function FCKToolbarSpecialCombo_OnSelect(c,d){FCK.ToolbarSet.CurrentInstance.Commands.GetCommand(this.CommandName).Execute(c,d);}FCKToolbarSpecialCombo.prototype.Create=function(b){this._Combo=new FCKSpecialCombo(this.GetLabel(),this.FieldWidth,this.PanelWidth,this.PanelMaxHeight,FCKBrowserInfo.IsIE?window:FCKTools.GetElementWindow(b).parent);this._Combo.Tooltip=this.Tooltip;this._Combo.Style=this.Style;this.CreateItems(this._Combo);this._Combo.Create(b);this._Combo.CommandName=this.CommandName;this._Combo.OnSelect=FCKToolbarSpecialCombo_OnSelect;};function FCKToolbarSpecialCombo_RefreshActiveItems(c,d){c.DeselectAll();c.SelectItem(d);c.SetLabelById(d);}FCKToolbarSpecialCombo.prototype.RefreshState=function(){var d;var c=FCK.ToolbarSet.CurrentInstance.Commands.GetCommand(this.CommandName).GetState();if(c!=FCK_TRISTATE_DISABLED){d=FCK_TRISTATE_ON;if(this.RefreshActiveItems){this.RefreshActiveItems(this._Combo,c);}else{if(this._LastValue!==c){this._LastValue=c;if(!c||c.length==0){this._Combo.DeselectAll();this._Combo.SetLabel(this.DefaultLabel);}else{FCKToolbarSpecialCombo_RefreshActiveItems(this._Combo,c);}}}}else{d=FCK_TRISTATE_DISABLED;}if(d==this.State){return;}if(d==FCK_TRISTATE_DISABLED){this._Combo.DeselectAll();this._Combo.SetLabel("");}this.State=d;this._Combo.SetEnabled(d!=FCK_TRISTATE_DISABLED);};FCKToolbarSpecialCombo.prototype.Enable=function(){this.RefreshState();};FCKToolbarSpecialCombo.prototype.Disable=function(){this.State=FCK_TRISTATE_DISABLED;this._Combo.DeselectAll();this._Combo.SetLabel("");this._Combo.SetEnabled(false);};