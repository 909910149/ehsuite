FCKDomRange.prototype.MoveToSelection=function(){this.Release(true);var b=this.Window.getSelection();if(b&&b.rangeCount>0){this._Range=FCKW3CRange.CreateFromRange(this.Window.document,b.getRangeAt(0));this._UpdateElementInfo();}else{if(this.Window.document){this.MoveToElementStart(this.Window.document.body);}}};FCKDomRange.prototype.Select=function(){var h=this._Range;if(h){var j=h.startContainer;if(h.collapsed&&j.nodeType==1&&j.childNodes.length==0){j.appendChild(h._Document.createTextNode(""));}var e=this.Window.document.createRange();e.setStart(j,h.startOffset);try{e.setEnd(h.endContainer,h.endOffset);}catch(i){if(i.toString().Contains("NS_ERROR_ILLEGAL_VALUE")){h.collapse(true);e.setEnd(h.endContainer,h.endOffset);}else{throw (i);}}var g=this.Window.getSelection();g.removeAllRanges();g.addRange(e);}};FCKDomRange.prototype.SelectBookmark=function(h){var f=this.Window.document.createRange();var j=this.GetBookmarkNode(h,true);var g=this.GetBookmarkNode(h,false);f.setStart(j.parentNode,FCKDomTools.GetIndexOf(j));FCKDomTools.RemoveNode(j);if(g){f.setEnd(g.parentNode,FCKDomTools.GetIndexOf(g));FCKDomTools.RemoveNode(g);}var i=this.Window.getSelection();i.removeAllRanges();i.addRange(f);};