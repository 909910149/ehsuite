var FCKKeystrokeHandler=function(b){this.Keystrokes=new Object();this.CancelCtrlDefaults=(b!==false);};FCKKeystrokeHandler.prototype.AttachToElement=function(b){FCKTools.AddEventListenerEx(b,"keydown",_FCKKeystrokeHandler_OnKeyDown,this);if(FCKBrowserInfo.IsGecko10||FCKBrowserInfo.IsOpera||(FCKBrowserInfo.IsGecko&&FCKBrowserInfo.IsMac)){FCKTools.AddEventListenerEx(b,"keypress",_FCKKeystrokeHandler_OnKeyPress,this);}};FCKKeystrokeHandler.prototype.SetKeystrokes=function(){for(var d=0;d<arguments.length;d++){var c=arguments[d];if(!c){continue;}if(typeof(c[0])=="object"){this.SetKeystrokes.apply(this,c);}else{if(c.length==1){delete this.Keystrokes[c[0]];}else{this.Keystrokes[c[0]]=c[1]===true?true:c;}}}};function _FCKKeystrokeHandler_OnKeyDown(m,i){var j=m.keyCode||m.which;var k=0;if(m.ctrlKey||m.metaKey){k+=CTRL;}if(m.shiftKey){k+=SHIFT;}if(m.altKey){k+=ALT;}var h=j+k;var n=i._CancelIt=false;var l=i.Keystrokes[h];if(l){if(l===true||!(i.OnKeystroke&&i.OnKeystroke.apply(i,l))){return true;}n=true;}if(n||(i.CancelCtrlDefaults&&k==CTRL&&(j<33||j>40))){i._CancelIt=true;if(m.preventDefault){return m.preventDefault();}m.returnValue=false;m.cancelBubble=true;return false;}return true;}function _FCKKeystrokeHandler_OnKeyPress(c,d){if(d._CancelIt){if(c.preventDefault){return c.preventDefault();}return false;}return true;}