var FCKFitWindow=function(){this.Name="FitWindow";};FCKFitWindow.prototype.Execute=function(){var w=window.frameElement;var q=w.style;var o=parent;var m=o.document.documentElement;var x=o.document.body;var r=x.style;var p;var u,s;if(FCK.EditMode==FCK_EDITMODE_WYSIWYG){u=new FCKDomRange(FCK.EditorWindow);u.MoveToSelection();s=FCKTools.GetScrollPosition(FCK.EditorWindow);}else{var v=FCK.EditingArea.Textarea;u=!FCKBrowserInfo.IsIE&&[v.selectionStart,v.selectionEnd];s=[v.scrollLeft,v.scrollTop];}if(!this.IsMaximized){if(FCKBrowserInfo.IsIE){o.attachEvent("onresize",FCKFitWindow_Resize);}else{o.addEventListener("resize",FCKFitWindow_Resize,true);}this._ScrollPos=FCKTools.GetScrollPosition(o);p=w;while((p=p.parentNode)){if(p.nodeType==1){p._fckSavedStyles=FCKTools.SaveStyles(p);p.style.zIndex=FCKConfig.FloatingPanelsZIndex-1;}}if(FCKBrowserInfo.IsIE){this.documentElementOverflow=m.style.overflow;m.style.overflow="hidden";r.overflow="hidden";}else{r.overflow="hidden";r.width="0px";r.height="0px";}this._EditorFrameStyles=FCKTools.SaveStyles(w);var t=FCKTools.GetViewPaneSize(o);q.position="absolute";w.offsetLeft;q.zIndex=FCKConfig.FloatingPanelsZIndex-1;q.left="0px";q.top="0px";q.width=t.Width+"px";q.height=t.Height+"px";if(!FCKBrowserInfo.IsIE){q.borderRight=q.borderBottom="9999px solid white";q.backgroundColor="white";}o.scrollTo(0,0);var n=FCKTools.GetWindowPosition(o,w);if(n.x!=0){q.left=(-1*n.x)+"px";}if(n.y!=0){q.top=(-1*n.y)+"px";}this.IsMaximized=true;}else{if(FCKBrowserInfo.IsIE){o.detachEvent("onresize",FCKFitWindow_Resize);}else{o.removeEventListener("resize",FCKFitWindow_Resize,true);}p=w;while((p=p.parentNode)){if(p._fckSavedStyles){FCKTools.RestoreStyles(p,p._fckSavedStyles);p._fckSavedStyles=null;}}if(FCKBrowserInfo.IsIE){m.style.overflow=this.documentElementOverflow;}FCKTools.RestoreStyles(w,this._EditorFrameStyles);o.scrollTo(this._ScrollPos.X,this._ScrollPos.Y);this.IsMaximized=false;}FCKToolbarItems.GetItem("FitWindow").RefreshState();if(FCK.EditMode==FCK_EDITMODE_WYSIWYG){FCK.EditingArea.MakeEditable();}FCK.Focus();if(FCK.EditMode==FCK_EDITMODE_WYSIWYG){u.Select();FCK.EditorWindow.scrollTo(s.X,s.Y);}else{if(!FCKBrowserInfo.IsIE){v.selectionStart=u[0];v.selectionEnd=u[1];}v.scrollLeft=s[0];v.scrollTop=s[1];}};FCKFitWindow.prototype.GetState=function(){if(FCKConfig.ToolbarLocation!="In"){return FCK_TRISTATE_DISABLED;}else{return(this.IsMaximized?FCK_TRISTATE_ON:FCK_TRISTATE_OFF);}};function FCKFitWindow_Resize(){var c=FCKTools.GetViewPaneSize(parent);var d=window.frameElement.style;d.width=c.Width+"px";d.height=c.Height+"px";}