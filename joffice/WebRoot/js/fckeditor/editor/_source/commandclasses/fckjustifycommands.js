var FCKJustifyCommand=function(d){this.AlignValue=d;var f=FCKConfig.ContentLangDirection.toLowerCase();this.IsDefaultAlign=(d=="left"&&f=="ltr")||(d=="right"&&f=="rtl");var e=this._CssClassName=(function(){var a=FCKConfig.JustifyClasses;if(a){switch(d){case"left":return a[0]||null;case"center":return a[1]||null;case"right":return a[2]||null;case"justify":return a[3]||null;}}return null;})();if(e&&e.length>0){this._CssClassRegex=new RegExp("(?:^|\\s+)"+e+"(?=$|\\s)");}};FCKJustifyCommand._GetClassNameRegex=function(){var i=FCKJustifyCommand._ClassRegex;if(i!=undefined){return i;}var h=[];var f=FCKConfig.JustifyClasses;if(f){for(var g=0;g<4;g++){var j=f[g];if(j&&j.length>0){h.push(j);}}}if(h.length>0){i=new RegExp("(?:^|\\s+)(?:"+h.join("|")+")(?=$|\\s)");}else{i=null;}return FCKJustifyCommand._ClassRegex=i;};FCKJustifyCommand.prototype={Execute:function(){FCKUndo.SaveUndoStep();var i=new FCKDomRange(FCK.EditorWindow);i.MoveToSelection();var l=this.GetState();if(l==FCK_TRISTATE_DISABLED){return;}var m=i.CreateBookmark();var j=this._CssClassName;var n=new FCKDomRangeIterator(i);var k;while((k=n.GetNextParagraph())){k.removeAttribute("align");if(j){var o=k.className.replace(FCKJustifyCommand._GetClassNameRegex(),"");if(l==FCK_TRISTATE_OFF){if(o.length>0){o+=" ";}k.className=o+j;}else{if(o.length==0){FCKDomTools.RemoveAttribute(k,"class");}}}else{var p=k.style;if(l==FCK_TRISTATE_OFF){p.textAlign=this.AlignValue;}else{p.textAlign="";if(p.cssText.length==0){k.removeAttribute("style");}}}}i.MoveToBookmark(m);i.Select();FCK.Focus();FCK.Events.FireEvent("OnSelectionChange");},GetState:function(){if(FCK.EditMode!=FCK_EDITMODE_WYSIWYG||!FCK.EditorWindow){return FCK_TRISTATE_DISABLED;}var f=new FCKElementPath(FCKSelection.GetBoundaryParentElement(true));var e=f.Block||f.BlockLimit;if(!e||e.nodeName.toLowerCase()=="body"){return FCK_TRISTATE_OFF;}var d;if(FCKBrowserInfo.IsIE){d=e.currentStyle.textAlign;}else{d=FCK.EditorWindow.getComputedStyle(e,"").getPropertyValue("text-align");}d=d.replace(/(-moz-|-webkit-|start|auto)/i,"");if((!d&&this.IsDefaultAlign)||d==this.AlignValue){return FCK_TRISTATE_ON;}return FCK_TRISTATE_OFF;}};