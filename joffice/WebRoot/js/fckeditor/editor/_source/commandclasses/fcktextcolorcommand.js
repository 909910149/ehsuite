var FCKTextColorCommand=function(c){this.Name=c=="ForeColor"?"TextColor":"BGColor";this.Type=c;var d;if(FCKBrowserInfo.IsIE){d=window;}else{if(FCK.ToolbarSet._IFrame){d=FCKTools.GetElementWindow(FCK.ToolbarSet._IFrame);}else{d=window.parent;}}this._Panel=new FCKPanel(d);this._Panel.AppendStyleSheet(FCKConfig.SkinEditorCSS);this._Panel.MainNode.className="FCK_Panel";this._CreatePanelBody(this._Panel.Document,this._Panel.MainNode);FCK.ToolbarSet.ToolbarItems.GetItem(this.Name).RegisterPanel(this._Panel);FCKTools.DisableSelection(this._Panel.Document.body);};FCKTextColorCommand.prototype.Execute=function(f,d,e){this._Panel.Show(f,d,e);};FCKTextColorCommand.prototype.SetColor=function(d){FCKUndo.SaveUndoStep();var c=FCKStyles.GetStyle("_FCK_"+(this.Type=="ForeColor"?"Color":"BackColor"));if(!d||d.length==0){FCK.Styles.RemoveStyle(c);}else{c.SetVariable("Color",d);FCKStyles.ApplyStyle(c);}FCKUndo.SaveUndoStep();FCK.Focus();FCK.Events.FireEvent("OnSelectionChange");};FCKTextColorCommand.prototype.GetState=function(){if(FCK.EditMode!=FCK_EDITMODE_WYSIWYG){return FCK_TRISTATE_DISABLED;}return FCK_TRISTATE_OFF;};function FCKTextColorCommand_OnMouseOver(){this.className="ColorSelected";}function FCKTextColorCommand_OnMouseOut(){this.className="ColorDeselected";}function FCKTextColorCommand_OnClick(d,f,e){this.className="ColorDeselected";f.SetColor(e);f._Panel.Hide();}function FCKTextColorCommand_AutoOnClick(d,c){this.className="ColorDeselected";c.SetColor("");c._Panel.Hide();}function FCKTextColorCommand_MoreOnClick(d,c){this.className="ColorDeselected";c._Panel.Hide();FCKDialog.OpenDialog("FCKDialog_Color",FCKLang.DlgColorTitle,"dialog/fck_colorselector.html",410,320,FCKTools.Bind(c,c.SetColor));}FCKTextColorCommand.prototype._CreatePanelBody=function(s,v){function w(){var a=s.createElement("DIV");a.className="ColorDeselected";FCKTools.AddEventListenerEx(a,"mouseover",FCKTextColorCommand_OnMouseOver);FCKTools.AddEventListenerEx(a,"mouseout",FCKTextColorCommand_OnMouseOut);return a;}var q=v.appendChild(s.createElement("TABLE"));q.className="ForceBaseFont";q.style.tableLayout="fixed";q.cellPadding=0;q.cellSpacing=0;q.border=0;q.width=150;var t=q.insertRow(-1).insertCell(-1);t.colSpan=8;var x=t.appendChild(w());x.innerHTML='<table cellspacing="0" cellpadding="0" width="100%" border="0">			<tr>				<td><div class="ColorBoxBorder"><div class="ColorBox" style="background-color: #000000"></div></div></td>				<td nowrap width="100%" align="center">'+FCKLang.ColorAutomatic+"</td>			</tr>		</table>";FCKTools.AddEventListenerEx(x,"click",FCKTextColorCommand_AutoOnClick,this);if(!FCKBrowserInfo.IsIE){x.style.width="96%";}var o=FCKConfig.FontColors.toString().split(",");var p=0;while(p<o.length){var y=q.insertRow(-1);for(var u=0;u<8;u++,p++){if(p<o.length){var r=o[p].split("/");var z="#"+r[0];var i=r[1]||z;}x=y.insertCell(-1).appendChild(w());x.innerHTML='<div class="ColorBoxBorder"><div class="ColorBox" style="background-color: '+z+'"></div></div>';if(p>=o.length){x.style.visibility="hidden";}else{FCKTools.AddEventListenerEx(x,"click",FCKTextColorCommand_OnClick,[this,i]);}}}if(FCKConfig.EnableMoreFontColors){t=q.insertRow(-1).insertCell(-1);t.colSpan=8;x=t.appendChild(w());x.innerHTML='<table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td nowrap align="center">'+FCKLang.ColorMoreColors+"</td></tr></table>";FCKTools.AddEventListenerEx(x,"click",FCKTextColorCommand_MoreOnClick,this);if(!FCKBrowserInfo.IsIE){x.style.width="96%";}}};