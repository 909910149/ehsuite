var FCKDialog=(function(){var k;var j;var l;var e=window.parent;while(e.parent&&e.parent!=e){try{if(e.parent.document.domain!=document.domain){break;}if(e.parent.document.getElementsByTagName("frameset").length>0){break;}}catch(m){break;}e=e.parent;}var o=e.document;var n=function(){if(!j){j=FCKConfig.FloatingPanelsZIndex+999;}return ++j;};var p=function(){if(!l){return;}var a=FCKTools.IsStrictMode(o)?o.documentElement:o.body;FCKDomTools.SetElementStyles(l,{"width":Math.max(a.scrollWidth,a.clientWidth,o.scrollWidth||0)-1+"px","height":Math.max(a.scrollHeight,a.clientHeight,o.scrollHeight||0)-1+"px"});};return{OpenDialog:function(h,x,A,i,y,d,w){if(!k){this.DisplayMainCover();}var f={Title:x,Page:A,Editor:window,CustomValue:d,TopWindow:e};FCK.ToolbarSet.CurrentInstance.Selection.Save(true);var a=FCKTools.GetViewPaneSize(e);var B={"X":0,"Y":0};var z=FCKBrowserInfo.IsIE&&(!FCKBrowserInfo.IsIE7||!FCKTools.IsStrictMode(e.document));if(z){B=FCKTools.GetScrollPosition(e);}var g=Math.max(B.Y+(a.Height-y-20)/2,0);var c=Math.max(B.X+(a.Width-i-20)/2,0);var b=o.createElement("iframe");FCKTools.ResetStyles(b);b.src=FCKConfig.BasePath+"fckdialog.html";b.frameBorder=0;b.allowTransparency=true;FCKDomTools.SetElementStyles(b,{"position":(z)?"absolute":"fixed","top":g+"px","left":c+"px","width":i+"px","height":y+"px","zIndex":n()});b._DialogArguments=f;o.body.appendChild(b);b._ParentDialog=k;k=b;},OnDialogClose:function(a){var b=a.frameElement;FCKDomTools.RemoveNode(b);if(b._ParentDialog){k=b._ParentDialog;b._ParentDialog.contentWindow.SetEnabled(true);}else{if(!FCKBrowserInfo.IsIE){FCK.Focus();}this.HideMainCover();setTimeout(function(){k=null;},0);FCK.ToolbarSet.CurrentInstance.Selection.Release();}},DisplayMainCover:function(){l=o.createElement("div");FCKTools.ResetStyles(l);FCKDomTools.SetElementStyles(l,{"position":"absolute","zIndex":n(),"top":"0px","left":"0px","backgroundColor":FCKConfig.BackgroundBlockerColor});FCKDomTools.SetOpacity(l,FCKConfig.BackgroundBlockerOpacity);if(FCKBrowserInfo.IsIE&&!FCKBrowserInfo.IsIE7){var a=o.createElement("iframe");FCKTools.ResetStyles(a);a.hideFocus=true;a.frameBorder=0;a.src=FCKTools.GetVoidUrl();FCKDomTools.SetElementStyles(a,{"width":"100%","height":"100%","position":"absolute","left":"0px","top":"0px","filter":"progid:DXImageTransform.Microsoft.Alpha(opacity=0)"});l.appendChild(a);}FCKTools.AddEventListener(e,"resize",p);p();o.body.appendChild(l);FCKFocusManager.Lock();var b=FCK.ToolbarSet.CurrentInstance.GetInstanceObject("frameElement");b._fck_originalTabIndex=b.tabIndex;b.tabIndex=-1;},HideMainCover:function(){FCKDomTools.RemoveNode(l);FCKFocusManager.Unlock();var a=FCK.ToolbarSet.CurrentInstance.GetInstanceObject("frameElement");a.tabIndex=a._fck_originalTabIndex;FCKDomTools.ClearElementJSProperty(a,"_fck_originalTabIndex");},GetCover:function(){return l;}};})();