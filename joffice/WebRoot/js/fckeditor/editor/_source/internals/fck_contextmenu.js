FCK.ContextMenu=new Object();FCK.ContextMenu.Listeners=new Array();FCK.ContextMenu.RegisterListener=function(b){if(b){this.Listeners.push(b);}};function FCK_ContextMenu_Init(){var d=FCK.ContextMenu._InnerContextMenu=new FCKContextMenu(FCKBrowserInfo.IsIE?window:window.parent,FCKLang.Dir);d.CtrlDisable=FCKConfig.BrowserContextMenuOnCtrl;d.OnBeforeOpen=FCK_ContextMenu_OnBeforeOpen;d.OnItemClick=FCK_ContextMenu_OnItemClick;var e=FCK.ContextMenu;for(var f=0;f<FCKConfig.ContextMenu.length;f++){e.RegisterListener(FCK_ContextMenu_GetListener(FCKConfig.ContextMenu[f]));}}function FCK_ContextMenu_GetListener(b){switch(b){case"Generic":return{AddItems:function(e,a,f){e.AddItem("Cut",FCKLang.Cut,7,FCKCommands.GetCommand("Cut").GetState()==FCK_TRISTATE_DISABLED);e.AddItem("Copy",FCKLang.Copy,8,FCKCommands.GetCommand("Copy").GetState()==FCK_TRISTATE_DISABLED);e.AddItem("Paste",FCKLang.Paste,9,FCKCommands.GetCommand("Paste").GetState()==FCK_TRISTATE_DISABLED);}};case"Table":return{AddItems:function(h,a,j){var k=(j=="TABLE");var l=(!k&&FCKSelection.HasAncestorNode("TABLE"));if(l){h.AddSeparator();var i=h.AddItem("Cell",FCKLang.CellCM);i.AddItem("TableInsertCellBefore",FCKLang.InsertCellBefore,69);i.AddItem("TableInsertCellAfter",FCKLang.InsertCellAfter,58);i.AddItem("TableDeleteCells",FCKLang.DeleteCells,59);if(FCKBrowserInfo.IsGecko){i.AddItem("TableMergeCells",FCKLang.MergeCells,60,FCKCommands.GetCommand("TableMergeCells").GetState()==FCK_TRISTATE_DISABLED);}else{i.AddItem("TableMergeRight",FCKLang.MergeRight,60,FCKCommands.GetCommand("TableMergeRight").GetState()==FCK_TRISTATE_DISABLED);i.AddItem("TableMergeDown",FCKLang.MergeDown,60,FCKCommands.GetCommand("TableMergeDown").GetState()==FCK_TRISTATE_DISABLED);}i.AddItem("TableHorizontalSplitCell",FCKLang.HorizontalSplitCell,61,FCKCommands.GetCommand("TableHorizontalSplitCell").GetState()==FCK_TRISTATE_DISABLED);i.AddItem("TableVerticalSplitCell",FCKLang.VerticalSplitCell,61,FCKCommands.GetCommand("TableVerticalSplitCell").GetState()==FCK_TRISTATE_DISABLED);i.AddSeparator();i.AddItem("TableCellProp",FCKLang.CellProperties,57,FCKCommands.GetCommand("TableCellProp").GetState()==FCK_TRISTATE_DISABLED);h.AddSeparator();i=h.AddItem("Row",FCKLang.RowCM);i.AddItem("TableInsertRowBefore",FCKLang.InsertRowBefore,70);i.AddItem("TableInsertRowAfter",FCKLang.InsertRowAfter,62);i.AddItem("TableDeleteRows",FCKLang.DeleteRows,63);h.AddSeparator();i=h.AddItem("Column",FCKLang.ColumnCM);i.AddItem("TableInsertColumnBefore",FCKLang.InsertColumnBefore,71);i.AddItem("TableInsertColumnAfter",FCKLang.InsertColumnAfter,64);i.AddItem("TableDeleteColumns",FCKLang.DeleteColumns,65);}if(k||l){h.AddSeparator();h.AddItem("TableDelete",FCKLang.TableDelete);h.AddItem("TableProp",FCKLang.TableProperties,39);}}};case"Link":return{AddItems:function(h,a,k){var j=(k=="A"||FCKSelection.HasAncestorNode("A"));if(j||FCK.GetNamedCommandState("Unlink")!=FCK_TRISTATE_DISABLED){var i=FCKSelection.MoveToAncestorNode("A");var l=(i&&i.name.length>0&&i.href.length==0);if(l){return;}h.AddSeparator();h.AddItem("VisitLink",FCKLang.VisitLink);h.AddSeparator();if(j){h.AddItem("Link",FCKLang.EditLink,34);}h.AddItem("Unlink",FCKLang.RemoveLink,35);}}};case"Image":return{AddItems:function(e,a,f){if(f=="IMG"&&!a.getAttribute("_fckfakelement")){e.AddSeparator();e.AddItem("Image",FCKLang.ImageProperties,37);}}};case"Anchor":return{AddItems:function(g,a,i){var h=FCKSelection.MoveToAncestorNode("A");var j=(h&&h.name.length>0);if(j||(i=="IMG"&&a.getAttribute("_fckanchor"))){g.AddSeparator();g.AddItem("Anchor",FCKLang.AnchorProp,36);g.AddItem("AnchorDelete",FCKLang.AnchorDelete);}}};case"Flash":return{AddItems:function(e,a,f){if(f=="IMG"&&a.getAttribute("_fckflash")){e.AddSeparator();e.AddItem("Flash",FCKLang.FlashProperties,38);}}};case"Form":return{AddItems:function(e,a,f){if(FCKSelection.HasAncestorNode("FORM")){e.AddSeparator();e.AddItem("Form",FCKLang.FormProp,48);}}};case"Checkbox":return{AddItems:function(e,a,f){if(f=="INPUT"&&a.type=="checkbox"){e.AddSeparator();e.AddItem("Checkbox",FCKLang.CheckboxProp,49);}}};case"Radio":return{AddItems:function(e,a,f){if(f=="INPUT"&&a.type=="radio"){e.AddSeparator();e.AddItem("Radio",FCKLang.RadioButtonProp,50);}}};case"TextField":return{AddItems:function(e,a,f){if(f=="INPUT"&&(a.type=="text"||a.type=="password")){e.AddSeparator();e.AddItem("TextField",FCKLang.TextFieldProp,51);}}};case"HiddenField":return{AddItems:function(e,a,f){if(f=="IMG"&&a.getAttribute("_fckinputhidden")){e.AddSeparator();e.AddItem("HiddenField",FCKLang.HiddenFieldProp,56);}}};case"ImageButton":return{AddItems:function(e,a,f){if(f=="INPUT"&&a.type=="image"){e.AddSeparator();e.AddItem("ImageButton",FCKLang.ImageButtonProp,55);}}};case"Button":return{AddItems:function(e,a,f){if(f=="INPUT"&&(a.type=="button"||a.type=="submit"||a.type=="reset")){e.AddSeparator();e.AddItem("Button",FCKLang.ButtonProp,54);}}};case"Select":return{AddItems:function(e,a,f){if(f=="SELECT"){e.AddSeparator();e.AddItem("Select",FCKLang.SelectionFieldProp,53);}}};case"Textarea":return{AddItems:function(e,a,f){if(f=="TEXTAREA"){e.AddSeparator();e.AddItem("Textarea",FCKLang.TextareaProp,52);}}};case"BulletedList":return{AddItems:function(e,a,f){if(FCKSelection.HasAncestorNode("UL")){e.AddSeparator();e.AddItem("BulletedList",FCKLang.BulletedListProp,27);}}};case"NumberedList":return{AddItems:function(e,a,f){if(FCKSelection.HasAncestorNode("OL")){e.AddSeparator();e.AddItem("NumberedList",FCKLang.NumberedListProp,26);}}};case"DivContainer":return{AddItems:function(f,a,h){var g=FCKDomTools.GetSelectedDivContainers();if(g.length>0){f.AddSeparator();f.AddItem("EditDiv",FCKLang.EditDiv,75);f.AddItem("DeleteDiv",FCKLang.DeleteDiv,76);}}};}return null;}function FCK_ContextMenu_OnBeforeOpen(){FCK.Events.FireEvent("OnSelectionChange");var i,f;if((i=FCKSelection.GetSelectedElement())){f=i.tagName;}var g=FCK.ContextMenu._InnerContextMenu;g.RemoveAllItems();var h=FCK.ContextMenu.Listeners;for(var j=0;j<h.length;j++){h[j].AddItems(g,i,f);}}function FCK_ContextMenu_OnItemClick(b){if(!FCKBrowserInfo.IsIE){FCK.Focus();}FCKCommands.GetCommand(b.Name).Execute(b.CustomData);}