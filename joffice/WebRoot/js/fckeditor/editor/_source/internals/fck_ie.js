FCK.Description="FCKeditor for Internet Explorer 5.5+";FCK._GetBehaviorsStyle=function(){if(!FCK._BehaviorsStyle){var d=FCKConfig.BasePath;var f="";var e;e='<style type="text/css" _fcktemp="true">';if(FCKConfig.ShowBorders){f="url("+d+"css/behaviors/showtableborders.htc)";}e+="INPUT,TEXTAREA,SELECT,.FCK__Anchor,.FCK__PageBreak,.FCK__InputHidden";if(FCKConfig.DisableObjectResizing){e+=",IMG";f+=" url("+d+"css/behaviors/disablehandles.htc)";}e+=" { behavior: url("+d+"css/behaviors/disablehandles.htc) ; }";if(f.length>0){e+="TABLE { behavior: "+f+" ; }";}e+="</style>";FCK._BehaviorsStyle=e;}return FCK._BehaviorsStyle;};function Doc_OnMouseUp(){if(FCK.EditorWindow.event.srcElement.tagName=="HTML"){FCK.Focus();FCK.EditorWindow.event.cancelBubble=true;FCK.EditorWindow.event.returnValue=false;}}function Doc_OnPaste(){var d=FCK.EditorDocument.body;d.detachEvent("onpaste",Doc_OnPaste);var c=FCK.Paste(!FCKConfig.ForcePasteAsPlainText&&!FCKConfig.AutoDetectPasteFromWord);d.attachEvent("onpaste",Doc_OnPaste);return c;}function Doc_OnDblClick(){FCK.OnDoubleClick(FCK.EditorWindow.event.srcElement);FCK.EditorWindow.event.cancelBubble=true;}function Doc_OnSelectionChange(){if(!FCK.IsSelectionChangeLocked&&FCK.EditorDocument){FCK.Events.FireEvent("OnSelectionChange");}}function Doc_OnDrop(){if(FCK.MouseDownFlag){FCK.MouseDownFlag=false;return;}if(FCKConfig.ForcePasteAsPlainText){var b=FCK.EditorWindow.event;if(FCK._CheckIsPastingEnabled()||FCKConfig.ShowDropDialog){FCK.PasteAsPlainText(b.dataTransfer.getData("Text"));}b.returnValue=false;b.cancelBubble=true;}}FCK.InitializeBehaviors=function(b){this.EditorDocument.attachEvent("onmouseup",Doc_OnMouseUp);this.EditorDocument.body.attachEvent("onpaste",Doc_OnPaste);this.EditorDocument.body.attachEvent("ondrop",Doc_OnDrop);FCK.ContextMenu._InnerContextMenu.AttachToElement(FCK.EditorDocument.body);this.EditorDocument.attachEvent("onkeydown",FCK._KeyDownListener);this.EditorDocument.attachEvent("ondblclick",Doc_OnDblClick);this.EditorDocument.attachEvent("onbeforedeactivate",function(){FCKSelection.Save();});this.EditorDocument.attachEvent("onselectionchange",Doc_OnSelectionChange);FCKTools.AddEventListener(FCK.EditorDocument,"mousedown",Doc_OnMouseDown);};FCK.InsertHtml=function(f){f=FCKConfig.ProtectedSource.Protect(f);f=FCK.ProtectEvents(f);f=FCK.ProtectUrls(f);f=FCK.ProtectTags(f);FCKSelection.Restore();FCK.EditorWindow.focus();FCKUndo.SaveUndoStep();var e=FCKSelection.GetSelection();if(e.type.toLowerCase()=="control"){e.clear();}f='<span id="__fakeFCKRemove__" style="display:none;">fakeFCKRemove</span>'+f;e.createRange().pasteHTML(f);var d=FCK.EditorDocument.getElementById("__fakeFCKRemove__");if(d.parentNode.childNodes.length==1){d=d.parentNode;}d.removeNode(true);FCKDocumentProcessor.Process(FCK.EditorDocument);this.Events.FireEvent("OnSelectionChange");};FCK.SetInnerHtml=function(c){var d=FCK.EditorDocument;d.body.innerHTML='<div id="__fakeFCKRemove__">&nbsp;</div>'+c;d.getElementById("__fakeFCKRemove__").removeNode(true);};function FCK_PreloadImages(){var b=new FCKImagePreloader();b.AddImages(FCKConfig.PreloadImages);b.AddImages(FCKConfig.SkinPath+"fck_strip.gif");b.OnComplete=LoadToolbarSetup;b.Start();}function Document_OnContextMenu(){return(event.srcElement._FCKShowContextMenu==true);}document.oncontextmenu=Document_OnContextMenu;function FCK_Cleanup(){this.LinkedField=null;this.EditorWindow=null;this.EditorDocument=null;}FCK._ExecPaste=function(){if(FCK._PasteIsRunning){return true;}if(FCKConfig.ForcePasteAsPlainText){FCK.PasteAsPlainText();return false;}var c=FCK._CheckIsPastingEnabled(true);if(c===false){FCKTools.RunFunction(FCKDialog.OpenDialog,FCKDialog,["FCKDialog_Paste",FCKLang.Paste,"dialog/fck_paste.html",400,330,"Security"]);}else{if(FCKConfig.AutoDetectPasteFromWord&&c.length>0){var d=/<\w[^>]*(( class="?MsoNormal"?)|(="mso-))/gi;if(d.test(c)){if(confirm(FCKLang.PasteWordConfirm)){FCK.PasteFromWord();return false;}}}FCK._PasteIsRunning=true;FCK.ExecuteNamedCommand("Paste");delete FCK._PasteIsRunning;}return false;};FCK.PasteAsPlainText=function(h){if(!FCK._CheckIsPastingEnabled()){FCKDialog.OpenDialog("FCKDialog_Paste",FCKLang.PasteAsText,"dialog/fck_paste.html",400,330,"PlainText");return;}var f=null;if(!h){f=clipboardData.getData("Text");}else{f=h;}if(f&&f.length>0){f=FCKTools.HTMLEncode(f);f=FCKTools.ProcessLineBreaks(window,FCKConfig,f);var k=f.search("</p>");var g=f.search("<p>");if((k!=-1&&g!=-1&&k<g)||(k!=-1&&g==-1)){var j=f.substr(0,k);f=f.substr(k+4);this.InsertHtml(j);}FCKUndo.SaveLocked=true;this.InsertHtml(f);FCKUndo.SaveLocked=false;}};FCK._CheckIsPastingEnabled=function(d){FCK._PasteIsEnabled=false;document.body.attachEvent("onpaste",FCK_CheckPasting_Listener);var c=FCK.GetClipboardHTML();document.body.detachEvent("onpaste",FCK_CheckPasting_Listener);if(FCK._PasteIsEnabled){if(!d){c=true;}}else{c=false;}delete FCK._PasteIsEnabled;return c;};function FCK_CheckPasting_Listener(){FCK._PasteIsEnabled=true;}FCK.GetClipboardHTML=function(){var h=document.getElementById("___FCKHiddenDiv");if(!h){h=document.createElement("DIV");h.id="___FCKHiddenDiv";var e=h.style;e.position="absolute";e.visibility=e.overflow="hidden";e.width=e.height=1;document.body.appendChild(h);}h.innerHTML="";var g=document.body.createTextRange();g.moveToElementText(h);g.execCommand("Paste");var f=h.innerHTML;h.innerHTML="";return f;};FCK.CreateLink=function(w,t){var v=new Array();var n=FCKSelection.GetType()=="Control";var q=n&&FCKSelection.GetSelectedElement();if(!(n&&!FCKTools.GetElementAscensor(q,"a"))){FCK.ExecuteNamedCommand("Unlink",null,false,!!t);}if(w.length>0){if(n){var r=this.EditorDocument.createElement("A");r.href=w;var u=q;u.parentNode.insertBefore(r,u);u.parentNode.removeChild(u);r.appendChild(u);return[r];}var s="javascript:void(0);/*"+(new Date().getTime())+"*/";FCK.ExecuteNamedCommand("CreateLink",s,false,!!t);var o=this.EditorDocument.links;for(i=0;i<o.length;i++){var r=o[i];if(r.getAttribute("href",2)==s){var p=r.innerHTML;r.href=w;r.innerHTML=p;var m=r.lastChild;if(m&&m.nodeName=="BR"){FCKDomTools.InsertAfterNode(r,r.removeChild(m));}v.push(r);}}}return v;};function _FCK_RemoveDisabledAtt(){this.removeAttribute("disabled");}function Doc_OnMouseDown(d){var c=d.srcElement;if(c.nodeName&&c.nodeName.IEquals("input")&&c.type.IEquals(["radio","checkbox"])&&!c.disabled){c.disabled=true;FCKTools.SetTimeout(_FCK_RemoveDisabledAtt,1,c);}}