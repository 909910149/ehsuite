var FCKCodeFormatter=new Object();FCKCodeFormatter.Init=function(){var b=this.Regex=new Object();b.BlocksOpener=/\<(P|DIV|H1|H2|H3|H4|H5|H6|ADDRESS|PRE|OL|UL|LI|DL|DT|DD|TITLE|META|LINK|BASE|SCRIPT|LINK|TD|TH|AREA|OPTION)[^\>]*\>/gi;b.BlocksCloser=/\<\/(P|DIV|H1|H2|H3|H4|H5|H6|ADDRESS|PRE|OL|UL|LI|DL|DT|DD|TITLE|META|LINK|BASE|SCRIPT|LINK|TD|TH|AREA|OPTION)[^\>]*\>/gi;b.NewLineTags=/\<(BR|HR)[^\>]*\>/gi;b.MainTags=/\<\/?(HTML|HEAD|BODY|FORM|TABLE|TBODY|THEAD|TR)[^\>]*\>/gi;b.LineSplitter=/\s*\n+\s*/g;b.IncreaseIndent=/^\<(HTML|HEAD|BODY|FORM|TABLE|TBODY|THEAD|TR|UL|OL|DL)[ \/\>]/i;b.DecreaseIndent=/^\<\/(HTML|HEAD|BODY|FORM|TABLE|TBODY|THEAD|TR|UL|OL|DL)[ \>]/i;b.FormatIndentatorRemove=new RegExp("^"+FCKConfig.FormatIndentator);b.ProtectedTags=/(<PRE[^>]*>)([\s\S]*?)(<\/PRE>)/gi;};FCKCodeFormatter._ProtectData=function(f,e,h,g){return e+"___FCKpd___"+(FCKCodeFormatter.ProtectedData.push(h)-1)+g;};FCKCodeFormatter.Format=function(m){if(!this.Regex){this.Init();}FCKCodeFormatter.ProtectedData=new Array();var o=m.replace(this.Regex.ProtectedTags,FCKCodeFormatter._ProtectData);o=o.replace(this.Regex.BlocksOpener,"\n$&");o=o.replace(this.Regex.BlocksCloser,"$&\n");o=o.replace(this.Regex.NewLineTags,"$&\n");o=o.replace(this.Regex.MainTags,"\n$&\n");var k="";var p=o.split(this.Regex.LineSplitter);o="";for(var n=0;n<p.length;n++){var l=p[n];if(l.length==0){continue;}if(this.Regex.DecreaseIndent.test(l)){k=k.replace(this.Regex.FormatIndentatorRemove,"");}o+=k+l+"\n";if(this.Regex.IncreaseIndent.test(l)){k+=FCKConfig.FormatIndentator;}}for(var i=0;i<FCKCodeFormatter.ProtectedData.length;i++){var j=new RegExp("___FCKpd___"+i);o=o.replace(j,FCKCodeFormatter.ProtectedData[i].replace(/\$/g,"$$$$"));}return o.Trim();};