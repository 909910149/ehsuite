FCKCommands.RegisterCommand("dgrid",new FCKDialogCommand("dgrid",FCKLang.DgridProp,FCKPlugins.Items["dgrid"].Path+"fck_dgrid.html?Parent2",440,160));var oSItem=new FCKToolbarButton("dgrid",FCKLang.DgridButton);oSItem.IconPath=FCKPlugins.Items["dgrid"].Path+"grid.png";FCKToolbarItems.RegisterItem("dgrid",oSItem);FCKSelection.IsFormNode=function(){var c=this.GetSelectedElement();if(!c&&FCK.EditorWindow){try{c=this.GetSelection().getRangeAt(0).startContainer;}catch(d){}}while(c){if(c.nodeType==1&&c.nodeName.IEquals("TABLE")){if(c.getAttribute("isgrid")=="false"){return true;}return false;}c=c.parentNode;if(!c){break;}}return false;};FCKSelection.GetTableType=function(){var c=this.GetSelectedElement();if(!c&&FCK.EditorWindow){try{c=this.GetSelection().getRangeAt(0).startContainer;}catch(d){}}while(c){if(c.nodeType==1&&c.nodeName.IEquals("TABLE")){if(c.getAttribute("isgrid")=="true"){return"grid";}else{if(c.getAttribute("isgrid")=="false"){return"form";}else{return"table";}}}c=c.parentNode;if(!c){break;}}return"table";};FCK.ContextMenu.RegisterListener({AddItems:function(k,j,o){var p=(o=="TABLE");var m=FCKSelection.IsGridNode();var i=(!p&&FCKSelection.HasAncestorNode("TABLE")&&m);var n=FCKSelection.GetTableType();if(i){k.AddSeparator();var l=k.AddItem("Cell",FCKLang.CellCM);if(n=="form"){l.AddItem("TableInsertCellBefore",FCKLang.InsertCellBefore,69);l.AddItem("TableInsertCellAfter",FCKLang.InsertCellAfter,58);l.AddItem("TableDeleteCells",FCKLang.DeleteCells,59);if(FCKBrowserInfo.IsGecko){l.AddItem("TableMergeCells",FCKLang.MergeCells,60,FCKCommands.GetCommand("TableMergeCells").GetState()==FCK_TRISTATE_DISABLED);}else{l.AddItem("TableMergeRight",FCKLang.MergeRight,60,FCKCommands.GetCommand("TableMergeRight").GetState()==FCK_TRISTATE_DISABLED);}l.AddItem("TableHorizontalSplitCell",FCKLang.HorizontalSplitCell,61,FCKCommands.GetCommand("TableHorizontalSplitCell").GetState()==FCK_TRISTATE_DISABLED);l.AddSeparator();}l.AddItem("TableCellProp",FCKLang.CellProperties,57,FCKCommands.GetCommand("TableCellProp").GetState()==FCK_TRISTATE_DISABLED);if(n=="form"){k.AddSeparator();l=k.AddItem("Row",FCKLang.RowCM);l.AddItem("TableInsertRowBefore",FCKLang.InsertRowBefore,70);l.AddItem("TableInsertRowAfter",FCKLang.InsertRowAfter,62);l.AddItem("TableDeleteRows",FCKLang.DeleteRows,63);}k.AddSeparator();l=k.AddItem("Column",FCKLang.ColumnCM);l.AddItem("TableInsertColumnBefore",FCKLang.InsertColumnBefore,71);l.AddItem("TableInsertColumnAfter",FCKLang.InsertColumnAfter,64);l.AddItem("TableDeleteColumns",FCKLang.DeleteColumns,65);}if(p||i){k.AddSeparator();k.AddItem("TableDelete",FCKLang.TableDelete);k.AddItem("dgrid",FCKLang.DgridProp,FCKToolbarItems.GetItem("dgrid").IconPath);}}});