var FckToolbarTemplateCombo=function(d,c){if(d===false){return;}this.CommandName="dtemplates";this.Label=this.GetLabel();this.Tooltip=d?d:this.Label;this.Style=c?c:2;this.DefaultLabel="";};FckToolbarTemplateCombo.prototype=new FCKToolbarSpecialCombo;FckToolbarTemplateCombo.prototype.GetLabel=function(){return FCKLang.Template;};FckToolbarTemplateCombo.prototype.getTemplates=function(){LoadTemplatesXml();return FCK._DTemplates;};FckToolbarTemplateCombo.prototype.CreateItems=function(g){var h=g._Panel.Document;FCKTools.AppendStyleSheet(h,FCKConfig.ToolbarComboPreviewCSS);FCKTools.AppendStyleString(h,FCKConfig.EditorAreaStyles);h.body.className+=" ForceBaseFont";FCKConfig.ApplyBodyAttributes(h.body);var i=this.getTemplates();for(var j=0;j<i.length;j++){var f=i[j];g.AddItem(j,f.Title,f.Title);}};FckToolbarTemplateCombo.prototype.RefreshActiveItems=function(b){b.SetLabel(this.DefaultLabel);};function LoadTemplatesXml(){var n;if(!FCK._DTemplates){FCK._DTemplates=new Array();var m=new FCKXml();m.LoadUrl(FCKConfig.DTemplatesXmlPath);var o=m.SelectSingleNode("Templates/@imagesBasePath");var l=o?o.value:"";var j=m.SelectNodes("Templates/Template");for(var i=0;i<j.length;i++){var k=j[i];n=new Object();var p;if((p=k.attributes.getNamedItem("title"))){n.Title=p.value;}else{n.Title="Template "+(i+1);}if((p=m.SelectSingleNode("Description",k))){n.Description=p.text?p.text:p.textContent;}if((p=k.attributes.getNamedItem("image"))){n.Image=l+p.value;}if((p=m.SelectSingleNode("Html",k))){n.Html=p.text?p.text:p.textContent;}else{alert("No HTML defined for template index "+i+'. Please review the "'+FCKConfig.TemplatesXmlPath+'" file.');continue;}FCK._DTemplates[FCK._DTemplates.length]=n;}}}var FckTemplateCommand=function(){};FckTemplateCommand.prototype={Name:"dtemplates",Execute:function(d,c){FCKUndo.SaveUndoStep();FCK.SetData(FCK._DTemplates[d].Html);},GetState:function(){if(FCK.EditMode!=0||!FCK.EditorDocument){return -1;}return 0;}};FCKCommands.RegisterCommand("dtemplates",new FckTemplateCommand());FCKToolbarItems.RegisterItem("dtemplates",new FckToolbarTemplateCombo());