ProDefRightsForm=Ext.extend(Ext.Window,{constructor:function(b){Ext.applyIf(this,b);this.initUIComponents();ProDefRightsForm.superclass.constructor.call(this,{id:"ProDefRightsFormWin",layout:"fit",items:this.formPanel,modal:true,height:300,width:500,maximizable:true,title:"流程权限详细信息",buttonAlign:"center",buttons:[{text:"保存",iconCls:"btn-save",scope:this,handler:this.save},{text:"重置",iconCls:"btn-reset",scope:this,handler:this.reset},{text:"取消",iconCls:"btn-cancel",scope:this,handler:this.cancel}]});},initUIComponents:function(){this.formPanel=new Ext.FormPanel({layout:"form",bodyStyle:"padding:10px",border:false,autoScroll:true,defaults:{anchor:"96%,96%"},defaultType:"textfield",items:[{name:"proDefRights.rightsId",xtype:"hidden",value:this.rightsId==null?"":this.rightsId},{name:"proDefRights.proTypeId",xtype:"hidden",value:this.proTypeId?this.proTypeId:null},{name:"proDefRights.defId",xtype:"hidden",value:this.defId?this.defId:null},{name:"proDefRights.userIds",xtype:"hidden"},{name:"proDefRights.roleIds",xtype:"hidden"},{name:"proDefRights.depIds",xtype:"hidden"},{xtype:"compositefield",fieldLabel:"用户权限",items:[{width:255,name:"proDefRights.userNames",xtype:"textarea",maxLength:2000},{xtype:"button",iconCls:"btn-select",text:"选择人员",scope:this,handler:function(){fPanel=this.formPanel;UserSelector.getView(function(c,d){fPanel.getCmpByName("proDefRights.userNames").setValue(d);fPanel.getCmpByName("proDefRights.userIds").setValue(c);}).show();}}]},{xtype:"compositefield",fieldLabel:"角色权限",items:[{width:255,name:"proDefRights.roleNames",xtype:"textarea",maxLength:2000},{xtype:"button",iconCls:"btn-select",text:"选择角色",scope:this,handler:function(){fPanel=this.formPanel;RoleSelector.getView(function(c,d){fPanel.getCmpByName("proDefRights.roleNames").setValue(d);fPanel.getCmpByName("proDefRights.roleIds").setValue(c);}).show();}}]},{xtype:"compositefield",fieldLabel:"部门权限",items:[{width:255,name:"proDefRights.depNames",xtype:"textarea",maxLength:2000},{xtype:"button",iconCls:"btn-select",text:"选择部门",scope:this,handler:function(){fPanel=this.formPanel;DepSelector.getView(function(c,d){fPanel.getCmpByName("proDefRights.depNames").setValue(d);fPanel.getCmpByName("proDefRights.depIds").setValue(c);}).show();}}]}]});if(this.proTypeId!=null&&this.proTypeId!="undefined"){this.formPanel.loadData({url:__ctxPath+"/flow/getProDefRights.do?proTypeId="+this.proTypeId,root:"data",preName:"proDefRights"});}if(this.defId!=null&&this.defId!="undefined"){this.formPanel.loadData({url:__ctxPath+"/flow/getProDefRights.do?defId="+this.defId,root:"data",preName:"proDefRights"});}},reset:function(){this.formPanel.getForm().reset();},cancel:function(){this.close();},save:function(){$postForm({formPanel:this.formPanel,scope:this,url:__ctxPath+"/flow/saveProDefRights.do",callback:function(e,f){var d=Ext.getCmp("ProDefRightsGrid");if(d!=null){d.getStore().reload();}this.close();}});}});