var ProcessRunDetail=function(g,f,h,e){this.runId=g;this.defId=f;this.piId=h;this.name=e;return this.setup();};ProcessRunDetail.prototype.setup=function(){var k=this.piId;var h=this.defId;var l=new Ext.Panel({title:"流程示意图",width:500,autoScroll:true,height:800,split:true,collapsible:true,region:"west",margin:"5 5 5 5",html:'<img src="'+__ctxPath+"/jbpmImage?piId="+k+"&defId="+h+"&runId="+this.runId+"&rand="+Math.random()+'"/>'});var j=this.getRightPanel(this.piId,this.runId,this.defId);var i=new Ext.Toolbar({height:28,items:[{text:"刷新",iconCls:"btn-refresh",handler:function(){l.body.update('<img src="'+__ctxPath+"/jbpmImage?piId="+k+"&defId="+h+"&rand="+Math.random()+'"/>');j.doLayout(true);}},"-",{text:"打印表单",id:"formTablePrintButton",iconCls:"btn-print",scope:this,handler:function(){var c=this.formPanel.body;var a=c.dom.innerHTML;var b=window.open("","newwindow");b.document.write("<HEAD>");b.document.write("<TITLE>打印表单</TITLE>");b.document.write('<link rel="stylesheet" type="text/css" href="'+__ctxPath+'/css/admin.css"/>');b.document.write("</HEAD>");b.document.write("<BODY BGCOLOR=#ffffff>");b.document.write(a);b.document.write("</BODY>");b.document.write("</HTML>");b.document.close();}}]});var g=new Ext.Panel({id:"ProcessRunDetail"+this.runId,title:"流程详细－"+this.name,iconCls:"menu-flowEnd",layout:"border",tbar:i,autoScroll:true,items:[l,j]});return g;};ProcessRunDetail.prototype.getFormHtmlCallback=function(){var e=document.getElementById("entity_"+this.runId);var q=Ext.getCmp("formTablePrintButton");if(!e||(e!=null&&!e.value)){this.formPanel.hide();q.hide();return;}else{this.formPanel.show();q.show();}this.formPanel.doLayout();var s=this.formPanel;var u=this.formPanel.getForm().getEl().dom;var t=u.elements||(document.forms[u]||Ext.getDom(u)).elements;try{var v,o,n,r;var m=function(){var a=null;if(e!=null&&e.value){a=Ext.decode(e.value);}$converDetailToRead.call(this,a);};$ImportSimpleJs([__ctxPath+"/js/core/ntkoffice/NtkOfficePanel.js",__ctxPath+"/js/selector/SealSelector.js",__ctxPath+"/js/selector/PaintTemplateSelector.js"],m,this);}catch(p){}};ProcessRunDetail.prototype.getRightPanel=function(i,j,g){this.formPanel=new Ext.FormPanel({title:"流程表单信息",width:400,autoScroll:true,height:300,autoLoad:{url:__ctxPath+"/flow/getFormProcessActivity.do",nocache:true,params:{piId:i,runId:j,defId:g},scope:this,callback:this.getFormHtmlCallback}});var f=new Ext.Panel({title:"流程审批信息",region:"center",width:400,autoScroll:true,autoLoad:{url:__ctxPath+"/flow/processRunDetail.do?piId="+i+"&runId="+j,nocache:true}});var h=new Ext.Panel({region:"center",width:400,autoScroll:true,border:false,layout:"form",defaults:{anchor:"100% 100%"},items:[this.formPanel,f]});return h;};