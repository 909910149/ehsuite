Ext.ns("DocumentSharedView");var DocumentSharedView=function(){return new Ext.Panel({id:"DocumentSharedView",title:"共享文档列表",layout:"border",iconCls:"menu-folder-shared",autoScroll:true,items:[new Ext.FormPanel({id:"SharedDocumentForm",region:"north",height:40,frame:false,border:false,layout:"hbox",layoutConfig:{padding:"5",align:"middle"},defaults:{xtype:"label",margins:{top:0,right:4,bottom:4,left:4}},items:[{text:"文档名称"},{xtype:"textfield",name:"document.docName"},{text:"共享人"},{xtype:"textfield",name:"fullname"},{text:"创建时间 从"},{xtype:"datefield",format:"Y-m-d",name:"from"},{text:"至"},{xtype:"datefield",format:"Y-m-d",name:"to"},{xtype:"button",text:"查询",iconCls:"search",handler:function(){var d=Ext.getCmp("SharedDocumentForm");var c=Ext.getCmp("DocumentSharedGrid");if(d.getForm().isValid()){$search({searchPanel:d,gridPanel:c});}}},{xtype:"button",text:"重置",iconCls:"reset",handler:function(){var b=Ext.getCmp("SharedDocumentForm");b.getForm().reset();}}]}),this.setup()]});};DocumentSharedView.prototype.setup=function(){return this.grid();};DocumentSharedView.prototype.grid=function(){var g=new Ext.grid.CheckboxSelectionModel();var f=new Ext.grid.ColumnModel({columns:[g,new Ext.grid.RowNumberer(),{header:"docId",dataIndex:"docId",hidden:true},{header:"文档名称",dataIndex:"docName",width:120,renderer:function(a,b,c){return a+"--"+'由 <font color="green">'+c.data.fullname+"</font> 共享";}},{header:"创建时间",dataIndex:"createtime"},{header:"共享人",dataIndex:"fullname"},{header:"附件",dataIndex:"haveAttach",renderer:function(b,d,l){if(b==""||b=="0"){return"无附件";}else{var c=l.data.attachFiles;var a="";for(var i=0;i<c.length;i++){a+='<a href="#" onclick="FileAttachDetail.show('+c[i].fileId+');" class="attachment">'+c[i].fileName+"</a>";a+="&nbsp;";}return a;}}},{header:"查看",dataIndex:"docId",width:50,renderer:function(d,m,o,a,n){var b=o.data.docId;var p=o.data.docName;var c='<button title="查看" value=" " class="btn-readdocument" onclick="DocumentSharedView.read('+b+",'"+p+"')\">&nbsp;</button>";return c;}}],defaults:{menuDisabled:false,width:100}});var e=this.store();e.load({params:{start:0,limit:25}});var h=new Ext.grid.GridPanel({id:"DocumentSharedGrid",region:"center",store:e,trackMouseOver:true,disableSelection:false,loadMask:true,tbar:new Ext.Toolbar({height:27}),maxHeight:600,cm:f,sm:g,viewConfig:{forceFit:true,enableRowBody:false,showPreview:false},bbar:new HT.PagingBar({store:e})});h.addListener("rowdblclick",function(b,c,a){b.getSelectionModel().each(function(d){DocumentSharedView.read(d.data.docId,d.data.docName);});});return h;};DocumentSharedView.prototype.store=function(){var b=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:__ctxPath+"/document/shareListDocument.do"}),reader:new Ext.data.JsonReader({root:"result",totalProperty:"totalCounts",id:"id",fields:[{name:"docId",type:"int"},"docName","fullname","content","createtime","haveAttach","attachFiles"]}),remoteSort:true});return b;};DocumentSharedView.read=function(g,e){var h=Ext.getCmp("centerTabPanel");var f=Ext.getCmp("DocumentShared");if(f==null){f=new DocumentSharedPanel(g,e);h.add(f);h.activate(f);}else{h.remove("DocumentShared");f=new DocumentSharedPanel(g,e);h.add(f);h.activate(f);}};