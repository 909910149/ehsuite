DocumentSharedForm=Ext.extend(Ext.Window,{formPanel:null,constructor:function(b){Ext.applyIf(this,b);this.initUI();DocumentSharedForm.superclass.constructor.call(this,{title:"文档授权信息",width:545,iconCls:"menu-mail_folder",height:380,modal:true,layout:"fit",plain:true,scope:this,minWidth:544,buttonAlign:"center",items:this.formPanel,buttons:this.buttons});},initUI:function(){this.formPanel=new Ext.FormPanel({id:"documentSharedForm",bodyStyle:"padding:4px 10px 4px 10px",items:[{xtype:"hidden",name:"docId",value:this.docId},{xtype:"fieldset",border:false,layout:"column",items:[{xtype:"label",text:"共享人员",width:100},{xtype:"hidden",name:"sharedUserIds",id:"sharedUserIds"},{xtype:"textarea",name:"sharedUserNames",id:"sharedUserNames",width:300},{xtype:"button",text:"选择",iconCls:"btn-select",width:80,handler:function(){UserSelector.getView(function(g,k){var h=Ext.getCmp("sharedUserIds");var j=Ext.getCmp("sharedUserNames");if(h.getValue()==""){h.setValue(","+g+",");j.setValue(k);return;}else{var i=h.getValue().split(",");var l=j.getValue().split(",");h.setValue(uniqueArray(i.concat(g.split(",")))+",");j.setValue(uniqueArray(l.concat(k.split(","))));}}).show();}},{xtype:"button",iconCls:"btn-clear",text:"清空",handler:function(){var d=Ext.getCmp("sharedUserIds");var c=Ext.getCmp("sharedUserNames");d.setValue("");c.setValue("");},width:80}]},{xtype:"fieldset",border:false,layout:"column",items:[{xtype:"label",text:"共享部门",width:100},{name:"sharedDepIds",id:"sharedDepIds",xtype:"hidden"},{name:"sharedDepNames",id:"sharedDepNames",xtype:"textarea",width:300},{xtype:"button",text:"选择",iconCls:"btn-select",width:80,handler:function(){DepSelector.getView(function(l,j){var g=Ext.getCmp("sharedDepIds");var k=Ext.getCmp("sharedDepNames");if(g.getValue()==""){g.setValue(","+l+",");k.setValue(j);return;}var i=g.getValue().split(",");var h=k.getValue().split(",");g.setValue(uniqueArray(i.concat(l.split(",")))+",");k.setValue(uniqueArray(h.concat(j.split(","))));}).show();}},{xtype:"button",text:"清空",iconCls:"btn-clear",handler:function(){var d=Ext.getCmp("sharedDepIds");var c=Ext.getCmp("sharedDepNames");d.setValue("");c.setValue("");},width:80}]},{xtype:"fieldset",border:false,layout:"column",items:[{xtype:"label",text:"共享角色",width:100},{xtype:"hidden",id:"sharedRoleIds",name:"sharedRoleIds"},{name:"sharedRoleNames",id:"sharedRoleNames",xtype:"textarea",width:300},{xtype:"button",text:"选择",iconCls:"btn-select",width:80,handler:function(){RoleSelector.getView(function(k,j){var h=Ext.getCmp("sharedRoleIds");var g=Ext.getCmp("sharedRoleNames");if(h.getValue()==""){h.setValue(","+k+",");g.setValue(j);return;}var i=h.getValue().split(",");var l=g.getValue().split(",");h.setValue(uniqueArray(i.concat(k.split(",")))+",");g.setValue(uniqueArray(l.concat(j.split(","))));}).show();}},{xtype:"button",text:"清空",iconCls:"btn-clear",handler:function(){var d=Ext.getCmp("sharedRoleIds");var c=Ext.getCmp("sharedRoleNames");d.setValue("");c.setValue("");},width:80}]}]});if(this.docId!=null&&this.docId!=""&&this.docId!="undefined"){this.formPanel.getForm().load({deferredRender:false,url:__ctxPath+"/document/getDocument.do?docId="+this.docId,waitMsg:"正在载入数据...",success:function(d,c){},failure:function(d,c){Ext.MessageBox.show({title:"操作信息",msg:"载入信息失败，请联系管理员！",buttons:Ext.MessageBox.OK,icon:"ext-mb-error"});}});}this.buttons=[{xtype:"button",text:"共享",scope:this,iconCls:"btn-ok",handler:function(){var b=this;this.formPanel.getForm().submit({url:__ctxPath+"/document/shareDocument.do",method:"post",waitMsg:"正在提交...",success:function(f,e){var a=Ext.getCmp("PrivateDocumentView");if(a!=null){a.dataView.getStore().reload();}b.close();}});}},{xtype:"button",text:"取消共享",scope:this,iconCls:"btn-cancel",handler:function(){var b=this;this.formPanel.getForm().submit({url:__ctxPath+"/document/unshareDocument.do",method:"post",waitMsg:"正在提交...",success:function(f,e){var a=Ext.getCmp("PrivateDocumentView");if(a!=null){a.dataView.getStore().reload();}b.close();}});}},{xtype:"button",iconCls:"btn-cancel",text:"关闭",scope:this,handler:function(){this.close();}}];}});