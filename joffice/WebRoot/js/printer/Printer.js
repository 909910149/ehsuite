Ext.ns("Ext.ux.plugins");Ext.ux.plugins.Print={printGrid:function(n){var m=this.component;var h=m.getStore();if((!n||n.browserEvent)&&h.lastOptions&&h.lastOptions.params&&h.lastOptions.params.limit&&h.lastOptions.params.limit!=0){var i=Math.min(100,h.getTotalCount());var k=h.lastOptions.params;var j=Ext.applyIf({limit:i},k);h.load({params:j,callback:function(){this.printGrid({params:k});},scope:this});return;}var l=m.getColumnModel().getTotalWidth();var j={id:m.el.id,width:l};window.open(__ctxPath+"/js/printer/Preview.jsp?"+Ext.urlEncode(j)+"&rand="+Math.random(),"printPreview");if(n&&n.params){h.load.defer(1000,h,[{params:n.params}]);}},printForm:function(){var d=this.component;var c={id:d.body.id,type:"form",title:d.title||d.ownerCt.title};window.open(__ctxPath+"/js/printer/Preview.jsp?"+Ext.urlEncode(c)+"&rand="+Math.random(),"printPreview");},init:function(j){var k=j.xtype||j.getXType();switch(k){case"htgrid":this.component=j;if(!j.tools){j.tools=[];}j.tools.push({id:"print",handler:this.printGrid,scope:this});break;case"form":this.component=j;if(j.tools){j.tools.push({id:"print",handler:this.printForm,scope:this});}else{var l=j.getTopToolbar();if(l){var m=false;for(var n=0,i=l.length;n<i;n++){if(l[n].text=="Print"){var h=l[n];if(!h.handler){Ext.apply(h,{handler:this.printForm,scope:j});m=true;}break;}}if(!m){l.push({iconCls:"print",handler:this.printForm,scope:this});}}}break;}}};Ext.ux.PrintSetup=function(){this.init();};Ext.ux.PrintSetup=Ext.extend(Ext.ux.PrintSetup,{setupGrid:function(){var d=this.params.width;if(!isNaN(d)){d=parseInt(d)+"px";}else{d=undefined;}var c={height:null,width:d};this.applyStyles("div[class*='x-grid3-hd-inner']",{"padding-right":null});this.applyStyles("div[class*='x-grid3-header-inner']",{"width":null});this.applyStyles("div[class='x-grid3-scroller']",c);this.applyStyles("div[class='x-panel-body']",c);this.applyStyles("div[class='x-grid3']",c);this.setTitle();},applyStyles:function(g,k){var i=Ext.DomQuery.select(g);if(i){var j=Ext.DomHelper;for(var l=0,h=i.length;l<h;l++){j.applyStyles(i[l],k);}}},setTitle:function(d){if(!d){d="x-panel-header-text";}var c=Ext.DomQuery.select("span[class='"+d+"']");if(c&&c.length>0){document.title=c[0].innerHTML;}},setupForm:function(){document.title=this.params.title;},init:function(){var d=window.opener;if(d){var c=Ext.urlDecode(location.href.substring(location.href.indexOf("?")+1));this.params=c;if(c.id){window.document.body.innerHTML=d.document.getElementById(c.id).innerHTML;Ext.applyIf(c,{type:"grid"});alert(c.type);switch(c.type){case"htgrid":this.setupGrid();break;case"form":this.setupForm();}}}}});