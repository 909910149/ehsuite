Ext.ns("MySubUserDiaryView");var MySubUserDiaryView=function(){return new Ext.Panel({id:"MySubUserDiaryView",title:"下属工作日志",iconCls:"menu-subDiary",layout:"border",region:"center",autoScroll:true,keys:{key:Ext.EventObject.ENTER,fn:function(){MySubUserDiaryView.search();},scope:this},items:[new Ext.FormPanel({region:"north",height:40,frame:false,border:false,id:"MySubUserDiarySearchForm",layout:"hbox",layoutConfig:{padding:"5",align:"middle"},defaults:{xtype:"label",margins:{top:0,right:4,bottom:4,left:4}},items:[{text:"请输入查询条件:"},{text:"下属姓名"},{xtype:"textfield",name:"fullname",maxLength:125},{xtype:"button",text:"查询",iconCls:"search",handler:function(){MySubUserDiaryView.search();}},{xtype:"button",text:"重置",iconCls:"reset",handler:function(){var b=Ext.getCmp("MySubUserDiarySearchForm");b.getForm().reset();}}]}),this.setup()]});};MySubUserDiaryView.prototype.setup=function(){return this.grid();};MySubUserDiaryView.prototype.grid=function(){var e=new Ext.grid.ColumnModel({columns:[new Ext.grid.RowNumberer(),{header:"diaryId",dataIndex:"diaryId",hidden:true},{header:"姓名",dataIndex:"userName"},{header:"日期",dataIndex:"dayTime"},{header:"管理",dataIndex:"diaryId",width:100,renderer:function(k,l,n,a,m){var b=n.data.diaryId;var c='<button title="查看" value=" " class="btn-readdocument" onclick="MySubUserDiaryView.check('+b+')">&nbsp;</button>';return c;}}],defaults:{sortable:true,menuDisabled:true,width:100}});var d=this.store();d.load({params:{start:0,limit:10}});var f=new Ext.grid.GridPanel({id:"MySubUserDiaryGrid",store:d,trackMouseOver:true,disableSelection:false,loadMask:true,tbar:new Ext.Toolbar({height:30,bodyStyle:"text-align:left",items:[]}),region:"center",cm:e,viewConfig:{forceFit:true,enableRowBody:false,showPreview:false},bbar:new HT.PagingBar({store:d})});f.addListener("rowdblclick",function(b,c,a){b.getSelectionModel().each(function(g){MySubUserDiaryView.check(g.data.diaryId);});});return f;};MySubUserDiaryView.prototype.store=function(){var b=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:__ctxPath+"/system/subUserDiary.do"}),reader:new Ext.data.JsonReader({root:"result",totalProperty:"totalCounts",id:"id",fields:[{name:"diaryId",type:"int"},"dayTime","content","diaryType",{name:"userName",mapping:"appUser.fullname"}]}),remoteSort:true});b.setDefaultSort("diaryId","desc");return b;};MySubUserDiaryView.check=function(b){new DiaryDetail(b);};MySubUserDiaryView.search=function(){var d=Ext.getCmp("MySubUserDiarySearchForm");var c=Ext.getCmp("MySubUserDiaryGrid");if(d.getForm().isValid()){$search({searchPanel:d,gridPanel:c});}};