var ReportParamView=function(d,e){this.title=e;var f=new Ext.Window({id:"ReportParamView",title:this.title+"--查询参数设置",width:650,autoHeight:true,x:200,y:50,modal:true,layout:"fit",plain:true,bodyStyle:"padding:5px;",buttonAlign:"center",items:[this.setup(d)]});f.show();};ReportParamView.prototype.setup=function(b){return this.grid(b);};ReportParamView.prototype.grid=function(i){var h=new Ext.grid.CheckboxSelectionModel();var g=new Ext.grid.ColumnModel({columns:[h,new Ext.grid.RowNumberer(),{header:"paramId",dataIndex:"paramId",hidden:true},{header:"参数名称",dataIndex:"paramName"},{header:"参数Key",dataIndex:"paramKey"},{header:"缺省值",dataIndex:"defaultVal"},{header:"类型",dataIndex:"paramType",renderer:function(a){switch(a){case"textfield":return"文件输入框";break;case"datefield":return"日期输入框";break;case"datetimefield":return"时间输入框";break;case"numberfield":return"数字输入框";break;case"combo":return"下拉框";break;case"diccombo":return"数据字典";break;default:return"文件输入框";}}},{header:"序列号",dataIndex:"sn"},{header:"管理",dataIndex:"paramId",width:50,sortable:false,renderer:function(d,e,n,a,m){var b=n.data.paramId;var c='<button title="删除" value=" " class="btn-del" onclick="ReportParamView.remove('+i+",'"+b+"')\">&nbsp;&nbsp;</button>";c+='&nbsp;<button title="编辑" value=" " class="btn-edit" onclick="ReportParamView.edit('+i+",'"+b+"')\">&nbsp;&nbsp;</button>";return c;}}],defaults:{sortable:true,menuDisabled:false,width:100}});var f=this.store();f.load({params:{reportId:i}});var j=new Ext.grid.GridPanel({id:"ReportParamGrid",tbar:this.topbar(i),store:f,height:250,trackMouseOver:true,disableSelection:false,loadMask:true,region:"center",cm:g,sm:h,viewConfig:{forceFit:true,enableRowBody:false,showPreview:false}});j.addListener("rowdblclick",function(b,c,a){b.getSelectionModel().each(function(d){ReportParamView.edit(i,d.data.paramId);});});return j;};ReportParamView.prototype.store=function(){var b=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:__ctxPath+"/system/listReportParam.do"}),reader:new Ext.data.JsonReader({root:"result",id:"id",fields:[{name:"paramId",type:"int"},"reportId","paramName","paramKey","defaultVal","paramType","sn"]}),remoteSort:true});b.setDefaultSort("paramId","desc");return b;};ReportParamView.prototype.topbar=function(d){var c=new Ext.Toolbar({id:"ReportParamFootBar",height:30,bodyStyle:"text-align:left",items:[{iconCls:"btn-add",text:"添加参数",xtype:"button",handler:function(){new ReportParamForm(d);}},{iconCls:"btn-del",text:"删除参数",xtype:"button",handler:function(){var b=Ext.getCmp("ReportParamGrid");var h=b.getSelectionModel().getSelections();if(h.length==0){Ext.ux.Toast.msg("信息","请选择要删除的记录！");return;}var a=Array();for(var g=0;g<h.length;g++){a.push(h[g].data.paramId);}ReportParamView.remove(d,a);}}]});return c;};ReportParamView.remove=function(f,e){var d=Ext.getCmp("ReportParamGrid");Ext.Msg.confirm("信息确认","您确认要删除该记录吗？",function(a){if(a=="yes"){Ext.Ajax.request({url:__ctxPath+"/system/multiDelReportParam.do",params:{ids:e},method:"post",success:function(){Ext.ux.Toast.msg("信息提示","成功删除所选记录！");d.getStore().reload({params:{reportId:f}});}});}});};ReportParamView.edit=function(c,d){new ReportParamForm(c,d);};