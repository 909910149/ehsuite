UserJobForm=Ext.extend(Ext.Window,{constructor:function(b){Ext.applyIf(this,b);this.initUIComponents();UserJobForm.superclass.constructor.call(this,{id:"UserJobFormWin",layout:"fit",iconCls:"menu-job",items:this.formPanel,modal:true,height:180,minHeight:180,width:500,minWidth:500,maximizable:true,title:this.jobName==null?"新增/编辑职位人员信息":"新增/编辑职位["+this.jobName+"]人员信息",buttonAlign:"center",buttons:[{text:"保存",iconCls:"btn-save",scope:this,handler:this.save},{text:"取消",iconCls:"btn-cancel",scope:this,handler:this.cancel}],keys:{key:Ext.EventObject.ENTER,fn:this.save,scope:this}});},initUIComponents:function(){this.formPanel=new Ext.FormPanel({layout:"form",bodyStyle:"padding:10px",border:false,id:"UserJobForm",defaults:{anchor:"100%,100%"},defaultType:"textfield",items:[{name:"userJob.userJobId",xtype:"hidden",value:this.userJobId==null?"":this.userJobId},{name:"userJob.job.jobId",xtype:"hidden",value:this.jobId==null?"":this.jobId},{name:"userJob.appUser.userId",xtype:"hidden"},{xtype:"container",layout:"column",fieldLabel:"员工名称",style:"margin-bottom:5px;",items:[{columnWidth:0.99,xtype:"textfield",name:"userJob.appUser.username",readOnly:true,allowBlank:false,maxLength:128},{xtype:"button",text:"请选择",iconCls:"btn-user-sel",handler:function(){UserSelector.getView(function(f,e){var d=Ext.getCmp("UserJobForm");d.getCmpByName("userJob.appUser.userId").setValue(f);d.getCmpByName("userJob.appUser.username").setValue(e);},true).show();},disabled:this.userJobId==null?false:true}]},{xtype:"container",layout:"column",fieldLabel:"员工职位",style:"margin-bottom:5px;",items:[{columnWidth:0.99,xtype:"textfield",name:"userJob.job.jobName",readOnly:true,allowBlank:false,maxLength:128,value:this.jobName!=null?this.jobName:""},{xtype:"button",text:"请选择",iconCls:"btn-job-sel",handler:function(){JobSelector.getView(function(d,e){var f=Ext.getCmp("UserJobForm");f.getCmpByName("userJob.job.jobId").setValue(d);f.getCmpByName("userJob.job.jobName").setValue(e);},true).show();}}]},{fieldLabel:"是否主职位",hiddenName:"userJob.isMain",displayField:"name",valueField:"id",xtype:"combo",mode:"local",store:[["0","否"],["1","是"]],triggerAction:"all",editable:false,emptyText:"--请选择是否为主职位--",value:0,anchor:"99%"}]});if(this.userJobId!=null&&this.userJobId!="undefined"){this.formPanel.loadData({url:__ctxPath+"/system/getUserJob.do?userJobId="+this.userJobId,root:"data",preName:"userJob"});}},cancel:function(){this.close();},save:function(){var b=this.formPanel;if(b.getForm().isValid()){b.getForm().submit({url:__ctxPath+"/system/saveUserJob.do",method:"post",waitMsg:"数据正在，提交请稍后...",success:function(a,e){var f=Ext.getCmp("userJobUserGrid");if(f!=null){f.getStore().reload();}Ext.ux.Toast.msg("操作提示","数据提交成功！");Ext.getCmp("UserJobFormWin").close();},failure:function(a,e){var f=Ext.util.JSON.decode(e.response.responseText);Ext.ux.Toast.msg("操作提示",f.msg);}});}}});