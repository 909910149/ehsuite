Ext.ns("SysConfigView");var SysConfigView=function(){return new Ext.Panel({id:"SysConfigView",iconCls:"menu-system-setting",title:"系统配置",tbar:this.tbar(),autoScroll:true,items:[this.setup()]});};SysConfigView.prototype.tbar=function(){var b=new Ext.Toolbar();b.add(new Ext.Button({text:"保存",iconCls:"btn-save",handler:function(){var a=Ext.getCmp("mailConfigForm");if(a.getForm().isValid()){a.getForm().submit({method:"post",waitMsg:"正在提交数据...",success:function(h,f){Ext.ux.Toast.msg("操作信息","成功信息保存！");var g=Ext.getCmp("centerTabPanel");g.remove("SysConfigView");},failure:function(f,e){Ext.MessageBox.show({title:"操作信息",msg:"信息保存出错，请联系管理员！",buttons:Ext.MessageBox.OK,icon:"ext-mb-error"});}});}}}));b.add(new Ext.Button({text:"重置",iconCls:"btn-reseted",handler:function(){var a=Ext.getCmp("mailConfigForm");a.removeAll();SysConfigView.loadSysConfigData(a);}}));return b;};SysConfigView.prototype.setup=function(){var b=new Ext.FormPanel({id:"mailConfigForm",url:__ctxPath+"/system/saveSysConfig.do",defaultType:"textfield",bodyStyle:"padding-left:10%;",frame:false,border:false,layout:"form",items:[]});SysConfigView.loadSysConfigData(b);return b;};SysConfigView.loadSysConfigData=function(b){Ext.Ajax.request({url:__ctxPath+"/system/loadSysConfig.do",success:function(Q,O){var i=Ext.util.JSON.decode(Q.responseText);var I=i.data.adminConfig;var A=[];if(I){for(var D=0;D<I.length;D++){A.push({xtype:"container",style:"padding-bottom:3px;",layout:"column",items:[{xtype:"label",style:"font-weight:bold;",text:I[D].configName,width:100},{xtype:"textfield",width:300,allowBlank:false,id:I[D].configKey,name:I[D].configKey,value:I[D].dataValue},{xtype:"label",width:200,text:I[D].configDesc}]});}}var C={xtype:"fieldset",title:"行政管理配置",width:650,style:"padding-bottom:3px;",layout:"form",items:A};var y=i.data.codeConfig;var B=[];if(y){for(var D=0;D<y.length;D++){B.push({xtype:"container",style:"padding-bottom:3px;",layout:"column",items:[{xtype:"label",style:"font-weight:bold;",text:y[D].configName,width:100},{xtype:"combo",mode:"local",editable:false,triggerAction:"all",store:[["1","开启验证码"],["2","屏蔽验证码"]],width:300,allowBlank:false,hiddenName:y[D].configKey,value:y[D].dataValue},{xtype:"label",width:200,text:y[D].configDesc}]});}}var F={xtype:"fieldset",title:"验证码配置",width:650,style:"padding-bottom:3px;",layout:"form",items:B};var R=i.data.smsConfig;var z=[];if(R){for(var D=0;D<R.length;D++){if(R[D].dataType==2){z.push({xtype:"container",style:"padding-bottom:3px;",layout:"column",items:[{xtype:"label",style:"font-weight:bold;",text:R[D].configName,width:100},{xtype:"combo",mode:"local",editable:false,triggerAction:"all",store:[["1","打开"],["2","关闭"]],width:300,allowBlank:false,hiddenName:R[D].configKey,value:R[D].dataValue},{xtype:"label",width:200,text:R[D].configDesc}]});}else{z.push({xtype:"container",style:"padding-bottom:3px;",layout:"column",items:[{xtype:"label",style:"font-weight:bold;",text:R[D].configName,width:100},{xtype:"textfield",width:300,allowBlank:false,id:R[D].configKey,name:R[D].configKey,value:R[D].dataValue},{xtype:"label",width:200,text:R[D].configDesc}]});}}z.push({xtype:"container",style:"padding-bottom:3px;",layout:"column",items:[{xtype:"button",iconCls:"menu-mobile",text:"测试设备连接",handler:function(){new SmsMobileForm({}).show();}}]});}var G={xtype:"fieldset",title:"短信猫配置",width:650,style:"padding-bottom:3px;",layout:"form",items:z};var H=i.data.smsPortConfig;var a=[];if(H){for(var D=0;D<H.length;D++){a.push({xtype:"container",style:"padding-bottom:3px;",layout:"column",items:[{xtype:"label",style:"font-weight:bold;",text:H[D].configName,width:100},{xtype:"textfield",width:300,id:H[D].configKey,name:H[D].configKey,value:H[D].dataValue},{xtype:"label",width:200,text:H[D].configDesc}]});}a.push({xtype:"container",style:"padding-bottom:3px;",layout:"column",items:[{xtype:"button",iconCls:"menu-mobile",text:"测试手机端口",handler:function(){new SmsMobileForm({}).show();}}]});}var P={xtype:"fieldset",title:"短信端口配置",width:650,style:"padding-bottom:3px;",layout:"form",items:a};var E=i.data.suggestConfig;var K=[];if(E){K.push({xtype:"container",style:"padding-bottom:3px;",layout:"column",items:[{xtype:"label",style:"font-weight:bold;",text:E[1].configName,width:100},{xtype:"textfield",editable:false,width:300,allowBlank:false,id:E[1].configKey,name:E[1].configKey,value:E[1].dataValue},{xtype:"button",text:"选择",iconCls:"btn-add",handler:function(){UserSelector.getView(function(c,e){var d=Ext.getCmp(E[1].configKey);var f=Ext.getCmp(E[0].configKey);d.setValue(e);f.setValue(c);},true).show();}},{xtype:"label",width:100,text:E[1].configDesc},{xtype:"hidden",editable:false,width:300,allowBlank:false,id:E[0].configKey,name:E[0].configKey,value:E[0].dataValue}]});}var J={xtype:"fieldset",title:"意见箱配置",width:650,style:"padding-bottom:3px;",layout:"form",items:K};var N=i.data.dynamicPwdConfig;var L=[];if(N){L.push({xtype:"container",style:"padding-bottom:3px;",layout:"column",items:[{xtype:"container",style:"padding-bottom:3px;",layout:"column",items:[{xtype:"label",style:"font-weight:bold;",text:N[0].configName,width:100},{xtype:"combo",mode:"local",editable:false,triggerAction:"all",store:[["1","打开"],["2","关闭"]],width:300,allowBlank:false,hiddenName:N[0].configKey,value:N[0].dataValue},{xtype:"label",width:200,text:N[0].configDesc}]},{xtype:"label",style:"font-weight:bold;",text:N[1].configName,width:100},{xtype:"textfield",width:300,allowBlank:false,id:N[1].configKey,name:N[1].configKey,value:N[1].dataValue},{xtype:"label",width:200,text:N[1].configDesc}]});}var M={xtype:"fieldset",title:"动态密码配置",width:650,style:"padding-bottom:3px;",layout:"form",items:L};b.add(C);b.add(F);b.add(G);b.add(P);b.add(J);b.add(M);b.doLayout();}});};