Ext.ux.grid.filter.DateFilter=Ext.extend(Ext.ux.grid.filter.Filter,{afterText:"After",beforeText:"Before",compareMap:{before:"lt",after:"gt",on:"eq"},dateFormat:"m/d/Y",menuItems:["before","after","-","on"],menuItemCfgs:{selectOnFocus:true,width:125},onText:"On",pickerOpts:{},init:function(n){var j,m,i,l,h,k;j=Ext.apply(this.pickerOpts,{minDate:this.minDate,maxDate:this.maxDate,format:this.dateFormat,listeners:{scope:this,select:this.onMenuSelect}});this.fields={};for(m=0,i=this.menuItems.length;m<i;m++){l=this.menuItems[m];if(l!=="-"){h={itemId:"range-"+l,text:this[l+"Text"],menu:new Ext.menu.DateMenu(Ext.apply(j,{itemId:l})),listeners:{scope:this,checkchange:this.onCheckChange}};k=Ext.menu.CheckItem;l=this.fields[l]=new k(h);}this.menu.add(l);}},onCheckChange:function(){this.setActive(this.isActivatable());this.fireEvent("update",this);},onInputKeyUp:function(f,d){var e=d.getKey();if(e==d.RETURN&&f.isValid()){d.stopEvent();this.menu.hide(true);return;}},onMenuSelect:function(j,i,f){var g=this.fields,h=this.fields[j.itemId];h.setChecked(true);if(h==g.on){g.before.setChecked(false,true);g.after.setChecked(false,true);}else{g.on.setChecked(false,true);if(h==g.after&&g.before.menu.picker.value<i){g.before.setChecked(false,true);}else{if(h==g.before&&g.after.menu.picker.value>i){g.after.setChecked(false,true);}}}this.fireEvent("update",this);},getValue:function(){var c,d={};for(c in this.fields){if(this.fields[c].checked){d[c]=this.fields[c].menu.picker.getValue();}}return d;},setValue:function(f,d){var e;for(e in this.fields){if(f[e]){this.fields[e].menu.picker.setValue(f[e]);this.fields[e].setChecked(true);}else{if(!d){this.fields[e].setChecked(false);}}}this.fireEvent("update",this);},isActivatable:function(){var b;for(b in this.fields){if(this.fields[b].checked){return true;}}return false;},getSerialArgs:function(){var d=[];for(var c in this.fields){if(this.fields[c].checked){d.push({type:"date",comparison:this.compareMap[c],value:this.getFieldValue(c).format(this.dateFormat)});}}return d;},getFieldValue:function(b){return this.fields[b].menu.picker.getValue();},getPicker:function(b){return this.fields[b].menu.picker;},validateRecord:function(f){var e,g,h=f.get(this.dataIndex);if(!Ext.isDate(h)){return false;}h=h.clearTime(true).getTime();for(e in this.fields){if(this.fields[e].checked){g=this.getFieldValue(e).clearTime(true).getTime();if(e=="before"&&g<=h){return false;}if(e=="after"&&g>=h){return false;}if(e=="on"&&g!=h){return false;}}}return true;}});